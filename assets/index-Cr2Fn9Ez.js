var d2=Object.defineProperty;var K1=e=>{throw TypeError(e)};var p2=(e,_e,er)=>_e in e?d2(e,_e,{enumerable:!0,configurable:!0,writable:!0,value:er}):e[_e]=er;var Xs=(e,_e,er)=>p2(e,typeof _e!="symbol"?_e+"":_e,er),zp=(e,_e,er)=>_e.has(e)||K1("Cannot "+er);var jr=(e,_e,er)=>(zp(e,_e,"read from private field"),er?er.call(e):_e.get(e)),Vn=(e,_e,er)=>_e.has(e)?K1("Cannot add the same private member more than once"):_e instanceof WeakSet?_e.add(e):_e.set(e,er),Gn=(e,_e,er,tr)=>(zp(e,_e,"write to private field"),tr?tr.call(e,er):_e.set(e,er),er),On=(e,_e,er)=>(zp(e,_e,"access private method"),er);var _f=(e,_e,er,tr)=>({set _(rr){Gn(e,_e,rr,er)},get _(){return jr(e,_e,tr)}});(function(){const _e=document.createElement("link").relList;if(_e&&_e.supports&&_e.supports("modulepreload"))return;for(const rr of document.querySelectorAll('link[rel="modulepreload"]'))tr(rr);new MutationObserver(rr=>{for(const nr of rr)if(nr.type==="childList")for(const ir of nr.addedNodes)ir.tagName==="LINK"&&ir.rel==="modulepreload"&&tr(ir)}).observe(document,{childList:!0,subtree:!0});function er(rr){const nr={};return rr.integrity&&(nr.integrity=rr.integrity),rr.referrerPolicy&&(nr.referrerPolicy=rr.referrerPolicy),rr.crossOrigin==="use-credentials"?nr.credentials="include":rr.crossOrigin==="anonymous"?nr.credentials="omit":nr.credentials="same-origin",nr}function tr(rr){if(rr.ep)return;rr.ep=!0;const nr=er(rr);fetch(rr.href,nr)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var _e=e.default;if(typeof _e=="function"){var er=function tr(){return this instanceof tr?Reflect.construct(_e,arguments,this.constructor):_e.apply(this,arguments)};er.prototype=_e.prototype}else er={};return Object.defineProperty(er,"__esModule",{value:!0}),Object.keys(e).forEach(function(tr){var rr=Object.getOwnPropertyDescriptor(e,tr);Object.defineProperty(er,tr,rr.get?rr:{enumerable:!0,get:function(){return e[tr]}})}),er}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(e){return e===null||typeof e!="object"?null:(e=z$2&&e[z$2]||e["@@iterator"],typeof e=="function"?e:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(e,_e,er){this.props=e,this.context=_e,this.refs=D$2,this.updater=er||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(e,_e){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,_e,"setState")};E$2.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(e,_e,er){this.props=e,this.context=_e,this.refs=D$2,this.updater=er||B$2}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$2={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(e,_e,er){var tr,rr={},nr=null,ir=null;if(_e!=null)for(tr in _e.ref!==void 0&&(ir=_e.ref),_e.key!==void 0&&(nr=""+_e.key),_e)J$1.call(_e,tr)&&!L$2.hasOwnProperty(tr)&&(rr[tr]=_e[tr]);var ar=arguments.length-2;if(ar===1)rr.children=er;else if(1<ar){for(var sr=Array(ar),or=0;or<ar;or++)sr[or]=arguments[or+2];rr.children=sr}if(e&&e.defaultProps)for(tr in ar=e.defaultProps,ar)rr[tr]===void 0&&(rr[tr]=ar[tr]);return{$$typeof:l$2,type:e,key:nr,ref:ir,props:rr,_owner:K$2.current}}function N$2(e,_e){return{$$typeof:l$2,type:e.type,key:_e,ref:e.ref,props:e.props,_owner:e._owner}}function O$2(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$2}function escape$1(e){var _e={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(er){return _e[er]})}var P$2=/\/+/g;function Q$2(e,_e){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):_e.toString(36)}function R$2(e,_e,er,tr,rr){var nr=typeof e;(nr==="undefined"||nr==="boolean")&&(e=null);var ir=!1;if(e===null)ir=!0;else switch(nr){case"string":case"number":ir=!0;break;case"object":switch(e.$$typeof){case l$2:case n$2:ir=!0}}if(ir)return ir=e,rr=rr(ir),e=tr===""?"."+Q$2(ir,0):tr,I$2(rr)?(er="",e!=null&&(er=e.replace(P$2,"$&/")+"/"),R$2(rr,_e,er,"",function(or){return or})):rr!=null&&(O$2(rr)&&(rr=N$2(rr,er+(!rr.key||ir&&ir.key===rr.key?"":(""+rr.key).replace(P$2,"$&/")+"/")+e)),_e.push(rr)),1;if(ir=0,tr=tr===""?".":tr+":",I$2(e))for(var ar=0;ar<e.length;ar++){nr=e[ar];var sr=tr+Q$2(nr,ar);ir+=R$2(nr,_e,er,sr,rr)}else if(sr=A$2(e),typeof sr=="function")for(e=sr.call(e),ar=0;!(nr=e.next()).done;)nr=nr.value,sr=tr+Q$2(nr,ar++),ir+=R$2(nr,_e,er,sr,rr);else if(nr==="object")throw _e=String(e),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return ir}function S$2(e,_e,er){if(e==null)return e;var tr=[],rr=0;return R$2(e,tr,"","",function(nr){return _e.call(er,nr,rr++)}),tr}function T$2(e){if(e._status===-1){var _e=e._result;_e=_e(),_e.then(function(er){(e._status===0||e._status===-1)&&(e._status=1,e._result=er)},function(er){(e._status===0||e._status===-1)&&(e._status=2,e._result=er)}),e._status===-1&&(e._status=0,e._result=_e)}if(e._status===1)return e._result.default;throw e._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$2};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(e,_e,er){S$2(e,function(){_e.apply(this,arguments)},er)},count:function(e){var _e=0;return S$2(e,function(){_e++}),_e},toArray:function(e){return S$2(e,function(_e){return _e})||[]},only:function(e){if(!O$2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(e,_e,er){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var tr=C$2({},e.props),rr=e.key,nr=e.ref,ir=e._owner;if(_e!=null){if(_e.ref!==void 0&&(nr=_e.ref,ir=K$2.current),_e.key!==void 0&&(rr=""+_e.key),e.type&&e.type.defaultProps)var ar=e.type.defaultProps;for(sr in _e)J$1.call(_e,sr)&&!L$2.hasOwnProperty(sr)&&(tr[sr]=_e[sr]===void 0&&ar!==void 0?ar[sr]:_e[sr])}var sr=arguments.length-2;if(sr===1)tr.children=er;else if(1<sr){ar=Array(sr);for(var or=0;or<sr;or++)ar[or]=arguments[or+2];tr.children=ar}return{$$typeof:l$2,type:e.type,key:rr,ref:nr,props:tr,_owner:ir}};react_production_min.createContext=function(e){return e={$$typeof:u$1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$2;react_production_min.createFactory=function(e){var _e=M$2.bind(null,e);return _e.type=e,_e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$2,render:e}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(e){return{$$typeof:y$1,_payload:{_status:-1,_result:e},_init:T$2}};react_production_min.memo=function(e,_e){return{$$typeof:x$2,type:e,compare:_e===void 0?null:_e}};react_production_min.startTransition=function(e){var _e=V$2.transition;V$2.transition={};try{e()}finally{V$2.transition=_e}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(e,_e){return U$2.current.useCallback(e,_e)};react_production_min.useContext=function(e){return U$2.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$2.current.useDeferredValue(e)};react_production_min.useEffect=function(e,_e){return U$2.current.useEffect(e,_e)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(e,_e,er){return U$2.current.useImperativeHandle(e,_e,er)};react_production_min.useInsertionEffect=function(e,_e){return U$2.current.useInsertionEffect(e,_e)};react_production_min.useLayoutEffect=function(e,_e){return U$2.current.useLayoutEffect(e,_e)};react_production_min.useMemo=function(e,_e){return U$2.current.useMemo(e,_e)};react_production_min.useReducer=function(e,_e,er){return U$2.current.useReducer(e,_e,er)};react_production_min.useRef=function(e){return U$2.current.useRef(e)};react_production_min.useState=function(e){return U$2.current.useState(e)};react_production_min.useSyncExternalStore=function(e,_e,er){return U$2.current.useSyncExternalStore(e,_e,er)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(e,_e,er){var tr,rr={},nr=null,ir=null;er!==void 0&&(nr=""+er),_e.key!==void 0&&(nr=""+_e.key),_e.ref!==void 0&&(ir=_e.ref);for(tr in _e)m$2.call(_e,tr)&&!p$2.hasOwnProperty(tr)&&(rr[tr]=_e[tr]);if(e&&e.defaultProps)for(tr in _e=e.defaultProps,_e)rr[tr]===void 0&&(rr[tr]=_e[tr]);return{$$typeof:k$1,type:e,key:nr,ref:ir,props:rr,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function _e(Vr,Rr){var Xr=Vr.length;Vr.push(Rr);e:for(;0<Xr;){var an=Xr-1>>>1,yr=Vr[an];if(0<rr(yr,Rr))Vr[an]=Rr,Vr[Xr]=yr,Xr=an;else break e}}function er(Vr){return Vr.length===0?null:Vr[0]}function tr(Vr){if(Vr.length===0)return null;var Rr=Vr[0],Xr=Vr.pop();if(Xr!==Rr){Vr[0]=Xr;e:for(var an=0,yr=Vr.length,br=yr>>>1;an<br;){var Er=2*(an+1)-1,Lr=Vr[Er],Or=Er+1,Ur=Vr[Or];if(0>rr(Lr,Xr))Or<yr&&0>rr(Ur,Lr)?(Vr[an]=Ur,Vr[Or]=Xr,an=Or):(Vr[an]=Lr,Vr[Er]=Xr,an=Er);else if(Or<yr&&0>rr(Ur,Xr))Vr[an]=Ur,Vr[Or]=Xr,an=Or;else break e}}return Rr}function rr(Vr,Rr){var Xr=Vr.sortIndex-Rr.sortIndex;return Xr!==0?Xr:Vr.id-Rr.id}if(typeof performance=="object"&&typeof performance.now=="function"){var nr=performance;e.unstable_now=function(){return nr.now()}}else{var ir=Date,ar=ir.now();e.unstable_now=function(){return ir.now()-ar}}var sr=[],or=[],lr=1,ur=null,fr=3,cr=!1,mr=!1,dr=!1,xr=typeof setTimeout=="function"?setTimeout:null,pr=typeof clearTimeout=="function"?clearTimeout:null,gr=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function vr(Vr){for(var Rr=er(or);Rr!==null;){if(Rr.callback===null)tr(or);else if(Rr.startTime<=Vr)tr(or),Rr.sortIndex=Rr.expirationTime,_e(sr,Rr);else break;Rr=er(or)}}function Cr(Vr){if(dr=!1,vr(Vr),!mr)if(er(sr)!==null)mr=!0,zr(Tr);else{var Rr=er(or);Rr!==null&&Br(Cr,Rr.startTime-Vr)}}function Tr(Vr,Rr){mr=!1,dr&&(dr=!1,pr(Ar),Ar=-1),cr=!0;var Xr=fr;try{for(vr(Rr),ur=er(sr);ur!==null&&(!(ur.expirationTime>Rr)||Vr&&!wr());){var an=ur.callback;if(typeof an=="function"){ur.callback=null,fr=ur.priorityLevel;var yr=an(ur.expirationTime<=Rr);Rr=e.unstable_now(),typeof yr=="function"?ur.callback=yr:ur===er(sr)&&tr(sr),vr(Rr)}else tr(sr);ur=er(sr)}if(ur!==null)var br=!0;else{var Er=er(or);Er!==null&&Br(Cr,Er.startTime-Rr),br=!1}return br}finally{ur=null,fr=Xr,cr=!1}}var Fr=!1,_r=null,Ar=-1,Pr=5,Ir=-1;function wr(){return!(e.unstable_now()-Ir<Pr)}function kr(){if(_r!==null){var Vr=e.unstable_now();Ir=Vr;var Rr=!0;try{Rr=_r(!0,Vr)}finally{Rr?Mr():(Fr=!1,_r=null)}}else Fr=!1}var Mr;if(typeof gr=="function")Mr=function(){gr(kr)};else if(typeof MessageChannel<"u"){var Hr=new MessageChannel,Gr=Hr.port2;Hr.port1.onmessage=kr,Mr=function(){Gr.postMessage(null)}}else Mr=function(){xr(kr,0)};function zr(Vr){_r=Vr,Fr||(Fr=!0,Mr())}function Br(Vr,Rr){Ar=xr(function(){Vr(e.unstable_now())},Rr)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Vr){Vr.callback=null},e.unstable_continueExecution=function(){mr||cr||(mr=!0,zr(Tr))},e.unstable_forceFrameRate=function(Vr){0>Vr||125<Vr?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Pr=0<Vr?Math.floor(1e3/Vr):5},e.unstable_getCurrentPriorityLevel=function(){return fr},e.unstable_getFirstCallbackNode=function(){return er(sr)},e.unstable_next=function(Vr){switch(fr){case 1:case 2:case 3:var Rr=3;break;default:Rr=fr}var Xr=fr;fr=Rr;try{return Vr()}finally{fr=Xr}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Vr,Rr){switch(Vr){case 1:case 2:case 3:case 4:case 5:break;default:Vr=3}var Xr=fr;fr=Vr;try{return Rr()}finally{fr=Xr}},e.unstable_scheduleCallback=function(Vr,Rr,Xr){var an=e.unstable_now();switch(typeof Xr=="object"&&Xr!==null?(Xr=Xr.delay,Xr=typeof Xr=="number"&&0<Xr?an+Xr:an):Xr=an,Vr){case 1:var yr=-1;break;case 2:yr=250;break;case 5:yr=1073741823;break;case 4:yr=1e4;break;default:yr=5e3}return yr=Xr+yr,Vr={id:lr++,callback:Rr,priorityLevel:Vr,startTime:Xr,expirationTime:yr,sortIndex:-1},Xr>an?(Vr.sortIndex=Xr,_e(or,Vr),er(sr)===null&&Vr===er(or)&&(dr?(pr(Ar),Ar=-1):dr=!0,Br(Cr,Xr-an))):(Vr.sortIndex=yr,_e(sr,Vr),mr||cr||(mr=!0,zr(Tr))),Vr},e.unstable_shouldYield=wr,e.unstable_wrapCallback=function(Vr){var Rr=fr;return function(){var Xr=fr;fr=Rr;try{return Vr.apply(this,arguments)}finally{fr=Xr}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(e){for(var _e="https://reactjs.org/docs/error-decoder.html?invariant="+e,er=1;er<arguments.length;er++)_e+="&args[]="+encodeURIComponent(arguments[er]);return"Minified React error #"+e+"; visit "+_e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,_e){ha(e,_e),ha(e+"Capture",_e)}function ha(e,_e){for(ea[e]=_e,e=0;e<_e.length;e++)da.add(_e[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,_e,er,tr){if(er!==null&&er.type===0)return!1;switch(typeof _e){case"function":case"symbol":return!0;case"boolean":return tr?!1:er!==null?!er.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,_e,er,tr){if(_e===null||typeof _e>"u"||pa(e,_e,er,tr))return!0;if(tr)return!1;if(er!==null)switch(er.type){case 3:return!_e;case 4:return _e===!1;case 5:return isNaN(_e);case 6:return isNaN(_e)||1>_e}return!1}function v$1(e,_e,er,tr,rr,nr,ir){this.acceptsBooleans=_e===2||_e===3||_e===4,this.attributeName=tr,this.attributeNamespace=rr,this.mustUseProperty=er,this.propertyName=e,this.type=_e,this.sanitizeURL=nr,this.removeEmptyString=ir}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z$1[e]=new v$1(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var _e=e[0];z$1[_e]=new v$1(_e,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z$1[e]=new v$1(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z$1[e]=new v$1(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z$1[e]=new v$1(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z$1[e]=new v$1(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z$1[e]=new v$1(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z$1[e]=new v$1(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z$1[e]=new v$1(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var _e=e.replace(ra,sa);z$1[_e]=new v$1(_e,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var _e=e.replace(ra,sa);z$1[_e]=new v$1(_e,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var _e=e.replace(ra,sa);z$1[_e]=new v$1(_e,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z$1[e]=new v$1(e,1,!1,e.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z$1[e]=new v$1(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,_e,er,tr){var rr=z$1.hasOwnProperty(_e)?z$1[_e]:null;(rr!==null?rr.type!==0:tr||!(2<_e.length)||_e[0]!=="o"&&_e[0]!=="O"||_e[1]!=="n"&&_e[1]!=="N")&&(qa(_e,er,rr,tr)&&(er=null),tr||rr===null?oa(_e)&&(er===null?e.removeAttribute(_e):e.setAttribute(_e,""+er)):rr.mustUseProperty?e[rr.propertyName]=er===null?rr.type===3?!1:"":er:(_e=rr.attributeName,tr=rr.attributeNamespace,er===null?e.removeAttribute(_e):(rr=rr.type,er=rr===3||rr===4&&er===!0?"":""+er,tr?e.setAttributeNS(tr,_e,er):e.setAttribute(_e,er))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A$1=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(er){var _e=er.stack.trim().match(/\n( *(at )?)/);La=_e&&_e[1]||""}return`
`+La+e}var Na=!1;function Oa(e,_e){if(!e||Na)return"";Na=!0;var er=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_e)if(_e=function(){throw Error()},Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(or){var tr=or}Reflect.construct(e,[],_e)}else{try{_e.call()}catch(or){tr=or}e.call(_e.prototype)}else{try{throw Error()}catch(or){tr=or}e()}}catch(or){if(or&&tr&&typeof or.stack=="string"){for(var rr=or.stack.split(`
`),nr=tr.stack.split(`
`),ir=rr.length-1,ar=nr.length-1;1<=ir&&0<=ar&&rr[ir]!==nr[ar];)ar--;for(;1<=ir&&0<=ar;ir--,ar--)if(rr[ir]!==nr[ar]){if(ir!==1||ar!==1)do if(ir--,ar--,0>ar||rr[ir]!==nr[ar]){var sr=`
`+rr[ir].replace(" at new "," at ");return e.displayName&&sr.includes("<anonymous>")&&(sr=sr.replace("<anonymous>",e.displayName)),sr}while(1<=ir&&0<=ar);break}}}finally{Na=!1,Error.prepareStackTrace=er}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var _e=e.render;return e=e.displayName,e||(e=_e.displayName||_e.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return _e=e.displayName||null,_e!==null?_e:Qa(e.type)||"Memo";case Ha:_e=e._payload,e=e._init;try{return Qa(e(_e))}catch{}}return null}function Ra(e){var _e=e.type;switch(e.tag){case 24:return"Cache";case 9:return(_e.displayName||"Context")+".Consumer";case 10:return(_e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=_e.render,e=e.displayName||e.name||"",_e.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return _e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(_e);case 8:return _e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _e=="function")return _e.displayName||_e.name||null;if(typeof _e=="string")return _e}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var _e=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(_e==="checkbox"||_e==="radio")}function Ua(e){var _e=Ta(e)?"checked":"value",er=Object.getOwnPropertyDescriptor(e.constructor.prototype,_e),tr=""+e[_e];if(!e.hasOwnProperty(_e)&&typeof er<"u"&&typeof er.get=="function"&&typeof er.set=="function"){var rr=er.get,nr=er.set;return Object.defineProperty(e,_e,{configurable:!0,get:function(){return rr.call(this)},set:function(ir){tr=""+ir,nr.call(this,ir)}}),Object.defineProperty(e,_e,{enumerable:er.enumerable}),{getValue:function(){return tr},setValue:function(ir){tr=""+ir},stopTracking:function(){e._valueTracker=null,delete e[_e]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var _e=e._valueTracker;if(!_e)return!0;var er=_e.getValue(),tr="";return e&&(tr=Ta(e)?e.checked?"true":"false":e.value),e=tr,e!==er?(_e.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,_e){var er=_e.checked;return A$1({},_e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:er??e._wrapperState.initialChecked})}function Za(e,_e){var er=_e.defaultValue==null?"":_e.defaultValue,tr=_e.checked!=null?_e.checked:_e.defaultChecked;er=Sa(_e.value!=null?_e.value:er),e._wrapperState={initialChecked:tr,initialValue:er,controlled:_e.type==="checkbox"||_e.type==="radio"?_e.checked!=null:_e.value!=null}}function ab(e,_e){_e=_e.checked,_e!=null&&ta(e,"checked",_e,!1)}function bb(e,_e){ab(e,_e);var er=Sa(_e.value),tr=_e.type;if(er!=null)tr==="number"?(er===0&&e.value===""||e.value!=er)&&(e.value=""+er):e.value!==""+er&&(e.value=""+er);else if(tr==="submit"||tr==="reset"){e.removeAttribute("value");return}_e.hasOwnProperty("value")?cb(e,_e.type,er):_e.hasOwnProperty("defaultValue")&&cb(e,_e.type,Sa(_e.defaultValue)),_e.checked==null&&_e.defaultChecked!=null&&(e.defaultChecked=!!_e.defaultChecked)}function db(e,_e,er){if(_e.hasOwnProperty("value")||_e.hasOwnProperty("defaultValue")){var tr=_e.type;if(!(tr!=="submit"&&tr!=="reset"||_e.value!==void 0&&_e.value!==null))return;_e=""+e._wrapperState.initialValue,er||_e===e.value||(e.value=_e),e.defaultValue=_e}er=e.name,er!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,er!==""&&(e.name=er)}function cb(e,_e,er){(_e!=="number"||Xa(e.ownerDocument)!==e)&&(er==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+er&&(e.defaultValue=""+er))}var eb=Array.isArray;function fb(e,_e,er,tr){if(e=e.options,_e){_e={};for(var rr=0;rr<er.length;rr++)_e["$"+er[rr]]=!0;for(er=0;er<e.length;er++)rr=_e.hasOwnProperty("$"+e[er].value),e[er].selected!==rr&&(e[er].selected=rr),rr&&tr&&(e[er].defaultSelected=!0)}else{for(er=""+Sa(er),_e=null,rr=0;rr<e.length;rr++){if(e[rr].value===er){e[rr].selected=!0,tr&&(e[rr].defaultSelected=!0);return}_e!==null||e[rr].disabled||(_e=e[rr])}_e!==null&&(_e.selected=!0)}}function gb(e,_e){if(_e.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},_e,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,_e){var er=_e.value;if(er==null){if(er=_e.children,_e=_e.defaultValue,er!=null){if(_e!=null)throw Error(p$1(92));if(eb(er)){if(1<er.length)throw Error(p$1(93));er=er[0]}_e=er}_e==null&&(_e=""),er=_e}e._wrapperState={initialValue:Sa(er)}}function ib(e,_e){var er=Sa(_e.value),tr=Sa(_e.defaultValue);er!=null&&(er=""+er,er!==e.value&&(e.value=er),_e.defaultValue==null&&e.defaultValue!==er&&(e.defaultValue=er)),tr!=null&&(e.defaultValue=""+tr)}function jb(e){var _e=e.textContent;_e===e._wrapperState.initialValue&&_e!==""&&_e!==null&&(e.value=_e)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,_e){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(_e):e==="http://www.w3.org/2000/svg"&&_e==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_e,er,tr,rr){MSApp.execUnsafeLocalFunction(function(){return e(_e,er,tr,rr)})}:e}(function(e,_e){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=_e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_e.valueOf().toString()+"</svg>",_e=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;_e.firstChild;)e.appendChild(_e.firstChild)}});function ob(e,_e){if(_e){var er=e.firstChild;if(er&&er===e.lastChild&&er.nodeType===3){er.nodeValue=_e;return}}e.textContent=_e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(_e){_e=_e+e.charAt(0).toUpperCase()+e.substring(1),pb[_e]=pb[e]})});function rb(e,_e,er){return _e==null||typeof _e=="boolean"||_e===""?"":er||typeof _e!="number"||_e===0||pb.hasOwnProperty(e)&&pb[e]?(""+_e).trim():_e+"px"}function sb(e,_e){e=e.style;for(var er in _e)if(_e.hasOwnProperty(er)){var tr=er.indexOf("--")===0,rr=rb(er,_e[er],tr);er==="float"&&(er="cssFloat"),tr?e.setProperty(er,rr):e[er]=rr}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,_e){if(_e){if(tb[e]&&(_e.children!=null||_e.dangerouslySetInnerHTML!=null))throw Error(p$1(137,e));if(_e.dangerouslySetInnerHTML!=null){if(_e.children!=null)throw Error(p$1(60));if(typeof _e.dangerouslySetInnerHTML!="object"||!("__html"in _e.dangerouslySetInnerHTML))throw Error(p$1(61))}if(_e.style!=null&&typeof _e.style!="object")throw Error(p$1(62))}}function vb(e,_e){if(e.indexOf("-")===-1)return typeof _e.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p$1(280));var _e=e.stateNode;_e&&(_e=Db(_e),yb(e.stateNode,e.type,_e))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,_e=Ab;if(Ab=zb=null,Bb(e),_e)for(e=0;e<_e.length;e++)Bb(_e[e])}}function Gb(e,_e){return e(_e)}function Hb(){}var Ib=!1;function Jb(e,_e,er){if(Ib)return e(_e,er);Ib=!0;try{return Gb(e,_e,er)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,_e){var er=e.stateNode;if(er===null)return null;var tr=Db(er);if(tr===null)return null;er=tr[_e];e:switch(_e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(tr=!tr.disabled)||(e=e.type,tr=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!tr;break e;default:e=!1}if(e)return null;if(er&&typeof er!="function")throw Error(p$1(231,_e,typeof er));return er}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,_e,er,tr,rr,nr,ir,ar,sr){var or=Array.prototype.slice.call(arguments,3);try{_e.apply(er,or)}catch(lr){this.onError(lr)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,_e,er,tr,rr,nr,ir,ar,sr){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,_e,er,tr,rr,nr,ir,ar,sr){if(Tb.apply(this,arguments),Ob){if(Ob){var or=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=or)}}function Vb(e){var _e=e,er=e;if(e.alternate)for(;_e.return;)_e=_e.return;else{e=_e;do _e=e,_e.flags&4098&&(er=_e.return),e=_e.return;while(e)}return _e.tag===3?er:null}function Wb(e){if(e.tag===13){var _e=e.memoizedState;if(_e===null&&(e=e.alternate,e!==null&&(_e=e.memoizedState)),_e!==null)return _e.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p$1(188))}function Yb(e){var _e=e.alternate;if(!_e){if(_e=Vb(e),_e===null)throw Error(p$1(188));return _e!==e?null:e}for(var er=e,tr=_e;;){var rr=er.return;if(rr===null)break;var nr=rr.alternate;if(nr===null){if(tr=rr.return,tr!==null){er=tr;continue}break}if(rr.child===nr.child){for(nr=rr.child;nr;){if(nr===er)return Xb(rr),e;if(nr===tr)return Xb(rr),_e;nr=nr.sibling}throw Error(p$1(188))}if(er.return!==tr.return)er=rr,tr=nr;else{for(var ir=!1,ar=rr.child;ar;){if(ar===er){ir=!0,er=rr,tr=nr;break}if(ar===tr){ir=!0,tr=rr,er=nr;break}ar=ar.sibling}if(!ir){for(ar=nr.child;ar;){if(ar===er){ir=!0,er=nr,tr=rr;break}if(ar===tr){ir=!0,tr=nr,er=rr;break}ar=ar.sibling}if(!ir)throw Error(p$1(189))}}if(er.alternate!==tr)throw Error(p$1(190))}if(er.tag!==3)throw Error(p$1(188));return er.stateNode.current===er?e:_e}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var _e=$b(e);if(_e!==null)return _e;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec$1=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc$1=null;function mc(e){if(lc$1&&typeof lc$1.onCommitFiberRoot=="function")try{lc$1.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,_e){var er=e.pendingLanes;if(er===0)return 0;var tr=0,rr=e.suspendedLanes,nr=e.pingedLanes,ir=er&268435455;if(ir!==0){var ar=ir&~rr;ar!==0?tr=tc(ar):(nr&=ir,nr!==0&&(tr=tc(nr)))}else ir=er&~rr,ir!==0?tr=tc(ir):nr!==0&&(tr=tc(nr));if(tr===0)return 0;if(_e!==0&&_e!==tr&&!(_e&rr)&&(rr=tr&-tr,nr=_e&-_e,rr>=nr||rr===16&&(nr&4194240)!==0))return _e;if(tr&4&&(tr|=er&16),_e=e.entangledLanes,_e!==0)for(e=e.entanglements,_e&=tr;0<_e;)er=31-oc(_e),rr=1<<er,tr|=e[er],_e&=~rr;return tr}function vc(e,_e){switch(e){case 1:case 2:case 4:return _e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,_e){for(var er=e.suspendedLanes,tr=e.pingedLanes,rr=e.expirationTimes,nr=e.pendingLanes;0<nr;){var ir=31-oc(nr),ar=1<<ir,sr=rr[ir];sr===-1?(!(ar&er)||ar&tr)&&(rr[ir]=vc(ar,_e)):sr<=_e&&(e.expiredLanes|=ar),nr&=~ar}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var _e=[],er=0;31>er;er++)_e.push(e);return _e}function Ac(e,_e,er){e.pendingLanes|=_e,_e!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,_e=31-oc(_e),e[_e]=er}function Bc(e,_e){var er=e.pendingLanes&~_e;e.pendingLanes=_e,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=_e,e.mutableReadLanes&=_e,e.entangledLanes&=_e,_e=e.entanglements;var tr=e.eventTimes;for(e=e.expirationTimes;0<er;){var rr=31-oc(er),nr=1<<rr;_e[rr]=0,tr[rr]=-1,e[rr]=-1,er&=~nr}}function Cc(e,_e){var er=e.entangledLanes|=_e;for(e=e.entanglements;er;){var tr=31-oc(er),rr=1<<tr;rr&_e|e[tr]&_e&&(e[tr]|=_e),er&=~rr}}var C$1=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,_e){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(_e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(_e.pointerId)}}function Tc(e,_e,er,tr,rr,nr){return e===null||e.nativeEvent!==nr?(e={blockedOn:_e,domEventName:er,eventSystemFlags:tr,nativeEvent:nr,targetContainers:[rr]},_e!==null&&(_e=Cb(_e),_e!==null&&Fc(_e)),e):(e.eventSystemFlags|=tr,_e=e.targetContainers,rr!==null&&_e.indexOf(rr)===-1&&_e.push(rr),e)}function Uc(e,_e,er,tr,rr){switch(_e){case"focusin":return Lc=Tc(Lc,e,_e,er,tr,rr),!0;case"dragenter":return Mc=Tc(Mc,e,_e,er,tr,rr),!0;case"mouseover":return Nc=Tc(Nc,e,_e,er,tr,rr),!0;case"pointerover":var nr=rr.pointerId;return Oc.set(nr,Tc(Oc.get(nr)||null,e,_e,er,tr,rr)),!0;case"gotpointercapture":return nr=rr.pointerId,Pc.set(nr,Tc(Pc.get(nr)||null,e,_e,er,tr,rr)),!0}return!1}function Vc(e){var _e=Wc(e.target);if(_e!==null){var er=Vb(_e);if(er!==null){if(_e=er.tag,_e===13){if(_e=Wb(er),_e!==null){e.blockedOn=_e,Ic(e.priority,function(){Gc(er)});return}}else if(_e===3&&er.stateNode.current.memoizedState.isDehydrated){e.blockedOn=er.tag===3?er.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var _e=e.targetContainers;0<_e.length;){var er=Yc(e.domEventName,e.eventSystemFlags,_e[0],e.nativeEvent);if(er===null){er=e.nativeEvent;var tr=new er.constructor(er.type,er);wb=tr,er.target.dispatchEvent(tr),wb=null}else return _e=Cb(er),_e!==null&&Fc(_e),e.blockedOn=er,!1;_e.shift()}return!0}function Zc(e,_e,er){Xc(e)&&er.delete(_e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,_e){e.blockedOn===_e&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function _e(rr){return ad(rr,e)}if(0<Kc.length){ad(Kc[0],e);for(var er=1;er<Kc.length;er++){var tr=Kc[er];tr.blockedOn===e&&(tr.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(_e),Pc.forEach(_e),er=0;er<Qc.length;er++)tr=Qc[er],tr.blockedOn===e&&(tr.blockedOn=null);for(;0<Qc.length&&(er=Qc[0],er.blockedOn===null);)Vc(er),er.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,_e,er,tr){var rr=C$1,nr=cd.transition;cd.transition=null;try{C$1=1,fd$1(e,_e,er,tr)}finally{C$1=rr,cd.transition=nr}}function gd(e,_e,er,tr){var rr=C$1,nr=cd.transition;cd.transition=null;try{C$1=4,fd$1(e,_e,er,tr)}finally{C$1=rr,cd.transition=nr}}function fd$1(e,_e,er,tr){if(dd){var rr=Yc(e,_e,er,tr);if(rr===null)hd(e,_e,tr,id,er),Sc(e,tr);else if(Uc(rr,e,_e,er,tr))tr.stopPropagation();else if(Sc(e,tr),_e&4&&-1<Rc.indexOf(e)){for(;rr!==null;){var nr=Cb(rr);if(nr!==null&&Ec(nr),nr=Yc(e,_e,er,tr),nr===null&&hd(e,_e,tr,id,er),nr===rr)break;rr=nr}rr!==null&&tr.stopPropagation()}else hd(e,_e,tr,null,er)}}var id=null;function Yc(e,_e,er,tr){if(id=null,e=xb(tr),e=Wc(e),e!==null)if(_e=Vb(e),_e===null)e=null;else if(er=_e.tag,er===13){if(e=Wb(_e),e!==null)return e;e=null}else if(er===3){if(_e.stateNode.current.memoizedState.isDehydrated)return _e.tag===3?_e.stateNode.containerInfo:null;e=null}else _e!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,_e=ld,er=_e.length,tr,rr="value"in kd?kd.value:kd.textContent,nr=rr.length;for(e=0;e<er&&_e[e]===rr[e];e++);var ir=er-e;for(tr=1;tr<=ir&&_e[er-tr]===rr[nr-tr];tr++);return md=rr.slice(e,1<tr?1-tr:void 0)}function od(e){var _e=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&_e===13&&(e=13)):e=_e,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function _e(er,tr,rr,nr,ir){this._reactName=er,this._targetInst=rr,this.type=tr,this.nativeEvent=nr,this.target=ir,this.currentTarget=null;for(var ar in e)e.hasOwnProperty(ar)&&(er=e[ar],this[ar]=er?er(nr):nr[ar]);return this.isDefaultPrevented=(nr.defaultPrevented!=null?nr.defaultPrevented:nr.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(_e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var er=this.nativeEvent;er&&(er.preventDefault?er.preventDefault():typeof er.returnValue!="unknown"&&(er.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var er=this.nativeEvent;er&&(er.stopPropagation?er.stopPropagation():typeof er.cancelBubble!="unknown"&&(er.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var _e=this.nativeEvent;return _e.getModifierState?_e.getModifierState(e):(e=Od[e])?!!_e[e]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(e){if(e.key){var _e=Md[e.key]||e.key;if(_e!=="Unidentified")return _e}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge$1(e,_e){switch(e){case"keyup":return $d.indexOf(_e.keyCode)!==-1;case"keydown":return _e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie$1=!1;function je(e,_e){switch(e){case"compositionend":return he$1(_e);case"keypress":return _e.which!==32?null:(fe$1=!0,ee$1);case"textInput":return e=_e.data,e===ee$1&&fe$1?null:e;default:return null}}function ke(e,_e){if(ie$1)return e==="compositionend"||!ae$1&&ge$1(e,_e)?(e=nd(),md=ld=kd=null,ie$1=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(_e.ctrlKey||_e.altKey||_e.metaKey)||_e.ctrlKey&&_e.altKey){if(_e.char&&1<_e.char.length)return _e.char;if(_e.which)return String.fromCharCode(_e.which)}return null;case"compositionend":return de$1&&_e.locale!=="ko"?null:_e.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(e){var _e=e&&e.nodeName&&e.nodeName.toLowerCase();return _e==="input"?!!le$1[e.type]:_e==="textarea"}function ne$1(e,_e,er,tr){Eb(tr),_e=oe$1(_e,"onChange"),0<_e.length&&(er=new td$1("onChange","change",null,er,tr),e.push({event:er,listeners:_e}))}var pe$1=null,qe=null;function re$1(e){se$1(e,0)}function te$1(e){var _e=ue$1(e);if(Wa(_e))return e}function ve$1(e,_e){if(e==="change")return _e}var we$1=!1;if(ia){var xe;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$1=typeof ze.oninput=="function"}xe=ye$1}else xe=!1;we$1=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe$1&&(pe$1.detachEvent("onpropertychange",Be),qe=pe$1=null)}function Be(e){if(e.propertyName==="value"&&te$1(qe)){var _e=[];ne$1(_e,qe,e,xb(e)),Jb(re$1,_e)}}function Ce(e,_e,er){e==="focusin"?(Ae(),pe$1=_e,qe=er,pe$1.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te$1(qe)}function Ee(e,_e){if(e==="click")return te$1(_e)}function Fe(e,_e){if(e==="input"||e==="change")return te$1(_e)}function Ge(e,_e){return e===_e&&(e!==0||1/e===1/_e)||e!==e&&_e!==_e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,_e){if(He(e,_e))return!0;if(typeof e!="object"||e===null||typeof _e!="object"||_e===null)return!1;var er=Object.keys(e),tr=Object.keys(_e);if(er.length!==tr.length)return!1;for(tr=0;tr<er.length;tr++){var rr=er[tr];if(!ja.call(_e,rr)||!He(e[rr],_e[rr]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,_e){var er=Je(e);e=0;for(var tr;er;){if(er.nodeType===3){if(tr=e+er.textContent.length,e<=_e&&tr>=_e)return{node:er,offset:_e-e};e=tr}e:{for(;er;){if(er.nextSibling){er=er.nextSibling;break e}er=er.parentNode}er=void 0}er=Je(er)}}function Le$1(e,_e){return e&&_e?e===_e?!0:e&&e.nodeType===3?!1:_e&&_e.nodeType===3?Le$1(e,_e.parentNode):"contains"in e?e.contains(_e):e.compareDocumentPosition?!!(e.compareDocumentPosition(_e)&16):!1:!1}function Me(){for(var e=window,_e=Xa();_e instanceof e.HTMLIFrameElement;){try{var er=typeof _e.contentWindow.location.href=="string"}catch{er=!1}if(er)e=_e.contentWindow;else break;_e=Xa(e.document)}return _e}function Ne$1(e){var _e=e&&e.nodeName&&e.nodeName.toLowerCase();return _e&&(_e==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||_e==="textarea"||e.contentEditable==="true")}function Oe(e){var _e=Me(),er=e.focusedElem,tr=e.selectionRange;if(_e!==er&&er&&er.ownerDocument&&Le$1(er.ownerDocument.documentElement,er)){if(tr!==null&&Ne$1(er)){if(_e=tr.start,e=tr.end,e===void 0&&(e=_e),"selectionStart"in er)er.selectionStart=_e,er.selectionEnd=Math.min(e,er.value.length);else if(e=(_e=er.ownerDocument||document)&&_e.defaultView||window,e.getSelection){e=e.getSelection();var rr=er.textContent.length,nr=Math.min(tr.start,rr);tr=tr.end===void 0?nr:Math.min(tr.end,rr),!e.extend&&nr>tr&&(rr=tr,tr=nr,nr=rr),rr=Ke(er,nr);var ir=Ke(er,tr);rr&&ir&&(e.rangeCount!==1||e.anchorNode!==rr.node||e.anchorOffset!==rr.offset||e.focusNode!==ir.node||e.focusOffset!==ir.offset)&&(_e=_e.createRange(),_e.setStart(rr.node,rr.offset),e.removeAllRanges(),nr>tr?(e.addRange(_e),e.extend(ir.node,ir.offset)):(_e.setEnd(ir.node,ir.offset),e.addRange(_e)))}}for(_e=[],e=er;e=e.parentNode;)e.nodeType===1&&_e.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof er.focus=="function"&&er.focus(),er=0;er<_e.length;er++)e=_e[er],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,_e,er){var tr=er.window===er?er.document:er.nodeType===9?er:er.ownerDocument;Te||Qe==null||Qe!==Xa(tr)||(tr=Qe,"selectionStart"in tr&&Ne$1(tr)?tr={start:tr.selectionStart,end:tr.selectionEnd}:(tr=(tr.ownerDocument&&tr.ownerDocument.defaultView||window).getSelection(),tr={anchorNode:tr.anchorNode,anchorOffset:tr.anchorOffset,focusNode:tr.focusNode,focusOffset:tr.focusOffset}),Se&&Ie(Se,tr)||(Se=tr,tr=oe$1(Re,"onSelect"),0<tr.length&&(_e=new td$1("onSelect","select",null,_e,er),e.push({event:_e,listeners:tr}),_e.target=Qe)))}function Ve(e,_e){var er={};return er[e.toLowerCase()]=_e.toLowerCase(),er["Webkit"+e]="webkit"+_e,er["Moz"+e]="moz"+_e,er}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var _e=We[e],er;for(er in _e)if(_e.hasOwnProperty(er)&&er in Ye)return Xe[e]=_e[er];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,_e){df.set(e,_e),fa(_e,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,_e,er){var tr=e.type||"unknown-event";e.currentTarget=er,Ub(tr,_e,void 0,e),e.currentTarget=null}function se$1(e,_e){_e=(_e&4)!==0;for(var er=0;er<e.length;er++){var tr=e[er],rr=tr.event;tr=tr.listeners;e:{var nr=void 0;if(_e)for(var ir=tr.length-1;0<=ir;ir--){var ar=tr[ir],sr=ar.instance,or=ar.currentTarget;if(ar=ar.listener,sr!==nr&&rr.isPropagationStopped())break e;nf(rr,ar,or),nr=sr}else for(ir=0;ir<tr.length;ir++){if(ar=tr[ir],sr=ar.instance,or=ar.currentTarget,ar=ar.listener,sr!==nr&&rr.isPropagationStopped())break e;nf(rr,ar,or),nr=sr}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D$1(e,_e){var er=_e[of];er===void 0&&(er=_e[of]=new Set);var tr=e+"__bubble";er.has(tr)||(pf(_e,e,2,!1),er.add(tr))}function qf(e,_e,er){var tr=0;_e&&(tr|=4),pf(er,e,tr,_e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(er){er!=="selectionchange"&&(mf.has(er)||qf(er,!1,e),qf(er,!0,e))});var _e=e.nodeType===9?e:e.ownerDocument;_e===null||_e[rf]||(_e[rf]=!0,qf("selectionchange",!1,_e))}}function pf(e,_e,er,tr){switch(jd(_e)){case 1:var rr=ed;break;case 4:rr=gd;break;default:rr=fd$1}er=rr.bind(null,_e,er,e),rr=void 0,!Lb||_e!=="touchstart"&&_e!=="touchmove"&&_e!=="wheel"||(rr=!0),tr?rr!==void 0?e.addEventListener(_e,er,{capture:!0,passive:rr}):e.addEventListener(_e,er,!0):rr!==void 0?e.addEventListener(_e,er,{passive:rr}):e.addEventListener(_e,er,!1)}function hd(e,_e,er,tr,rr){var nr=tr;if(!(_e&1)&&!(_e&2)&&tr!==null)e:for(;;){if(tr===null)return;var ir=tr.tag;if(ir===3||ir===4){var ar=tr.stateNode.containerInfo;if(ar===rr||ar.nodeType===8&&ar.parentNode===rr)break;if(ir===4)for(ir=tr.return;ir!==null;){var sr=ir.tag;if((sr===3||sr===4)&&(sr=ir.stateNode.containerInfo,sr===rr||sr.nodeType===8&&sr.parentNode===rr))return;ir=ir.return}for(;ar!==null;){if(ir=Wc(ar),ir===null)return;if(sr=ir.tag,sr===5||sr===6){tr=nr=ir;continue e}ar=ar.parentNode}}tr=tr.return}Jb(function(){var or=nr,lr=xb(er),ur=[];e:{var fr=df.get(e);if(fr!==void 0){var cr=td$1,mr=e;switch(e){case"keypress":if(od(er)===0)break e;case"keydown":case"keyup":cr=Rd;break;case"focusin":mr="focus",cr=Fd;break;case"focusout":mr="blur",cr=Fd;break;case"beforeblur":case"afterblur":cr=Fd;break;case"click":if(er.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":cr=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":cr=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":cr=Vd;break;case $e:case af:case bf:cr=Hd;break;case cf:cr=Xd;break;case"scroll":cr=vd;break;case"wheel":cr=Zd;break;case"copy":case"cut":case"paste":cr=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":cr=Td}var dr=(_e&4)!==0,xr=!dr&&e==="scroll",pr=dr?fr!==null?fr+"Capture":null:fr;dr=[];for(var gr=or,vr;gr!==null;){vr=gr;var Cr=vr.stateNode;if(vr.tag===5&&Cr!==null&&(vr=Cr,pr!==null&&(Cr=Kb(gr,pr),Cr!=null&&dr.push(tf(gr,Cr,vr)))),xr)break;gr=gr.return}0<dr.length&&(fr=new cr(fr,mr,null,er,lr),ur.push({event:fr,listeners:dr}))}}if(!(_e&7)){e:{if(fr=e==="mouseover"||e==="pointerover",cr=e==="mouseout"||e==="pointerout",fr&&er!==wb&&(mr=er.relatedTarget||er.fromElement)&&(Wc(mr)||mr[uf]))break e;if((cr||fr)&&(fr=lr.window===lr?lr:(fr=lr.ownerDocument)?fr.defaultView||fr.parentWindow:window,cr?(mr=er.relatedTarget||er.toElement,cr=or,mr=mr?Wc(mr):null,mr!==null&&(xr=Vb(mr),mr!==xr||mr.tag!==5&&mr.tag!==6)&&(mr=null)):(cr=null,mr=or),cr!==mr)){if(dr=Bd,Cr="onMouseLeave",pr="onMouseEnter",gr="mouse",(e==="pointerout"||e==="pointerover")&&(dr=Td,Cr="onPointerLeave",pr="onPointerEnter",gr="pointer"),xr=cr==null?fr:ue$1(cr),vr=mr==null?fr:ue$1(mr),fr=new dr(Cr,gr+"leave",cr,er,lr),fr.target=xr,fr.relatedTarget=vr,Cr=null,Wc(lr)===or&&(dr=new dr(pr,gr+"enter",mr,er,lr),dr.target=vr,dr.relatedTarget=xr,Cr=dr),xr=Cr,cr&&mr)t:{for(dr=cr,pr=mr,gr=0,vr=dr;vr;vr=vf(vr))gr++;for(vr=0,Cr=pr;Cr;Cr=vf(Cr))vr++;for(;0<gr-vr;)dr=vf(dr),gr--;for(;0<vr-gr;)pr=vf(pr),vr--;for(;gr--;){if(dr===pr||pr!==null&&dr===pr.alternate)break t;dr=vf(dr),pr=vf(pr)}dr=null}else dr=null;cr!==null&&wf(ur,fr,cr,dr,!1),mr!==null&&xr!==null&&wf(ur,xr,mr,dr,!0)}}e:{if(fr=or?ue$1(or):window,cr=fr.nodeName&&fr.nodeName.toLowerCase(),cr==="select"||cr==="input"&&fr.type==="file")var Tr=ve$1;else if(me$1(fr))if(we$1)Tr=Fe;else{Tr=De;var Fr=Ce}else(cr=fr.nodeName)&&cr.toLowerCase()==="input"&&(fr.type==="checkbox"||fr.type==="radio")&&(Tr=Ee);if(Tr&&(Tr=Tr(e,or))){ne$1(ur,Tr,er,lr);break e}Fr&&Fr(e,fr,or),e==="focusout"&&(Fr=fr._wrapperState)&&Fr.controlled&&fr.type==="number"&&cb(fr,"number",fr.value)}switch(Fr=or?ue$1(or):window,e){case"focusin":(me$1(Fr)||Fr.contentEditable==="true")&&(Qe=Fr,Re=or,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ur,er,lr);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ur,er,lr)}var _r;if(ae$1)e:{switch(e){case"compositionstart":var Ar="onCompositionStart";break e;case"compositionend":Ar="onCompositionEnd";break e;case"compositionupdate":Ar="onCompositionUpdate";break e}Ar=void 0}else ie$1?ge$1(e,er)&&(Ar="onCompositionEnd"):e==="keydown"&&er.keyCode===229&&(Ar="onCompositionStart");Ar&&(de$1&&er.locale!=="ko"&&(ie$1||Ar!=="onCompositionStart"?Ar==="onCompositionEnd"&&ie$1&&(_r=nd()):(kd=lr,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),Fr=oe$1(or,Ar),0<Fr.length&&(Ar=new Ld(Ar,e,null,er,lr),ur.push({event:Ar,listeners:Fr}),_r?Ar.data=_r:(_r=he$1(er),_r!==null&&(Ar.data=_r)))),(_r=ce$1?je(e,er):ke(e,er))&&(or=oe$1(or,"onBeforeInput"),0<or.length&&(lr=new Ld("onBeforeInput","beforeinput",null,er,lr),ur.push({event:lr,listeners:or}),lr.data=_r))}se$1(ur,_e)})}function tf(e,_e,er){return{instance:e,listener:_e,currentTarget:er}}function oe$1(e,_e){for(var er=_e+"Capture",tr=[];e!==null;){var rr=e,nr=rr.stateNode;rr.tag===5&&nr!==null&&(rr=nr,nr=Kb(e,er),nr!=null&&tr.unshift(tf(e,nr,rr)),nr=Kb(e,_e),nr!=null&&tr.push(tf(e,nr,rr))),e=e.return}return tr}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,_e,er,tr,rr){for(var nr=_e._reactName,ir=[];er!==null&&er!==tr;){var ar=er,sr=ar.alternate,or=ar.stateNode;if(sr!==null&&sr===tr)break;ar.tag===5&&or!==null&&(ar=or,rr?(sr=Kb(er,nr),sr!=null&&ir.unshift(tf(er,sr,ar))):rr||(sr=Kb(er,nr),sr!=null&&ir.push(tf(er,sr,ar)))),er=er.return}ir.length!==0&&e.push({event:_e,listeners:ir})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,_e,er){if(_e=zf(_e),zf(e)!==_e&&er)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,_e){return e==="textarea"||e==="noscript"||typeof _e.children=="string"||typeof _e.children=="number"||typeof _e.dangerouslySetInnerHTML=="object"&&_e.dangerouslySetInnerHTML!==null&&_e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,_e){var er=_e,tr=0;do{var rr=er.nextSibling;if(e.removeChild(er),rr&&rr.nodeType===8)if(er=rr.data,er==="/$"){if(tr===0){e.removeChild(rr),bd(_e);return}tr--}else er!=="$"&&er!=="$?"&&er!=="$!"||tr++;er=rr}while(er);bd(_e)}function Lf(e){for(;e!=null;e=e.nextSibling){var _e=e.nodeType;if(_e===1||_e===3)break;if(_e===8){if(_e=e.data,_e==="$"||_e==="$!"||_e==="$?")break;if(_e==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var _e=0;e;){if(e.nodeType===8){var er=e.data;if(er==="$"||er==="$!"||er==="$?"){if(_e===0)return e;_e--}else er==="/$"&&_e++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var _e=e[Of];if(_e)return _e;for(var er=e.parentNode;er;){if(_e=er[uf]||er[Of]){if(er=_e.alternate,_e.child!==null||er!==null&&er.child!==null)for(e=Mf(e);e!==null;){if(er=e[Of])return er;e=Mf(e)}return _e}e=er,er=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue$1(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p$1(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E$1(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(e,_e){Tf++,Sf[Tf]=e.current,e.current=_e}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,_e){var er=e.type.contextTypes;if(!er)return Vf;var tr=e.stateNode;if(tr&&tr.__reactInternalMemoizedUnmaskedChildContext===_e)return tr.__reactInternalMemoizedMaskedChildContext;var rr={},nr;for(nr in er)rr[nr]=_e[nr];return tr&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=_e,e.__reactInternalMemoizedMaskedChildContext=rr),rr}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(e,_e,er){if(H$1.current!==Vf)throw Error(p$1(168));G$1(H$1,_e),G$1(Wf,er)}function bg(e,_e,er){var tr=e.stateNode;if(_e=_e.childContextTypes,typeof tr.getChildContext!="function")return er;tr=tr.getChildContext();for(var rr in tr)if(!(rr in _e))throw Error(p$1(108,Ra(e)||"Unknown",rr));return A$1({},er,tr)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,e),G$1(Wf,Wf.current),!0}function dg(e,_e,er){var tr=e.stateNode;if(!tr)throw Error(p$1(169));er?(e=bg(e,_e,Xf),tr.__reactInternalMemoizedMergedChildContext=e,E$1(Wf),E$1(H$1),G$1(H$1,e)):E$1(Wf),G$1(Wf,er)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,_e=C$1;try{var er=eg;for(C$1=1;e<er.length;e++){var tr=er[e];do tr=tr(!0);while(tr!==null)}eg=null,fg=!1}catch(rr){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),rr}finally{C$1=_e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,_e){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=_e}function ug(e,_e,er){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var tr=rg;e=sg;var rr=32-oc(tr)-1;tr&=~(1<<rr),er+=1;var nr=32-oc(_e)+rr;if(30<nr){var ir=rr-rr%5;nr=(tr&(1<<ir)-1).toString(32),tr>>=ir,rr-=ir,rg=1<<32-oc(_e)+rr|er<<rr|tr,sg=nr+e}else rg=1<<nr|er<<rr|tr,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(e,_e){var er=Bg(5,null,null,0);er.elementType="DELETED",er.stateNode=_e,er.return=e,_e=e.deletions,_e===null?(e.deletions=[er],e.flags|=16):_e.push(er)}function Cg(e,_e){switch(e.tag){case 5:var er=e.type;return _e=_e.nodeType!==1||er.toLowerCase()!==_e.nodeName.toLowerCase()?null:_e,_e!==null?(e.stateNode=_e,xg=e,yg=Lf(_e.firstChild),!0):!1;case 6:return _e=e.pendingProps===""||_e.nodeType!==3?null:_e,_e!==null?(e.stateNode=_e,xg=e,yg=null,!0):!1;case 13:return _e=_e.nodeType!==8?null:_e,_e!==null?(er=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:_e,treeContext:er,retryLane:1073741824},er=Bg(18,null,null,0),er.stateNode=_e,er.return=e,e.child=er,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I$1){var _e=yg;if(_e){var er=_e;if(!Cg(e,_e)){if(Dg(e))throw Error(p$1(418));_e=Lf(er.nextSibling);var tr=xg;_e&&Cg(e,_e)?Ag(tr,er):(e.flags=e.flags&-4097|2,I$1=!1,xg=e)}}else{if(Dg(e))throw Error(p$1(418));e.flags=e.flags&-4097|2,I$1=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I$1)return Fg(e),I$1=!0,!1;var _e;if((_e=e.tag!==3)&&!(_e=e.tag!==5)&&(_e=e.type,_e=_e!=="head"&&_e!=="body"&&!Ef(e.type,e.memoizedProps)),_e&&(_e=yg)){if(Dg(e))throw Hg(),Error(p$1(418));for(;_e;)Ag(e,_e),_e=Lf(_e.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p$1(317));e:{for(e=e.nextSibling,_e=0;e;){if(e.nodeType===8){var er=e.data;if(er==="/$"){if(_e===0){yg=Lf(e.nextSibling);break e}_e--}else er!=="$"&&er!=="$!"&&er!=="$?"||_e++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,_e,er){if(e=er.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(er._owner){if(er=er._owner,er){if(er.tag!==1)throw Error(p$1(309));var tr=er.stateNode}if(!tr)throw Error(p$1(147,e));var rr=tr,nr=""+e;return _e!==null&&_e.ref!==null&&typeof _e.ref=="function"&&_e.ref._stringRef===nr?_e.ref:(_e=function(ir){var ar=rr.refs;ir===null?delete ar[nr]:ar[nr]=ir},_e._stringRef=nr,_e)}if(typeof e!="string")throw Error(p$1(284));if(!er._owner)throw Error(p$1(290,e))}return e}function Mg(e,_e){throw e=Object.prototype.toString.call(_e),Error(p$1(31,e==="[object Object]"?"object with keys {"+Object.keys(_e).join(", ")+"}":e))}function Ng(e){var _e=e._init;return _e(e._payload)}function Og(e){function _e(pr,gr){if(e){var vr=pr.deletions;vr===null?(pr.deletions=[gr],pr.flags|=16):vr.push(gr)}}function er(pr,gr){if(!e)return null;for(;gr!==null;)_e(pr,gr),gr=gr.sibling;return null}function tr(pr,gr){for(pr=new Map;gr!==null;)gr.key!==null?pr.set(gr.key,gr):pr.set(gr.index,gr),gr=gr.sibling;return pr}function rr(pr,gr){return pr=Pg(pr,gr),pr.index=0,pr.sibling=null,pr}function nr(pr,gr,vr){return pr.index=vr,e?(vr=pr.alternate,vr!==null?(vr=vr.index,vr<gr?(pr.flags|=2,gr):vr):(pr.flags|=2,gr)):(pr.flags|=1048576,gr)}function ir(pr){return e&&pr.alternate===null&&(pr.flags|=2),pr}function ar(pr,gr,vr,Cr){return gr===null||gr.tag!==6?(gr=Qg(vr,pr.mode,Cr),gr.return=pr,gr):(gr=rr(gr,vr),gr.return=pr,gr)}function sr(pr,gr,vr,Cr){var Tr=vr.type;return Tr===ya?lr(pr,gr,vr.props.children,Cr,vr.key):gr!==null&&(gr.elementType===Tr||typeof Tr=="object"&&Tr!==null&&Tr.$$typeof===Ha&&Ng(Tr)===gr.type)?(Cr=rr(gr,vr.props),Cr.ref=Lg(pr,gr,vr),Cr.return=pr,Cr):(Cr=Rg(vr.type,vr.key,vr.props,null,pr.mode,Cr),Cr.ref=Lg(pr,gr,vr),Cr.return=pr,Cr)}function or(pr,gr,vr,Cr){return gr===null||gr.tag!==4||gr.stateNode.containerInfo!==vr.containerInfo||gr.stateNode.implementation!==vr.implementation?(gr=Sg(vr,pr.mode,Cr),gr.return=pr,gr):(gr=rr(gr,vr.children||[]),gr.return=pr,gr)}function lr(pr,gr,vr,Cr,Tr){return gr===null||gr.tag!==7?(gr=Tg(vr,pr.mode,Cr,Tr),gr.return=pr,gr):(gr=rr(gr,vr),gr.return=pr,gr)}function ur(pr,gr,vr){if(typeof gr=="string"&&gr!==""||typeof gr=="number")return gr=Qg(""+gr,pr.mode,vr),gr.return=pr,gr;if(typeof gr=="object"&&gr!==null){switch(gr.$$typeof){case va:return vr=Rg(gr.type,gr.key,gr.props,null,pr.mode,vr),vr.ref=Lg(pr,null,gr),vr.return=pr,vr;case wa:return gr=Sg(gr,pr.mode,vr),gr.return=pr,gr;case Ha:var Cr=gr._init;return ur(pr,Cr(gr._payload),vr)}if(eb(gr)||Ka(gr))return gr=Tg(gr,pr.mode,vr,null),gr.return=pr,gr;Mg(pr,gr)}return null}function fr(pr,gr,vr,Cr){var Tr=gr!==null?gr.key:null;if(typeof vr=="string"&&vr!==""||typeof vr=="number")return Tr!==null?null:ar(pr,gr,""+vr,Cr);if(typeof vr=="object"&&vr!==null){switch(vr.$$typeof){case va:return vr.key===Tr?sr(pr,gr,vr,Cr):null;case wa:return vr.key===Tr?or(pr,gr,vr,Cr):null;case Ha:return Tr=vr._init,fr(pr,gr,Tr(vr._payload),Cr)}if(eb(vr)||Ka(vr))return Tr!==null?null:lr(pr,gr,vr,Cr,null);Mg(pr,vr)}return null}function cr(pr,gr,vr,Cr,Tr){if(typeof Cr=="string"&&Cr!==""||typeof Cr=="number")return pr=pr.get(vr)||null,ar(gr,pr,""+Cr,Tr);if(typeof Cr=="object"&&Cr!==null){switch(Cr.$$typeof){case va:return pr=pr.get(Cr.key===null?vr:Cr.key)||null,sr(gr,pr,Cr,Tr);case wa:return pr=pr.get(Cr.key===null?vr:Cr.key)||null,or(gr,pr,Cr,Tr);case Ha:var Fr=Cr._init;return cr(pr,gr,vr,Fr(Cr._payload),Tr)}if(eb(Cr)||Ka(Cr))return pr=pr.get(vr)||null,lr(gr,pr,Cr,Tr,null);Mg(gr,Cr)}return null}function mr(pr,gr,vr,Cr){for(var Tr=null,Fr=null,_r=gr,Ar=gr=0,Pr=null;_r!==null&&Ar<vr.length;Ar++){_r.index>Ar?(Pr=_r,_r=null):Pr=_r.sibling;var Ir=fr(pr,_r,vr[Ar],Cr);if(Ir===null){_r===null&&(_r=Pr);break}e&&_r&&Ir.alternate===null&&_e(pr,_r),gr=nr(Ir,gr,Ar),Fr===null?Tr=Ir:Fr.sibling=Ir,Fr=Ir,_r=Pr}if(Ar===vr.length)return er(pr,_r),I$1&&tg(pr,Ar),Tr;if(_r===null){for(;Ar<vr.length;Ar++)_r=ur(pr,vr[Ar],Cr),_r!==null&&(gr=nr(_r,gr,Ar),Fr===null?Tr=_r:Fr.sibling=_r,Fr=_r);return I$1&&tg(pr,Ar),Tr}for(_r=tr(pr,_r);Ar<vr.length;Ar++)Pr=cr(_r,pr,Ar,vr[Ar],Cr),Pr!==null&&(e&&Pr.alternate!==null&&_r.delete(Pr.key===null?Ar:Pr.key),gr=nr(Pr,gr,Ar),Fr===null?Tr=Pr:Fr.sibling=Pr,Fr=Pr);return e&&_r.forEach(function(wr){return _e(pr,wr)}),I$1&&tg(pr,Ar),Tr}function dr(pr,gr,vr,Cr){var Tr=Ka(vr);if(typeof Tr!="function")throw Error(p$1(150));if(vr=Tr.call(vr),vr==null)throw Error(p$1(151));for(var Fr=Tr=null,_r=gr,Ar=gr=0,Pr=null,Ir=vr.next();_r!==null&&!Ir.done;Ar++,Ir=vr.next()){_r.index>Ar?(Pr=_r,_r=null):Pr=_r.sibling;var wr=fr(pr,_r,Ir.value,Cr);if(wr===null){_r===null&&(_r=Pr);break}e&&_r&&wr.alternate===null&&_e(pr,_r),gr=nr(wr,gr,Ar),Fr===null?Tr=wr:Fr.sibling=wr,Fr=wr,_r=Pr}if(Ir.done)return er(pr,_r),I$1&&tg(pr,Ar),Tr;if(_r===null){for(;!Ir.done;Ar++,Ir=vr.next())Ir=ur(pr,Ir.value,Cr),Ir!==null&&(gr=nr(Ir,gr,Ar),Fr===null?Tr=Ir:Fr.sibling=Ir,Fr=Ir);return I$1&&tg(pr,Ar),Tr}for(_r=tr(pr,_r);!Ir.done;Ar++,Ir=vr.next())Ir=cr(_r,pr,Ar,Ir.value,Cr),Ir!==null&&(e&&Ir.alternate!==null&&_r.delete(Ir.key===null?Ar:Ir.key),gr=nr(Ir,gr,Ar),Fr===null?Tr=Ir:Fr.sibling=Ir,Fr=Ir);return e&&_r.forEach(function(kr){return _e(pr,kr)}),I$1&&tg(pr,Ar),Tr}function xr(pr,gr,vr,Cr){if(typeof vr=="object"&&vr!==null&&vr.type===ya&&vr.key===null&&(vr=vr.props.children),typeof vr=="object"&&vr!==null){switch(vr.$$typeof){case va:e:{for(var Tr=vr.key,Fr=gr;Fr!==null;){if(Fr.key===Tr){if(Tr=vr.type,Tr===ya){if(Fr.tag===7){er(pr,Fr.sibling),gr=rr(Fr,vr.props.children),gr.return=pr,pr=gr;break e}}else if(Fr.elementType===Tr||typeof Tr=="object"&&Tr!==null&&Tr.$$typeof===Ha&&Ng(Tr)===Fr.type){er(pr,Fr.sibling),gr=rr(Fr,vr.props),gr.ref=Lg(pr,Fr,vr),gr.return=pr,pr=gr;break e}er(pr,Fr);break}else _e(pr,Fr);Fr=Fr.sibling}vr.type===ya?(gr=Tg(vr.props.children,pr.mode,Cr,vr.key),gr.return=pr,pr=gr):(Cr=Rg(vr.type,vr.key,vr.props,null,pr.mode,Cr),Cr.ref=Lg(pr,gr,vr),Cr.return=pr,pr=Cr)}return ir(pr);case wa:e:{for(Fr=vr.key;gr!==null;){if(gr.key===Fr)if(gr.tag===4&&gr.stateNode.containerInfo===vr.containerInfo&&gr.stateNode.implementation===vr.implementation){er(pr,gr.sibling),gr=rr(gr,vr.children||[]),gr.return=pr,pr=gr;break e}else{er(pr,gr);break}else _e(pr,gr);gr=gr.sibling}gr=Sg(vr,pr.mode,Cr),gr.return=pr,pr=gr}return ir(pr);case Ha:return Fr=vr._init,xr(pr,gr,Fr(vr._payload),Cr)}if(eb(vr))return mr(pr,gr,vr,Cr);if(Ka(vr))return dr(pr,gr,vr,Cr);Mg(pr,vr)}return typeof vr=="string"&&vr!==""||typeof vr=="number"?(vr=""+vr,gr!==null&&gr.tag===6?(er(pr,gr.sibling),gr=rr(gr,vr),gr.return=pr,pr=gr):(er(pr,gr),gr=Qg(vr,pr.mode,Cr),gr.return=pr,pr=gr),ir(pr)):er(pr,gr)}return xr}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var _e=Wg.current;E$1(Wg),e._currentValue=_e}function bh(e,_e,er){for(;e!==null;){var tr=e.alternate;if((e.childLanes&_e)!==_e?(e.childLanes|=_e,tr!==null&&(tr.childLanes|=_e)):tr!==null&&(tr.childLanes&_e)!==_e&&(tr.childLanes|=_e),e===er)break;e=e.return}}function ch(e,_e){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&_e&&(dh=!0),e.firstContext=null)}function eh(e){var _e=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:_e,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return _e}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,_e,er,tr){var rr=_e.interleaved;return rr===null?(er.next=er,gh(_e)):(er.next=rr.next,rr.next=er),_e.interleaved=er,ih(e,tr)}function ih(e,_e){e.lanes|=_e;var er=e.alternate;for(er!==null&&(er.lanes|=_e),er=e,e=e.return;e!==null;)e.childLanes|=_e,er=e.alternate,er!==null&&(er.childLanes|=_e),er=e,e=e.return;return er.tag===3?er.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,_e){e=e.updateQueue,_e.updateQueue===e&&(_e.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,_e){return{eventTime:e,lane:_e,tag:0,payload:null,callback:null,next:null}}function nh(e,_e,er){var tr=e.updateQueue;if(tr===null)return null;if(tr=tr.shared,K$1&2){var rr=tr.pending;return rr===null?_e.next=_e:(_e.next=rr.next,rr.next=_e),tr.pending=_e,ih(e,er)}return rr=tr.interleaved,rr===null?(_e.next=_e,gh(tr)):(_e.next=rr.next,rr.next=_e),tr.interleaved=_e,ih(e,er)}function oh(e,_e,er){if(_e=_e.updateQueue,_e!==null&&(_e=_e.shared,(er&4194240)!==0)){var tr=_e.lanes;tr&=e.pendingLanes,er|=tr,_e.lanes=er,Cc(e,er)}}function ph(e,_e){var er=e.updateQueue,tr=e.alternate;if(tr!==null&&(tr=tr.updateQueue,er===tr)){var rr=null,nr=null;if(er=er.firstBaseUpdate,er!==null){do{var ir={eventTime:er.eventTime,lane:er.lane,tag:er.tag,payload:er.payload,callback:er.callback,next:null};nr===null?rr=nr=ir:nr=nr.next=ir,er=er.next}while(er!==null);nr===null?rr=nr=_e:nr=nr.next=_e}else rr=nr=_e;er={baseState:tr.baseState,firstBaseUpdate:rr,lastBaseUpdate:nr,shared:tr.shared,effects:tr.effects},e.updateQueue=er;return}e=er.lastBaseUpdate,e===null?er.firstBaseUpdate=_e:e.next=_e,er.lastBaseUpdate=_e}function qh(e,_e,er,tr){var rr=e.updateQueue;jh=!1;var nr=rr.firstBaseUpdate,ir=rr.lastBaseUpdate,ar=rr.shared.pending;if(ar!==null){rr.shared.pending=null;var sr=ar,or=sr.next;sr.next=null,ir===null?nr=or:ir.next=or,ir=sr;var lr=e.alternate;lr!==null&&(lr=lr.updateQueue,ar=lr.lastBaseUpdate,ar!==ir&&(ar===null?lr.firstBaseUpdate=or:ar.next=or,lr.lastBaseUpdate=sr))}if(nr!==null){var ur=rr.baseState;ir=0,lr=or=sr=null,ar=nr;do{var fr=ar.lane,cr=ar.eventTime;if((tr&fr)===fr){lr!==null&&(lr=lr.next={eventTime:cr,lane:0,tag:ar.tag,payload:ar.payload,callback:ar.callback,next:null});e:{var mr=e,dr=ar;switch(fr=_e,cr=er,dr.tag){case 1:if(mr=dr.payload,typeof mr=="function"){ur=mr.call(cr,ur,fr);break e}ur=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=dr.payload,fr=typeof mr=="function"?mr.call(cr,ur,fr):mr,fr==null)break e;ur=A$1({},ur,fr);break e;case 2:jh=!0}}ar.callback!==null&&ar.lane!==0&&(e.flags|=64,fr=rr.effects,fr===null?rr.effects=[ar]:fr.push(ar))}else cr={eventTime:cr,lane:fr,tag:ar.tag,payload:ar.payload,callback:ar.callback,next:null},lr===null?(or=lr=cr,sr=ur):lr=lr.next=cr,ir|=fr;if(ar=ar.next,ar===null){if(ar=rr.shared.pending,ar===null)break;fr=ar,ar=fr.next,fr.next=null,rr.lastBaseUpdate=fr,rr.shared.pending=null}}while(!0);if(lr===null&&(sr=ur),rr.baseState=sr,rr.firstBaseUpdate=or,rr.lastBaseUpdate=lr,_e=rr.shared.interleaved,_e!==null){rr=_e;do ir|=rr.lane,rr=rr.next;while(rr!==_e)}else nr===null&&(rr.shared.lanes=0);rh|=ir,e.lanes=ir,e.memoizedState=ur}}function sh(e,_e,er){if(e=_e.effects,_e.effects=null,e!==null)for(_e=0;_e<e.length;_e++){var tr=e[_e],rr=tr.callback;if(rr!==null){if(tr.callback=null,tr=er,typeof rr!="function")throw Error(p$1(191,rr));rr.call(tr)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p$1(174));return e}function yh(e,_e){switch(G$1(wh,_e),G$1(vh,e),G$1(uh,th),e=_e.nodeType,e){case 9:case 11:_e=(_e=_e.documentElement)?_e.namespaceURI:lb(null,"");break;default:e=e===8?_e.parentNode:_e,_e=e.namespaceURI||null,e=e.tagName,_e=lb(_e,e)}E$1(uh),G$1(uh,_e)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(e){xh(wh.current);var _e=xh(uh.current),er=lb(_e,e.type);_e!==er&&(G$1(vh,e),G$1(uh,er))}function Bh(e){vh.current===e&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(e){for(var _e=e;_e!==null;){if(_e.tag===13){var er=_e.memoizedState;if(er!==null&&(er=er.dehydrated,er===null||er.data==="$?"||er.data==="$!"))return _e}else if(_e.tag===19&&_e.memoizedProps.revealOrder!==void 0){if(_e.flags&128)return _e}else if(_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===e)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===e)return null;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$1=null,N$1=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$1(321))}function Mh(e,_e){if(_e===null)return!1;for(var er=0;er<_e.length&&er<e.length;er++)if(!He(e[er],_e[er]))return!1;return!0}function Nh(e,_e,er,tr,rr,nr){if(Hh=nr,M$1=_e,_e.memoizedState=null,_e.updateQueue=null,_e.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=er(tr,rr),Jh){nr=0;do{if(Jh=!1,Kh=0,25<=nr)throw Error(p$1(301));nr+=1,O$1=N$1=null,_e.updateQueue=null,Fh.current=Qh,e=er(tr,rr)}while(Jh)}if(Fh.current=Rh,_e=N$1!==null&&N$1.next!==null,Hh=0,O$1=N$1=M$1=null,Ih=!1,_e)throw Error(p$1(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$1.memoizedState=O$1=e:O$1=O$1.next=e,O$1}function Uh(){if(N$1===null){var e=M$1.alternate;e=e!==null?e.memoizedState:null}else e=N$1.next;var _e=O$1===null?M$1.memoizedState:O$1.next;if(_e!==null)O$1=_e,N$1=e;else{if(e===null)throw Error(p$1(310));N$1=e,e={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$1===null?M$1.memoizedState=O$1=e:O$1=O$1.next=e}return O$1}function Vh(e,_e){return typeof _e=="function"?_e(e):_e}function Wh(e){var _e=Uh(),er=_e.queue;if(er===null)throw Error(p$1(311));er.lastRenderedReducer=e;var tr=N$1,rr=tr.baseQueue,nr=er.pending;if(nr!==null){if(rr!==null){var ir=rr.next;rr.next=nr.next,nr.next=ir}tr.baseQueue=rr=nr,er.pending=null}if(rr!==null){nr=rr.next,tr=tr.baseState;var ar=ir=null,sr=null,or=nr;do{var lr=or.lane;if((Hh&lr)===lr)sr!==null&&(sr=sr.next={lane:0,action:or.action,hasEagerState:or.hasEagerState,eagerState:or.eagerState,next:null}),tr=or.hasEagerState?or.eagerState:e(tr,or.action);else{var ur={lane:lr,action:or.action,hasEagerState:or.hasEagerState,eagerState:or.eagerState,next:null};sr===null?(ar=sr=ur,ir=tr):sr=sr.next=ur,M$1.lanes|=lr,rh|=lr}or=or.next}while(or!==null&&or!==nr);sr===null?ir=tr:sr.next=ar,He(tr,_e.memoizedState)||(dh=!0),_e.memoizedState=tr,_e.baseState=ir,_e.baseQueue=sr,er.lastRenderedState=tr}if(e=er.interleaved,e!==null){rr=e;do nr=rr.lane,M$1.lanes|=nr,rh|=nr,rr=rr.next;while(rr!==e)}else rr===null&&(er.lanes=0);return[_e.memoizedState,er.dispatch]}function Xh(e){var _e=Uh(),er=_e.queue;if(er===null)throw Error(p$1(311));er.lastRenderedReducer=e;var tr=er.dispatch,rr=er.pending,nr=_e.memoizedState;if(rr!==null){er.pending=null;var ir=rr=rr.next;do nr=e(nr,ir.action),ir=ir.next;while(ir!==rr);He(nr,_e.memoizedState)||(dh=!0),_e.memoizedState=nr,_e.baseQueue===null&&(_e.baseState=nr),er.lastRenderedState=nr}return[nr,tr]}function Yh(){}function Zh(e,_e){var er=M$1,tr=Uh(),rr=_e(),nr=!He(tr.memoizedState,rr);if(nr&&(tr.memoizedState=rr,dh=!0),tr=tr.queue,$h(ai.bind(null,er,tr,e),[e]),tr.getSnapshot!==_e||nr||O$1!==null&&O$1.memoizedState.tag&1){if(er.flags|=2048,bi(9,ci.bind(null,er,tr,rr,_e),void 0,null),Q$1===null)throw Error(p$1(349));Hh&30||di(er,_e,rr)}return rr}function di(e,_e,er){e.flags|=16384,e={getSnapshot:_e,value:er},_e=M$1.updateQueue,_e===null?(_e={lastEffect:null,stores:null},M$1.updateQueue=_e,_e.stores=[e]):(er=_e.stores,er===null?_e.stores=[e]:er.push(e))}function ci(e,_e,er,tr){_e.value=er,_e.getSnapshot=tr,ei(_e)&&fi(e)}function ai(e,_e,er){return er(function(){ei(_e)&&fi(e)})}function ei(e){var _e=e.getSnapshot;e=e.value;try{var er=_e();return!He(e,er)}catch{return!0}}function fi(e){var _e=ih(e,1);_e!==null&&gi(_e,e,1,-1)}function hi(e){var _e=Th();return typeof e=="function"&&(e=e()),_e.memoizedState=_e.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},_e.queue=e,e=e.dispatch=ii.bind(null,M$1,e),[_e.memoizedState,e]}function bi(e,_e,er,tr){return e={tag:e,create:_e,destroy:er,deps:tr,next:null},_e=M$1.updateQueue,_e===null?(_e={lastEffect:null,stores:null},M$1.updateQueue=_e,_e.lastEffect=e.next=e):(er=_e.lastEffect,er===null?_e.lastEffect=e.next=e:(tr=er.next,er.next=e,e.next=tr,_e.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,_e,er,tr){var rr=Th();M$1.flags|=e,rr.memoizedState=bi(1|_e,er,void 0,tr===void 0?null:tr)}function li(e,_e,er,tr){var rr=Uh();tr=tr===void 0?null:tr;var nr=void 0;if(N$1!==null){var ir=N$1.memoizedState;if(nr=ir.destroy,tr!==null&&Mh(tr,ir.deps)){rr.memoizedState=bi(_e,er,nr,tr);return}}M$1.flags|=e,rr.memoizedState=bi(1|_e,er,nr,tr)}function mi(e,_e){return ki(8390656,8,e,_e)}function $h(e,_e){return li(2048,8,e,_e)}function ni(e,_e){return li(4,2,e,_e)}function oi(e,_e){return li(4,4,e,_e)}function pi(e,_e){if(typeof _e=="function")return e=e(),_e(e),function(){_e(null)};if(_e!=null)return e=e(),_e.current=e,function(){_e.current=null}}function qi(e,_e,er){return er=er!=null?er.concat([e]):null,li(4,4,pi.bind(null,_e,e),er)}function ri(){}function si(e,_e){var er=Uh();_e=_e===void 0?null:_e;var tr=er.memoizedState;return tr!==null&&_e!==null&&Mh(_e,tr[1])?tr[0]:(er.memoizedState=[e,_e],e)}function ti(e,_e){var er=Uh();_e=_e===void 0?null:_e;var tr=er.memoizedState;return tr!==null&&_e!==null&&Mh(_e,tr[1])?tr[0]:(e=e(),er.memoizedState=[e,_e],e)}function ui(e,_e,er){return Hh&21?(He(er,_e)||(er=yc(),M$1.lanes|=er,rh|=er,e.baseState=!0),_e):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=er)}function vi(e,_e){var er=C$1;C$1=er!==0&&4>er?er:4,e(!0);var tr=Gh.transition;Gh.transition={};try{e(!1),_e()}finally{C$1=er,Gh.transition=tr}}function wi(){return Uh().memoizedState}function xi(e,_e,er){var tr=yi(e);if(er={lane:tr,action:er,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(_e,er);else if(er=hh(e,_e,er,tr),er!==null){var rr=R$1();gi(er,e,tr,rr),Bi(er,_e,tr)}}function ii(e,_e,er){var tr=yi(e),rr={lane:tr,action:er,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(_e,rr);else{var nr=e.alternate;if(e.lanes===0&&(nr===null||nr.lanes===0)&&(nr=_e.lastRenderedReducer,nr!==null))try{var ir=_e.lastRenderedState,ar=nr(ir,er);if(rr.hasEagerState=!0,rr.eagerState=ar,He(ar,ir)){var sr=_e.interleaved;sr===null?(rr.next=rr,gh(_e)):(rr.next=sr.next,sr.next=rr),_e.interleaved=rr;return}}catch{}finally{}er=hh(e,_e,rr,tr),er!==null&&(rr=R$1(),gi(er,e,tr,rr),Bi(er,_e,tr))}}function zi(e){var _e=e.alternate;return e===M$1||_e!==null&&_e===M$1}function Ai(e,_e){Jh=Ih=!0;var er=e.pending;er===null?_e.next=_e:(_e.next=er.next,er.next=_e),e.pending=_e}function Bi(e,_e,er){if(er&4194240){var tr=_e.lanes;tr&=e.pendingLanes,er|=tr,_e.lanes=er,Cc(e,er)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,_e){return Th().memoizedState=[e,_e===void 0?null:_e],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,_e,er){return er=er!=null?er.concat([e]):null,ki(4194308,4,pi.bind(null,_e,e),er)},useLayoutEffect:function(e,_e){return ki(4194308,4,e,_e)},useInsertionEffect:function(e,_e){return ki(4,2,e,_e)},useMemo:function(e,_e){var er=Th();return _e=_e===void 0?null:_e,e=e(),er.memoizedState=[e,_e],e},useReducer:function(e,_e,er){var tr=Th();return _e=er!==void 0?er(_e):_e,tr.memoizedState=tr.baseState=_e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:_e},tr.queue=e,e=e.dispatch=xi.bind(null,M$1,e),[tr.memoizedState,e]},useRef:function(e){var _e=Th();return e={current:e},_e.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),_e=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[_e,e]},useMutableSource:function(){},useSyncExternalStore:function(e,_e,er){var tr=M$1,rr=Th();if(I$1){if(er===void 0)throw Error(p$1(407));er=er()}else{if(er=_e(),Q$1===null)throw Error(p$1(349));Hh&30||di(tr,_e,er)}rr.memoizedState=er;var nr={value:er,getSnapshot:_e};return rr.queue=nr,mi(ai.bind(null,tr,nr,e),[e]),tr.flags|=2048,bi(9,ci.bind(null,tr,nr,er,_e),void 0,null),er},useId:function(){var e=Th(),_e=Q$1.identifierPrefix;if(I$1){var er=sg,tr=rg;er=(tr&~(1<<32-oc(tr)-1)).toString(32)+er,_e=":"+_e+"R"+er,er=Kh++,0<er&&(_e+="H"+er.toString(32)),_e+=":"}else er=Lh++,_e=":"+_e+"r"+er.toString(32)+":";return e.memoizedState=_e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var _e=Uh();return ui(_e,N$1.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],_e=Uh().memoizedState;return[e,_e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var _e=Uh();return N$1===null?_e.memoizedState=e:ui(_e,N$1.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],_e=Uh().memoizedState;return[e,_e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,_e){if(e&&e.defaultProps){_e=A$1({},_e),e=e.defaultProps;for(var er in e)_e[er]===void 0&&(_e[er]=e[er]);return _e}return _e}function Di(e,_e,er,tr){_e=e.memoizedState,er=er(tr,_e),er=er==null?_e:A$1({},_e,er),e.memoizedState=er,e.lanes===0&&(e.updateQueue.baseState=er)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,_e,er){e=e._reactInternals;var tr=R$1(),rr=yi(e),nr=mh(tr,rr);nr.payload=_e,er!=null&&(nr.callback=er),_e=nh(e,nr,rr),_e!==null&&(gi(_e,e,rr,tr),oh(_e,e,rr))},enqueueReplaceState:function(e,_e,er){e=e._reactInternals;var tr=R$1(),rr=yi(e),nr=mh(tr,rr);nr.tag=1,nr.payload=_e,er!=null&&(nr.callback=er),_e=nh(e,nr,rr),_e!==null&&(gi(_e,e,rr,tr),oh(_e,e,rr))},enqueueForceUpdate:function(e,_e){e=e._reactInternals;var er=R$1(),tr=yi(e),rr=mh(er,tr);rr.tag=2,_e!=null&&(rr.callback=_e),_e=nh(e,rr,tr),_e!==null&&(gi(_e,e,tr,er),oh(_e,e,tr))}};function Fi(e,_e,er,tr,rr,nr,ir){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(tr,nr,ir):_e.prototype&&_e.prototype.isPureReactComponent?!Ie(er,tr)||!Ie(rr,nr):!0}function Gi(e,_e,er){var tr=!1,rr=Vf,nr=_e.contextType;return typeof nr=="object"&&nr!==null?nr=eh(nr):(rr=Zf(_e)?Xf:H$1.current,tr=_e.contextTypes,nr=(tr=tr!=null)?Yf(e,rr):Vf),_e=new _e(er,nr),e.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,_e.updater=Ei,e.stateNode=_e,_e._reactInternals=e,tr&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=rr,e.__reactInternalMemoizedMaskedChildContext=nr),_e}function Hi(e,_e,er,tr){e=_e.state,typeof _e.componentWillReceiveProps=="function"&&_e.componentWillReceiveProps(er,tr),typeof _e.UNSAFE_componentWillReceiveProps=="function"&&_e.UNSAFE_componentWillReceiveProps(er,tr),_e.state!==e&&Ei.enqueueReplaceState(_e,_e.state,null)}function Ii(e,_e,er,tr){var rr=e.stateNode;rr.props=er,rr.state=e.memoizedState,rr.refs={},kh(e);var nr=_e.contextType;typeof nr=="object"&&nr!==null?rr.context=eh(nr):(nr=Zf(_e)?Xf:H$1.current,rr.context=Yf(e,nr)),rr.state=e.memoizedState,nr=_e.getDerivedStateFromProps,typeof nr=="function"&&(Di(e,_e,nr,er),rr.state=e.memoizedState),typeof _e.getDerivedStateFromProps=="function"||typeof rr.getSnapshotBeforeUpdate=="function"||typeof rr.UNSAFE_componentWillMount!="function"&&typeof rr.componentWillMount!="function"||(_e=rr.state,typeof rr.componentWillMount=="function"&&rr.componentWillMount(),typeof rr.UNSAFE_componentWillMount=="function"&&rr.UNSAFE_componentWillMount(),_e!==rr.state&&Ei.enqueueReplaceState(rr,rr.state,null),qh(e,er,rr,tr),rr.state=e.memoizedState),typeof rr.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,_e){try{var er="",tr=_e;do er+=Pa(tr),tr=tr.return;while(tr);var rr=er}catch(nr){rr=`
Error generating stack: `+nr.message+`
`+nr.stack}return{value:e,source:_e,stack:rr,digest:null}}function Ki(e,_e,er){return{value:e,source:null,stack:er??null,digest:_e??null}}function Li(e,_e){try{console.error(_e.value)}catch(er){setTimeout(function(){throw er})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,_e,er){er=mh(-1,er),er.tag=3,er.payload={element:null};var tr=_e.value;return er.callback=function(){Oi||(Oi=!0,Pi=tr),Li(e,_e)},er}function Qi(e,_e,er){er=mh(-1,er),er.tag=3;var tr=e.type.getDerivedStateFromError;if(typeof tr=="function"){var rr=_e.value;er.payload=function(){return tr(rr)},er.callback=function(){Li(e,_e)}}var nr=e.stateNode;return nr!==null&&typeof nr.componentDidCatch=="function"&&(er.callback=function(){Li(e,_e),typeof tr!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var ir=_e.stack;this.componentDidCatch(_e.value,{componentStack:ir!==null?ir:""})}),er}function Si(e,_e,er){var tr=e.pingCache;if(tr===null){tr=e.pingCache=new Mi;var rr=new Set;tr.set(_e,rr)}else rr=tr.get(_e),rr===void 0&&(rr=new Set,tr.set(_e,rr));rr.has(er)||(rr.add(er),e=Ti.bind(null,e,_e,er),_e.then(e,e))}function Ui(e){do{var _e;if((_e=e.tag===13)&&(_e=e.memoizedState,_e=_e!==null?_e.dehydrated!==null:!0),_e)return e;e=e.return}while(e!==null);return null}function Vi(e,_e,er,tr,rr){return e.mode&1?(e.flags|=65536,e.lanes=rr,e):(e===_e?e.flags|=65536:(e.flags|=128,er.flags|=131072,er.flags&=-52805,er.tag===1&&(er.alternate===null?er.tag=17:(_e=mh(-1,1),_e.tag=2,nh(er,_e,1))),er.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,_e,er,tr){_e.child=e===null?Vg(_e,null,er,tr):Ug(_e,e.child,er,tr)}function Yi(e,_e,er,tr,rr){er=er.render;var nr=_e.ref;return ch(_e,rr),tr=Nh(e,_e,er,tr,nr,rr),er=Sh(),e!==null&&!dh?(_e.updateQueue=e.updateQueue,_e.flags&=-2053,e.lanes&=~rr,Zi(e,_e,rr)):(I$1&&er&&vg(_e),_e.flags|=1,Xi(e,_e,tr,rr),_e.child)}function $i(e,_e,er,tr,rr){if(e===null){var nr=er.type;return typeof nr=="function"&&!aj(nr)&&nr.defaultProps===void 0&&er.compare===null&&er.defaultProps===void 0?(_e.tag=15,_e.type=nr,bj(e,_e,nr,tr,rr)):(e=Rg(er.type,null,tr,_e,_e.mode,rr),e.ref=_e.ref,e.return=_e,_e.child=e)}if(nr=e.child,!(e.lanes&rr)){var ir=nr.memoizedProps;if(er=er.compare,er=er!==null?er:Ie,er(ir,tr)&&e.ref===_e.ref)return Zi(e,_e,rr)}return _e.flags|=1,e=Pg(nr,tr),e.ref=_e.ref,e.return=_e,_e.child=e}function bj(e,_e,er,tr,rr){if(e!==null){var nr=e.memoizedProps;if(Ie(nr,tr)&&e.ref===_e.ref)if(dh=!1,_e.pendingProps=tr=nr,(e.lanes&rr)!==0)e.flags&131072&&(dh=!0);else return _e.lanes=e.lanes,Zi(e,_e,rr)}return cj(e,_e,er,tr,rr)}function dj(e,_e,er){var tr=_e.pendingProps,rr=tr.children,nr=e!==null?e.memoizedState:null;if(tr.mode==="hidden")if(!(_e.mode&1))_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=er;else{if(!(er&1073741824))return e=nr!==null?nr.baseLanes|er:er,_e.lanes=_e.childLanes=1073741824,_e.memoizedState={baseLanes:e,cachePool:null,transitions:null},_e.updateQueue=null,G$1(ej,fj),fj|=e,null;_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr=nr!==null?nr.baseLanes:er,G$1(ej,fj),fj|=tr}else nr!==null?(tr=nr.baseLanes|er,_e.memoizedState=null):tr=er,G$1(ej,fj),fj|=tr;return Xi(e,_e,rr,er),_e.child}function gj(e,_e){var er=_e.ref;(e===null&&er!==null||e!==null&&e.ref!==er)&&(_e.flags|=512,_e.flags|=2097152)}function cj(e,_e,er,tr,rr){var nr=Zf(er)?Xf:H$1.current;return nr=Yf(_e,nr),ch(_e,rr),er=Nh(e,_e,er,tr,nr,rr),tr=Sh(),e!==null&&!dh?(_e.updateQueue=e.updateQueue,_e.flags&=-2053,e.lanes&=~rr,Zi(e,_e,rr)):(I$1&&tr&&vg(_e),_e.flags|=1,Xi(e,_e,er,rr),_e.child)}function hj(e,_e,er,tr,rr){if(Zf(er)){var nr=!0;cg(_e)}else nr=!1;if(ch(_e,rr),_e.stateNode===null)ij(e,_e),Gi(_e,er,tr),Ii(_e,er,tr,rr),tr=!0;else if(e===null){var ir=_e.stateNode,ar=_e.memoizedProps;ir.props=ar;var sr=ir.context,or=er.contextType;typeof or=="object"&&or!==null?or=eh(or):(or=Zf(er)?Xf:H$1.current,or=Yf(_e,or));var lr=er.getDerivedStateFromProps,ur=typeof lr=="function"||typeof ir.getSnapshotBeforeUpdate=="function";ur||typeof ir.UNSAFE_componentWillReceiveProps!="function"&&typeof ir.componentWillReceiveProps!="function"||(ar!==tr||sr!==or)&&Hi(_e,ir,tr,or),jh=!1;var fr=_e.memoizedState;ir.state=fr,qh(_e,tr,ir,rr),sr=_e.memoizedState,ar!==tr||fr!==sr||Wf.current||jh?(typeof lr=="function"&&(Di(_e,er,lr,tr),sr=_e.memoizedState),(ar=jh||Fi(_e,er,ar,tr,fr,sr,or))?(ur||typeof ir.UNSAFE_componentWillMount!="function"&&typeof ir.componentWillMount!="function"||(typeof ir.componentWillMount=="function"&&ir.componentWillMount(),typeof ir.UNSAFE_componentWillMount=="function"&&ir.UNSAFE_componentWillMount()),typeof ir.componentDidMount=="function"&&(_e.flags|=4194308)):(typeof ir.componentDidMount=="function"&&(_e.flags|=4194308),_e.memoizedProps=tr,_e.memoizedState=sr),ir.props=tr,ir.state=sr,ir.context=or,tr=ar):(typeof ir.componentDidMount=="function"&&(_e.flags|=4194308),tr=!1)}else{ir=_e.stateNode,lh(e,_e),ar=_e.memoizedProps,or=_e.type===_e.elementType?ar:Ci(_e.type,ar),ir.props=or,ur=_e.pendingProps,fr=ir.context,sr=er.contextType,typeof sr=="object"&&sr!==null?sr=eh(sr):(sr=Zf(er)?Xf:H$1.current,sr=Yf(_e,sr));var cr=er.getDerivedStateFromProps;(lr=typeof cr=="function"||typeof ir.getSnapshotBeforeUpdate=="function")||typeof ir.UNSAFE_componentWillReceiveProps!="function"&&typeof ir.componentWillReceiveProps!="function"||(ar!==ur||fr!==sr)&&Hi(_e,ir,tr,sr),jh=!1,fr=_e.memoizedState,ir.state=fr,qh(_e,tr,ir,rr);var mr=_e.memoizedState;ar!==ur||fr!==mr||Wf.current||jh?(typeof cr=="function"&&(Di(_e,er,cr,tr),mr=_e.memoizedState),(or=jh||Fi(_e,er,or,tr,fr,mr,sr)||!1)?(lr||typeof ir.UNSAFE_componentWillUpdate!="function"&&typeof ir.componentWillUpdate!="function"||(typeof ir.componentWillUpdate=="function"&&ir.componentWillUpdate(tr,mr,sr),typeof ir.UNSAFE_componentWillUpdate=="function"&&ir.UNSAFE_componentWillUpdate(tr,mr,sr)),typeof ir.componentDidUpdate=="function"&&(_e.flags|=4),typeof ir.getSnapshotBeforeUpdate=="function"&&(_e.flags|=1024)):(typeof ir.componentDidUpdate!="function"||ar===e.memoizedProps&&fr===e.memoizedState||(_e.flags|=4),typeof ir.getSnapshotBeforeUpdate!="function"||ar===e.memoizedProps&&fr===e.memoizedState||(_e.flags|=1024),_e.memoizedProps=tr,_e.memoizedState=mr),ir.props=tr,ir.state=mr,ir.context=sr,tr=or):(typeof ir.componentDidUpdate!="function"||ar===e.memoizedProps&&fr===e.memoizedState||(_e.flags|=4),typeof ir.getSnapshotBeforeUpdate!="function"||ar===e.memoizedProps&&fr===e.memoizedState||(_e.flags|=1024),tr=!1)}return jj(e,_e,er,tr,nr,rr)}function jj(e,_e,er,tr,rr,nr){gj(e,_e);var ir=(_e.flags&128)!==0;if(!tr&&!ir)return rr&&dg(_e,er,!1),Zi(e,_e,nr);tr=_e.stateNode,Wi.current=_e;var ar=ir&&typeof er.getDerivedStateFromError!="function"?null:tr.render();return _e.flags|=1,e!==null&&ir?(_e.child=Ug(_e,e.child,null,nr),_e.child=Ug(_e,null,ar,nr)):Xi(e,_e,ar,nr),_e.memoizedState=tr.state,rr&&dg(_e,er,!0),_e.child}function kj(e){var _e=e.stateNode;_e.pendingContext?ag(e,_e.pendingContext,_e.pendingContext!==_e.context):_e.context&&ag(e,_e.context,!1),yh(e,_e.containerInfo)}function lj(e,_e,er,tr,rr){return Ig(),Jg(rr),_e.flags|=256,Xi(e,_e,er,tr),_e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,_e,er){var tr=_e.pendingProps,rr=L$1.current,nr=!1,ir=(_e.flags&128)!==0,ar;if((ar=ir)||(ar=e!==null&&e.memoizedState===null?!1:(rr&2)!==0),ar?(nr=!0,_e.flags&=-129):(e===null||e.memoizedState!==null)&&(rr|=1),G$1(L$1,rr&1),e===null)return Eg(_e),e=_e.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(_e.mode&1?e.data==="$!"?_e.lanes=8:_e.lanes=1073741824:_e.lanes=1,null):(ir=tr.children,e=tr.fallback,nr?(tr=_e.mode,nr=_e.child,ir={mode:"hidden",children:ir},!(tr&1)&&nr!==null?(nr.childLanes=0,nr.pendingProps=ir):nr=pj(ir,tr,0,null),e=Tg(e,tr,er,null),nr.return=_e,e.return=_e,nr.sibling=e,_e.child=nr,_e.child.memoizedState=nj(er),_e.memoizedState=mj,e):qj(_e,ir));if(rr=e.memoizedState,rr!==null&&(ar=rr.dehydrated,ar!==null))return rj(e,_e,ir,tr,ar,rr,er);if(nr){nr=tr.fallback,ir=_e.mode,rr=e.child,ar=rr.sibling;var sr={mode:"hidden",children:tr.children};return!(ir&1)&&_e.child!==rr?(tr=_e.child,tr.childLanes=0,tr.pendingProps=sr,_e.deletions=null):(tr=Pg(rr,sr),tr.subtreeFlags=rr.subtreeFlags&14680064),ar!==null?nr=Pg(ar,nr):(nr=Tg(nr,ir,er,null),nr.flags|=2),nr.return=_e,tr.return=_e,tr.sibling=nr,_e.child=tr,tr=nr,nr=_e.child,ir=e.child.memoizedState,ir=ir===null?nj(er):{baseLanes:ir.baseLanes|er,cachePool:null,transitions:ir.transitions},nr.memoizedState=ir,nr.childLanes=e.childLanes&~er,_e.memoizedState=mj,tr}return nr=e.child,e=nr.sibling,tr=Pg(nr,{mode:"visible",children:tr.children}),!(_e.mode&1)&&(tr.lanes=er),tr.return=_e,tr.sibling=null,e!==null&&(er=_e.deletions,er===null?(_e.deletions=[e],_e.flags|=16):er.push(e)),_e.child=tr,_e.memoizedState=null,tr}function qj(e,_e){return _e=pj({mode:"visible",children:_e},e.mode,0,null),_e.return=e,e.child=_e}function sj(e,_e,er,tr){return tr!==null&&Jg(tr),Ug(_e,e.child,null,er),e=qj(_e,_e.pendingProps.children),e.flags|=2,_e.memoizedState=null,e}function rj(e,_e,er,tr,rr,nr,ir){if(er)return _e.flags&256?(_e.flags&=-257,tr=Ki(Error(p$1(422))),sj(e,_e,ir,tr)):_e.memoizedState!==null?(_e.child=e.child,_e.flags|=128,null):(nr=tr.fallback,rr=_e.mode,tr=pj({mode:"visible",children:tr.children},rr,0,null),nr=Tg(nr,rr,ir,null),nr.flags|=2,tr.return=_e,nr.return=_e,tr.sibling=nr,_e.child=tr,_e.mode&1&&Ug(_e,e.child,null,ir),_e.child.memoizedState=nj(ir),_e.memoizedState=mj,nr);if(!(_e.mode&1))return sj(e,_e,ir,null);if(rr.data==="$!"){if(tr=rr.nextSibling&&rr.nextSibling.dataset,tr)var ar=tr.dgst;return tr=ar,nr=Error(p$1(419)),tr=Ki(nr,tr,void 0),sj(e,_e,ir,tr)}if(ar=(ir&e.childLanes)!==0,dh||ar){if(tr=Q$1,tr!==null){switch(ir&-ir){case 4:rr=2;break;case 16:rr=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:rr=32;break;case 536870912:rr=268435456;break;default:rr=0}rr=rr&(tr.suspendedLanes|ir)?0:rr,rr!==0&&rr!==nr.retryLane&&(nr.retryLane=rr,ih(e,rr),gi(tr,e,rr,-1))}return tj(),tr=Ki(Error(p$1(421))),sj(e,_e,ir,tr)}return rr.data==="$?"?(_e.flags|=128,_e.child=e.child,_e=uj.bind(null,e),rr._reactRetry=_e,null):(e=nr.treeContext,yg=Lf(rr.nextSibling),xg=_e,I$1=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=_e),_e=qj(_e,tr.children),_e.flags|=4096,_e)}function vj(e,_e,er){e.lanes|=_e;var tr=e.alternate;tr!==null&&(tr.lanes|=_e),bh(e.return,_e,er)}function wj(e,_e,er,tr,rr){var nr=e.memoizedState;nr===null?e.memoizedState={isBackwards:_e,rendering:null,renderingStartTime:0,last:tr,tail:er,tailMode:rr}:(nr.isBackwards=_e,nr.rendering=null,nr.renderingStartTime=0,nr.last=tr,nr.tail=er,nr.tailMode=rr)}function xj(e,_e,er){var tr=_e.pendingProps,rr=tr.revealOrder,nr=tr.tail;if(Xi(e,_e,tr.children,er),tr=L$1.current,tr&2)tr=tr&1|2,_e.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=_e.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,er,_e);else if(e.tag===19)vj(e,er,_e);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===_e)break e;for(;e.sibling===null;){if(e.return===null||e.return===_e)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}tr&=1}if(G$1(L$1,tr),!(_e.mode&1))_e.memoizedState=null;else switch(rr){case"forwards":for(er=_e.child,rr=null;er!==null;)e=er.alternate,e!==null&&Ch(e)===null&&(rr=er),er=er.sibling;er=rr,er===null?(rr=_e.child,_e.child=null):(rr=er.sibling,er.sibling=null),wj(_e,!1,rr,er,nr);break;case"backwards":for(er=null,rr=_e.child,_e.child=null;rr!==null;){if(e=rr.alternate,e!==null&&Ch(e)===null){_e.child=rr;break}e=rr.sibling,rr.sibling=er,er=rr,rr=e}wj(_e,!0,er,null,nr);break;case"together":wj(_e,!1,null,null,void 0);break;default:_e.memoizedState=null}return _e.child}function ij(e,_e){!(_e.mode&1)&&e!==null&&(e.alternate=null,_e.alternate=null,_e.flags|=2)}function Zi(e,_e,er){if(e!==null&&(_e.dependencies=e.dependencies),rh|=_e.lanes,!(er&_e.childLanes))return null;if(e!==null&&_e.child!==e.child)throw Error(p$1(153));if(_e.child!==null){for(e=_e.child,er=Pg(e,e.pendingProps),_e.child=er,er.return=_e;e.sibling!==null;)e=e.sibling,er=er.sibling=Pg(e,e.pendingProps),er.return=_e;er.sibling=null}return _e.child}function yj(e,_e,er){switch(_e.tag){case 3:kj(_e),Ig();break;case 5:Ah(_e);break;case 1:Zf(_e.type)&&cg(_e);break;case 4:yh(_e,_e.stateNode.containerInfo);break;case 10:var tr=_e.type._context,rr=_e.memoizedProps.value;G$1(Wg,tr._currentValue),tr._currentValue=rr;break;case 13:if(tr=_e.memoizedState,tr!==null)return tr.dehydrated!==null?(G$1(L$1,L$1.current&1),_e.flags|=128,null):er&_e.child.childLanes?oj(e,_e,er):(G$1(L$1,L$1.current&1),e=Zi(e,_e,er),e!==null?e.sibling:null);G$1(L$1,L$1.current&1);break;case 19:if(tr=(er&_e.childLanes)!==0,e.flags&128){if(tr)return xj(e,_e,er);_e.flags|=128}if(rr=_e.memoizedState,rr!==null&&(rr.rendering=null,rr.tail=null,rr.lastEffect=null),G$1(L$1,L$1.current),tr)break;return null;case 22:case 23:return _e.lanes=0,dj(e,_e,er)}return Zi(e,_e,er)}var zj,Aj,Bj,Cj;zj=function(e,_e){for(var er=_e.child;er!==null;){if(er.tag===5||er.tag===6)e.appendChild(er.stateNode);else if(er.tag!==4&&er.child!==null){er.child.return=er,er=er.child;continue}if(er===_e)break;for(;er.sibling===null;){if(er.return===null||er.return===_e)return;er=er.return}er.sibling.return=er.return,er=er.sibling}};Aj=function(){};Bj=function(e,_e,er,tr){var rr=e.memoizedProps;if(rr!==tr){e=_e.stateNode,xh(uh.current);var nr=null;switch(er){case"input":rr=Ya(e,rr),tr=Ya(e,tr),nr=[];break;case"select":rr=A$1({},rr,{value:void 0}),tr=A$1({},tr,{value:void 0}),nr=[];break;case"textarea":rr=gb(e,rr),tr=gb(e,tr),nr=[];break;default:typeof rr.onClick!="function"&&typeof tr.onClick=="function"&&(e.onclick=Bf)}ub(er,tr);var ir;er=null;for(or in rr)if(!tr.hasOwnProperty(or)&&rr.hasOwnProperty(or)&&rr[or]!=null)if(or==="style"){var ar=rr[or];for(ir in ar)ar.hasOwnProperty(ir)&&(er||(er={}),er[ir]="")}else or!=="dangerouslySetInnerHTML"&&or!=="children"&&or!=="suppressContentEditableWarning"&&or!=="suppressHydrationWarning"&&or!=="autoFocus"&&(ea.hasOwnProperty(or)?nr||(nr=[]):(nr=nr||[]).push(or,null));for(or in tr){var sr=tr[or];if(ar=rr!=null?rr[or]:void 0,tr.hasOwnProperty(or)&&sr!==ar&&(sr!=null||ar!=null))if(or==="style")if(ar){for(ir in ar)!ar.hasOwnProperty(ir)||sr&&sr.hasOwnProperty(ir)||(er||(er={}),er[ir]="");for(ir in sr)sr.hasOwnProperty(ir)&&ar[ir]!==sr[ir]&&(er||(er={}),er[ir]=sr[ir])}else er||(nr||(nr=[]),nr.push(or,er)),er=sr;else or==="dangerouslySetInnerHTML"?(sr=sr?sr.__html:void 0,ar=ar?ar.__html:void 0,sr!=null&&ar!==sr&&(nr=nr||[]).push(or,sr)):or==="children"?typeof sr!="string"&&typeof sr!="number"||(nr=nr||[]).push(or,""+sr):or!=="suppressContentEditableWarning"&&or!=="suppressHydrationWarning"&&(ea.hasOwnProperty(or)?(sr!=null&&or==="onScroll"&&D$1("scroll",e),nr||ar===sr||(nr=[])):(nr=nr||[]).push(or,sr))}er&&(nr=nr||[]).push("style",er);var or=nr;(_e.updateQueue=or)&&(_e.flags|=4)}};Cj=function(e,_e,er,tr){er!==tr&&(_e.flags|=4)};function Dj(e,_e){if(!I$1)switch(e.tailMode){case"hidden":_e=e.tail;for(var er=null;_e!==null;)_e.alternate!==null&&(er=_e),_e=_e.sibling;er===null?e.tail=null:er.sibling=null;break;case"collapsed":er=e.tail;for(var tr=null;er!==null;)er.alternate!==null&&(tr=er),er=er.sibling;tr===null?_e||e.tail===null?e.tail=null:e.tail.sibling=null:tr.sibling=null}}function S$1(e){var _e=e.alternate!==null&&e.alternate.child===e.child,er=0,tr=0;if(_e)for(var rr=e.child;rr!==null;)er|=rr.lanes|rr.childLanes,tr|=rr.subtreeFlags&14680064,tr|=rr.flags&14680064,rr.return=e,rr=rr.sibling;else for(rr=e.child;rr!==null;)er|=rr.lanes|rr.childLanes,tr|=rr.subtreeFlags,tr|=rr.flags,rr.return=e,rr=rr.sibling;return e.subtreeFlags|=tr,e.childLanes=er,_e}function Ej(e,_e,er){var tr=_e.pendingProps;switch(wg(_e),_e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(_e),null;case 1:return Zf(_e.type)&&$f(),S$1(_e),null;case 3:return tr=_e.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),tr.pendingContext&&(tr.context=tr.pendingContext,tr.pendingContext=null),(e===null||e.child===null)&&(Gg(_e)?_e.flags|=4:e===null||e.memoizedState.isDehydrated&&!(_e.flags&256)||(_e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,_e),S$1(_e),null;case 5:Bh(_e);var rr=xh(wh.current);if(er=_e.type,e!==null&&_e.stateNode!=null)Bj(e,_e,er,tr,rr),e.ref!==_e.ref&&(_e.flags|=512,_e.flags|=2097152);else{if(!tr){if(_e.stateNode===null)throw Error(p$1(166));return S$1(_e),null}if(e=xh(uh.current),Gg(_e)){tr=_e.stateNode,er=_e.type;var nr=_e.memoizedProps;switch(tr[Of]=_e,tr[Pf]=nr,e=(_e.mode&1)!==0,er){case"dialog":D$1("cancel",tr),D$1("close",tr);break;case"iframe":case"object":case"embed":D$1("load",tr);break;case"video":case"audio":for(rr=0;rr<lf.length;rr++)D$1(lf[rr],tr);break;case"source":D$1("error",tr);break;case"img":case"image":case"link":D$1("error",tr),D$1("load",tr);break;case"details":D$1("toggle",tr);break;case"input":Za(tr,nr),D$1("invalid",tr);break;case"select":tr._wrapperState={wasMultiple:!!nr.multiple},D$1("invalid",tr);break;case"textarea":hb(tr,nr),D$1("invalid",tr)}ub(er,nr),rr=null;for(var ir in nr)if(nr.hasOwnProperty(ir)){var ar=nr[ir];ir==="children"?typeof ar=="string"?tr.textContent!==ar&&(nr.suppressHydrationWarning!==!0&&Af(tr.textContent,ar,e),rr=["children",ar]):typeof ar=="number"&&tr.textContent!==""+ar&&(nr.suppressHydrationWarning!==!0&&Af(tr.textContent,ar,e),rr=["children",""+ar]):ea.hasOwnProperty(ir)&&ar!=null&&ir==="onScroll"&&D$1("scroll",tr)}switch(er){case"input":Va(tr),db(tr,nr,!0);break;case"textarea":Va(tr),jb(tr);break;case"select":case"option":break;default:typeof nr.onClick=="function"&&(tr.onclick=Bf)}tr=rr,_e.updateQueue=tr,tr!==null&&(_e.flags|=4)}else{ir=rr.nodeType===9?rr:rr.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(er)),e==="http://www.w3.org/1999/xhtml"?er==="script"?(e=ir.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof tr.is=="string"?e=ir.createElement(er,{is:tr.is}):(e=ir.createElement(er),er==="select"&&(ir=e,tr.multiple?ir.multiple=!0:tr.size&&(ir.size=tr.size))):e=ir.createElementNS(e,er),e[Of]=_e,e[Pf]=tr,zj(e,_e,!1,!1),_e.stateNode=e;e:{switch(ir=vb(er,tr),er){case"dialog":D$1("cancel",e),D$1("close",e),rr=tr;break;case"iframe":case"object":case"embed":D$1("load",e),rr=tr;break;case"video":case"audio":for(rr=0;rr<lf.length;rr++)D$1(lf[rr],e);rr=tr;break;case"source":D$1("error",e),rr=tr;break;case"img":case"image":case"link":D$1("error",e),D$1("load",e),rr=tr;break;case"details":D$1("toggle",e),rr=tr;break;case"input":Za(e,tr),rr=Ya(e,tr),D$1("invalid",e);break;case"option":rr=tr;break;case"select":e._wrapperState={wasMultiple:!!tr.multiple},rr=A$1({},tr,{value:void 0}),D$1("invalid",e);break;case"textarea":hb(e,tr),rr=gb(e,tr),D$1("invalid",e);break;default:rr=tr}ub(er,rr),ar=rr;for(nr in ar)if(ar.hasOwnProperty(nr)){var sr=ar[nr];nr==="style"?sb(e,sr):nr==="dangerouslySetInnerHTML"?(sr=sr?sr.__html:void 0,sr!=null&&nb(e,sr)):nr==="children"?typeof sr=="string"?(er!=="textarea"||sr!=="")&&ob(e,sr):typeof sr=="number"&&ob(e,""+sr):nr!=="suppressContentEditableWarning"&&nr!=="suppressHydrationWarning"&&nr!=="autoFocus"&&(ea.hasOwnProperty(nr)?sr!=null&&nr==="onScroll"&&D$1("scroll",e):sr!=null&&ta(e,nr,sr,ir))}switch(er){case"input":Va(e),db(e,tr,!1);break;case"textarea":Va(e),jb(e);break;case"option":tr.value!=null&&e.setAttribute("value",""+Sa(tr.value));break;case"select":e.multiple=!!tr.multiple,nr=tr.value,nr!=null?fb(e,!!tr.multiple,nr,!1):tr.defaultValue!=null&&fb(e,!!tr.multiple,tr.defaultValue,!0);break;default:typeof rr.onClick=="function"&&(e.onclick=Bf)}switch(er){case"button":case"input":case"select":case"textarea":tr=!!tr.autoFocus;break e;case"img":tr=!0;break e;default:tr=!1}}tr&&(_e.flags|=4)}_e.ref!==null&&(_e.flags|=512,_e.flags|=2097152)}return S$1(_e),null;case 6:if(e&&_e.stateNode!=null)Cj(e,_e,e.memoizedProps,tr);else{if(typeof tr!="string"&&_e.stateNode===null)throw Error(p$1(166));if(er=xh(wh.current),xh(uh.current),Gg(_e)){if(tr=_e.stateNode,er=_e.memoizedProps,tr[Of]=_e,(nr=tr.nodeValue!==er)&&(e=xg,e!==null))switch(e.tag){case 3:Af(tr.nodeValue,er,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(tr.nodeValue,er,(e.mode&1)!==0)}nr&&(_e.flags|=4)}else tr=(er.nodeType===9?er:er.ownerDocument).createTextNode(tr),tr[Of]=_e,_e.stateNode=tr}return S$1(_e),null;case 13:if(E$1(L$1),tr=_e.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&_e.mode&1&&!(_e.flags&128))Hg(),Ig(),_e.flags|=98560,nr=!1;else if(nr=Gg(_e),tr!==null&&tr.dehydrated!==null){if(e===null){if(!nr)throw Error(p$1(318));if(nr=_e.memoizedState,nr=nr!==null?nr.dehydrated:null,!nr)throw Error(p$1(317));nr[Of]=_e}else Ig(),!(_e.flags&128)&&(_e.memoizedState=null),_e.flags|=4;S$1(_e),nr=!1}else zg!==null&&(Fj(zg),zg=null),nr=!0;if(!nr)return _e.flags&65536?_e:null}return _e.flags&128?(_e.lanes=er,_e):(tr=tr!==null,tr!==(e!==null&&e.memoizedState!==null)&&tr&&(_e.child.flags|=8192,_e.mode&1&&(e===null||L$1.current&1?T$1===0&&(T$1=3):tj())),_e.updateQueue!==null&&(_e.flags|=4),S$1(_e),null);case 4:return zh(),Aj(e,_e),e===null&&sf(_e.stateNode.containerInfo),S$1(_e),null;case 10:return ah(_e.type._context),S$1(_e),null;case 17:return Zf(_e.type)&&$f(),S$1(_e),null;case 19:if(E$1(L$1),nr=_e.memoizedState,nr===null)return S$1(_e),null;if(tr=(_e.flags&128)!==0,ir=nr.rendering,ir===null)if(tr)Dj(nr,!1);else{if(T$1!==0||e!==null&&e.flags&128)for(e=_e.child;e!==null;){if(ir=Ch(e),ir!==null){for(_e.flags|=128,Dj(nr,!1),tr=ir.updateQueue,tr!==null&&(_e.updateQueue=tr,_e.flags|=4),_e.subtreeFlags=0,tr=er,er=_e.child;er!==null;)nr=er,e=tr,nr.flags&=14680066,ir=nr.alternate,ir===null?(nr.childLanes=0,nr.lanes=e,nr.child=null,nr.subtreeFlags=0,nr.memoizedProps=null,nr.memoizedState=null,nr.updateQueue=null,nr.dependencies=null,nr.stateNode=null):(nr.childLanes=ir.childLanes,nr.lanes=ir.lanes,nr.child=ir.child,nr.subtreeFlags=0,nr.deletions=null,nr.memoizedProps=ir.memoizedProps,nr.memoizedState=ir.memoizedState,nr.updateQueue=ir.updateQueue,nr.type=ir.type,e=ir.dependencies,nr.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),er=er.sibling;return G$1(L$1,L$1.current&1|2),_e.child}e=e.sibling}nr.tail!==null&&B$1()>Gj&&(_e.flags|=128,tr=!0,Dj(nr,!1),_e.lanes=4194304)}else{if(!tr)if(e=Ch(ir),e!==null){if(_e.flags|=128,tr=!0,er=e.updateQueue,er!==null&&(_e.updateQueue=er,_e.flags|=4),Dj(nr,!0),nr.tail===null&&nr.tailMode==="hidden"&&!ir.alternate&&!I$1)return S$1(_e),null}else 2*B$1()-nr.renderingStartTime>Gj&&er!==1073741824&&(_e.flags|=128,tr=!0,Dj(nr,!1),_e.lanes=4194304);nr.isBackwards?(ir.sibling=_e.child,_e.child=ir):(er=nr.last,er!==null?er.sibling=ir:_e.child=ir,nr.last=ir)}return nr.tail!==null?(_e=nr.tail,nr.rendering=_e,nr.tail=_e.sibling,nr.renderingStartTime=B$1(),_e.sibling=null,er=L$1.current,G$1(L$1,tr?er&1|2:er&1),_e):(S$1(_e),null);case 22:case 23:return Hj(),tr=_e.memoizedState!==null,e!==null&&e.memoizedState!==null!==tr&&(_e.flags|=8192),tr&&_e.mode&1?fj&1073741824&&(S$1(_e),_e.subtreeFlags&6&&(_e.flags|=8192)):S$1(_e),null;case 24:return null;case 25:return null}throw Error(p$1(156,_e.tag))}function Ij(e,_e){switch(wg(_e),_e.tag){case 1:return Zf(_e.type)&&$f(),e=_e.flags,e&65536?(_e.flags=e&-65537|128,_e):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),e=_e.flags,e&65536&&!(e&128)?(_e.flags=e&-65537|128,_e):null;case 5:return Bh(_e),null;case 13:if(E$1(L$1),e=_e.memoizedState,e!==null&&e.dehydrated!==null){if(_e.alternate===null)throw Error(p$1(340));Ig()}return e=_e.flags,e&65536?(_e.flags=e&-65537|128,_e):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(_e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj(e,_e){var er=e.ref;if(er!==null)if(typeof er=="function")try{er(null)}catch(tr){W$1(e,_e,tr)}else er.current=null}function Mj(e,_e,er){try{er()}catch(tr){W$1(e,_e,tr)}}var Nj=!1;function Oj(e,_e){if(Cf=dd,e=Me(),Ne$1(e)){if("selectionStart"in e)var er={start:e.selectionStart,end:e.selectionEnd};else e:{er=(er=e.ownerDocument)&&er.defaultView||window;var tr=er.getSelection&&er.getSelection();if(tr&&tr.rangeCount!==0){er=tr.anchorNode;var rr=tr.anchorOffset,nr=tr.focusNode;tr=tr.focusOffset;try{er.nodeType,nr.nodeType}catch{er=null;break e}var ir=0,ar=-1,sr=-1,or=0,lr=0,ur=e,fr=null;t:for(;;){for(var cr;ur!==er||rr!==0&&ur.nodeType!==3||(ar=ir+rr),ur!==nr||tr!==0&&ur.nodeType!==3||(sr=ir+tr),ur.nodeType===3&&(ir+=ur.nodeValue.length),(cr=ur.firstChild)!==null;)fr=ur,ur=cr;for(;;){if(ur===e)break t;if(fr===er&&++or===rr&&(ar=ir),fr===nr&&++lr===tr&&(sr=ir),(cr=ur.nextSibling)!==null)break;ur=fr,fr=ur.parentNode}ur=cr}er=ar===-1||sr===-1?null:{start:ar,end:sr}}else er=null}er=er||{start:0,end:0}}else er=null;for(Df={focusedElem:e,selectionRange:er},dd=!1,V$1=_e;V$1!==null;)if(_e=V$1,e=_e.child,(_e.subtreeFlags&1028)!==0&&e!==null)e.return=_e,V$1=e;else for(;V$1!==null;){_e=V$1;try{var mr=_e.alternate;if(_e.flags&1024)switch(_e.tag){case 0:case 11:case 15:break;case 1:if(mr!==null){var dr=mr.memoizedProps,xr=mr.memoizedState,pr=_e.stateNode,gr=pr.getSnapshotBeforeUpdate(_e.elementType===_e.type?dr:Ci(_e.type,dr),xr);pr.__reactInternalSnapshotBeforeUpdate=gr}break;case 3:var vr=_e.stateNode.containerInfo;vr.nodeType===1?vr.textContent="":vr.nodeType===9&&vr.documentElement&&vr.removeChild(vr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(Cr){W$1(_e,_e.return,Cr)}if(e=_e.sibling,e!==null){e.return=_e.return,V$1=e;break}V$1=_e.return}return mr=Nj,Nj=!1,mr}function Pj(e,_e,er){var tr=_e.updateQueue;if(tr=tr!==null?tr.lastEffect:null,tr!==null){var rr=tr=tr.next;do{if((rr.tag&e)===e){var nr=rr.destroy;rr.destroy=void 0,nr!==void 0&&Mj(_e,er,nr)}rr=rr.next}while(rr!==tr)}}function Qj(e,_e){if(_e=_e.updateQueue,_e=_e!==null?_e.lastEffect:null,_e!==null){var er=_e=_e.next;do{if((er.tag&e)===e){var tr=er.create;er.destroy=tr()}er=er.next}while(er!==_e)}}function Rj(e){var _e=e.ref;if(_e!==null){var er=e.stateNode;switch(e.tag){case 5:e=er;break;default:e=er}typeof _e=="function"?_e(e):_e.current=e}}function Sj(e){var _e=e.alternate;_e!==null&&(e.alternate=null,Sj(_e)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(_e=e.stateNode,_e!==null&&(delete _e[Of],delete _e[Pf],delete _e[of],delete _e[Qf],delete _e[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,_e,er){var tr=e.tag;if(tr===5||tr===6)e=e.stateNode,_e?er.nodeType===8?er.parentNode.insertBefore(e,_e):er.insertBefore(e,_e):(er.nodeType===8?(_e=er.parentNode,_e.insertBefore(e,er)):(_e=er,_e.appendChild(e)),er=er._reactRootContainer,er!=null||_e.onclick!==null||(_e.onclick=Bf));else if(tr!==4&&(e=e.child,e!==null))for(Vj(e,_e,er),e=e.sibling;e!==null;)Vj(e,_e,er),e=e.sibling}function Wj(e,_e,er){var tr=e.tag;if(tr===5||tr===6)e=e.stateNode,_e?er.insertBefore(e,_e):er.appendChild(e);else if(tr!==4&&(e=e.child,e!==null))for(Wj(e,_e,er),e=e.sibling;e!==null;)Wj(e,_e,er),e=e.sibling}var X$1=null,Xj=!1;function Yj(e,_e,er){for(er=er.child;er!==null;)Zj(e,_e,er),er=er.sibling}function Zj(e,_e,er){if(lc$1&&typeof lc$1.onCommitFiberUnmount=="function")try{lc$1.onCommitFiberUnmount(kc,er)}catch{}switch(er.tag){case 5:U$1||Lj(er,_e);case 6:var tr=X$1,rr=Xj;X$1=null,Yj(e,_e,er),X$1=tr,Xj=rr,X$1!==null&&(Xj?(e=X$1,er=er.stateNode,e.nodeType===8?e.parentNode.removeChild(er):e.removeChild(er)):X$1.removeChild(er.stateNode));break;case 18:X$1!==null&&(Xj?(e=X$1,er=er.stateNode,e.nodeType===8?Kf(e.parentNode,er):e.nodeType===1&&Kf(e,er),bd(e)):Kf(X$1,er.stateNode));break;case 4:tr=X$1,rr=Xj,X$1=er.stateNode.containerInfo,Xj=!0,Yj(e,_e,er),X$1=tr,Xj=rr;break;case 0:case 11:case 14:case 15:if(!U$1&&(tr=er.updateQueue,tr!==null&&(tr=tr.lastEffect,tr!==null))){rr=tr=tr.next;do{var nr=rr,ir=nr.destroy;nr=nr.tag,ir!==void 0&&(nr&2||nr&4)&&Mj(er,_e,ir),rr=rr.next}while(rr!==tr)}Yj(e,_e,er);break;case 1:if(!U$1&&(Lj(er,_e),tr=er.stateNode,typeof tr.componentWillUnmount=="function"))try{tr.props=er.memoizedProps,tr.state=er.memoizedState,tr.componentWillUnmount()}catch(ar){W$1(er,_e,ar)}Yj(e,_e,er);break;case 21:Yj(e,_e,er);break;case 22:er.mode&1?(U$1=(tr=U$1)||er.memoizedState!==null,Yj(e,_e,er),U$1=tr):Yj(e,_e,er);break;default:Yj(e,_e,er)}}function ak(e){var _e=e.updateQueue;if(_e!==null){e.updateQueue=null;var er=e.stateNode;er===null&&(er=e.stateNode=new Kj),_e.forEach(function(tr){var rr=bk.bind(null,e,tr);er.has(tr)||(er.add(tr),tr.then(rr,rr))})}}function ck(e,_e){var er=_e.deletions;if(er!==null)for(var tr=0;tr<er.length;tr++){var rr=er[tr];try{var nr=e,ir=_e,ar=ir;e:for(;ar!==null;){switch(ar.tag){case 5:X$1=ar.stateNode,Xj=!1;break e;case 3:X$1=ar.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=ar.stateNode.containerInfo,Xj=!0;break e}ar=ar.return}if(X$1===null)throw Error(p$1(160));Zj(nr,ir,rr),X$1=null,Xj=!1;var sr=rr.alternate;sr!==null&&(sr.return=null),rr.return=null}catch(or){W$1(rr,_e,or)}}if(_e.subtreeFlags&12854)for(_e=_e.child;_e!==null;)dk(_e,e),_e=_e.sibling}function dk(e,_e){var er=e.alternate,tr=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(_e,e),ek(e),tr&4){try{Pj(3,e,e.return),Qj(3,e)}catch(dr){W$1(e,e.return,dr)}try{Pj(5,e,e.return)}catch(dr){W$1(e,e.return,dr)}}break;case 1:ck(_e,e),ek(e),tr&512&&er!==null&&Lj(er,er.return);break;case 5:if(ck(_e,e),ek(e),tr&512&&er!==null&&Lj(er,er.return),e.flags&32){var rr=e.stateNode;try{ob(rr,"")}catch(dr){W$1(e,e.return,dr)}}if(tr&4&&(rr=e.stateNode,rr!=null)){var nr=e.memoizedProps,ir=er!==null?er.memoizedProps:nr,ar=e.type,sr=e.updateQueue;if(e.updateQueue=null,sr!==null)try{ar==="input"&&nr.type==="radio"&&nr.name!=null&&ab(rr,nr),vb(ar,ir);var or=vb(ar,nr);for(ir=0;ir<sr.length;ir+=2){var lr=sr[ir],ur=sr[ir+1];lr==="style"?sb(rr,ur):lr==="dangerouslySetInnerHTML"?nb(rr,ur):lr==="children"?ob(rr,ur):ta(rr,lr,ur,or)}switch(ar){case"input":bb(rr,nr);break;case"textarea":ib(rr,nr);break;case"select":var fr=rr._wrapperState.wasMultiple;rr._wrapperState.wasMultiple=!!nr.multiple;var cr=nr.value;cr!=null?fb(rr,!!nr.multiple,cr,!1):fr!==!!nr.multiple&&(nr.defaultValue!=null?fb(rr,!!nr.multiple,nr.defaultValue,!0):fb(rr,!!nr.multiple,nr.multiple?[]:"",!1))}rr[Pf]=nr}catch(dr){W$1(e,e.return,dr)}}break;case 6:if(ck(_e,e),ek(e),tr&4){if(e.stateNode===null)throw Error(p$1(162));rr=e.stateNode,nr=e.memoizedProps;try{rr.nodeValue=nr}catch(dr){W$1(e,e.return,dr)}}break;case 3:if(ck(_e,e),ek(e),tr&4&&er!==null&&er.memoizedState.isDehydrated)try{bd(_e.containerInfo)}catch(dr){W$1(e,e.return,dr)}break;case 4:ck(_e,e),ek(e);break;case 13:ck(_e,e),ek(e),rr=e.child,rr.flags&8192&&(nr=rr.memoizedState!==null,rr.stateNode.isHidden=nr,!nr||rr.alternate!==null&&rr.alternate.memoizedState!==null||(fk=B$1())),tr&4&&ak(e);break;case 22:if(lr=er!==null&&er.memoizedState!==null,e.mode&1?(U$1=(or=U$1)||lr,ck(_e,e),U$1=or):ck(_e,e),ek(e),tr&8192){if(or=e.memoizedState!==null,(e.stateNode.isHidden=or)&&!lr&&e.mode&1)for(V$1=e,lr=e.child;lr!==null;){for(ur=V$1=lr;V$1!==null;){switch(fr=V$1,cr=fr.child,fr.tag){case 0:case 11:case 14:case 15:Pj(4,fr,fr.return);break;case 1:Lj(fr,fr.return);var mr=fr.stateNode;if(typeof mr.componentWillUnmount=="function"){tr=fr,er=fr.return;try{_e=tr,mr.props=_e.memoizedProps,mr.state=_e.memoizedState,mr.componentWillUnmount()}catch(dr){W$1(tr,er,dr)}}break;case 5:Lj(fr,fr.return);break;case 22:if(fr.memoizedState!==null){gk(ur);continue}}cr!==null?(cr.return=fr,V$1=cr):gk(ur)}lr=lr.sibling}e:for(lr=null,ur=e;;){if(ur.tag===5){if(lr===null){lr=ur;try{rr=ur.stateNode,or?(nr=rr.style,typeof nr.setProperty=="function"?nr.setProperty("display","none","important"):nr.display="none"):(ar=ur.stateNode,sr=ur.memoizedProps.style,ir=sr!=null&&sr.hasOwnProperty("display")?sr.display:null,ar.style.display=rb("display",ir))}catch(dr){W$1(e,e.return,dr)}}}else if(ur.tag===6){if(lr===null)try{ur.stateNode.nodeValue=or?"":ur.memoizedProps}catch(dr){W$1(e,e.return,dr)}}else if((ur.tag!==22&&ur.tag!==23||ur.memoizedState===null||ur===e)&&ur.child!==null){ur.child.return=ur,ur=ur.child;continue}if(ur===e)break e;for(;ur.sibling===null;){if(ur.return===null||ur.return===e)break e;lr===ur&&(lr=null),ur=ur.return}lr===ur&&(lr=null),ur.sibling.return=ur.return,ur=ur.sibling}}break;case 19:ck(_e,e),ek(e),tr&4&&ak(e);break;case 21:break;default:ck(_e,e),ek(e)}}function ek(e){var _e=e.flags;if(_e&2){try{e:{for(var er=e.return;er!==null;){if(Tj(er)){var tr=er;break e}er=er.return}throw Error(p$1(160))}switch(tr.tag){case 5:var rr=tr.stateNode;tr.flags&32&&(ob(rr,""),tr.flags&=-33);var nr=Uj(e);Wj(e,nr,rr);break;case 3:case 4:var ir=tr.stateNode.containerInfo,ar=Uj(e);Vj(e,ar,ir);break;default:throw Error(p$1(161))}}catch(sr){W$1(e,e.return,sr)}e.flags&=-3}_e&4096&&(e.flags&=-4097)}function hk(e,_e,er){V$1=e,ik(e)}function ik(e,_e,er){for(var tr=(e.mode&1)!==0;V$1!==null;){var rr=V$1,nr=rr.child;if(rr.tag===22&&tr){var ir=rr.memoizedState!==null||Jj;if(!ir){var ar=rr.alternate,sr=ar!==null&&ar.memoizedState!==null||U$1;ar=Jj;var or=U$1;if(Jj=ir,(U$1=sr)&&!or)for(V$1=rr;V$1!==null;)ir=V$1,sr=ir.child,ir.tag===22&&ir.memoizedState!==null?jk(rr):sr!==null?(sr.return=ir,V$1=sr):jk(rr);for(;nr!==null;)V$1=nr,ik(nr),nr=nr.sibling;V$1=rr,Jj=ar,U$1=or}kk(e)}else rr.subtreeFlags&8772&&nr!==null?(nr.return=rr,V$1=nr):kk(e)}}function kk(e){for(;V$1!==null;){var _e=V$1;if(_e.flags&8772){var er=_e.alternate;try{if(_e.flags&8772)switch(_e.tag){case 0:case 11:case 15:U$1||Qj(5,_e);break;case 1:var tr=_e.stateNode;if(_e.flags&4&&!U$1)if(er===null)tr.componentDidMount();else{var rr=_e.elementType===_e.type?er.memoizedProps:Ci(_e.type,er.memoizedProps);tr.componentDidUpdate(rr,er.memoizedState,tr.__reactInternalSnapshotBeforeUpdate)}var nr=_e.updateQueue;nr!==null&&sh(_e,nr,tr);break;case 3:var ir=_e.updateQueue;if(ir!==null){if(er=null,_e.child!==null)switch(_e.child.tag){case 5:er=_e.child.stateNode;break;case 1:er=_e.child.stateNode}sh(_e,ir,er)}break;case 5:var ar=_e.stateNode;if(er===null&&_e.flags&4){er=ar;var sr=_e.memoizedProps;switch(_e.type){case"button":case"input":case"select":case"textarea":sr.autoFocus&&er.focus();break;case"img":sr.src&&(er.src=sr.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_e.memoizedState===null){var or=_e.alternate;if(or!==null){var lr=or.memoizedState;if(lr!==null){var ur=lr.dehydrated;ur!==null&&bd(ur)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$1||_e.flags&512&&Rj(_e)}catch(fr){W$1(_e,_e.return,fr)}}if(_e===e){V$1=null;break}if(er=_e.sibling,er!==null){er.return=_e.return,V$1=er;break}V$1=_e.return}}function gk(e){for(;V$1!==null;){var _e=V$1;if(_e===e){V$1=null;break}var er=_e.sibling;if(er!==null){er.return=_e.return,V$1=er;break}V$1=_e.return}}function jk(e){for(;V$1!==null;){var _e=V$1;try{switch(_e.tag){case 0:case 11:case 15:var er=_e.return;try{Qj(4,_e)}catch(sr){W$1(_e,er,sr)}break;case 1:var tr=_e.stateNode;if(typeof tr.componentDidMount=="function"){var rr=_e.return;try{tr.componentDidMount()}catch(sr){W$1(_e,rr,sr)}}var nr=_e.return;try{Rj(_e)}catch(sr){W$1(_e,nr,sr)}break;case 5:var ir=_e.return;try{Rj(_e)}catch(sr){W$1(_e,ir,sr)}}}catch(sr){W$1(_e,_e.return,sr)}if(_e===e){V$1=null;break}var ar=_e.sibling;if(ar!==null){ar.return=_e.return,V$1=ar;break}V$1=_e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K$1=0,Q$1=null,Y$1=null,Z$1=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$1&6?B$1():Ak!==-1?Ak:Ak=B$1()}function yi(e){return e.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C$1,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,_e,er,tr){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(e,er,tr),(!(K$1&2)||e!==Q$1)&&(e===Q$1&&(!(K$1&2)&&(qk|=er),T$1===4&&Ck(e,Z$1)),Dk(e,tr),er===1&&K$1===0&&!(_e.mode&1)&&(Gj=B$1()+500,fg&&jg()))}function Dk(e,_e){var er=e.callbackNode;wc(e,_e);var tr=uc(e,e===Q$1?Z$1:0);if(tr===0)er!==null&&bc(er),e.callbackNode=null,e.callbackPriority=0;else if(_e=tr&-tr,e.callbackPriority!==_e){if(er!=null&&bc(er),_e===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K$1&6)&&jg()}),er=null;else{switch(Dc(tr)){case 1:er=fc;break;case 4:er=gc;break;case 16:er=hc;break;case 536870912:er=jc;break;default:er=hc}er=Fk(er,Gk.bind(null,e))}e.callbackPriority=_e,e.callbackNode=er}}function Gk(e,_e){if(Ak=-1,Bk=0,K$1&6)throw Error(p$1(327));var er=e.callbackNode;if(Hk()&&e.callbackNode!==er)return null;var tr=uc(e,e===Q$1?Z$1:0);if(tr===0)return null;if(tr&30||tr&e.expiredLanes||_e)_e=Ik(e,tr);else{_e=tr;var rr=K$1;K$1|=2;var nr=Jk();(Q$1!==e||Z$1!==_e)&&(uk=null,Gj=B$1()+500,Kk(e,_e));do try{Lk();break}catch(ar){Mk(e,ar)}while(!0);$g(),mk.current=nr,K$1=rr,Y$1!==null?_e=0:(Q$1=null,Z$1=0,_e=T$1)}if(_e!==0){if(_e===2&&(rr=xc(e),rr!==0&&(tr=rr,_e=Nk(e,rr))),_e===1)throw er=pk,Kk(e,0),Ck(e,tr),Dk(e,B$1()),er;if(_e===6)Ck(e,tr);else{if(rr=e.current.alternate,!(tr&30)&&!Ok(rr)&&(_e=Ik(e,tr),_e===2&&(nr=xc(e),nr!==0&&(tr=nr,_e=Nk(e,nr))),_e===1))throw er=pk,Kk(e,0),Ck(e,tr),Dk(e,B$1()),er;switch(e.finishedWork=rr,e.finishedLanes=tr,_e){case 0:case 1:throw Error(p$1(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,tr),(tr&130023424)===tr&&(_e=fk+500-B$1(),10<_e)){if(uc(e,0)!==0)break;if(rr=e.suspendedLanes,(rr&tr)!==tr){R$1(),e.pingedLanes|=e.suspendedLanes&rr;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),_e);break}Pk(e,tk,uk);break;case 4:if(Ck(e,tr),(tr&4194240)===tr)break;for(_e=e.eventTimes,rr=-1;0<tr;){var ir=31-oc(tr);nr=1<<ir,ir=_e[ir],ir>rr&&(rr=ir),tr&=~nr}if(tr=rr,tr=B$1()-tr,tr=(120>tr?120:480>tr?480:1080>tr?1080:1920>tr?1920:3e3>tr?3e3:4320>tr?4320:1960*lk(tr/1960))-tr,10<tr){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),tr);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(e,B$1()),e.callbackNode===er?Gk.bind(null,e):null}function Nk(e,_e){var er=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,_e).flags|=256),e=Ik(e,_e),e!==2&&(_e=tk,tk=er,_e!==null&&Fj(_e)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var _e=e;;){if(_e.flags&16384){var er=_e.updateQueue;if(er!==null&&(er=er.stores,er!==null))for(var tr=0;tr<er.length;tr++){var rr=er[tr],nr=rr.getSnapshot;rr=rr.value;try{if(!He(nr(),rr))return!1}catch{return!1}}}if(er=_e.child,_e.subtreeFlags&16384&&er!==null)er.return=_e,_e=er;else{if(_e===e)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===e)return!0;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}}return!0}function Ck(e,_e){for(_e&=~rk,_e&=~qk,e.suspendedLanes|=_e,e.pingedLanes&=~_e,e=e.expirationTimes;0<_e;){var er=31-oc(_e),tr=1<<er;e[er]=-1,_e&=~tr}}function Ek(e){if(K$1&6)throw Error(p$1(327));Hk();var _e=uc(e,0);if(!(_e&1))return Dk(e,B$1()),null;var er=Ik(e,_e);if(e.tag!==0&&er===2){var tr=xc(e);tr!==0&&(_e=tr,er=Nk(e,tr))}if(er===1)throw er=pk,Kk(e,0),Ck(e,_e),Dk(e,B$1()),er;if(er===6)throw Error(p$1(345));return e.finishedWork=e.current.alternate,e.finishedLanes=_e,Pk(e,tk,uk),Dk(e,B$1()),null}function Qk(e,_e){var er=K$1;K$1|=1;try{return e(_e)}finally{K$1=er,K$1===0&&(Gj=B$1()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K$1&6)&&Hk();var _e=K$1;K$1|=1;var er=ok.transition,tr=C$1;try{if(ok.transition=null,C$1=1,e)return e()}finally{C$1=tr,ok.transition=er,K$1=_e,!(K$1&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(e,_e){e.finishedWork=null,e.finishedLanes=0;var er=e.timeoutHandle;if(er!==-1&&(e.timeoutHandle=-1,Gf(er)),Y$1!==null)for(er=Y$1.return;er!==null;){var tr=er;switch(wg(tr),tr.tag){case 1:tr=tr.type.childContextTypes,tr!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(tr);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(tr.type._context);break;case 22:case 23:Hj()}er=er.return}if(Q$1=e,Y$1=e=Pg(e.current,null),Z$1=fj=_e,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(_e=0;_e<fh.length;_e++)if(er=fh[_e],tr=er.interleaved,tr!==null){er.interleaved=null;var rr=tr.next,nr=er.pending;if(nr!==null){var ir=nr.next;nr.next=rr,tr.next=ir}er.pending=tr}fh=null}return e}function Mk(e,_e){do{var er=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var tr=M$1.memoizedState;tr!==null;){var rr=tr.queue;rr!==null&&(rr.pending=null),tr=tr.next}Ih=!1}if(Hh=0,O$1=N$1=M$1=null,Jh=!1,Kh=0,nk.current=null,er===null||er.return===null){T$1=1,pk=_e,Y$1=null;break}e:{var nr=e,ir=er.return,ar=er,sr=_e;if(_e=Z$1,ar.flags|=32768,sr!==null&&typeof sr=="object"&&typeof sr.then=="function"){var or=sr,lr=ar,ur=lr.tag;if(!(lr.mode&1)&&(ur===0||ur===11||ur===15)){var fr=lr.alternate;fr?(lr.updateQueue=fr.updateQueue,lr.memoizedState=fr.memoizedState,lr.lanes=fr.lanes):(lr.updateQueue=null,lr.memoizedState=null)}var cr=Ui(ir);if(cr!==null){cr.flags&=-257,Vi(cr,ir,ar,nr,_e),cr.mode&1&&Si(nr,or,_e),_e=cr,sr=or;var mr=_e.updateQueue;if(mr===null){var dr=new Set;dr.add(sr),_e.updateQueue=dr}else mr.add(sr);break e}else{if(!(_e&1)){Si(nr,or,_e),tj();break e}sr=Error(p$1(426))}}else if(I$1&&ar.mode&1){var xr=Ui(ir);if(xr!==null){!(xr.flags&65536)&&(xr.flags|=256),Vi(xr,ir,ar,nr,_e),Jg(Ji(sr,ar));break e}}nr=sr=Ji(sr,ar),T$1!==4&&(T$1=2),sk===null?sk=[nr]:sk.push(nr),nr=ir;do{switch(nr.tag){case 3:nr.flags|=65536,_e&=-_e,nr.lanes|=_e;var pr=Ni(nr,sr,_e);ph(nr,pr);break e;case 1:ar=sr;var gr=nr.type,vr=nr.stateNode;if(!(nr.flags&128)&&(typeof gr.getDerivedStateFromError=="function"||vr!==null&&typeof vr.componentDidCatch=="function"&&(Ri===null||!Ri.has(vr)))){nr.flags|=65536,_e&=-_e,nr.lanes|=_e;var Cr=Qi(nr,ar,_e);ph(nr,Cr);break e}}nr=nr.return}while(nr!==null)}Sk(er)}catch(Tr){_e=Tr,Y$1===er&&er!==null&&(Y$1=er=er.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q$1===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$1,Z$1)}function Ik(e,_e){var er=K$1;K$1|=2;var tr=Jk();(Q$1!==e||Z$1!==_e)&&(uk=null,Kk(e,_e));do try{Tk();break}catch(rr){Mk(e,rr)}while(!0);if($g(),K$1=er,mk.current=tr,Y$1!==null)throw Error(p$1(261));return Q$1=null,Z$1=0,T$1}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(e){var _e=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,_e===null?Sk(e):Y$1=_e,nk.current=null}function Sk(e){var _e=e;do{var er=_e.alternate;if(e=_e.return,_e.flags&32768){if(er=Ij(er,_e),er!==null){er.flags&=32767,Y$1=er;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T$1=6,Y$1=null;return}}else if(er=Ej(er,_e,fj),er!==null){Y$1=er;return}if(_e=_e.sibling,_e!==null){Y$1=_e;return}Y$1=_e=e}while(_e!==null);T$1===0&&(T$1=5)}function Pk(e,_e,er){var tr=C$1,rr=ok.transition;try{ok.transition=null,C$1=1,Wk(e,_e,er,tr)}finally{ok.transition=rr,C$1=tr}return null}function Wk(e,_e,er,tr){do Hk();while(wk!==null);if(K$1&6)throw Error(p$1(327));er=e.finishedWork;var rr=e.finishedLanes;if(er===null)return null;if(e.finishedWork=null,e.finishedLanes=0,er===e.current)throw Error(p$1(177));e.callbackNode=null,e.callbackPriority=0;var nr=er.lanes|er.childLanes;if(Bc(e,nr),e===Q$1&&(Y$1=Q$1=null,Z$1=0),!(er.subtreeFlags&2064)&&!(er.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),nr=(er.flags&15990)!==0,er.subtreeFlags&15990||nr){nr=ok.transition,ok.transition=null;var ir=C$1;C$1=1;var ar=K$1;K$1|=4,nk.current=null,Oj(e,er),dk(er,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=er,hk(er),dc(),K$1=ar,C$1=ir,ok.transition=nr}else e.current=er;if(vk&&(vk=!1,wk=e,xk=rr),nr=e.pendingLanes,nr===0&&(Ri=null),mc(er.stateNode),Dk(e,B$1()),_e!==null)for(tr=e.onRecoverableError,er=0;er<_e.length;er++)rr=_e[er],tr(rr.value,{componentStack:rr.stack,digest:rr.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),nr=e.pendingLanes,nr&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),_e=ok.transition,er=C$1;try{if(ok.transition=null,C$1=16>e?16:e,wk===null)var tr=!1;else{if(e=wk,wk=null,xk=0,K$1&6)throw Error(p$1(331));var rr=K$1;for(K$1|=4,V$1=e.current;V$1!==null;){var nr=V$1,ir=nr.child;if(V$1.flags&16){var ar=nr.deletions;if(ar!==null){for(var sr=0;sr<ar.length;sr++){var or=ar[sr];for(V$1=or;V$1!==null;){var lr=V$1;switch(lr.tag){case 0:case 11:case 15:Pj(8,lr,nr)}var ur=lr.child;if(ur!==null)ur.return=lr,V$1=ur;else for(;V$1!==null;){lr=V$1;var fr=lr.sibling,cr=lr.return;if(Sj(lr),lr===or){V$1=null;break}if(fr!==null){fr.return=cr,V$1=fr;break}V$1=cr}}}var mr=nr.alternate;if(mr!==null){var dr=mr.child;if(dr!==null){mr.child=null;do{var xr=dr.sibling;dr.sibling=null,dr=xr}while(dr!==null)}}V$1=nr}}if(nr.subtreeFlags&2064&&ir!==null)ir.return=nr,V$1=ir;else e:for(;V$1!==null;){if(nr=V$1,nr.flags&2048)switch(nr.tag){case 0:case 11:case 15:Pj(9,nr,nr.return)}var pr=nr.sibling;if(pr!==null){pr.return=nr.return,V$1=pr;break e}V$1=nr.return}}var gr=e.current;for(V$1=gr;V$1!==null;){ir=V$1;var vr=ir.child;if(ir.subtreeFlags&2064&&vr!==null)vr.return=ir,V$1=vr;else e:for(ir=gr;V$1!==null;){if(ar=V$1,ar.flags&2048)try{switch(ar.tag){case 0:case 11:case 15:Qj(9,ar)}}catch(Tr){W$1(ar,ar.return,Tr)}if(ar===ir){V$1=null;break e}var Cr=ar.sibling;if(Cr!==null){Cr.return=ar.return,V$1=Cr;break e}V$1=ar.return}}if(K$1=rr,jg(),lc$1&&typeof lc$1.onPostCommitFiberRoot=="function")try{lc$1.onPostCommitFiberRoot(kc,e)}catch{}tr=!0}return tr}finally{C$1=er,ok.transition=_e}}return!1}function Xk(e,_e,er){_e=Ji(er,_e),_e=Ni(e,_e,1),e=nh(e,_e,1),_e=R$1(),e!==null&&(Ac(e,1,_e),Dk(e,_e))}function W$1(e,_e,er){if(e.tag===3)Xk(e,e,er);else for(;_e!==null;){if(_e.tag===3){Xk(_e,e,er);break}else if(_e.tag===1){var tr=_e.stateNode;if(typeof _e.type.getDerivedStateFromError=="function"||typeof tr.componentDidCatch=="function"&&(Ri===null||!Ri.has(tr))){e=Ji(er,e),e=Qi(_e,e,1),_e=nh(_e,e,1),e=R$1(),_e!==null&&(Ac(_e,1,e),Dk(_e,e));break}}_e=_e.return}}function Ti(e,_e,er){var tr=e.pingCache;tr!==null&&tr.delete(_e),_e=R$1(),e.pingedLanes|=e.suspendedLanes&er,Q$1===e&&(Z$1&er)===er&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$1()-fk?Kk(e,0):rk|=er),Dk(e,_e)}function Yk(e,_e){_e===0&&(e.mode&1?(_e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_e=1);var er=R$1();e=ih(e,_e),e!==null&&(Ac(e,_e,er),Dk(e,er))}function uj(e){var _e=e.memoizedState,er=0;_e!==null&&(er=_e.retryLane),Yk(e,er)}function bk(e,_e){var er=0;switch(e.tag){case 13:var tr=e.stateNode,rr=e.memoizedState;rr!==null&&(er=rr.retryLane);break;case 19:tr=e.stateNode;break;default:throw Error(p$1(314))}tr!==null&&tr.delete(_e),Yk(e,er)}var Vk;Vk=function(e,_e,er){if(e!==null)if(e.memoizedProps!==_e.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&er)&&!(_e.flags&128))return dh=!1,yj(e,_e,er);dh=!!(e.flags&131072)}else dh=!1,I$1&&_e.flags&1048576&&ug(_e,ng,_e.index);switch(_e.lanes=0,_e.tag){case 2:var tr=_e.type;ij(e,_e),e=_e.pendingProps;var rr=Yf(_e,H$1.current);ch(_e,er),rr=Nh(null,_e,tr,e,rr,er);var nr=Sh();return _e.flags|=1,typeof rr=="object"&&rr!==null&&typeof rr.render=="function"&&rr.$$typeof===void 0?(_e.tag=1,_e.memoizedState=null,_e.updateQueue=null,Zf(tr)?(nr=!0,cg(_e)):nr=!1,_e.memoizedState=rr.state!==null&&rr.state!==void 0?rr.state:null,kh(_e),rr.updater=Ei,_e.stateNode=rr,rr._reactInternals=_e,Ii(_e,tr,e,er),_e=jj(null,_e,tr,!0,nr,er)):(_e.tag=0,I$1&&nr&&vg(_e),Xi(null,_e,rr,er),_e=_e.child),_e;case 16:tr=_e.elementType;e:{switch(ij(e,_e),e=_e.pendingProps,rr=tr._init,tr=rr(tr._payload),_e.type=tr,rr=_e.tag=Zk(tr),e=Ci(tr,e),rr){case 0:_e=cj(null,_e,tr,e,er);break e;case 1:_e=hj(null,_e,tr,e,er);break e;case 11:_e=Yi(null,_e,tr,e,er);break e;case 14:_e=$i(null,_e,tr,Ci(tr.type,e),er);break e}throw Error(p$1(306,tr,""))}return _e;case 0:return tr=_e.type,rr=_e.pendingProps,rr=_e.elementType===tr?rr:Ci(tr,rr),cj(e,_e,tr,rr,er);case 1:return tr=_e.type,rr=_e.pendingProps,rr=_e.elementType===tr?rr:Ci(tr,rr),hj(e,_e,tr,rr,er);case 3:e:{if(kj(_e),e===null)throw Error(p$1(387));tr=_e.pendingProps,nr=_e.memoizedState,rr=nr.element,lh(e,_e),qh(_e,tr,null,er);var ir=_e.memoizedState;if(tr=ir.element,nr.isDehydrated)if(nr={element:tr,isDehydrated:!1,cache:ir.cache,pendingSuspenseBoundaries:ir.pendingSuspenseBoundaries,transitions:ir.transitions},_e.updateQueue.baseState=nr,_e.memoizedState=nr,_e.flags&256){rr=Ji(Error(p$1(423)),_e),_e=lj(e,_e,tr,er,rr);break e}else if(tr!==rr){rr=Ji(Error(p$1(424)),_e),_e=lj(e,_e,tr,er,rr);break e}else for(yg=Lf(_e.stateNode.containerInfo.firstChild),xg=_e,I$1=!0,zg=null,er=Vg(_e,null,tr,er),_e.child=er;er;)er.flags=er.flags&-3|4096,er=er.sibling;else{if(Ig(),tr===rr){_e=Zi(e,_e,er);break e}Xi(e,_e,tr,er)}_e=_e.child}return _e;case 5:return Ah(_e),e===null&&Eg(_e),tr=_e.type,rr=_e.pendingProps,nr=e!==null?e.memoizedProps:null,ir=rr.children,Ef(tr,rr)?ir=null:nr!==null&&Ef(tr,nr)&&(_e.flags|=32),gj(e,_e),Xi(e,_e,ir,er),_e.child;case 6:return e===null&&Eg(_e),null;case 13:return oj(e,_e,er);case 4:return yh(_e,_e.stateNode.containerInfo),tr=_e.pendingProps,e===null?_e.child=Ug(_e,null,tr,er):Xi(e,_e,tr,er),_e.child;case 11:return tr=_e.type,rr=_e.pendingProps,rr=_e.elementType===tr?rr:Ci(tr,rr),Yi(e,_e,tr,rr,er);case 7:return Xi(e,_e,_e.pendingProps,er),_e.child;case 8:return Xi(e,_e,_e.pendingProps.children,er),_e.child;case 12:return Xi(e,_e,_e.pendingProps.children,er),_e.child;case 10:e:{if(tr=_e.type._context,rr=_e.pendingProps,nr=_e.memoizedProps,ir=rr.value,G$1(Wg,tr._currentValue),tr._currentValue=ir,nr!==null)if(He(nr.value,ir)){if(nr.children===rr.children&&!Wf.current){_e=Zi(e,_e,er);break e}}else for(nr=_e.child,nr!==null&&(nr.return=_e);nr!==null;){var ar=nr.dependencies;if(ar!==null){ir=nr.child;for(var sr=ar.firstContext;sr!==null;){if(sr.context===tr){if(nr.tag===1){sr=mh(-1,er&-er),sr.tag=2;var or=nr.updateQueue;if(or!==null){or=or.shared;var lr=or.pending;lr===null?sr.next=sr:(sr.next=lr.next,lr.next=sr),or.pending=sr}}nr.lanes|=er,sr=nr.alternate,sr!==null&&(sr.lanes|=er),bh(nr.return,er,_e),ar.lanes|=er;break}sr=sr.next}}else if(nr.tag===10)ir=nr.type===_e.type?null:nr.child;else if(nr.tag===18){if(ir=nr.return,ir===null)throw Error(p$1(341));ir.lanes|=er,ar=ir.alternate,ar!==null&&(ar.lanes|=er),bh(ir,er,_e),ir=nr.sibling}else ir=nr.child;if(ir!==null)ir.return=nr;else for(ir=nr;ir!==null;){if(ir===_e){ir=null;break}if(nr=ir.sibling,nr!==null){nr.return=ir.return,ir=nr;break}ir=ir.return}nr=ir}Xi(e,_e,rr.children,er),_e=_e.child}return _e;case 9:return rr=_e.type,tr=_e.pendingProps.children,ch(_e,er),rr=eh(rr),tr=tr(rr),_e.flags|=1,Xi(e,_e,tr,er),_e.child;case 14:return tr=_e.type,rr=Ci(tr,_e.pendingProps),rr=Ci(tr.type,rr),$i(e,_e,tr,rr,er);case 15:return bj(e,_e,_e.type,_e.pendingProps,er);case 17:return tr=_e.type,rr=_e.pendingProps,rr=_e.elementType===tr?rr:Ci(tr,rr),ij(e,_e),_e.tag=1,Zf(tr)?(e=!0,cg(_e)):e=!1,ch(_e,er),Gi(_e,tr,rr),Ii(_e,tr,rr,er),jj(null,_e,tr,!0,e,er);case 19:return xj(e,_e,er);case 22:return dj(e,_e,er)}throw Error(p$1(156,_e.tag))};function Fk(e,_e){return ac(e,_e)}function $k(e,_e,er,tr){this.tag=e,this.key=er,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=tr,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,_e,er,tr){return new $k(e,_e,er,tr)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,_e){var er=e.alternate;return er===null?(er=Bg(e.tag,_e,e.key,e.mode),er.elementType=e.elementType,er.type=e.type,er.stateNode=e.stateNode,er.alternate=e,e.alternate=er):(er.pendingProps=_e,er.type=e.type,er.flags=0,er.subtreeFlags=0,er.deletions=null),er.flags=e.flags&14680064,er.childLanes=e.childLanes,er.lanes=e.lanes,er.child=e.child,er.memoizedProps=e.memoizedProps,er.memoizedState=e.memoizedState,er.updateQueue=e.updateQueue,_e=e.dependencies,er.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext},er.sibling=e.sibling,er.index=e.index,er.ref=e.ref,er}function Rg(e,_e,er,tr,rr,nr){var ir=2;if(tr=e,typeof e=="function")aj(e)&&(ir=1);else if(typeof e=="string")ir=5;else e:switch(e){case ya:return Tg(er.children,rr,nr,_e);case za:ir=8,rr|=8;break;case Aa:return e=Bg(12,er,_e,rr|2),e.elementType=Aa,e.lanes=nr,e;case Ea:return e=Bg(13,er,_e,rr),e.elementType=Ea,e.lanes=nr,e;case Fa:return e=Bg(19,er,_e,rr),e.elementType=Fa,e.lanes=nr,e;case Ia:return pj(er,rr,nr,_e);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:ir=10;break e;case Ca:ir=9;break e;case Da:ir=11;break e;case Ga:ir=14;break e;case Ha:ir=16,tr=null;break e}throw Error(p$1(130,e==null?e:typeof e,""))}return _e=Bg(ir,er,_e,rr),_e.elementType=e,_e.type=tr,_e.lanes=nr,_e}function Tg(e,_e,er,tr){return e=Bg(7,e,tr,_e),e.lanes=er,e}function pj(e,_e,er,tr){return e=Bg(22,e,tr,_e),e.elementType=Ia,e.lanes=er,e.stateNode={isHidden:!1},e}function Qg(e,_e,er){return e=Bg(6,e,null,_e),e.lanes=er,e}function Sg(e,_e,er){return _e=Bg(4,e.children!==null?e.children:[],e.key,_e),_e.lanes=er,_e.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},_e}function al(e,_e,er,tr,rr){this.tag=_e,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=tr,this.onRecoverableError=rr,this.mutableSourceEagerHydrationData=null}function bl(e,_e,er,tr,rr,nr,ir,ar,sr){return e=new al(e,_e,er,ar,sr),_e===1?(_e=1,nr===!0&&(_e|=8)):_e=0,nr=Bg(3,null,null,_e),e.current=nr,nr.stateNode=e,nr.memoizedState={element:tr,isDehydrated:er,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(nr),e}function cl(e,_e,er){var tr=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:tr==null?null:""+tr,children:e,containerInfo:_e,implementation:er}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p$1(170));var _e=e;do{switch(_e.tag){case 3:_e=_e.stateNode.context;break e;case 1:if(Zf(_e.type)){_e=_e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_e=_e.return}while(_e!==null);throw Error(p$1(171))}if(e.tag===1){var er=e.type;if(Zf(er))return bg(e,er,_e)}return _e}function el(e,_e,er,tr,rr,nr,ir,ar,sr){return e=bl(er,tr,!0,e,rr,nr,ir,ar,sr),e.context=dl(null),er=e.current,tr=R$1(),rr=yi(er),nr=mh(tr,rr),nr.callback=_e??null,nh(er,nr,rr),e.current.lanes=rr,Ac(e,rr,tr),Dk(e,tr),e}function fl$1(e,_e,er,tr){var rr=_e.current,nr=R$1(),ir=yi(rr);return er=dl(er),_e.context===null?_e.context=er:_e.pendingContext=er,_e=mh(nr,ir),_e.payload={element:e},tr=tr===void 0?null:tr,tr!==null&&(_e.callback=tr),e=nh(rr,_e,ir),e!==null&&(gi(e,rr,ir,nr),oh(e,rr,ir)),ir}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,_e){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var er=e.retryLane;e.retryLane=er!==0&&er<_e?er:_e}}function il(e,_e){hl(e,_e),(e=e.alternate)&&hl(e,_e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var _e=this._internalRoot;if(_e===null)throw Error(p$1(409));fl$1(e,_e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var _e=e.containerInfo;Rk(function(){fl$1(null,e,null,null)}),_e[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var _e=Hc();e={blockedOn:null,target:e,priority:_e};for(var er=0;er<Qc.length&&_e!==0&&_e<Qc[er].priority;er++);Qc.splice(er,0,e),er===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,_e,er,tr,rr){if(rr){if(typeof tr=="function"){var nr=tr;tr=function(){var or=gl(ir);nr.call(or)}}var ir=el(_e,tr,e,0,null,!1,!1,"",pl);return e._reactRootContainer=ir,e[uf]=ir.current,sf(e.nodeType===8?e.parentNode:e),Rk(),ir}for(;rr=e.lastChild;)e.removeChild(rr);if(typeof tr=="function"){var ar=tr;tr=function(){var or=gl(sr);ar.call(or)}}var sr=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=sr,e[uf]=sr.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl$1(_e,sr,er,tr)}),sr}function rl(e,_e,er,tr,rr){var nr=er._reactRootContainer;if(nr){var ir=nr;if(typeof rr=="function"){var ar=rr;rr=function(){var sr=gl(ir);ar.call(sr)}}fl$1(_e,ir,e,rr)}else ir=ql(er,_e,e,rr,tr);return gl(ir)}Ec=function(e){switch(e.tag){case 3:var _e=e.stateNode;if(_e.current.memoizedState.isDehydrated){var er=tc(_e.pendingLanes);er!==0&&(Cc(_e,er|1),Dk(_e,B$1()),!(K$1&6)&&(Gj=B$1()+500,jg()))}break;case 13:Rk(function(){var tr=ih(e,1);if(tr!==null){var rr=R$1();gi(tr,e,1,rr)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var _e=ih(e,134217728);if(_e!==null){var er=R$1();gi(_e,e,134217728,er)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var _e=yi(e),er=ih(e,_e);if(er!==null){var tr=R$1();gi(er,e,_e,tr)}il(e,_e)}};Hc=function(){return C$1};Ic=function(e,_e){var er=C$1;try{return C$1=e,_e()}finally{C$1=er}};yb=function(e,_e,er){switch(_e){case"input":if(bb(e,er),_e=er.name,er.type==="radio"&&_e!=null){for(er=e;er.parentNode;)er=er.parentNode;for(er=er.querySelectorAll("input[name="+JSON.stringify(""+_e)+'][type="radio"]'),_e=0;_e<er.length;_e++){var tr=er[_e];if(tr!==e&&tr.form===e.form){var rr=Db(tr);if(!rr)throw Error(p$1(90));Wa(tr),bb(tr,rr)}}}break;case"textarea":ib(e,er);break;case"select":_e=er.value,_e!=null&&fb(e,!!er.multiple,_e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc$1=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,_e){var er=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(_e))throw Error(p$1(200));return cl(e,_e,null,er)};reactDom_production_min.createRoot=function(e,_e){if(!nl(e))throw Error(p$1(299));var er=!1,tr="",rr=kl;return _e!=null&&(_e.unstable_strictMode===!0&&(er=!0),_e.identifierPrefix!==void 0&&(tr=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(rr=_e.onRecoverableError)),_e=bl(e,1,!1,null,null,er,!1,tr,rr),e[uf]=_e.current,sf(e.nodeType===8?e.parentNode:e),new ll(_e)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var _e=e._reactInternals;if(_e===void 0)throw typeof e.render=="function"?Error(p$1(188)):(e=Object.keys(e).join(","),Error(p$1(268,e)));return e=Zb(_e),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,_e,er){if(!ol(_e))throw Error(p$1(200));return rl(null,e,_e,!0,er)};reactDom_production_min.hydrateRoot=function(e,_e,er){if(!nl(e))throw Error(p$1(405));var tr=er!=null&&er.hydratedSources||null,rr=!1,nr="",ir=kl;if(er!=null&&(er.unstable_strictMode===!0&&(rr=!0),er.identifierPrefix!==void 0&&(nr=er.identifierPrefix),er.onRecoverableError!==void 0&&(ir=er.onRecoverableError)),_e=el(_e,null,e,1,er??null,rr,!1,nr,ir),e[uf]=_e.current,sf(e),tr)for(e=0;e<tr.length;e++)er=tr[e],rr=er._getVersion,rr=rr(er._source),_e.mutableSourceEagerHydrationData==null?_e.mutableSourceEagerHydrationData=[er,rr]:_e.mutableSourceEagerHydrationData.push(er,rr);return new ml(_e)};reactDom_production_min.render=function(e,_e,er){if(!ol(_e))throw Error(p$1(200));return rl(null,e,_e,!1,er)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p$1(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,_e,er,tr){if(!ol(er))throw Error(p$1(200));if(e==null||e._reactInternals===void 0)throw Error(p$1(38));return rl(e,_e,er,!1,tr)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},_typeof(e)}function toInteger(e){if(e===null||e===!0||e===!1)return NaN;var _e=Number(e);return isNaN(_e)?_e:_e<0?Math.ceil(_e):Math.floor(_e)}function requiredArgs(e,_e){if(_e.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+_e.length+" present")}function toDate(e){requiredArgs(1,arguments);var _e=Object.prototype.toString.call(e);return e instanceof Date||_typeof(e)==="object"&&_e==="[object Date]"?new Date(e.getTime()):typeof e=="number"||_e==="[object Number]"?new Date(e):((typeof e=="string"||_e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function addMonths(e,_e){requiredArgs(2,arguments);var er=toDate(e),tr=toInteger(_e);if(isNaN(tr))return new Date(NaN);if(!tr)return er;var rr=er.getDate(),nr=new Date(er.getTime());nr.setMonth(er.getMonth()+tr+1,0);var ir=nr.getDate();return rr>=ir?nr:(er.setFullYear(nr.getFullYear(),nr.getMonth(),rr),er)}function addMilliseconds(e,_e){requiredArgs(2,arguments);var er=toDate(e).getTime(),tr=toInteger(_e);return new Date(er+tr)}var defaultOptions={};function getDefaultOptions(){return defaultOptions}function getTimezoneOffsetInMilliseconds(e){var _e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return _e.setUTCFullYear(e.getFullYear()),e.getTime()-_e.getTime()}function isDate(e){return requiredArgs(1,arguments),e instanceof Date||_typeof(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function isValid(e){if(requiredArgs(1,arguments),!isDate(e)&&typeof e!="number")return!1;var _e=toDate(e);return!isNaN(Number(_e))}function endOfMonth(e){requiredArgs(1,arguments);var _e=toDate(e),er=_e.getMonth();return _e.setFullYear(_e.getFullYear(),er+1,0),_e.setHours(23,59,59,999),_e}function startOfMonth(e){requiredArgs(1,arguments);var _e=toDate(e);return _e.setDate(1),_e.setHours(0,0,0,0),_e}function endOfYear(e){requiredArgs(1,arguments);var _e=toDate(e),er=_e.getFullYear();return _e.setFullYear(er+1,0,0),_e.setHours(23,59,59,999),_e}function startOfYear(e){requiredArgs(1,arguments);var _e=toDate(e),er=new Date(0);return er.setFullYear(_e.getFullYear(),0,1),er.setHours(0,0,0,0),er}function subMilliseconds(e,_e){requiredArgs(2,arguments);var er=toInteger(_e);return addMilliseconds(e,-er)}var MILLISECONDS_IN_DAY=864e5;function getUTCDayOfYear(e){requiredArgs(1,arguments);var _e=toDate(e),er=_e.getTime();_e.setUTCMonth(0,1),_e.setUTCHours(0,0,0,0);var tr=_e.getTime(),rr=er-tr;return Math.floor(rr/MILLISECONDS_IN_DAY)+1}function startOfUTCISOWeek(e){requiredArgs(1,arguments);var _e=1,er=toDate(e),tr=er.getUTCDay(),rr=(tr<_e?7:0)+tr-_e;return er.setUTCDate(er.getUTCDate()-rr),er.setUTCHours(0,0,0,0),er}function getUTCISOWeekYear(e){requiredArgs(1,arguments);var _e=toDate(e),er=_e.getUTCFullYear(),tr=new Date(0);tr.setUTCFullYear(er+1,0,4),tr.setUTCHours(0,0,0,0);var rr=startOfUTCISOWeek(tr),nr=new Date(0);nr.setUTCFullYear(er,0,4),nr.setUTCHours(0,0,0,0);var ir=startOfUTCISOWeek(nr);return _e.getTime()>=rr.getTime()?er+1:_e.getTime()>=ir.getTime()?er:er-1}function startOfUTCISOWeekYear(e){requiredArgs(1,arguments);var _e=getUTCISOWeekYear(e),er=new Date(0);er.setUTCFullYear(_e,0,4),er.setUTCHours(0,0,0,0);var tr=startOfUTCISOWeek(er);return tr}var MILLISECONDS_IN_WEEK$1=6048e5;function getUTCISOWeek(e){requiredArgs(1,arguments);var _e=toDate(e),er=startOfUTCISOWeek(_e).getTime()-startOfUTCISOWeekYear(_e).getTime();return Math.round(er/MILLISECONDS_IN_WEEK$1)+1}function startOfUTCWeek(e,_e){var er,tr,rr,nr,ir,ar,sr,or;requiredArgs(1,arguments);var lr=getDefaultOptions(),ur=toInteger((er=(tr=(rr=(nr=_e==null?void 0:_e.weekStartsOn)!==null&&nr!==void 0?nr:_e==null||(ir=_e.locale)===null||ir===void 0||(ar=ir.options)===null||ar===void 0?void 0:ar.weekStartsOn)!==null&&rr!==void 0?rr:lr.weekStartsOn)!==null&&tr!==void 0?tr:(sr=lr.locale)===null||sr===void 0||(or=sr.options)===null||or===void 0?void 0:or.weekStartsOn)!==null&&er!==void 0?er:0);if(!(ur>=0&&ur<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var fr=toDate(e),cr=fr.getUTCDay(),mr=(cr<ur?7:0)+cr-ur;return fr.setUTCDate(fr.getUTCDate()-mr),fr.setUTCHours(0,0,0,0),fr}function getUTCWeekYear(e,_e){var er,tr,rr,nr,ir,ar,sr,or;requiredArgs(1,arguments);var lr=toDate(e),ur=lr.getUTCFullYear(),fr=getDefaultOptions(),cr=toInteger((er=(tr=(rr=(nr=_e==null?void 0:_e.firstWeekContainsDate)!==null&&nr!==void 0?nr:_e==null||(ir=_e.locale)===null||ir===void 0||(ar=ir.options)===null||ar===void 0?void 0:ar.firstWeekContainsDate)!==null&&rr!==void 0?rr:fr.firstWeekContainsDate)!==null&&tr!==void 0?tr:(sr=fr.locale)===null||sr===void 0||(or=sr.options)===null||or===void 0?void 0:or.firstWeekContainsDate)!==null&&er!==void 0?er:1);if(!(cr>=1&&cr<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var mr=new Date(0);mr.setUTCFullYear(ur+1,0,cr),mr.setUTCHours(0,0,0,0);var dr=startOfUTCWeek(mr,_e),xr=new Date(0);xr.setUTCFullYear(ur,0,cr),xr.setUTCHours(0,0,0,0);var pr=startOfUTCWeek(xr,_e);return lr.getTime()>=dr.getTime()?ur+1:lr.getTime()>=pr.getTime()?ur:ur-1}function startOfUTCWeekYear(e,_e){var er,tr,rr,nr,ir,ar,sr,or;requiredArgs(1,arguments);var lr=getDefaultOptions(),ur=toInteger((er=(tr=(rr=(nr=_e==null?void 0:_e.firstWeekContainsDate)!==null&&nr!==void 0?nr:_e==null||(ir=_e.locale)===null||ir===void 0||(ar=ir.options)===null||ar===void 0?void 0:ar.firstWeekContainsDate)!==null&&rr!==void 0?rr:lr.firstWeekContainsDate)!==null&&tr!==void 0?tr:(sr=lr.locale)===null||sr===void 0||(or=sr.options)===null||or===void 0?void 0:or.firstWeekContainsDate)!==null&&er!==void 0?er:1),fr=getUTCWeekYear(e,_e),cr=new Date(0);cr.setUTCFullYear(fr,0,ur),cr.setUTCHours(0,0,0,0);var mr=startOfUTCWeek(cr,_e);return mr}var MILLISECONDS_IN_WEEK=6048e5;function getUTCWeek(e,_e){requiredArgs(1,arguments);var er=toDate(e),tr=startOfUTCWeek(er,_e).getTime()-startOfUTCWeekYear(er,_e).getTime();return Math.round(tr/MILLISECONDS_IN_WEEK)+1}function addLeadingZeros(e,_e){for(var er=e<0?"-":"",tr=Math.abs(e).toString();tr.length<_e;)tr="0"+tr;return er+tr}var formatters$1={y:function(_e,er){var tr=_e.getUTCFullYear(),rr=tr>0?tr:1-tr;return addLeadingZeros(er==="yy"?rr%100:rr,er.length)},M:function(_e,er){var tr=_e.getUTCMonth();return er==="M"?String(tr+1):addLeadingZeros(tr+1,2)},d:function(_e,er){return addLeadingZeros(_e.getUTCDate(),er.length)},a:function(_e,er){var tr=_e.getUTCHours()/12>=1?"pm":"am";switch(er){case"a":case"aa":return tr.toUpperCase();case"aaa":return tr;case"aaaaa":return tr[0];case"aaaa":default:return tr==="am"?"a.m.":"p.m."}},h:function(_e,er){return addLeadingZeros(_e.getUTCHours()%12||12,er.length)},H:function(_e,er){return addLeadingZeros(_e.getUTCHours(),er.length)},m:function(_e,er){return addLeadingZeros(_e.getUTCMinutes(),er.length)},s:function(_e,er){return addLeadingZeros(_e.getUTCSeconds(),er.length)},S:function(_e,er){var tr=er.length,rr=_e.getUTCMilliseconds(),nr=Math.floor(rr*Math.pow(10,tr-3));return addLeadingZeros(nr,er.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function(_e,er,tr){var rr=_e.getUTCFullYear()>0?1:0;switch(er){case"G":case"GG":case"GGG":return tr.era(rr,{width:"abbreviated"});case"GGGGG":return tr.era(rr,{width:"narrow"});case"GGGG":default:return tr.era(rr,{width:"wide"})}},y:function(_e,er,tr){if(er==="yo"){var rr=_e.getUTCFullYear(),nr=rr>0?rr:1-rr;return tr.ordinalNumber(nr,{unit:"year"})}return formatters$1.y(_e,er)},Y:function(_e,er,tr,rr){var nr=getUTCWeekYear(_e,rr),ir=nr>0?nr:1-nr;if(er==="YY"){var ar=ir%100;return addLeadingZeros(ar,2)}return er==="Yo"?tr.ordinalNumber(ir,{unit:"year"}):addLeadingZeros(ir,er.length)},R:function(_e,er){var tr=getUTCISOWeekYear(_e);return addLeadingZeros(tr,er.length)},u:function(_e,er){var tr=_e.getUTCFullYear();return addLeadingZeros(tr,er.length)},Q:function(_e,er,tr){var rr=Math.ceil((_e.getUTCMonth()+1)/3);switch(er){case"Q":return String(rr);case"QQ":return addLeadingZeros(rr,2);case"Qo":return tr.ordinalNumber(rr,{unit:"quarter"});case"QQQ":return tr.quarter(rr,{width:"abbreviated",context:"formatting"});case"QQQQQ":return tr.quarter(rr,{width:"narrow",context:"formatting"});case"QQQQ":default:return tr.quarter(rr,{width:"wide",context:"formatting"})}},q:function(_e,er,tr){var rr=Math.ceil((_e.getUTCMonth()+1)/3);switch(er){case"q":return String(rr);case"qq":return addLeadingZeros(rr,2);case"qo":return tr.ordinalNumber(rr,{unit:"quarter"});case"qqq":return tr.quarter(rr,{width:"abbreviated",context:"standalone"});case"qqqqq":return tr.quarter(rr,{width:"narrow",context:"standalone"});case"qqqq":default:return tr.quarter(rr,{width:"wide",context:"standalone"})}},M:function(_e,er,tr){var rr=_e.getUTCMonth();switch(er){case"M":case"MM":return formatters$1.M(_e,er);case"Mo":return tr.ordinalNumber(rr+1,{unit:"month"});case"MMM":return tr.month(rr,{width:"abbreviated",context:"formatting"});case"MMMMM":return tr.month(rr,{width:"narrow",context:"formatting"});case"MMMM":default:return tr.month(rr,{width:"wide",context:"formatting"})}},L:function(_e,er,tr){var rr=_e.getUTCMonth();switch(er){case"L":return String(rr+1);case"LL":return addLeadingZeros(rr+1,2);case"Lo":return tr.ordinalNumber(rr+1,{unit:"month"});case"LLL":return tr.month(rr,{width:"abbreviated",context:"standalone"});case"LLLLL":return tr.month(rr,{width:"narrow",context:"standalone"});case"LLLL":default:return tr.month(rr,{width:"wide",context:"standalone"})}},w:function(_e,er,tr,rr){var nr=getUTCWeek(_e,rr);return er==="wo"?tr.ordinalNumber(nr,{unit:"week"}):addLeadingZeros(nr,er.length)},I:function(_e,er,tr){var rr=getUTCISOWeek(_e);return er==="Io"?tr.ordinalNumber(rr,{unit:"week"}):addLeadingZeros(rr,er.length)},d:function(_e,er,tr){return er==="do"?tr.ordinalNumber(_e.getUTCDate(),{unit:"date"}):formatters$1.d(_e,er)},D:function(_e,er,tr){var rr=getUTCDayOfYear(_e);return er==="Do"?tr.ordinalNumber(rr,{unit:"dayOfYear"}):addLeadingZeros(rr,er.length)},E:function(_e,er,tr){var rr=_e.getUTCDay();switch(er){case"E":case"EE":case"EEE":return tr.day(rr,{width:"abbreviated",context:"formatting"});case"EEEEE":return tr.day(rr,{width:"narrow",context:"formatting"});case"EEEEEE":return tr.day(rr,{width:"short",context:"formatting"});case"EEEE":default:return tr.day(rr,{width:"wide",context:"formatting"})}},e:function(_e,er,tr,rr){var nr=_e.getUTCDay(),ir=(nr-rr.weekStartsOn+8)%7||7;switch(er){case"e":return String(ir);case"ee":return addLeadingZeros(ir,2);case"eo":return tr.ordinalNumber(ir,{unit:"day"});case"eee":return tr.day(nr,{width:"abbreviated",context:"formatting"});case"eeeee":return tr.day(nr,{width:"narrow",context:"formatting"});case"eeeeee":return tr.day(nr,{width:"short",context:"formatting"});case"eeee":default:return tr.day(nr,{width:"wide",context:"formatting"})}},c:function(_e,er,tr,rr){var nr=_e.getUTCDay(),ir=(nr-rr.weekStartsOn+8)%7||7;switch(er){case"c":return String(ir);case"cc":return addLeadingZeros(ir,er.length);case"co":return tr.ordinalNumber(ir,{unit:"day"});case"ccc":return tr.day(nr,{width:"abbreviated",context:"standalone"});case"ccccc":return tr.day(nr,{width:"narrow",context:"standalone"});case"cccccc":return tr.day(nr,{width:"short",context:"standalone"});case"cccc":default:return tr.day(nr,{width:"wide",context:"standalone"})}},i:function(_e,er,tr){var rr=_e.getUTCDay(),nr=rr===0?7:rr;switch(er){case"i":return String(nr);case"ii":return addLeadingZeros(nr,er.length);case"io":return tr.ordinalNumber(nr,{unit:"day"});case"iii":return tr.day(rr,{width:"abbreviated",context:"formatting"});case"iiiii":return tr.day(rr,{width:"narrow",context:"formatting"});case"iiiiii":return tr.day(rr,{width:"short",context:"formatting"});case"iiii":default:return tr.day(rr,{width:"wide",context:"formatting"})}},a:function(_e,er,tr){var rr=_e.getUTCHours(),nr=rr/12>=1?"pm":"am";switch(er){case"a":case"aa":return tr.dayPeriod(nr,{width:"abbreviated",context:"formatting"});case"aaa":return tr.dayPeriod(nr,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return tr.dayPeriod(nr,{width:"narrow",context:"formatting"});case"aaaa":default:return tr.dayPeriod(nr,{width:"wide",context:"formatting"})}},b:function(_e,er,tr){var rr=_e.getUTCHours(),nr;switch(rr===12?nr=dayPeriodEnum.noon:rr===0?nr=dayPeriodEnum.midnight:nr=rr/12>=1?"pm":"am",er){case"b":case"bb":return tr.dayPeriod(nr,{width:"abbreviated",context:"formatting"});case"bbb":return tr.dayPeriod(nr,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return tr.dayPeriod(nr,{width:"narrow",context:"formatting"});case"bbbb":default:return tr.dayPeriod(nr,{width:"wide",context:"formatting"})}},B:function(_e,er,tr){var rr=_e.getUTCHours(),nr;switch(rr>=17?nr=dayPeriodEnum.evening:rr>=12?nr=dayPeriodEnum.afternoon:rr>=4?nr=dayPeriodEnum.morning:nr=dayPeriodEnum.night,er){case"B":case"BB":case"BBB":return tr.dayPeriod(nr,{width:"abbreviated",context:"formatting"});case"BBBBB":return tr.dayPeriod(nr,{width:"narrow",context:"formatting"});case"BBBB":default:return tr.dayPeriod(nr,{width:"wide",context:"formatting"})}},h:function(_e,er,tr){if(er==="ho"){var rr=_e.getUTCHours()%12;return rr===0&&(rr=12),tr.ordinalNumber(rr,{unit:"hour"})}return formatters$1.h(_e,er)},H:function(_e,er,tr){return er==="Ho"?tr.ordinalNumber(_e.getUTCHours(),{unit:"hour"}):formatters$1.H(_e,er)},K:function(_e,er,tr){var rr=_e.getUTCHours()%12;return er==="Ko"?tr.ordinalNumber(rr,{unit:"hour"}):addLeadingZeros(rr,er.length)},k:function(_e,er,tr){var rr=_e.getUTCHours();return rr===0&&(rr=24),er==="ko"?tr.ordinalNumber(rr,{unit:"hour"}):addLeadingZeros(rr,er.length)},m:function(_e,er,tr){return er==="mo"?tr.ordinalNumber(_e.getUTCMinutes(),{unit:"minute"}):formatters$1.m(_e,er)},s:function(_e,er,tr){return er==="so"?tr.ordinalNumber(_e.getUTCSeconds(),{unit:"second"}):formatters$1.s(_e,er)},S:function(_e,er){return formatters$1.S(_e,er)},X:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=nr.getTimezoneOffset();if(ir===0)return"Z";switch(er){case"X":return formatTimezoneWithOptionalMinutes(ir);case"XXXX":case"XX":return formatTimezone(ir);case"XXXXX":case"XXX":default:return formatTimezone(ir,":")}},x:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=nr.getTimezoneOffset();switch(er){case"x":return formatTimezoneWithOptionalMinutes(ir);case"xxxx":case"xx":return formatTimezone(ir);case"xxxxx":case"xxx":default:return formatTimezone(ir,":")}},O:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=nr.getTimezoneOffset();switch(er){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(ir,":");case"OOOO":default:return"GMT"+formatTimezone(ir,":")}},z:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=nr.getTimezoneOffset();switch(er){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(ir,":");case"zzzz":default:return"GMT"+formatTimezone(ir,":")}},t:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=Math.floor(nr.getTime()/1e3);return addLeadingZeros(ir,er.length)},T:function(_e,er,tr,rr){var nr=rr._originalDate||_e,ir=nr.getTime();return addLeadingZeros(ir,er.length)}};function formatTimezoneShort(e,_e){var er=e>0?"-":"+",tr=Math.abs(e),rr=Math.floor(tr/60),nr=tr%60;if(nr===0)return er+String(rr);var ir=_e;return er+String(rr)+ir+addLeadingZeros(nr,2)}function formatTimezoneWithOptionalMinutes(e,_e){if(e%60===0){var er=e>0?"-":"+";return er+addLeadingZeros(Math.abs(e)/60,2)}return formatTimezone(e,_e)}function formatTimezone(e,_e){var er=_e||"",tr=e>0?"-":"+",rr=Math.abs(e),nr=addLeadingZeros(Math.floor(rr/60),2),ir=addLeadingZeros(rr%60,2);return tr+nr+er+ir}var dateLongFormatter=function(_e,er){switch(_e){case"P":return er.date({width:"short"});case"PP":return er.date({width:"medium"});case"PPP":return er.date({width:"long"});case"PPPP":default:return er.date({width:"full"})}},timeLongFormatter=function(_e,er){switch(_e){case"p":return er.time({width:"short"});case"pp":return er.time({width:"medium"});case"ppp":return er.time({width:"long"});case"pppp":default:return er.time({width:"full"})}},dateTimeLongFormatter=function(_e,er){var tr=_e.match(/(P+)(p+)?/)||[],rr=tr[1],nr=tr[2];if(!nr)return dateLongFormatter(_e,er);var ir;switch(rr){case"P":ir=er.dateTime({width:"short"});break;case"PP":ir=er.dateTime({width:"medium"});break;case"PPP":ir=er.dateTime({width:"long"});break;case"PPPP":default:ir=er.dateTime({width:"full"});break}return ir.replace("{{date}}",dateLongFormatter(rr,er)).replace("{{time}}",timeLongFormatter(nr,er))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},protectedDayOfYearTokens=["D","DD"],protectedWeekYearTokens=["YY","YYYY"];function isProtectedDayOfYearToken(e){return protectedDayOfYearTokens.indexOf(e)!==-1}function isProtectedWeekYearToken(e){return protectedWeekYearTokens.indexOf(e)!==-1}function throwProtectedError(e,_e,er){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(_e,"`) for formatting years to the input `").concat(er,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(_e,"`) for formatting years to the input `").concat(er,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(_e,"`) for formatting days of the month to the input `").concat(er,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(_e,"`) for formatting days of the month to the input `").concat(er,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=function(_e,er,tr){var rr,nr=formatDistanceLocale[_e];return typeof nr=="string"?rr=nr:er===1?rr=nr.one:rr=nr.other.replace("{{count}}",er.toString()),tr!=null&&tr.addSuffix?tr.comparison&&tr.comparison>0?"in "+rr:rr+" ago":rr};function buildFormatLongFn(e){return function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},er=_e.width?String(_e.width):e.defaultWidth,tr=e.formats[er]||e.formats[e.defaultWidth];return tr}}var dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=function(_e,er,tr,rr){return formatRelativeLocale[_e]};function buildLocalizeFn(e){return function(_e,er){var tr=er!=null&&er.context?String(er.context):"standalone",rr;if(tr==="formatting"&&e.formattingValues){var nr=e.defaultFormattingWidth||e.defaultWidth,ir=er!=null&&er.width?String(er.width):nr;rr=e.formattingValues[ir]||e.formattingValues[nr]}else{var ar=e.defaultWidth,sr=er!=null&&er.width?String(er.width):e.defaultWidth;rr=e.values[sr]||e.values[ar]}var or=e.argumentCallback?e.argumentCallback(_e):_e;return rr[or]}}var eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=function(_e,er){var tr=Number(_e),rr=tr%100;if(rr>20||rr<10)switch(rr%10){case 1:return tr+"st";case 2:return tr+"nd";case 3:return tr+"rd"}return tr+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:function(_e){return _e-1}}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(e){return function(_e){var er=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},tr=er.width,rr=tr&&e.matchPatterns[tr]||e.matchPatterns[e.defaultMatchWidth],nr=_e.match(rr);if(!nr)return null;var ir=nr[0],ar=tr&&e.parsePatterns[tr]||e.parsePatterns[e.defaultParseWidth],sr=Array.isArray(ar)?findIndex(ar,function(ur){return ur.test(ir)}):findKey(ar,function(ur){return ur.test(ir)}),or;or=e.valueCallback?e.valueCallback(sr):sr,or=er.valueCallback?er.valueCallback(or):or;var lr=_e.slice(ir.length);return{value:or,rest:lr}}}function findKey(e,_e){for(var er in e)if(e.hasOwnProperty(er)&&_e(e[er]))return er}function findIndex(e,_e){for(var er=0;er<e.length;er++)if(_e(e[er]))return er}function buildMatchPatternFn(e){return function(_e){var er=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},tr=_e.match(e.matchPattern);if(!tr)return null;var rr=tr[0],nr=_e.match(e.parsePattern);if(!nr)return null;var ir=e.valueCallback?e.valueCallback(nr[0]):nr[0];ir=er.valueCallback?er.valueCallback(ir):ir;var ar=_e.slice(rr.length);return{value:ir,rest:ar}}}var matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:function(_e){return parseInt(_e,10)}}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:function(_e){return _e+1}}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},locale={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}},formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(e,_e,er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr;requiredArgs(2,arguments);var pr=String(_e),gr=getDefaultOptions(),vr=(tr=(rr=void 0)!==null&&rr!==void 0?rr:gr.locale)!==null&&tr!==void 0?tr:locale,Cr=toInteger((nr=(ir=(ar=(sr=void 0)!==null&&sr!==void 0?sr:void 0)!==null&&ar!==void 0?ar:gr.firstWeekContainsDate)!==null&&ir!==void 0?ir:(or=gr.locale)===null||or===void 0||(lr=or.options)===null||lr===void 0?void 0:lr.firstWeekContainsDate)!==null&&nr!==void 0?nr:1);if(!(Cr>=1&&Cr<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Tr=toInteger((ur=(fr=(cr=(mr=void 0)!==null&&mr!==void 0?mr:void 0)!==null&&cr!==void 0?cr:gr.weekStartsOn)!==null&&fr!==void 0?fr:(dr=gr.locale)===null||dr===void 0||(xr=dr.options)===null||xr===void 0?void 0:xr.weekStartsOn)!==null&&ur!==void 0?ur:0);if(!(Tr>=0&&Tr<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!vr.localize)throw new RangeError("locale must contain localize property");if(!vr.formatLong)throw new RangeError("locale must contain formatLong property");var Fr=toDate(e);if(!isValid(Fr))throw new RangeError("Invalid time value");var _r=getTimezoneOffsetInMilliseconds(Fr),Ar=subMilliseconds(Fr,_r),Pr={firstWeekContainsDate:Cr,weekStartsOn:Tr,locale:vr,_originalDate:Fr},Ir=pr.match(longFormattingTokensRegExp).map(function(wr){var kr=wr[0];if(kr==="p"||kr==="P"){var Mr=longFormatters[kr];return Mr(wr,vr.formatLong)}return wr}).join("").match(formattingTokensRegExp).map(function(wr){if(wr==="''")return"'";var kr=wr[0];if(kr==="'")return cleanEscapedString(wr);var Mr=formatters[kr];if(Mr)return isProtectedWeekYearToken(wr)&&throwProtectedError(wr,_e,String(e)),isProtectedDayOfYearToken(wr)&&throwProtectedError(wr,_e,String(e)),Mr(Ar,wr,vr.localize,Pr);if(kr.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+kr+"`");return wr}).join("");return Ir}function cleanEscapedString(e){var _e=e.match(escapedStringRegExp);return _e?_e[1].replace(doubleQuoteRegExp,"'"):e}function getMonth(e){requiredArgs(1,arguments);var _e=toDate(e),er=_e.getMonth();return er}function getYear(e){return requiredArgs(1,arguments),toDate(e).getFullYear()}const scriptRel="modulepreload",assetsURL=function(e){return"/agendamento-ccb/"+e},seen={},__vitePreload=function(_e,er,tr){let rr=Promise.resolve();if(er&&er.length>0){document.getElementsByTagName("link");const ir=document.querySelector("meta[property=csp-nonce]"),ar=(ir==null?void 0:ir.nonce)||(ir==null?void 0:ir.getAttribute("nonce"));rr=Promise.allSettled(er.map(sr=>{if(sr=assetsURL(sr),sr in seen)return;seen[sr]=!0;const or=sr.endsWith(".css"),lr=or?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${sr}"]${lr}`))return;const ur=document.createElement("link");if(ur.rel=or?"stylesheet":scriptRel,or||(ur.as="script"),ur.crossOrigin="",ur.href=sr,ar&&ur.setAttribute("nonce",ar),document.head.appendChild(ur),or)return new Promise((fr,cr)=>{ur.addEventListener("load",fr),ur.addEventListener("error",()=>cr(new Error(`Unable to preload CSS for ${sr}`)))})}))}function nr(ir){const ar=new Event("vite:preloadError",{cancelable:!0});if(ar.payload=ir,window.dispatchEvent(ar),!ar.defaultPrevented)throw ir}return rr.then(ir=>{for(const ar of ir||[])ar.status==="rejected"&&nr(ar.reason);return _e().catch(nr)})};var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,_e){for(var er=new u16(31),tr=0;tr<31;++tr)er[tr]=_e+=1<<e[tr-1];for(var rr=new i32(er[30]),tr=1;tr<30;++tr)for(var nr=er[tr];nr<er[tr+1];++nr)rr[nr]=nr-er[tr]<<5|tr;return{b:er,r:rr}},_a=freb(fleb,2),fl=_a.b,revfl=_a.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b.b,revfd=_b.r,rev=new u16(32768);for(var i$1=0;i$1<32768;++i$1){var x$1=(i$1&43690)>>1|(i$1&21845)<<1;x$1=(x$1&52428)>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>4|(x$1&3855)<<4,rev[i$1]=((x$1&65280)>>8|(x$1&255)<<8)>>1}var hMap=function(e,_e,er){for(var tr=e.length,rr=0,nr=new u16(_e);rr<tr;++rr)e[rr]&&++nr[e[rr]-1];var ir=new u16(_e);for(rr=1;rr<_e;++rr)ir[rr]=ir[rr-1]+nr[rr-1]<<1;var ar;if(er){ar=new u16(1<<_e);var sr=15-_e;for(rr=0;rr<tr;++rr)if(e[rr])for(var or=rr<<4|e[rr],lr=_e-e[rr],ur=ir[e[rr]-1]++<<lr,fr=ur|(1<<lr)-1;ur<=fr;++ur)ar[rev[ur]>>sr]=or}else for(ar=new u16(tr),rr=0;rr<tr;++rr)e[rr]&&(ar[rr]=rev[ir[e[rr]-1]++]>>15-e[rr]);return ar},flt=new u8(288);for(var i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(var i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),flrm=hMap(flt,9,1),fdm=hMap(fdt,5,0),fdrm=hMap(fdt,5,1),max=function(e){for(var _e=e[0],er=1;er<e.length;++er)e[er]>_e&&(_e=e[er]);return _e},bits=function(e,_e,er){var tr=_e/8|0;return(e[tr]|e[tr+1]<<8)>>(_e&7)&er},bits16=function(e,_e){var er=_e/8|0;return(e[er]|e[er+1]<<8|e[er+2]<<16)>>(_e&7)},shft=function(e){return(e+7)/8|0},slc=function(e,_e,er){return(er==null||er>e.length)&&(er=e.length),new u8(e.subarray(_e,er))},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,_e,er){var tr=new Error(_e||ec[e]);if(tr.code=e,Error.captureStackTrace&&Error.captureStackTrace(tr,err),!er)throw tr;return tr},inflt=function(e,_e,er,tr){var rr=e.length,nr=0;if(!rr||_e.f&&!_e.l)return er||new u8(0);var ir=!er,ar=ir||_e.i!=2,sr=_e.i;ir&&(er=new u8(rr*3));var or=function(_n){var Kr=er.length;if(_n>Kr){var Cn=new u8(Math.max(Kr*2,_n));Cn.set(er),er=Cn}},lr=_e.f||0,ur=_e.p||0,fr=_e.b||0,cr=_e.l,mr=_e.d,dr=_e.m,xr=_e.n,pr=rr*8;do{if(!cr){lr=bits(e,ur,1);var gr=bits(e,ur+1,3);if(ur+=3,gr)if(gr==1)cr=flrm,mr=fdrm,dr=9,xr=5;else if(gr==2){var Fr=bits(e,ur,31)+257,_r=bits(e,ur+10,15)+4,Ar=Fr+bits(e,ur+5,31)+1;ur+=14;for(var Pr=new u8(Ar),Ir=new u8(19),wr=0;wr<_r;++wr)Ir[clim[wr]]=bits(e,ur+wr*3,7);ur+=_r*3;for(var kr=max(Ir),Mr=(1<<kr)-1,Hr=hMap(Ir,kr,1),wr=0;wr<Ar;){var Gr=Hr[bits(e,ur,Mr)];ur+=Gr&15;var vr=Gr>>4;if(vr<16)Pr[wr++]=vr;else{var zr=0,Br=0;for(vr==16?(Br=3+bits(e,ur,3),ur+=2,zr=Pr[wr-1]):vr==17?(Br=3+bits(e,ur,7),ur+=3):vr==18&&(Br=11+bits(e,ur,127),ur+=7);Br--;)Pr[wr++]=zr}}var Vr=Pr.subarray(0,Fr),Rr=Pr.subarray(Fr);dr=max(Vr),xr=max(Rr),cr=hMap(Vr,dr,1),mr=hMap(Rr,xr,1)}else err(1);else{var vr=shft(ur)+4,Cr=e[vr-4]|e[vr-3]<<8,Tr=vr+Cr;if(Tr>rr){sr&&err(0);break}ar&&or(fr+Cr),er.set(e.subarray(vr,Tr),fr),_e.b=fr+=Cr,_e.p=ur=Tr*8,_e.f=lr;continue}if(ur>pr){sr&&err(0);break}}ar&&or(fr+131072);for(var Xr=(1<<dr)-1,an=(1<<xr)-1,yr=ur;;yr=ur){var zr=cr[bits16(e,ur)&Xr],br=zr>>4;if(ur+=zr&15,ur>pr){sr&&err(0);break}if(zr||err(2),br<256)er[fr++]=br;else if(br==256){yr=ur,cr=null;break}else{var Er=br-254;if(br>264){var wr=br-257,Lr=fleb[wr];Er=bits(e,ur,(1<<Lr)-1)+fl[wr],ur+=Lr}var Or=mr[bits16(e,ur)&an],Ur=Or>>4;Or||err(3),ur+=Or&15;var Rr=fd[Ur];if(Ur>3){var Lr=fdeb[Ur];Rr+=bits16(e,ur)&(1<<Lr)-1,ur+=Lr}if(ur>pr){sr&&err(0);break}ar&&or(fr+131072);var $r=fr+Er;if(fr<Rr){var Zr=nr-Rr,fn=Math.min(Rr,$r);for(Zr+fr<0&&err(3);fr<fn;++fr)er[fr]=tr[Zr+fr]}for(;fr<$r;++fr)er[fr]=er[fr-Rr]}}_e.l=cr,_e.p=yr,_e.b=fr,_e.f=lr,cr&&(lr=1,_e.m=dr,_e.d=mr,_e.n=xr)}while(!lr);return fr!=er.length&&ir?slc(er,0,fr):er.subarray(0,fr)},wbits=function(e,_e,er){er<<=_e&7;var tr=_e/8|0;e[tr]|=er,e[tr+1]|=er>>8},wbits16=function(e,_e,er){er<<=_e&7;var tr=_e/8|0;e[tr]|=er,e[tr+1]|=er>>8,e[tr+2]|=er>>16},hTree=function(e,_e){for(var er=[],tr=0;tr<e.length;++tr)e[tr]&&er.push({s:tr,f:e[tr]});var rr=er.length,nr=er.slice();if(!rr)return{t:et$1,l:0};if(rr==1){var ir=new u8(er[0].s+1);return ir[er[0].s]=1,{t:ir,l:1}}er.sort(function(Tr,Fr){return Tr.f-Fr.f}),er.push({s:-1,f:25001});var ar=er[0],sr=er[1],or=0,lr=1,ur=2;for(er[0]={s:-1,f:ar.f+sr.f,l:ar,r:sr};lr!=rr-1;)ar=er[er[or].f<er[ur].f?or++:ur++],sr=er[or!=lr&&er[or].f<er[ur].f?or++:ur++],er[lr++]={s:-1,f:ar.f+sr.f,l:ar,r:sr};for(var fr=nr[0].s,tr=1;tr<rr;++tr)nr[tr].s>fr&&(fr=nr[tr].s);var cr=new u16(fr+1),mr=ln(er[lr-1],cr,0);if(mr>_e){var tr=0,dr=0,xr=mr-_e,pr=1<<xr;for(nr.sort(function(Fr,_r){return cr[_r.s]-cr[Fr.s]||Fr.f-_r.f});tr<rr;++tr){var gr=nr[tr].s;if(cr[gr]>_e)dr+=pr-(1<<mr-cr[gr]),cr[gr]=_e;else break}for(dr>>=xr;dr>0;){var vr=nr[tr].s;cr[vr]<_e?dr-=1<<_e-cr[vr]++-1:++tr}for(;tr>=0&&dr;--tr){var Cr=nr[tr].s;cr[Cr]==_e&&(--cr[Cr],++dr)}mr=_e}return{t:new u8(cr),l:mr}},ln=function(e,_e,er){return e.s==-1?Math.max(ln(e.l,_e,er+1),ln(e.r,_e,er+1)):_e[e.s]=er},lc=function(e){for(var _e=e.length;_e&&!e[--_e];);for(var er=new u16(++_e),tr=0,rr=e[0],nr=1,ir=function(sr){er[tr++]=sr},ar=1;ar<=_e;++ar)if(e[ar]==rr&&ar!=_e)++nr;else{if(!rr&&nr>2){for(;nr>138;nr-=138)ir(32754);nr>2&&(ir(nr>10?nr-11<<5|28690:nr-3<<5|12305),nr=0)}else if(nr>3){for(ir(rr),--nr;nr>6;nr-=6)ir(8304);nr>2&&(ir(nr-3<<5|8208),nr=0)}for(;nr--;)ir(rr);nr=1,rr=e[ar]}return{c:er.subarray(0,tr),n:_e}},clen=function(e,_e){for(var er=0,tr=0;tr<_e.length;++tr)er+=e[tr]*_e[tr];return er},wfblk=function(e,_e,er){var tr=er.length,rr=shft(_e+2);e[rr]=tr&255,e[rr+1]=tr>>8,e[rr+2]=e[rr]^255,e[rr+3]=e[rr+1]^255;for(var nr=0;nr<tr;++nr)e[rr+nr+4]=er[nr];return(rr+4+tr)*8},wblk=function(e,_e,er,tr,rr,nr,ir,ar,sr,or,lr){wbits(_e,lr++,er),++rr[256];for(var ur=hTree(rr,15),fr=ur.t,cr=ur.l,mr=hTree(nr,15),dr=mr.t,xr=mr.l,pr=lc(fr),gr=pr.c,vr=pr.n,Cr=lc(dr),Tr=Cr.c,Fr=Cr.n,_r=new u16(19),Ar=0;Ar<gr.length;++Ar)++_r[gr[Ar]&31];for(var Ar=0;Ar<Tr.length;++Ar)++_r[Tr[Ar]&31];for(var Pr=hTree(_r,7),Ir=Pr.t,wr=Pr.l,kr=19;kr>4&&!Ir[clim[kr-1]];--kr);var Mr=or+5<<3,Hr=clen(rr,flt)+clen(nr,fdt)+ir,Gr=clen(rr,fr)+clen(nr,dr)+ir+14+3*kr+clen(_r,Ir)+2*_r[16]+3*_r[17]+7*_r[18];if(sr>=0&&Mr<=Hr&&Mr<=Gr)return wfblk(_e,lr,e.subarray(sr,sr+or));var zr,Br,Vr,Rr;if(wbits(_e,lr,1+(Gr<Hr)),lr+=2,Gr<Hr){zr=hMap(fr,cr,0),Br=fr,Vr=hMap(dr,xr,0),Rr=dr;var Xr=hMap(Ir,wr,0);wbits(_e,lr,vr-257),wbits(_e,lr+5,Fr-1),wbits(_e,lr+10,kr-4),lr+=14;for(var Ar=0;Ar<kr;++Ar)wbits(_e,lr+3*Ar,Ir[clim[Ar]]);lr+=3*kr;for(var an=[gr,Tr],yr=0;yr<2;++yr)for(var br=an[yr],Ar=0;Ar<br.length;++Ar){var Er=br[Ar]&31;wbits(_e,lr,Xr[Er]),lr+=Ir[Er],Er>15&&(wbits(_e,lr,br[Ar]>>5&127),lr+=br[Ar]>>12)}}else zr=flm,Br=flt,Vr=fdm,Rr=fdt;for(var Ar=0;Ar<ar;++Ar){var Lr=tr[Ar];if(Lr>255){var Er=Lr>>18&31;wbits16(_e,lr,zr[Er+257]),lr+=Br[Er+257],Er>7&&(wbits(_e,lr,Lr>>23&31),lr+=fleb[Er]);var Or=Lr&31;wbits16(_e,lr,Vr[Or]),lr+=Rr[Or],Or>3&&(wbits16(_e,lr,Lr>>5&8191),lr+=fdeb[Or])}else wbits16(_e,lr,zr[Lr]),lr+=Br[Lr]}return wbits16(_e,lr,zr[256]),lr+Br[256]},deo=new i32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et$1=new u8(0),dflt=function(e,_e,er,tr,rr,nr){var ir=nr.z||e.length,ar=new u8(tr+ir+5*(1+Math.ceil(ir/7e3))+rr),sr=ar.subarray(tr,ar.length-rr),or=nr.l,lr=(nr.r||0)&7;if(_e){lr&&(sr[0]=nr.r>>3);for(var ur=deo[_e-1],fr=ur>>13,cr=ur&8191,mr=(1<<er)-1,dr=nr.p||new u16(32768),xr=nr.h||new u16(mr+1),pr=Math.ceil(er/3),gr=2*pr,vr=function(Dn){return(e[Dn]^e[Dn+1]<<pr^e[Dn+2]<<gr)&mr},Cr=new i32(25e3),Tr=new u16(288),Fr=new u16(32),_r=0,Ar=0,Pr=nr.i||0,Ir=0,wr=nr.w||0,kr=0;Pr+2<ir;++Pr){var Mr=vr(Pr),Hr=Pr&32767,Gr=xr[Mr];if(dr[Hr]=Gr,xr[Mr]=Hr,wr<=Pr){var zr=ir-Pr;if((_r>7e3||Ir>24576)&&(zr>423||!or)){lr=wblk(e,sr,0,Cr,Tr,Fr,Ar,Ir,kr,Pr-kr,lr),Ir=_r=Ar=0,kr=Pr;for(var Br=0;Br<286;++Br)Tr[Br]=0;for(var Br=0;Br<30;++Br)Fr[Br]=0}var Vr=2,Rr=0,Xr=cr,an=Hr-Gr&32767;if(zr>2&&Mr==vr(Pr-an))for(var yr=Math.min(fr,zr)-1,br=Math.min(32767,Pr),Er=Math.min(258,zr);an<=br&&--Xr&&Hr!=Gr;){if(e[Pr+Vr]==e[Pr+Vr-an]){for(var Lr=0;Lr<Er&&e[Pr+Lr]==e[Pr+Lr-an];++Lr);if(Lr>Vr){if(Vr=Lr,Rr=an,Lr>yr)break;for(var Or=Math.min(an,Lr-2),Ur=0,Br=0;Br<Or;++Br){var $r=Pr-an+Br&32767,Zr=dr[$r],fn=$r-Zr&32767;fn>Ur&&(Ur=fn,Gr=$r)}}}Hr=Gr,Gr=dr[Hr],an+=Hr-Gr&32767}if(Rr){Cr[Ir++]=268435456|revfl[Vr]<<18|revfd[Rr];var _n=revfl[Vr]&31,Kr=revfd[Rr]&31;Ar+=fleb[_n]+fdeb[Kr],++Tr[257+_n],++Fr[Kr],wr=Pr+Vr,++_r}else Cr[Ir++]=e[Pr],++Tr[e[Pr]]}}for(Pr=Math.max(Pr,wr);Pr<ir;++Pr)Cr[Ir++]=e[Pr],++Tr[e[Pr]];lr=wblk(e,sr,or,Cr,Tr,Fr,Ar,Ir,kr,Pr-kr,lr),or||(nr.r=lr&7|sr[lr/8|0]<<3,lr-=7,nr.h=xr,nr.p=dr,nr.i=Pr,nr.w=wr)}else{for(var Pr=nr.w||0;Pr<ir+or;Pr+=65535){var Cn=Pr+65535;Cn>=ir&&(sr[lr/8|0]=or,Cn=ir),lr=wfblk(sr,lr+1,e.subarray(Pr,Cn))}nr.i=ir}return slc(ar,0,tr+shft(lr)+rr)},adler=function(){var e=1,_e=0;return{p:function(er){for(var tr=e,rr=_e,nr=er.length|0,ir=0;ir!=nr;){for(var ar=Math.min(ir+2655,nr);ir<ar;++ir)rr+=tr+=er[ir];tr=(tr&65535)+15*(tr>>16),rr=(rr&65535)+15*(rr>>16)}e=tr,_e=rr},d:function(){return e%=65521,_e%=65521,(e&255)<<24|(e&65280)<<8|(_e&255)<<8|_e>>8}}},dopt=function(e,_e,er,tr,rr){if(!rr&&(rr={l:1},_e.dictionary)){var nr=_e.dictionary.subarray(-32768),ir=new u8(nr.length+e.length);ir.set(nr),ir.set(e,nr.length),e=ir,rr.w=nr.length}return dflt(e,_e.level==null?6:_e.level,_e.mem==null?rr.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+_e.mem,er,tr,rr)},wbytes=function(e,_e,er){for(;er;++_e)e[_e]=er,er>>>=8},zlh=function(e,_e){var er=_e.level,tr=er==0?0:er<6?1:er==9?3:2;if(e[0]=120,e[1]=tr<<6|(_e.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,_e.dictionary){var rr=adler();rr.p(_e.dictionary),wbytes(e,2,rr.d())}},zls=function(e,_e){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&err(6,"invalid zlib data"),(e[1]>>5&1)==1&&err(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function zlibSync(e,_e){_e||(_e={});var er=adler();er.p(e);var tr=dopt(e,_e,_e.dictionary?6:2,4);return zlh(tr,_e),wbytes(tr,tr.length-4,er.d()),tr}function unzlibSync(e,_e){return inflt(e.subarray(zls(e),-4),{i:2},_e,_e)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch{}var n=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function i(){n.console&&typeof n.console.log=="function"&&n.console.log.apply(n.console,arguments)}var a={log:i,warn:function(e){n.console&&(typeof n.console.warn=="function"?n.console.warn.apply(n.console,arguments):i.call(null,arguments))},error:function(e){n.console&&(typeof n.console.error=="function"?n.console.error.apply(n.console,arguments):i(e))}};function o(e,_e,er){var tr=new XMLHttpRequest;tr.open("GET",e),tr.responseType="blob",tr.onload=function(){l(tr.response,_e,er)},tr.onerror=function(){a.error("could not download file")},tr.send()}function s(e){var _e=new XMLHttpRequest;_e.open("HEAD",e,!1);try{_e.send()}catch{}return _e.status>=200&&_e.status<=299}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var _e=document.createEvent("MouseEvents");_e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(_e)}}var u,h,l=n.saveAs||((typeof window>"u"?"undefined":_typeof(window))!=="object"||window!==n?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,_e,er){var tr=n.URL||n.webkitURL,rr=document.createElement("a");_e=_e||e.name||"download",rr.download=_e,rr.rel="noopener",typeof e=="string"?(rr.href=e,rr.origin!==location.origin?s(rr.href)?o(e,_e,er):c(rr,rr.target="_blank"):c(rr)):(rr.href=tr.createObjectURL(e),setTimeout(function(){tr.revokeObjectURL(rr.href)},4e4),setTimeout(function(){c(rr)},0))}:"msSaveOrOpenBlob"in navigator?function(e,_e,er){if(_e=_e||e.name||"download",typeof e=="string")if(s(e))o(e,_e,er);else{var tr=document.createElement("a");tr.href=e,tr.target="_blank",setTimeout(function(){c(tr)})}else navigator.msSaveOrOpenBlob(function(rr,nr){return nr===void 0?nr={autoBom:!1}:_typeof(nr)!=="object"&&(a.warn("Deprecated: Expected third argument to be a object"),nr={autoBom:!nr}),nr.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(rr.type)?new Blob(["\uFEFF",rr],{type:rr.type}):rr}(e,er),_e)}:function(e,_e,er,tr){if((tr=tr||open("","_blank"))&&(tr.document.title=tr.document.body.innerText="downloading..."),typeof e=="string")return o(e,_e,er);var rr=e.type==="application/octet-stream",nr=/constructor/i.test(n.HTMLElement)||n.safari,ir=/CriOS\/[\d]+/.test(navigator.userAgent);if((ir||rr&&nr)&&(typeof FileReader>"u"?"undefined":_typeof(FileReader))==="object"){var ar=new FileReader;ar.onloadend=function(){var lr=ar.result;lr=ir?lr:lr.replace(/^data:[^;]*;/,"data:attachment/file;"),tr?tr.location.href=lr:location=lr,tr=null},ar.readAsDataURL(e)}else{var sr=n.URL||n.webkitURL,or=sr.createObjectURL(e);tr?tr.location=or:location.href=or,tr=null,setTimeout(function(){sr.revokeObjectURL(or)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function f(e){var _e;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var er=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(ar){return[parseInt(ar[1]),parseInt(ar[2]),parseInt(ar[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(ar){return[parseInt(ar[1],16),parseInt(ar[2],16),parseInt(ar[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(ar){return[parseInt(ar[1]+ar[1],16),parseInt(ar[2]+ar[2],16),parseInt(ar[3]+ar[3],16)]}}],tr=0;tr<er.length;tr++){var rr=er[tr].re,nr=er[tr].process,ir=rr.exec(e);ir&&(_e=nr(ir),this.r=_e[0],this.g=_e[1],this.b=_e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var ar=this.r.toString(16),sr=this.g.toString(16),or=this.b.toString(16);return ar.length==1&&(ar="0"+ar),sr.length==1&&(sr="0"+sr),or.length==1&&(or="0"+or),"#"+ar+sr+or}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function d(e,_e){var er=e[0],tr=e[1],rr=e[2],nr=e[3];er=g(er,tr,rr,nr,_e[0],7,-680876936),nr=g(nr,er,tr,rr,_e[1],12,-389564586),rr=g(rr,nr,er,tr,_e[2],17,606105819),tr=g(tr,rr,nr,er,_e[3],22,-1044525330),er=g(er,tr,rr,nr,_e[4],7,-176418897),nr=g(nr,er,tr,rr,_e[5],12,1200080426),rr=g(rr,nr,er,tr,_e[6],17,-1473231341),tr=g(tr,rr,nr,er,_e[7],22,-45705983),er=g(er,tr,rr,nr,_e[8],7,1770035416),nr=g(nr,er,tr,rr,_e[9],12,-1958414417),rr=g(rr,nr,er,tr,_e[10],17,-42063),tr=g(tr,rr,nr,er,_e[11],22,-1990404162),er=g(er,tr,rr,nr,_e[12],7,1804603682),nr=g(nr,er,tr,rr,_e[13],12,-40341101),rr=g(rr,nr,er,tr,_e[14],17,-1502002290),er=m(er,tr=g(tr,rr,nr,er,_e[15],22,1236535329),rr,nr,_e[1],5,-165796510),nr=m(nr,er,tr,rr,_e[6],9,-1069501632),rr=m(rr,nr,er,tr,_e[11],14,643717713),tr=m(tr,rr,nr,er,_e[0],20,-373897302),er=m(er,tr,rr,nr,_e[5],5,-701558691),nr=m(nr,er,tr,rr,_e[10],9,38016083),rr=m(rr,nr,er,tr,_e[15],14,-660478335),tr=m(tr,rr,nr,er,_e[4],20,-405537848),er=m(er,tr,rr,nr,_e[9],5,568446438),nr=m(nr,er,tr,rr,_e[14],9,-1019803690),rr=m(rr,nr,er,tr,_e[3],14,-187363961),tr=m(tr,rr,nr,er,_e[8],20,1163531501),er=m(er,tr,rr,nr,_e[13],5,-1444681467),nr=m(nr,er,tr,rr,_e[2],9,-51403784),rr=m(rr,nr,er,tr,_e[7],14,1735328473),er=v(er,tr=m(tr,rr,nr,er,_e[12],20,-1926607734),rr,nr,_e[5],4,-378558),nr=v(nr,er,tr,rr,_e[8],11,-2022574463),rr=v(rr,nr,er,tr,_e[11],16,1839030562),tr=v(tr,rr,nr,er,_e[14],23,-35309556),er=v(er,tr,rr,nr,_e[1],4,-1530992060),nr=v(nr,er,tr,rr,_e[4],11,1272893353),rr=v(rr,nr,er,tr,_e[7],16,-155497632),tr=v(tr,rr,nr,er,_e[10],23,-1094730640),er=v(er,tr,rr,nr,_e[13],4,681279174),nr=v(nr,er,tr,rr,_e[0],11,-358537222),rr=v(rr,nr,er,tr,_e[3],16,-722521979),tr=v(tr,rr,nr,er,_e[6],23,76029189),er=v(er,tr,rr,nr,_e[9],4,-640364487),nr=v(nr,er,tr,rr,_e[12],11,-421815835),rr=v(rr,nr,er,tr,_e[15],16,530742520),er=b(er,tr=v(tr,rr,nr,er,_e[2],23,-995338651),rr,nr,_e[0],6,-198630844),nr=b(nr,er,tr,rr,_e[7],10,1126891415),rr=b(rr,nr,er,tr,_e[14],15,-1416354905),tr=b(tr,rr,nr,er,_e[5],21,-57434055),er=b(er,tr,rr,nr,_e[12],6,1700485571),nr=b(nr,er,tr,rr,_e[3],10,-1894986606),rr=b(rr,nr,er,tr,_e[10],15,-1051523),tr=b(tr,rr,nr,er,_e[1],21,-2054922799),er=b(er,tr,rr,nr,_e[8],6,1873313359),nr=b(nr,er,tr,rr,_e[15],10,-30611744),rr=b(rr,nr,er,tr,_e[6],15,-1560198380),tr=b(tr,rr,nr,er,_e[13],21,1309151649),er=b(er,tr,rr,nr,_e[4],6,-145523070),nr=b(nr,er,tr,rr,_e[11],10,-1120210379),rr=b(rr,nr,er,tr,_e[2],15,718787259),tr=b(tr,rr,nr,er,_e[9],21,-343485551),e[0]=_(er,e[0]),e[1]=_(tr,e[1]),e[2]=_(rr,e[2]),e[3]=_(nr,e[3])}function p(e,_e,er,tr,rr,nr){return _e=_(_(_e,e),_(tr,nr)),_(_e<<rr|_e>>>32-rr,er)}function g(e,_e,er,tr,rr,nr,ir){return p(_e&er|~_e&tr,e,_e,rr,nr,ir)}function m(e,_e,er,tr,rr,nr,ir){return p(_e&tr|er&~tr,e,_e,rr,nr,ir)}function v(e,_e,er,tr,rr,nr,ir){return p(_e^er^tr,e,_e,rr,nr,ir)}function b(e,_e,er,tr,rr,nr,ir){return p(er^(_e|~tr),e,_e,rr,nr,ir)}function y(e){var _e,er=e.length,tr=[1732584193,-271733879,-1732584194,271733878];for(_e=64;_e<=e.length;_e+=64)d(tr,w(e.substring(_e-64,_e)));e=e.substring(_e-64);var rr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(_e=0;_e<e.length;_e++)rr[_e>>2]|=e.charCodeAt(_e)<<(_e%4<<3);if(rr[_e>>2]|=128<<(_e%4<<3),_e>55)for(d(tr,rr),_e=0;_e<16;_e++)rr[_e]=0;return rr[14]=8*er,d(tr,rr),tr}function w(e){var _e,er=[];for(_e=0;_e<64;_e+=4)er[_e>>2]=e.charCodeAt(_e)+(e.charCodeAt(_e+1)<<8)+(e.charCodeAt(_e+2)<<16)+(e.charCodeAt(_e+3)<<24);return er}u=n.atob.bind(n),h=n.btoa.bind(n);var N="0123456789abcdef".split("");function L(e){for(var _e="",er=0;er<4;er++)_e+=N[e>>8*er+4&15]+N[e>>8*er&15];return _e}function A(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function x(e){return y(e).map(A).join("")}var S=function(e){for(var _e=0;_e<e.length;_e++)e[_e]=L(e[_e]);return e.join("")}(y("hello"))!="5d41402abc4b2a76b9719d911017c592";function _(e,_e){if(S){var er=(65535&e)+(65535&_e);return(e>>16)+(_e>>16)+(er>>16)<<16|65535&er}return e+_e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function P(e,_e){var er,tr,rr,nr;if(e!==er){for(var ir=(rr=e,nr=1+(256/e.length>>0),new Array(nr+1).join(rr)),ar=[],sr=0;sr<256;sr++)ar[sr]=sr;var or=0;for(sr=0;sr<256;sr++){var lr=ar[sr];or=(or+lr+ir.charCodeAt(sr))%256,ar[sr]=ar[or],ar[or]=lr}er=e,tr=ar}else ar=tr;var ur=_e.length,fr=0,cr=0,mr="";for(sr=0;sr<ur;sr++)cr=(cr+(lr=ar[fr=(fr+1)%256]))%256,ar[fr]=ar[cr],ar[cr]=lr,ir=ar[(ar[fr]+ar[cr])%256],mr+=String.fromCharCode(_e.charCodeAt(sr)^ir);return mr}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var k={print:4,modify:8,copy:16,"annot-forms":32};function I(e,_e,er,tr){this.v=1,this.r=2;var rr=192;e.forEach(function(ar){if(k.perm!==void 0)throw new Error("Invalid permission: "+ar);rr+=k[ar]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var nr=(_e+this.padding).substr(0,32),ir=(er+this.padding).substr(0,32);this.O=this.processOwnerPassword(nr,ir),this.P=-(1+(255^rr)),this.encryptionKey=x(nr+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(tr)).substr(0,5),this.U=P(this.encryptionKey,this.padding)}function F(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var _e="",er=e.length,tr=0;tr<er;tr++){var rr=e.charCodeAt(tr);rr<33||rr===35||rr===37||rr===40||rr===41||rr===47||rr===60||rr===62||rr===91||rr===93||rr===123||rr===125||rr>126?_e+="#"+("0"+rr.toString(16)).slice(-2):_e+=e[tr]}return _e}function C(e){if(_typeof(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var _e={};this.subscribe=function(er,tr,rr){if(rr=rr||!1,typeof er!="string"||typeof tr!="function"||typeof rr!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");_e.hasOwnProperty(er)||(_e[er]={});var nr=Math.random().toString(35);return _e[er][nr]=[tr,!!rr],nr},this.unsubscribe=function(er){for(var tr in _e)if(_e[tr][er])return delete _e[tr][er],Object.keys(_e[tr]).length===0&&delete _e[tr],!0;return!1},this.publish=function(er){if(_e.hasOwnProperty(er)){var tr=Array.prototype.slice.call(arguments,1),rr=[];for(var nr in _e[er]){var ir=_e[er][nr];try{ir[0].apply(e,tr)}catch(ar){n.console&&a.error("jsPDF PubSub Error",ar.message,ar)}ir[1]&&rr.push(nr)}rr.length&&rr.forEach(this.unsubscribe)}},this.getTopics=function(){return _e}}function j(e){if(!(this instanceof j))return new j(e);var _e="opacity,stroke-opacity".split(",");for(var er in e)e.hasOwnProperty(er)&&_e.indexOf(er)>=0&&(this[er]=e[er]);this.id="",this.objectNumber=-1}function O(e,_e){this.gState=e,this.matrix=_e,this.id="",this.objectNumber=-1}function B(e,_e,er,tr,rr){if(!(this instanceof B))return new B(e,_e,er,tr,rr);this.type=e==="axial"?2:3,this.coords=_e,this.colors=er,O.call(this,tr,rr)}function M(e,_e,er,tr,rr){if(!(this instanceof M))return new M(e,_e,er,tr,rr);this.boundingBox=e,this.xStep=_e,this.yStep=er,this.stream="",this.cloneIndex=0,O.call(this,tr,rr)}function E(e){var _e,er=typeof arguments[0]=="string"?arguments[0]:"p",tr=arguments[1],rr=arguments[2],nr=arguments[3],ir=[],ar=1,sr=16,or="S",lr=null;_typeof(e=e||{})==="object"&&(er=e.orientation,tr=e.unit||tr,rr=e.format||rr,nr=e.compress||e.compressPdf||nr,(lr=e.encryption||null)!==null&&(lr.userPassword=lr.userPassword||"",lr.ownerPassword=lr.ownerPassword||"",lr.userPermissions=lr.userPermissions||[]),ar=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(_e=e.precision),e.floatPrecision!==void 0&&(sr=e.floatPrecision),or=e.defaultPathOperation||"S"),ir=e.filters||(nr===!0?["FlateEncode"]:ir),tr=tr||"mm",er=(""+(er||"P")).toLowerCase();var ur=e.putOnlyUsedFonts||!1,fr={},cr={internal:{},__private__:{}};cr.__private__.PubSub=C;var mr="1.3",dr=cr.__private__.getPdfVersion=function(){return mr};cr.__private__.setPdfVersion=function(Nr){mr=Nr};var xr={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};cr.__private__.getPageFormats=function(){return xr};var pr=cr.__private__.getPageFormat=function(Nr){return xr[Nr]};rr=rr||"a4";var gr={COMPAT:"compat",ADVANCED:"advanced"},vr=gr.COMPAT;function Cr(){this.saveGraphicsState(),Qr(new Rn(Xn,0,0,-Xn,0,Cl()*Xn).toString()+" cm"),this.setFontSize(this.getFontSize()/Xn),or="n",vr=gr.ADVANCED}function Tr(){this.restoreGraphicsState(),or="S",vr=gr.COMPAT}var Fr=cr.__private__.combineFontStyleAndFontWeight=function(Nr,nn){if(Nr=="bold"&&nn=="normal"||Nr=="bold"&&nn==400||Nr=="normal"&&nn=="italic"||Nr=="bold"&&nn=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return nn&&(Nr=nn==400||nn==="normal"?Nr==="italic"?"italic":"normal":nn!=700&&nn!=="bold"||Nr!=="normal"?(nn==700?"bold":nn)+""+Nr:"bold"),Nr};cr.advancedAPI=function(Nr){var nn=vr===gr.COMPAT;return nn&&Cr.call(this),typeof Nr!="function"||(Nr(this),nn&&Tr.call(this)),this},cr.compatAPI=function(Nr){var nn=vr===gr.ADVANCED;return nn&&Tr.call(this),typeof Nr!="function"||(Nr(this),nn&&Cr.call(this)),this},cr.isAdvancedAPI=function(){return vr===gr.ADVANCED};var _r,Ar=function(Nr){if(vr!==gr.ADVANCED)throw new Error(Nr+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Pr=cr.roundToPrecision=cr.__private__.roundToPrecision=function(Nr,nn){var An=_e||nn;if(isNaN(Nr)||isNaN(An))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Nr.toFixed(An).replace(/0+$/,"")};_r=cr.hpf=cr.__private__.hpf=typeof sr=="number"?function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.hpf");return Pr(Nr,sr)}:sr==="smart"?function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.hpf");return Pr(Nr,Nr>-1&&Nr<1?16:5)}:function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.hpf");return Pr(Nr,16)};var Ir=cr.f2=cr.__private__.f2=function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.f2");return Pr(Nr,2)},wr=cr.__private__.f3=function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.f3");return Pr(Nr,3)},kr=cr.scale=cr.__private__.scale=function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.scale");return vr===gr.COMPAT?Nr*Xn:vr===gr.ADVANCED?Nr:void 0},Mr=function(Nr){return vr===gr.COMPAT?Cl()-Nr:vr===gr.ADVANCED?Nr:void 0},Hr=function(Nr){return kr(Mr(Nr))};cr.__private__.setPrecision=cr.setPrecision=function(Nr){typeof parseInt(Nr,10)=="number"&&(_e=parseInt(Nr,10))};var Gr,zr="00000000000000000000000000000000",Br=cr.__private__.getFileId=function(){return zr},Vr=cr.__private__.setFileId=function(Nr){return zr=Nr!==void 0&&/^[a-fA-F0-9]{32}$/.test(Nr)?Nr.toUpperCase():zr.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),lr!==null&&(_o=new I(lr.userPermissions,lr.userPassword,lr.ownerPassword,zr)),zr};cr.setFileId=function(Nr){return Vr(Nr),this},cr.getFileId=function(){return Br()};var Rr=cr.__private__.convertDateToPDFDate=function(Nr){var nn=Nr.getTimezoneOffset(),An=nn<0?"+":"-",jn=Math.floor(Math.abs(nn/60)),Jn=Math.abs(nn%60),as=[An,Er(jn),"'",Er(Jn),"'"].join("");return["D:",Nr.getFullYear(),Er(Nr.getMonth()+1),Er(Nr.getDate()),Er(Nr.getHours()),Er(Nr.getMinutes()),Er(Nr.getSeconds()),as].join("")},Xr=cr.__private__.convertPDFDateToDate=function(Nr){var nn=parseInt(Nr.substr(2,4),10),An=parseInt(Nr.substr(6,2),10)-1,jn=parseInt(Nr.substr(8,2),10),Jn=parseInt(Nr.substr(10,2),10),as=parseInt(Nr.substr(12,2),10),_s=parseInt(Nr.substr(14,2),10);return new Date(nn,An,jn,Jn,as,_s,0)},an=cr.__private__.setCreationDate=function(Nr){var nn;if(Nr===void 0&&(Nr=new Date),Nr instanceof Date)nn=Rr(Nr);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Nr))throw new Error("Invalid argument passed to jsPDF.setCreationDate");nn=Nr}return Gr=nn},yr=cr.__private__.getCreationDate=function(Nr){var nn=Gr;return Nr==="jsDate"&&(nn=Xr(Gr)),nn};cr.setCreationDate=function(Nr){return an(Nr),this},cr.getCreationDate=function(Nr){return yr(Nr)};var br,Er=cr.__private__.padd2=function(Nr){return("0"+parseInt(Nr)).slice(-2)},Lr=cr.__private__.padd2Hex=function(Nr){return("00"+(Nr=Nr.toString())).substr(Nr.length)},Or=0,Ur=[],$r=[],Zr=0,fn=[],_n=[],Kr=!1,Cn=$r,Dn=function(){Or=0,Zr=0,$r=[],Ur=[],fn=[],qr=xs(),en=xs()};cr.__private__.setCustomOutputDestination=function(Nr){Kr=!0,Cn=Nr};var wn=function(Nr){Kr||(Cn=Nr)};cr.__private__.resetCustomOutputDestination=function(){Kr=!1,Cn=$r};var Qr=cr.__private__.out=function(Nr){return Nr=Nr.toString(),Zr+=Nr.length+1,Cn.push(Nr),Cn},xn=cr.__private__.write=function(Nr){return Qr(arguments.length===1?Nr.toString():Array.prototype.join.call(arguments," "))},tn=cr.__private__.getArrayBuffer=function(Nr){for(var nn=Nr.length,An=new ArrayBuffer(nn),jn=new Uint8Array(An);nn--;)jn[nn]=Nr.charCodeAt(nn);return An},on=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];cr.__private__.getStandardFonts=function(){return on};var vn=e.fontSize||16;cr.__private__.setFontSize=cr.setFontSize=function(Nr){return vn=vr===gr.ADVANCED?Nr/Xn:Nr,this};var Sn,Ln=cr.__private__.getFontSize=cr.getFontSize=function(){return vr===gr.COMPAT?vn:vn*Xn},Wn=e.R2L||!1;cr.__private__.setR2L=cr.setR2L=function(Nr){return Wn=Nr,this},cr.__private__.getR2L=cr.getR2L=function(){return Wn};var $n,En=cr.__private__.setZoomMode=function(Nr){var nn=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Nr))Sn=Nr;else if(isNaN(Nr)){if(nn.indexOf(Nr)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Nr+'" is not recognized.');Sn=Nr}else Sn=parseInt(Nr,10)};cr.__private__.getZoomMode=function(){return Sn};var ba,Qn=cr.__private__.setPageMode=function(Nr){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Nr)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Nr+'" is not recognized.');$n=Nr};cr.__private__.getPageMode=function(){return $n};var vs=cr.__private__.setLayoutMode=function(Nr){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Nr)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Nr+'" is not recognized.');ba=Nr};cr.__private__.getLayoutMode=function(){return ba},cr.__private__.setDisplayMode=cr.setDisplayMode=function(Nr,nn,An){return En(Nr),vs(nn),Qn(An),this};var es={title:"",subject:"",author:"",keywords:"",creator:""};cr.__private__.getDocumentProperty=function(Nr){if(Object.keys(es).indexOf(Nr)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return es[Nr]},cr.__private__.getDocumentProperties=function(){return es},cr.__private__.setDocumentProperties=cr.setProperties=cr.setDocumentProperties=function(Nr){for(var nn in es)es.hasOwnProperty(nn)&&Nr[nn]&&(es[nn]=Nr[nn]);return this},cr.__private__.setDocumentProperty=function(Nr,nn){if(Object.keys(es).indexOf(Nr)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return es[Nr]=nn};var ls,Xn,ws,ds,Ps,Zn={},Mn={},zn=[],cs={},Ls={},As={},yn={},_i=null,rs=0,os=[],ms=new C(cr),bs=e.hotfixes||[],gn={},pn={},Pn=[],Rn=function Nr(nn,An,jn,Jn,as,_s){if(!(this instanceof Nr))return new Nr(nn,An,jn,Jn,as,_s);isNaN(nn)&&(nn=1),isNaN(An)&&(An=0),isNaN(jn)&&(jn=0),isNaN(Jn)&&(Jn=1),isNaN(as)&&(as=0),isNaN(_s)&&(_s=0),this._matrix=[nn,An,jn,Jn,as,_s]};Object.defineProperty(Rn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Nr){this._matrix[0]=Nr}}),Object.defineProperty(Rn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Nr){this._matrix[1]=Nr}}),Object.defineProperty(Rn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Nr){this._matrix[2]=Nr}}),Object.defineProperty(Rn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Nr){this._matrix[3]=Nr}}),Object.defineProperty(Rn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Nr){this._matrix[4]=Nr}}),Object.defineProperty(Rn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Nr){this._matrix[5]=Nr}}),Object.defineProperty(Rn.prototype,"a",{get:function(){return this._matrix[0]},set:function(Nr){this._matrix[0]=Nr}}),Object.defineProperty(Rn.prototype,"b",{get:function(){return this._matrix[1]},set:function(Nr){this._matrix[1]=Nr}}),Object.defineProperty(Rn.prototype,"c",{get:function(){return this._matrix[2]},set:function(Nr){this._matrix[2]=Nr}}),Object.defineProperty(Rn.prototype,"d",{get:function(){return this._matrix[3]},set:function(Nr){this._matrix[3]=Nr}}),Object.defineProperty(Rn.prototype,"e",{get:function(){return this._matrix[4]},set:function(Nr){this._matrix[4]=Nr}}),Object.defineProperty(Rn.prototype,"f",{get:function(){return this._matrix[5]},set:function(Nr){this._matrix[5]=Nr}}),Object.defineProperty(Rn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Rn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Rn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Rn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Rn.prototype.join=function(Nr){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_r).join(Nr)},Rn.prototype.multiply=function(Nr){var nn=Nr.sx*this.sx+Nr.shy*this.shx,An=Nr.sx*this.shy+Nr.shy*this.sy,jn=Nr.shx*this.sx+Nr.sy*this.shx,Jn=Nr.shx*this.shy+Nr.sy*this.sy,as=Nr.tx*this.sx+Nr.ty*this.shx+this.tx,_s=Nr.tx*this.shy+Nr.ty*this.sy+this.ty;return new Rn(nn,An,jn,Jn,as,_s)},Rn.prototype.decompose=function(){var Nr=this.sx,nn=this.shy,An=this.shx,jn=this.sy,Jn=this.tx,as=this.ty,_s=Math.sqrt(Nr*Nr+nn*nn),Cs=(Nr/=_s)*An+(nn/=_s)*jn;An-=Nr*Cs,jn-=nn*Cs;var Rs=Math.sqrt(An*An+jn*jn);return Cs/=Rs,Nr*(jn/=Rs)<nn*(An/=Rs)&&(Nr=-Nr,nn=-nn,Cs=-Cs,_s=-_s),{scale:new Rn(_s,0,0,Rs,0,0),translate:new Rn(1,0,0,1,Jn,as),rotate:new Rn(Nr,nn,-nn,Nr,0,0),skew:new Rn(1,0,Cs,1,0,0)}},Rn.prototype.toString=function(Nr){return this.join(" ")},Rn.prototype.inversed=function(){var Nr=this.sx,nn=this.shy,An=this.shx,jn=this.sy,Jn=this.tx,as=this.ty,_s=1/(Nr*jn-nn*An),Cs=jn*_s,Rs=-nn*_s,js=-An*_s,Os=Nr*_s;return new Rn(Cs,Rs,js,Os,-Cs*Jn-js*as,-Rs*Jn-Os*as)},Rn.prototype.applyToPoint=function(Nr){var nn=Nr.x*this.sx+Nr.y*this.shx+this.tx,An=Nr.x*this.shy+Nr.y*this.sy+this.ty;return new iu(nn,An)},Rn.prototype.applyToRectangle=function(Nr){var nn=this.applyToPoint(Nr),An=this.applyToPoint(new iu(Nr.x+Nr.w,Nr.y+Nr.h));return new Du(nn.x,nn.y,An.x-nn.x,An.y-nn.y)},Rn.prototype.clone=function(){var Nr=this.sx,nn=this.shy,An=this.shx,jn=this.sy,Jn=this.tx,as=this.ty;return new Rn(Nr,nn,An,jn,Jn,as)},cr.Matrix=Rn;var Yn=cr.matrixMult=function(Nr,nn){return nn.multiply(Nr)},xa=new Rn(1,0,0,1,0,0);cr.unitMatrix=cr.identityMatrix=xa;var $a=function(Nr,nn){if(!Ls[Nr]){var An=(nn instanceof B?"Sh":"P")+(Object.keys(cs).length+1).toString(10);nn.id=An,Ls[Nr]=An,cs[An]=nn,ms.publish("addPattern",nn)}};cr.ShadingPattern=B,cr.TilingPattern=M,cr.addShadingPattern=function(Nr,nn){return Ar("addShadingPattern()"),$a(Nr,nn),this},cr.beginTilingPattern=function(Nr){Ar("beginTilingPattern()"),y0(Nr.boundingBox[0],Nr.boundingBox[1],Nr.boundingBox[2]-Nr.boundingBox[0],Nr.boundingBox[3]-Nr.boundingBox[1],Nr.matrix)},cr.endTilingPattern=function(Nr,nn){Ar("endTilingPattern()"),nn.stream=_n[br].join(`
`),$a(Nr,nn),ms.publish("endTilingPattern",nn),Pn.pop().restore()};var ys=cr.__private__.newObject=function(){var Nr=xs();return Jr(Nr,!0),Nr},xs=cr.__private__.newObjectDeferred=function(){return Or++,Ur[Or]=function(){return Zr},Or},Jr=function(Nr,nn){return nn=typeof nn=="boolean"&&nn,Ur[Nr]=Zr,nn&&Qr(Nr+" 0 obj"),Nr},Yr=cr.__private__.newAdditionalObject=function(){var Nr={objId:xs(),content:""};return fn.push(Nr),Nr},qr=xs(),en=xs(),sn=cr.__private__.decodeColorString=function(Nr){var nn=Nr.split(" ");if(nn.length!==2||nn[1]!=="g"&&nn[1]!=="G")nn.length===5&&(nn[4]==="k"||nn[4]==="K")&&(nn=[(1-nn[0])*(1-nn[3]),(1-nn[1])*(1-nn[3]),(1-nn[2])*(1-nn[3]),"r"]);else{var An=parseFloat(nn[0]);nn=[An,An,An,"r"]}for(var jn="#",Jn=0;Jn<3;Jn++)jn+=("0"+Math.floor(255*parseFloat(nn[Jn])).toString(16)).slice(-2);return jn},un=cr.__private__.encodeColorString=function(Nr){var nn;typeof Nr=="string"&&(Nr={ch1:Nr});var An=Nr.ch1,jn=Nr.ch2,Jn=Nr.ch3,as=Nr.ch4,_s=Nr.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof An=="string"&&An.charAt(0)!=="#"){var Cs=new f(An);if(Cs.ok)An=Cs.toHex();else if(!/^\d*\.?\d*$/.test(An))throw new Error('Invalid color "'+An+'" passed to jsPDF.encodeColorString.')}if(typeof An=="string"&&/^#[0-9A-Fa-f]{3}$/.test(An)&&(An="#"+An[1]+An[1]+An[2]+An[2]+An[3]+An[3]),typeof An=="string"&&/^#[0-9A-Fa-f]{6}$/.test(An)){var Rs=parseInt(An.substr(1),16);An=Rs>>16&255,jn=Rs>>8&255,Jn=255&Rs}if(jn===void 0||as===void 0&&An===jn&&jn===Jn)if(typeof An=="string")nn=An+" "+_s[0];else switch(Nr.precision){case 2:nn=Ir(An/255)+" "+_s[0];break;case 3:default:nn=wr(An/255)+" "+_s[0]}else if(as===void 0||_typeof(as)==="object"){if(as&&!isNaN(as.a)&&as.a===0)return nn=["1.","1.","1.",_s[1]].join(" ");if(typeof An=="string")nn=[An,jn,Jn,_s[1]].join(" ");else switch(Nr.precision){case 2:nn=[Ir(An/255),Ir(jn/255),Ir(Jn/255),_s[1]].join(" ");break;default:case 3:nn=[wr(An/255),wr(jn/255),wr(Jn/255),_s[1]].join(" ")}}else if(typeof An=="string")nn=[An,jn,Jn,as,_s[2]].join(" ");else switch(Nr.precision){case 2:nn=[Ir(An),Ir(jn),Ir(Jn),Ir(as),_s[2]].join(" ");break;case 3:default:nn=[wr(An),wr(jn),wr(Jn),wr(as),_s[2]].join(" ")}return nn},Tn=cr.__private__.getFilters=function(){return ir},In=cr.__private__.putStream=function(Nr){var nn=(Nr=Nr||{}).data||"",An=Nr.filters||Tn(),jn=Nr.alreadyAppliedFilters||[],Jn=Nr.addLength1||!1,as=nn.length,_s=Nr.objectId,Cs=function(wo){return wo};if(lr!==null&&_s===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");lr!==null&&(Cs=_o.encryptor(_s,0));var Rs={};An===!0&&(An=["FlateEncode"]);var js=Nr.additionalKeyValues||[],Os=(Rs=E.API.processDataByFilters!==void 0?E.API.processDataByFilters(nn,An):{data:nn,reverseChain:[]}).reverseChain+(Array.isArray(jn)?jn.join(" "):jn.toString());if(Rs.data.length!==0&&(js.push({key:"Length",value:Rs.data.length}),Jn===!0&&js.push({key:"Length1",value:as})),Os.length!=0)if(Os.split("/").length-1==1)js.push({key:"Filter",value:Os});else{js.push({key:"Filter",value:"["+Os+"]"});for(var zs=0;zs<js.length;zs+=1)if(js[zs].key==="DecodeParms"){for(var no=[],io=0;io<Rs.reverseChain.split("/").length-1;io+=1)no.push("null");no.push(js[zs].value),js[zs].value="["+no.join(" ")+"]"}}Qr("<<");for(var co=0;co<js.length;co++)Qr("/"+js[co].key+" "+js[co].value);Qr(">>"),Rs.data.length!==0&&(Qr("stream"),Qr(Cs(Rs.data)),Qr("endstream"))},Fn=cr.__private__.putPage=function(Nr){var nn=Nr.number,An=Nr.data,jn=Nr.objId,Jn=Nr.contentsObjId;Jr(jn,!0),Qr("<</Type /Page"),Qr("/Parent "+Nr.rootDictionaryObjId+" 0 R"),Qr("/Resources "+Nr.resourceDictionaryObjId+" 0 R"),Qr("/MediaBox ["+parseFloat(_r(Nr.mediaBox.bottomLeftX))+" "+parseFloat(_r(Nr.mediaBox.bottomLeftY))+" "+_r(Nr.mediaBox.topRightX)+" "+_r(Nr.mediaBox.topRightY)+"]"),Nr.cropBox!==null&&Qr("/CropBox ["+_r(Nr.cropBox.bottomLeftX)+" "+_r(Nr.cropBox.bottomLeftY)+" "+_r(Nr.cropBox.topRightX)+" "+_r(Nr.cropBox.topRightY)+"]"),Nr.bleedBox!==null&&Qr("/BleedBox ["+_r(Nr.bleedBox.bottomLeftX)+" "+_r(Nr.bleedBox.bottomLeftY)+" "+_r(Nr.bleedBox.topRightX)+" "+_r(Nr.bleedBox.topRightY)+"]"),Nr.trimBox!==null&&Qr("/TrimBox ["+_r(Nr.trimBox.bottomLeftX)+" "+_r(Nr.trimBox.bottomLeftY)+" "+_r(Nr.trimBox.topRightX)+" "+_r(Nr.trimBox.topRightY)+"]"),Nr.artBox!==null&&Qr("/ArtBox ["+_r(Nr.artBox.bottomLeftX)+" "+_r(Nr.artBox.bottomLeftY)+" "+_r(Nr.artBox.topRightX)+" "+_r(Nr.artBox.topRightY)+"]"),typeof Nr.userUnit=="number"&&Nr.userUnit!==1&&Qr("/UserUnit "+Nr.userUnit),ms.publish("putPage",{objId:jn,pageContext:os[nn],pageNumber:nn,page:An}),Qr("/Contents "+Jn+" 0 R"),Qr(">>"),Qr("endobj");var as=An.join(`
`);return vr===gr.ADVANCED&&(as+=`
Q`),Jr(Jn,!0),In({data:as,filters:Tn(),objectId:Jn}),Qr("endobj"),jn},kn=cr.__private__.putPages=function(){var Nr,nn,An=[];for(Nr=1;Nr<=rs;Nr++)os[Nr].objId=xs(),os[Nr].contentsObjId=xs();for(Nr=1;Nr<=rs;Nr++)An.push(Fn({number:Nr,data:_n[Nr],objId:os[Nr].objId,contentsObjId:os[Nr].contentsObjId,mediaBox:os[Nr].mediaBox,cropBox:os[Nr].cropBox,bleedBox:os[Nr].bleedBox,trimBox:os[Nr].trimBox,artBox:os[Nr].artBox,userUnit:os[Nr].userUnit,rootDictionaryObjId:qr,resourceDictionaryObjId:en}));Jr(qr,!0),Qr("<</Type /Pages");var jn="/Kids [";for(nn=0;nn<rs;nn++)jn+=An[nn]+" 0 R ";Qr(jn+"]"),Qr("/Count "+rs),Qr(">>"),Qr("endobj"),ms.publish("postPutPages")},Nn=function(Nr){ms.publish("putFont",{font:Nr,out:Qr,newObject:ys,putStream:In}),Nr.isAlreadyPutted!==!0&&(Nr.objectNumber=ys(),Qr("<<"),Qr("/Type /Font"),Qr("/BaseFont /"+F(Nr.postScriptName)),Qr("/Subtype /Type1"),typeof Nr.encoding=="string"&&Qr("/Encoding /"+Nr.encoding),Qr("/FirstChar 32"),Qr("/LastChar 255"),Qr(">>"),Qr("endobj"))},Kn=function(){for(var Nr in Zn)Zn.hasOwnProperty(Nr)&&(ur===!1||ur===!0&&fr.hasOwnProperty(Nr))&&Nn(Zn[Nr])},is=function(Nr){Nr.objectNumber=ys();var nn=[];nn.push({key:"Type",value:"/XObject"}),nn.push({key:"Subtype",value:"/Form"}),nn.push({key:"BBox",value:"["+[_r(Nr.x),_r(Nr.y),_r(Nr.x+Nr.width),_r(Nr.y+Nr.height)].join(" ")+"]"}),nn.push({key:"Matrix",value:"["+Nr.matrix.toString()+"]"});var An=Nr.pages[1].join(`
`);In({data:An,additionalKeyValues:nn,objectId:Nr.objectNumber}),Qr("endobj")},ps=function(){for(var Nr in gn)gn.hasOwnProperty(Nr)&&is(gn[Nr])},ns=function(Nr,nn){var An,jn=[],Jn=1/(nn-1);for(An=0;An<1;An+=Jn)jn.push(An);if(jn.push(1),Nr[0].offset!=0){var as={offset:0,color:Nr[0].color};Nr.unshift(as)}if(Nr[Nr.length-1].offset!=1){var _s={offset:1,color:Nr[Nr.length-1].color};Nr.push(_s)}for(var Cs="",Rs=0,js=0;js<jn.length;js++){for(An=jn[js];An>Nr[Rs+1].offset;)Rs++;var Os=Nr[Rs].offset,zs=(An-Os)/(Nr[Rs+1].offset-Os),no=Nr[Rs].color,io=Nr[Rs+1].color;Cs+=Lr(Math.round((1-zs)*no[0]+zs*io[0]).toString(16))+Lr(Math.round((1-zs)*no[1]+zs*io[1]).toString(16))+Lr(Math.round((1-zs)*no[2]+zs*io[2]).toString(16))}return Cs.trim()},ss=function(Nr,nn){nn||(nn=21);var An=ys(),jn=ns(Nr.colors,nn),Jn=[];Jn.push({key:"FunctionType",value:"0"}),Jn.push({key:"Domain",value:"[0.0 1.0]"}),Jn.push({key:"Size",value:"["+nn+"]"}),Jn.push({key:"BitsPerSample",value:"8"}),Jn.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Jn.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),In({data:jn,additionalKeyValues:Jn,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:An}),Qr("endobj"),Nr.objectNumber=ys(),Qr("<< /ShadingType "+Nr.type),Qr("/ColorSpace /DeviceRGB");var as="/Coords ["+_r(parseFloat(Nr.coords[0]))+" "+_r(parseFloat(Nr.coords[1]))+" ";Nr.type===2?as+=_r(parseFloat(Nr.coords[2]))+" "+_r(parseFloat(Nr.coords[3])):as+=_r(parseFloat(Nr.coords[2]))+" "+_r(parseFloat(Nr.coords[3]))+" "+_r(parseFloat(Nr.coords[4]))+" "+_r(parseFloat(Nr.coords[5])),Qr(as+="]"),Nr.matrix&&Qr("/Matrix ["+Nr.matrix.toString()+"]"),Qr("/Function "+An+" 0 R"),Qr("/Extend [true true]"),Qr(">>"),Qr("endobj")},Ss=function(Nr,nn){var An=xs(),jn=ys();nn.push({resourcesOid:An,objectOid:jn}),Nr.objectNumber=jn;var Jn=[];Jn.push({key:"Type",value:"/Pattern"}),Jn.push({key:"PatternType",value:"1"}),Jn.push({key:"PaintType",value:"1"}),Jn.push({key:"TilingType",value:"1"}),Jn.push({key:"BBox",value:"["+Nr.boundingBox.map(_r).join(" ")+"]"}),Jn.push({key:"XStep",value:_r(Nr.xStep)}),Jn.push({key:"YStep",value:_r(Nr.yStep)}),Jn.push({key:"Resources",value:An+" 0 R"}),Nr.matrix&&Jn.push({key:"Matrix",value:"["+Nr.matrix.toString()+"]"}),In({data:Nr.stream,additionalKeyValues:Jn,objectId:Nr.objectNumber}),Qr("endobj")},ks=function(Nr){var nn;for(nn in cs)cs.hasOwnProperty(nn)&&(cs[nn]instanceof B?ss(cs[nn]):cs[nn]instanceof M&&Ss(cs[nn],Nr))},Ns=function(Nr){for(var nn in Nr.objectNumber=ys(),Qr("<<"),Nr)switch(nn){case"opacity":Qr("/ca "+Ir(Nr[nn]));break;case"stroke-opacity":Qr("/CA "+Ir(Nr[nn]))}Qr(">>"),Qr("endobj")},Us=function(){var Nr;for(Nr in As)As.hasOwnProperty(Nr)&&Ns(As[Nr])},Is=function(){for(var Nr in Qr("/XObject <<"),gn)gn.hasOwnProperty(Nr)&&gn[Nr].objectNumber>=0&&Qr("/"+Nr+" "+gn[Nr].objectNumber+" 0 R");ms.publish("putXobjectDict"),Qr(">>")},Gs=function(){_o.oid=ys(),Qr("<<"),Qr("/Filter /Standard"),Qr("/V "+_o.v),Qr("/R "+_o.r),Qr("/U <"+_o.toHexString(_o.U)+">"),Qr("/O <"+_o.toHexString(_o.O)+">"),Qr("/P "+_o.P),Qr(">>"),Qr("endobj")},so=function(){for(var Nr in Qr("/Font <<"),Zn)Zn.hasOwnProperty(Nr)&&(ur===!1||ur===!0&&fr.hasOwnProperty(Nr))&&Qr("/"+Nr+" "+Zn[Nr].objectNumber+" 0 R");Qr(">>")},ro=function(){if(Object.keys(cs).length>0){for(var Nr in Qr("/Shading <<"),cs)cs.hasOwnProperty(Nr)&&cs[Nr]instanceof B&&cs[Nr].objectNumber>=0&&Qr("/"+Nr+" "+cs[Nr].objectNumber+" 0 R");ms.publish("putShadingPatternDict"),Qr(">>")}},Qs=function(Nr){if(Object.keys(cs).length>0){for(var nn in Qr("/Pattern <<"),cs)cs.hasOwnProperty(nn)&&cs[nn]instanceof cr.TilingPattern&&cs[nn].objectNumber>=0&&cs[nn].objectNumber<Nr&&Qr("/"+nn+" "+cs[nn].objectNumber+" 0 R");ms.publish("putTilingPatternDict"),Qr(">>")}},qs=function(){if(Object.keys(As).length>0){var Nr;for(Nr in Qr("/ExtGState <<"),As)As.hasOwnProperty(Nr)&&As[Nr].objectNumber>=0&&Qr("/"+Nr+" "+As[Nr].objectNumber+" 0 R");ms.publish("putGStateDict"),Qr(">>")}},Hs=function(Nr){Jr(Nr.resourcesOid,!0),Qr("<<"),Qr("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),so(),ro(),Qs(Nr.objectOid),qs(),Is(),Qr(">>"),Qr("endobj")},s0=function(){var Nr=[];Kn(),Us(),ps(),ks(Nr),ms.publish("putResources"),Nr.forEach(Hs),Hs({resourcesOid:en,objectOid:Number.MAX_SAFE_INTEGER}),ms.publish("postPutResources")},o0=function(){ms.publish("putAdditionalObjects");for(var Nr=0;Nr<fn.length;Nr++){var nn=fn[Nr];Jr(nn.objId,!0),Qr(nn.content),Qr("endobj")}ms.publish("postPutAdditionalObjects")},l0=function(Nr){Mn[Nr.fontName]=Mn[Nr.fontName]||{},Mn[Nr.fontName][Nr.fontStyle]=Nr.id},Au=function(Nr,nn,An,jn,Jn){var as={id:"F"+(Object.keys(Zn).length+1).toString(10),postScriptName:Nr,fontName:nn,fontStyle:An,encoding:jn,isStandardFont:Jn||!1,metadata:{}};return ms.publish("addFont",{font:as,instance:this}),Zn[as.id]=as,l0(as),as.id},sp=function(Nr){for(var nn=0,An=on.length;nn<An;nn++){var jn=Au.call(this,Nr[nn][0],Nr[nn][1],Nr[nn][2],on[nn][3],!0);ur===!1&&(fr[jn]=!0);var Jn=Nr[nn][0].split("-");l0({id:jn,fontName:Jn[0],fontStyle:Jn[1]||""})}ms.publish("addFonts",{fonts:Zn,dictionary:Mn})},Wo=function(Nr){return Nr.foo=function(){try{return Nr.apply(this,arguments)}catch(jn){var nn=jn.stack||"";~nn.indexOf(" at ")&&(nn=nn.split(" at ")[1]);var An="Error in function "+nn.split(`
`)[0].split("<")[0]+": "+jn.message;if(!n.console)throw new Error(An);n.console.error(An,jn),n.alert&&alert(An)}},Nr.foo.bar=Nr,Nr.foo},Ql=function(Nr,nn){var An,jn,Jn,as,_s,Cs,Rs,js,Os;if(Jn=(nn=nn||{}).sourceEncoding||"Unicode",_s=nn.outputEncoding,(nn.autoencode||_s)&&Zn[ls].metadata&&Zn[ls].metadata[Jn]&&Zn[ls].metadata[Jn].encoding&&(as=Zn[ls].metadata[Jn].encoding,!_s&&Zn[ls].encoding&&(_s=Zn[ls].encoding),!_s&&as.codePages&&(_s=as.codePages[0]),typeof _s=="string"&&(_s=as[_s]),_s)){for(Rs=!1,Cs=[],An=0,jn=Nr.length;An<jn;An++)(js=_s[Nr.charCodeAt(An)])?Cs.push(String.fromCharCode(js)):Cs.push(Nr[An]),Cs[An].charCodeAt(0)>>8&&(Rs=!0);Nr=Cs.join("")}for(An=Nr.length;Rs===void 0&&An!==0;)Nr.charCodeAt(An-1)>>8&&(Rs=!0),An--;if(!Rs)return Nr;for(Cs=nn.noBOM?[]:[254,255],An=0,jn=Nr.length;An<jn;An++){if((Os=(js=Nr.charCodeAt(An))>>8)>>8)throw new Error("Character at position "+An+" of string '"+Nr+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Cs.push(Os),Cs.push(js-(Os<<8))}return String.fromCharCode.apply(void 0,Cs)},Eo=cr.__private__.pdfEscape=cr.pdfEscape=function(Nr,nn){return Ql(Nr,nn).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ku=cr.__private__.beginPage=function(Nr){_n[++rs]=[],os[rs]={objId:0,contentsObjId:0,userUnit:Number(ar),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Nr[0]),topRightY:Number(Nr[1])}},u0(rs),wn(_n[br])},c0=function(Nr,nn){var An,jn,Jn;switch(er=nn||er,typeof Nr=="string"&&(An=pr(Nr.toLowerCase()),Array.isArray(An)&&(jn=An[0],Jn=An[1])),Array.isArray(Nr)&&(jn=Nr[0]*Xn,Jn=Nr[1]*Xn),isNaN(jn)&&(jn=rr[0],Jn=rr[1]),(jn>14400||Jn>14400)&&(a.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),jn=Math.min(14400,jn),Jn=Math.min(14400,Jn)),rr=[jn,Jn],er.substr(0,1)){case"l":Jn>jn&&(rr=[Jn,jn]);break;case"p":jn>Jn&&(rr=[Jn,jn])}ku(rr),g0(Pu),Qr(zo),Nu!==0&&Qr(Nu+" J"),Ru!==0&&Qr(Ru+" j"),ms.publish("addPage",{pageNumber:rs})},op=function(Nr){Nr>0&&Nr<=rs&&(_n.splice(Nr,1),os.splice(Nr,1),rs--,br>rs&&(br=rs),this.setPage(br))},u0=function(Nr){Nr>0&&Nr<=rs&&(br=Nr)},lp=cr.__private__.getNumberOfPages=cr.getNumberOfPages=function(){return _n.length-1},f0=function(Nr,nn,An){var jn,Jn=void 0;return An=An||{},Nr=Nr!==void 0?Nr:Zn[ls].fontName,nn=nn!==void 0?nn:Zn[ls].fontStyle,jn=Nr.toLowerCase(),Mn[jn]!==void 0&&Mn[jn][nn]!==void 0?Jn=Mn[jn][nn]:Mn[Nr]!==void 0&&Mn[Nr][nn]!==void 0?Jn=Mn[Nr][nn]:An.disableWarning===!1&&a.warn("Unable to look up font label for font '"+Nr+"', '"+nn+"'. Refer to getFontList() for available fonts."),Jn||An.noFallback||(Jn=Mn.times[nn])==null&&(Jn=Mn.times.normal),Jn},cp=cr.__private__.putInfo=function(){var Nr=ys(),nn=function(jn){return jn};for(var An in lr!==null&&(nn=_o.encryptor(Nr,0)),Qr("<<"),Qr("/Producer ("+Eo(nn("jsPDF "+E.version))+")"),es)es.hasOwnProperty(An)&&es[An]&&Qr("/"+An.substr(0,1).toUpperCase()+An.substr(1)+" ("+Eo(nn(es[An]))+")");Qr("/CreationDate ("+Eo(nn(Gr))+")"),Qr(">>"),Qr("endobj")},Tu=cr.__private__.putCatalog=function(Nr){var nn=(Nr=Nr||{}).rootDictionaryObjId||qr;switch(ys(),Qr("<<"),Qr("/Type /Catalog"),Qr("/Pages "+nn+" 0 R"),Sn||(Sn="fullwidth"),Sn){case"fullwidth":Qr("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Qr("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Qr("/OpenAction [3 0 R /Fit]");break;case"original":Qr("/OpenAction [3 0 R /XYZ null null 1]");break;default:var An=""+Sn;An.substr(An.length-1)==="%"&&(Sn=parseInt(Sn)/100),typeof Sn=="number"&&Qr("/OpenAction [3 0 R /XYZ null null "+Ir(Sn)+"]")}switch(ba||(ba="continuous"),ba){case"continuous":Qr("/PageLayout /OneColumn");break;case"single":Qr("/PageLayout /SinglePage");break;case"two":case"twoleft":Qr("/PageLayout /TwoColumnLeft");break;case"tworight":Qr("/PageLayout /TwoColumnRight")}$n&&Qr("/PageMode /"+$n),ms.publish("putCatalog"),Qr(">>"),Qr("endobj")},up=cr.__private__.putTrailer=function(){Qr("trailer"),Qr("<<"),Qr("/Size "+(Or+1)),Qr("/Root "+Or+" 0 R"),Qr("/Info "+(Or-1)+" 0 R"),lr!==null&&Qr("/Encrypt "+_o.oid+" 0 R"),Qr("/ID [ <"+zr+"> <"+zr+"> ]"),Qr(">>")},fp=cr.__private__.putHeader=function(){Qr("%PDF-"+mr),Qr("%")},hp=cr.__private__.putXRef=function(){var Nr="0000000000";Qr("xref"),Qr("0 "+(Or+1)),Qr("0000000000 65535 f ");for(var nn=1;nn<=Or;nn++)typeof Ur[nn]=="function"?Qr((Nr+Ur[nn]()).slice(-10)+" 00000 n "):Ur[nn]!==void 0?Qr((Nr+Ur[nn]).slice(-10)+" 00000 n "):Qr("0000000000 00000 n ")},Ko=cr.__private__.buildDocument=function(){Dn(),wn($r),ms.publish("buildDocument"),fp(),kn(),o0(),s0(),lr!==null&&Gs(),cp(),Tu();var Nr=Zr;return hp(),up(),Qr("startxref"),Qr(""+Nr),Qr("%%EOF"),wn(_n[br]),$r.join(`
`)},_c=cr.__private__.getBlob=function(Nr){return new Blob([tn(Nr)],{type:"application/pdf"})},eu=cr.output=cr.__private__.output=Wo(function(Nr,nn){switch(typeof(nn=nn||{})=="string"?nn={filename:nn}:nn.filename=nn.filename||"generated.pdf",Nr){case void 0:return Ko();case"save":cr.save(nn.filename);break;case"arraybuffer":return tn(Ko());case"blob":return _c(Ko());case"bloburi":case"bloburl":if(n.URL!==void 0&&typeof n.URL.createObjectURL=="function")return n.URL&&n.URL.createObjectURL(_c(Ko()))||void 0;a.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var An="",jn=Ko();try{An=h(jn)}catch{An=h(unescape(encodeURIComponent(jn)))}return"data:application/pdf;filename="+nn.filename+";base64,"+An;case"pdfobjectnewwindow":if(Object.prototype.toString.call(n)==="[object Window]"){var Jn="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",as=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';nn.pdfObjectUrl&&(Jn=nn.pdfObjectUrl,as="");var _s='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Jn+'"'+as+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(nn)+");<\/script></body></html>",Cs=n.open();return Cs!==null&&Cs.document.write(_s),Cs}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(n)==="[object Window]"){var Rs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(nn.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+nn.filename+'" width="500px" height="400px" /></body></html>',js=n.open();if(js!==null){js.document.write(Rs);var Os=this;js.document.documentElement.querySelector("#pdfViewer").onload=function(){js.document.title=nn.filename,js.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Os.output("bloburl"))}}return js}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(n)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var zs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",nn)+'"></iframe></body></html>',no=n.open();if(no!==null&&(no.document.write(zs),no.document.title=nn.filename),no||typeof safari>"u")return no;break;case"datauri":case"dataurl":return n.document.location.href=this.output("datauristring",nn);default:return null}}),h0=function(Nr){return Array.isArray(bs)===!0&&bs.indexOf(Nr)>-1};switch(tr){case"pt":Xn=1;break;case"mm":Xn=72/25.4;break;case"cm":Xn=72/2.54;break;case"in":Xn=72;break;case"px":Xn=h0("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xn=12;break;case"ex":Xn=6;break;default:if(typeof tr!="number")throw new Error("Invalid unit: "+tr);Xn=tr}var _o=null;an(),Vr();var dp=function(Nr){return lr!==null?_o.encryptor(Nr,0):function(nn){return nn}},d0=cr.__private__.getPageInfo=cr.getPageInfo=function(Nr){if(isNaN(Nr)||Nr%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:os[Nr].objId,pageNumber:Nr,pageContext:os[Nr]}},Ms=cr.__private__.getPageInfoByObjId=function(Nr){if(isNaN(Nr)||Nr%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var nn in os)if(os[nn].objId===Nr)break;return d0(nn)},pp=cr.__private__.getCurrentPageInfo=cr.getCurrentPageInfo=function(){return{objId:os[br].objId,pageNumber:br,pageContext:os[br]}};cr.addPage=function(){return c0.apply(this,arguments),this},cr.setPage=function(){return u0.apply(this,arguments),wn.call(this,_n[br]),this},cr.insertPage=function(Nr){return this.addPage(),this.movePage(br,Nr),this},cr.movePage=function(Nr,nn){var An,jn;if(Nr>nn){An=_n[Nr],jn=os[Nr];for(var Jn=Nr;Jn>nn;Jn--)_n[Jn]=_n[Jn-1],os[Jn]=os[Jn-1];_n[nn]=An,os[nn]=jn,this.setPage(nn)}else if(Nr<nn){An=_n[Nr],jn=os[Nr];for(var as=Nr;as<nn;as++)_n[as]=_n[as+1],os[as]=os[as+1];_n[nn]=An,os[nn]=jn,this.setPage(nn)}return this},cr.deletePage=function(){return op.apply(this,arguments),this},cr.__private__.text=cr.text=function(Nr,nn,An,jn,Jn){var as,_s,Cs,Rs,js,Os,zs,no,io,co=(jn=jn||{}).scope||this;if(typeof Nr=="number"&&typeof nn=="number"&&(typeof An=="string"||Array.isArray(An))){var wo=An;An=nn,nn=Nr,Nr=wo}if(arguments[3]instanceof Rn?(Ar("The transform parameter of text() with a Matrix value"),io=Jn):(Cs=arguments[4],Rs=arguments[5],_typeof(zs=arguments[3])==="object"&&zs!==null||(typeof Cs=="string"&&(Rs=Cs,Cs=null),typeof zs=="string"&&(Rs=zs,zs=null),typeof zs=="number"&&(Cs=zs,zs=null),jn={flags:zs,angle:Cs,align:Rs})),isNaN(nn)||isNaN(An)||Nr==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Nr.length===0)return co;var po="",$o=!1,Fo=typeof jn.lineHeightFactor=="number"?jn.lineHeightFactor:zl,Go=co.internal.scaleFactor;function b0(eo){return eo=eo.split("	").join(Array(jn.TabLen||9).join(" ")),Eo(eo,zs)}function ju(eo){for(var to,lo=eo.concat(),ho=[],_l=lo.length;_l--;)typeof(to=lo.shift())=="string"?ho.push(to):Array.isArray(eo)&&(to.length===1||to[1]===void 0&&to[2]===void 0)?ho.push(to[0]):ho.push([to[0],to[1],to[2]]);return ho}function Bu(eo,to){var lo;if(typeof eo=="string")lo=to(eo)[0];else if(Array.isArray(eo)){for(var ho,_l,qu=eo.concat(),mu=[],T0=qu.length;T0--;)typeof(ho=qu.shift())=="string"?mu.push(to(ho)[0]):Array.isArray(ho)&&typeof ho[0]=="string"&&(_l=to(ho[0],ho[1],ho[2]),mu.push([_l[0],_l[1],_l[2]]));lo=mu}return lo}var su=!1,Uu=!0;if(typeof Nr=="string")su=!0;else if(Array.isArray(Nr)){var Wu=Nr.concat();_s=[];for(var ou,xo=Wu.length;xo--;)(typeof(ou=Wu.shift())!="string"||Array.isArray(ou)&&typeof ou[0]!="string")&&(Uu=!1);su=Uu}if(su===!1)throw new Error('Type of text must be string or Array. "'+Nr+'" is not recognized.');typeof Nr=="string"&&(Nr=Nr.match(/[\r?\n]/)?Nr.split(/\r\n|\r|\n/g):[Nr]);var lu=vn/co.internal.scaleFactor,cu=lu*(Fo-1);switch(jn.baseline){case"bottom":An-=cu;break;case"top":An+=lu-cu;break;case"hanging":An+=lu-2*cu;break;case"middle":An+=lu/2-cu}if((Os=jn.maxWidth||0)>0&&(typeof Nr=="string"?Nr=co.splitTextToSize(Nr,Os):Object.prototype.toString.call(Nr)==="[object Array]"&&(Nr=Nr.reduce(function(eo,to){return eo.concat(co.splitTextToSize(to,Os))},[]))),as={text:Nr,x:nn,y:An,options:jn,mutex:{pdfEscape:Eo,activeFontKey:ls,fonts:Zn,activeFontSize:vn}},ms.publish("preProcessText",as),Nr=as.text,Cs=(jn=as.options).angle,!(io instanceof Rn)&&Cs&&typeof Cs=="number"){Cs*=Math.PI/180,jn.rotationDirection===0&&(Cs=-Cs),vr===gr.ADVANCED&&(Cs=-Cs);var uu=Math.cos(Cs),zu=Math.sin(Cs);io=new Rn(uu,zu,-zu,uu,0,0)}else Cs&&Cs instanceof Rn&&(io=Cs);vr!==gr.ADVANCED||io||(io=xa),(js=jn.charSpace||nu)!==void 0&&(po+=_r(kr(js))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(no=jn.horizontalScale)!==void 0&&(po+=_r(100*no)+` Tz
`),jn.lang;var Ao=-1,Ep=jn.renderingMode!==void 0?jn.renderingMode:jn.stroke,$u=co.internal.getCurrentPageInfo().pageContext;switch(Ep){case 0:case!1:case"fill":Ao=0;break;case 1:case!0:case"stroke":Ao=1;break;case 2:case"fillThenStroke":Ao=2;break;case 3:case"invisible":Ao=3;break;case 4:case"fillAndAddForClipping":Ao=4;break;case 5:case"strokeAndAddPathForClipping":Ao=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ao=6;break;case 7:case"addToPathForClipping":Ao=7}var S0=$u.usedRenderingMode!==void 0?$u.usedRenderingMode:-1;Ao!==-1?po+=Ao+` Tr
`:S0!==-1&&(po+=`0 Tr
`),Ao!==-1&&($u.usedRenderingMode=Ao),Rs=jn.align||"left";var Ro,fu=vn*Fo,E0=co.internal.pageSize.getWidth(),A0=Zn[ls];js=jn.charSpace||nu,Os=jn.maxWidth||0,zs=Object.assign({autoencode:!0,noBOM:!0},jn.flags);var Fl=[],Vl=function(eo){return co.getStringUnitWidth(eo,{font:A0,charSpace:js,fontSize:vn,doKerning:!1})*vn/Go};if(Object.prototype.toString.call(Nr)==="[object Array]"){var ko;_s=ju(Nr),Rs!=="left"&&(Ro=_s.map(Vl));var yo,Pl=0;if(Rs==="right"){nn-=Ro[0],Nr=[],xo=_s.length;for(var Zo=0;Zo<xo;Zo++)Zo===0?(yo=qo(nn),ko=Jo(An)):(yo=kr(Pl-Ro[Zo]),ko=-fu),Nr.push([_s[Zo],yo,ko]),Pl=Ro[Zo]}else if(Rs==="center"){nn-=Ro[0]/2,Nr=[],xo=_s.length;for(var Qo=0;Qo<xo;Qo++)Qo===0?(yo=qo(nn),ko=Jo(An)):(yo=kr((Pl-Ro[Qo])/2),ko=-fu),Nr.push([_s[Qo],yo,ko]),Pl=Ro[Qo]}else if(Rs==="left"){Nr=[],xo=_s.length;for(var hu=0;hu<xo;hu++)Nr.push(_s[hu])}else if(Rs==="justify"&&A0.encoding==="Identity-H"){Nr=[],xo=_s.length,Os=Os!==0?Os:E0;for(var xl=0,oo=0;oo<xo;oo++)if(ko=oo===0?Jo(An):-fu,yo=oo===0?qo(nn):xl,oo<xo-1){var Hu=kr((Os-Ro[oo])/(_s[oo].split(" ").length-1)),bo=_s[oo].split(" ");Nr.push([bo[0]+" ",yo,ko]),xl=0;for(var Do=1;Do<bo.length;Do++){var du=(Vl(bo[Do-1]+" "+bo[Do])-Vl(bo[Do]))*Go+Hu;Do==bo.length-1?Nr.push([bo[Do],du,0]):Nr.push([bo[Do]+" ",du,0]),xl-=du}}else Nr.push([_s[oo],yo,ko]);Nr.push(["",xl,0])}else{if(Rs!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(Nr=[],xo=_s.length,Os=Os!==0?Os:E0,oo=0;oo<xo;oo++)ko=oo===0?Jo(An):-fu,yo=oo===0?qo(nn):0,oo<xo-1?Fl.push(_r(kr((Os-Ro[oo])/(_s[oo].split(" ").length-1)))):Fl.push(0),Nr.push([_s[oo],yo,ko])}}var k0=typeof jn.R2L=="boolean"?jn.R2L:Wn;k0===!0&&(Nr=Bu(Nr,function(eo,to,lo){return[eo.split("").reverse().join(""),to,lo]})),as={text:Nr,x:nn,y:An,options:jn,mutex:{pdfEscape:Eo,activeFontKey:ls,fonts:Zn,activeFontSize:vn}},ms.publish("postProcessText",as),Nr=as.text,$o=as.mutex.isHex||!1;var Vu=Zn[ls].encoding;Vu!=="WinAnsiEncoding"&&Vu!=="StandardEncoding"||(Nr=Bu(Nr,function(eo,to,lo){return[b0(eo),to,lo]})),_s=ju(Nr),Nr=[];for(var Xl,Gl,Ll,Yl=0,pu=1,Kl=Array.isArray(_s[0])?pu:Yl,Nl="",Xu=function(eo,to,lo){var ho="";return lo instanceof Rn?(lo=typeof jn.angle=="number"?Yn(lo,new Rn(1,0,0,1,eo,to)):Yn(new Rn(1,0,0,1,eo,to),lo),vr===gr.ADVANCED&&(lo=Yn(new Rn(1,0,0,-1,0,0),lo)),ho=lo.join(" ")+` Tm
`):ho=_r(eo)+" "+_r(to)+` Td
`,ho},Io=0;Io<_s.length;Io++){switch(Nl="",Kl){case pu:Ll=($o?"<":"(")+_s[Io][0]+($o?">":")"),Xl=parseFloat(_s[Io][1]),Gl=parseFloat(_s[Io][2]);break;case Yl:Ll=($o?"<":"(")+_s[Io]+($o?">":")"),Xl=qo(nn),Gl=Jo(An)}Fl!==void 0&&Fl[Io]!==void 0&&(Nl=Fl[Io]+` Tw
`),Io===0?Nr.push(Nl+Xu(Xl,Gl,io)+Ll):Kl===Yl?Nr.push(Nl+Ll):Kl===pu&&Nr.push(Nl+Xu(Xl,Gl,io)+Ll)}Nr=Kl===Yl?Nr.join(` Tj
T* `):Nr.join(` Tj
`),Nr+=` Tj
`;var Mo=`BT
/`;return Mo+=ls+" "+vn+` Tf
`,Mo+=_r(vn*Fo)+` TL
`,Mo+=$l+`
`,Mo+=po,Mo+=Nr,Qr(Mo+="ET"),fr[ls]=!0,co};var mp=cr.__private__.clip=cr.clip=function(Nr){return Qr(Nr==="evenodd"?"W*":"W"),this};cr.clipEvenOdd=function(){return mp("evenodd")},cr.__private__.discardPath=cr.discardPath=function(){return Qr("n"),this};var Xo=cr.__private__.isValidStyle=function(Nr){var nn=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Nr)!==-1&&(nn=!0),nn};cr.__private__.setDefaultPathOperation=cr.setDefaultPathOperation=function(Nr){return Xo(Nr)&&(or=Nr),this};var p0=cr.__private__.getStyle=cr.getStyle=function(Nr){var nn=or;switch(Nr){case"D":case"S":nn="S";break;case"F":nn="f";break;case"FD":case"DF":nn="B";break;case"f":case"f*":case"B":case"B*":nn=Nr}return nn},m0=cr.close=function(){return Qr("h"),this};cr.stroke=function(){return Qr("S"),this},cr.fill=function(Nr){return tu("f",Nr),this},cr.fillEvenOdd=function(Nr){return tu("f*",Nr),this},cr.fillStroke=function(Nr){return tu("B",Nr),this},cr.fillStrokeEvenOdd=function(Nr){return tu("B*",Nr),this};var tu=function(Nr,nn){_typeof(nn)==="object"?xp(nn,Nr):Qr(Nr)},Cu=function(Nr){Nr===null||vr===gr.ADVANCED&&Nr===void 0||(Nr=p0(Nr),Qr(Nr))};function gp(Nr,nn,An,jn,Jn){var as=new M(nn||this.boundingBox,An||this.xStep,jn||this.yStep,this.gState,Jn||this.matrix);as.stream=this.stream;var _s=Nr+"$$"+this.cloneIndex+++"$$";return $a(_s,as),as}var xp=function(Nr,nn){var An=Ls[Nr.key],jn=cs[An];if(jn instanceof B)Qr("q"),Qr(vp(nn)),jn.gState&&cr.setGState(jn.gState),Qr(Nr.matrix.toString()+" cm"),Qr("/"+An+" sh"),Qr("Q");else if(jn instanceof M){var Jn=new Rn(1,0,0,-1,0,Cl());Nr.matrix&&(Jn=Jn.multiply(Nr.matrix||xa),An=gp.call(jn,Nr.key,Nr.boundingBox,Nr.xStep,Nr.yStep,Jn).id),Qr("q"),Qr("/Pattern cs"),Qr("/"+An+" scn"),jn.gState&&cr.setGState(jn.gState),Qr(nn),Qr("Q")}},vp=function(Nr){switch(Nr){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Fu=cr.moveTo=function(Nr,nn){return Qr(_r(kr(Nr))+" "+_r(Hr(nn))+" m"),this},Wl=cr.lineTo=function(Nr,nn){return Qr(_r(kr(Nr))+" "+_r(Hr(nn))+" l"),this},Al=cr.curveTo=function(Nr,nn,An,jn,Jn,as){return Qr([_r(kr(Nr)),_r(Hr(nn)),_r(kr(An)),_r(Hr(jn)),_r(kr(Jn)),_r(Hr(as)),"c"].join(" ")),this};cr.__private__.line=cr.line=function(Nr,nn,An,jn,Jn){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||isNaN(jn)||!Xo(Jn))throw new Error("Invalid arguments passed to jsPDF.line");return vr===gr.COMPAT?this.lines([[An-Nr,jn-nn]],Nr,nn,[1,1],Jn||"S"):this.lines([[An-Nr,jn-nn]],Nr,nn,[1,1]).stroke()},cr.__private__.lines=cr.lines=function(Nr,nn,An,jn,Jn,as){var _s,Cs,Rs,js,Os,zs,no,io,co,wo,po,$o;if(typeof Nr=="number"&&($o=An,An=nn,nn=Nr,Nr=$o),jn=jn||[1,1],as=as||!1,isNaN(nn)||isNaN(An)||!Array.isArray(Nr)||!Array.isArray(jn)||!Xo(Jn)||typeof as!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Fu(nn,An),_s=jn[0],Cs=jn[1],js=Nr.length,wo=nn,po=An,Rs=0;Rs<js;Rs++)(Os=Nr[Rs]).length===2?(wo=Os[0]*_s+wo,po=Os[1]*Cs+po,Wl(wo,po)):(zs=Os[0]*_s+wo,no=Os[1]*Cs+po,io=Os[2]*_s+wo,co=Os[3]*Cs+po,wo=Os[4]*_s+wo,po=Os[5]*Cs+po,Al(zs,no,io,co,wo,po));return as&&m0(),Cu(Jn),this},cr.path=function(Nr){for(var nn=0;nn<Nr.length;nn++){var An=Nr[nn],jn=An.c;switch(An.op){case"m":Fu(jn[0],jn[1]);break;case"l":Wl(jn[0],jn[1]);break;case"c":Al.apply(this,jn);break;case"h":m0()}}return this},cr.__private__.rect=cr.rect=function(Nr,nn,An,jn,Jn){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||isNaN(jn)||!Xo(Jn))throw new Error("Invalid arguments passed to jsPDF.rect");return vr===gr.COMPAT&&(jn=-jn),Qr([_r(kr(Nr)),_r(Hr(nn)),_r(kr(An)),_r(kr(jn)),"re"].join(" ")),Cu(Jn),this},cr.__private__.triangle=cr.triangle=function(Nr,nn,An,jn,Jn,as,_s){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||isNaN(jn)||isNaN(Jn)||isNaN(as)||!Xo(_s))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[An-Nr,jn-nn],[Jn-An,as-jn],[Nr-Jn,nn-as]],Nr,nn,[1,1],_s,!0),this},cr.__private__.roundedRect=cr.roundedRect=function(Nr,nn,An,jn,Jn,as,_s){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||isNaN(jn)||isNaN(Jn)||isNaN(as)||!Xo(_s))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Cs=4/3*(Math.SQRT2-1);return Jn=Math.min(Jn,.5*An),as=Math.min(as,.5*jn),this.lines([[An-2*Jn,0],[Jn*Cs,0,Jn,as-as*Cs,Jn,as],[0,jn-2*as],[0,as*Cs,-Jn*Cs,as,-Jn,as],[2*Jn-An,0],[-Jn*Cs,0,-Jn,-as*Cs,-Jn,-as],[0,2*as-jn],[0,-as*Cs,Jn*Cs,-as,Jn,-as]],Nr+Jn,nn,[1,1],_s,!0),this},cr.__private__.ellipse=cr.ellipse=function(Nr,nn,An,jn,Jn){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||isNaN(jn)||!Xo(Jn))throw new Error("Invalid arguments passed to jsPDF.ellipse");var as=4/3*(Math.SQRT2-1)*An,_s=4/3*(Math.SQRT2-1)*jn;return Fu(Nr+An,nn),Al(Nr+An,nn-_s,Nr+as,nn-jn,Nr,nn-jn),Al(Nr-as,nn-jn,Nr-An,nn-_s,Nr-An,nn),Al(Nr-An,nn+_s,Nr-as,nn+jn,Nr,nn+jn),Al(Nr+as,nn+jn,Nr+An,nn+_s,Nr+An,nn),Cu(Jn),this},cr.__private__.circle=cr.circle=function(Nr,nn,An,jn){if(isNaN(Nr)||isNaN(nn)||isNaN(An)||!Xo(jn))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Nr,nn,An,An,jn)},cr.setFont=function(Nr,nn,An){return An&&(nn=Fr(nn,An)),ls=f0(Nr,nn,{disableWarning:!1}),this};var _p=cr.__private__.getFont=cr.getFont=function(){return Zn[f0.apply(cr,arguments)]};cr.__private__.getFontList=cr.getFontList=function(){var Nr,nn,An={};for(Nr in Mn)if(Mn.hasOwnProperty(Nr))for(nn in An[Nr]=[],Mn[Nr])Mn[Nr].hasOwnProperty(nn)&&An[Nr].push(nn);return An},cr.addFont=function(Nr,nn,An,jn,Jn){var as=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&as.indexOf(arguments[3])!==-1?Jn=arguments[3]:arguments[3]&&as.indexOf(arguments[3])==-1&&(An=Fr(An,jn)),Jn=Jn||"Identity-H",Au.call(this,Nr,nn,An,Jn)};var zl,Pu=e.lineWidth||.200025,ru=cr.__private__.getLineWidth=cr.getLineWidth=function(){return Pu},g0=cr.__private__.setLineWidth=cr.setLineWidth=function(Nr){return Pu=Nr,Qr(_r(kr(Nr))+" w"),this};cr.__private__.setLineDash=E.API.setLineDash=E.API.setLineDashPattern=function(Nr,nn){if(Nr=Nr||[],nn=nn||0,isNaN(nn)||!Array.isArray(Nr))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Nr=Nr.map(function(An){return _r(kr(An))}).join(" "),nn=_r(kr(nn)),Qr("["+Nr+"] "+nn+" d"),this};var x0=cr.__private__.getLineHeight=cr.getLineHeight=function(){return vn*zl};cr.__private__.getLineHeight=cr.getLineHeight=function(){return vn*zl};var v0=cr.__private__.setLineHeightFactor=cr.setLineHeightFactor=function(Nr){return typeof(Nr=Nr||1.15)=="number"&&(zl=Nr),this},_0=cr.__private__.getLineHeightFactor=cr.getLineHeightFactor=function(){return zl};v0(e.lineHeight);var qo=cr.__private__.getHorizontalCoordinate=function(Nr){return kr(Nr)},Jo=cr.__private__.getVerticalCoordinate=function(Nr){return vr===gr.ADVANCED?Nr:os[br].mediaBox.topRightY-os[br].mediaBox.bottomLeftY-kr(Nr)},wp=cr.__private__.getHorizontalCoordinateString=cr.getHorizontalCoordinateString=function(Nr){return _r(qo(Nr))},Tl=cr.__private__.getVerticalCoordinateString=cr.getVerticalCoordinateString=function(Nr){return _r(Jo(Nr))},zo=e.strokeColor||"0 G";cr.__private__.getStrokeColor=cr.getDrawColor=function(){return sn(zo)},cr.__private__.setStrokeColor=cr.setDrawColor=function(Nr,nn,An,jn){return zo=un({ch1:Nr,ch2:nn,ch3:An,ch4:jn,pdfColorType:"draw",precision:2}),Qr(zo),this};var Lu=e.fillColor||"0 g";cr.__private__.getFillColor=cr.getFillColor=function(){return sn(Lu)},cr.__private__.setFillColor=cr.setFillColor=function(Nr,nn,An,jn){return Lu=un({ch1:Nr,ch2:nn,ch3:An,ch4:jn,pdfColorType:"fill",precision:2}),Qr(Lu),this};var $l=e.textColor||"0 g",yp=cr.__private__.getTextColor=cr.getTextColor=function(){return sn($l)};cr.__private__.setTextColor=cr.setTextColor=function(Nr,nn,An,jn){return $l=un({ch1:Nr,ch2:nn,ch3:An,ch4:jn,pdfColorType:"text",precision:3}),this};var nu=e.charSpace,bp=cr.__private__.getCharSpace=cr.getCharSpace=function(){return parseFloat(nu||0)};cr.__private__.setCharSpace=cr.setCharSpace=function(Nr){if(isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return nu=Nr,this};var Nu=0;cr.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},cr.__private__.setLineCap=cr.setLineCap=function(Nr){var nn=cr.CapJoinStyles[Nr];if(nn===void 0)throw new Error("Line cap style of '"+Nr+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nu=nn,Qr(nn+" J"),this};var Ru=0;cr.__private__.setLineJoin=cr.setLineJoin=function(Nr){var nn=cr.CapJoinStyles[Nr];if(nn===void 0)throw new Error("Line join style of '"+Nr+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ru=nn,Qr(nn+" j"),this},cr.__private__.setLineMiterLimit=cr.__private__.setMiterLimit=cr.setLineMiterLimit=cr.setMiterLimit=function(Nr){if(Nr=Nr||0,isNaN(Nr))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Qr(_r(kr(Nr))+" M"),this},cr.GState=j,cr.setGState=function(Nr){(Nr=typeof Nr=="string"?As[yn[Nr]]:w0(null,Nr)).equals(_i)||(Qr("/"+Nr.id+" gs"),_i=Nr)};var w0=function(Nr,nn){if(!Nr||!yn[Nr]){var An=!1;for(var jn in As)if(As.hasOwnProperty(jn)&&As[jn].equals(nn)){An=!0;break}if(An)nn=As[jn];else{var Jn="GS"+(Object.keys(As).length+1).toString(10);As[Jn]=nn,nn.id=Jn}return Nr&&(yn[Nr]=nn.id),ms.publish("addGState",nn),nn}};cr.addGState=function(Nr,nn){return w0(Nr,nn),this},cr.saveGraphicsState=function(){return Qr("q"),zn.push({key:ls,size:vn,color:$l}),this},cr.restoreGraphicsState=function(){Qr("Q");var Nr=zn.pop();return ls=Nr.key,vn=Nr.size,$l=Nr.color,_i=null,this},cr.setCurrentTransformationMatrix=function(Nr){return Qr(Nr.toString()+" cm"),this},cr.comment=function(Nr){return Qr("#"+Nr),this};var iu=function(Nr,nn){var An=Nr||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return An},set:function(as){isNaN(as)||(An=parseFloat(as))}});var jn=nn||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return jn},set:function(as){isNaN(as)||(jn=parseFloat(as))}});var Jn="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Jn},set:function(as){Jn=as.toString()}}),this},Du=function(Nr,nn,An,jn){iu.call(this,Nr,nn),this.type="rect";var Jn=An||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Jn},set:function(_s){isNaN(_s)||(Jn=parseFloat(_s))}});var as=jn||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return as},set:function(_s){isNaN(_s)||(as=parseFloat(_s))}}),this},Iu=function(){this.page=rs,this.currentPage=br,this.pages=_n.slice(0),this.pagesContext=os.slice(0),this.x=ws,this.y=ds,this.matrix=Ps,this.width=Hl(br),this.height=Cl(br),this.outputDestination=Cn,this.id="",this.objectNumber=-1};Iu.prototype.restore=function(){rs=this.page,br=this.currentPage,os=this.pagesContext,_n=this.pages,ws=this.x,ds=this.y,Ps=this.matrix,Mu(br,this.width),Ou(br,this.height),Cn=this.outputDestination};var y0=function(Nr,nn,An,jn,Jn){Pn.push(new Iu),rs=br=0,_n=[],ws=Nr,ds=nn,Ps=Jn,ku([An,jn])},Sp=function(Nr){if(pn[Nr])Pn.pop().restore();else{var nn=new Iu,An="Xo"+(Object.keys(gn).length+1).toString(10);nn.id=An,pn[Nr]=An,gn[An]=nn,ms.publish("addFormObject",nn),Pn.pop().restore()}};for(var au in cr.beginFormObject=function(Nr,nn,An,jn,Jn){return y0(Nr,nn,An,jn,Jn),this},cr.endFormObject=function(Nr){return Sp(Nr),this},cr.doFormObject=function(Nr,nn){var An=gn[pn[Nr]];return Qr("q"),Qr(nn.toString()+" cm"),Qr("/"+An.id+" Do"),Qr("Q"),this},cr.getFormObject=function(Nr){var nn=gn[pn[Nr]];return{x:nn.x,y:nn.y,width:nn.width,height:nn.height,matrix:nn.matrix}},cr.save=function(Nr,nn){return Nr=Nr||"generated.pdf",(nn=nn||{}).returnPromise=nn.returnPromise||!1,nn.returnPromise===!1?(l(_c(Ko()),Nr),typeof l.unload=="function"&&n.setTimeout&&setTimeout(l.unload,911),this):new Promise(function(An,jn){try{var Jn=l(_c(Ko()),Nr);typeof l.unload=="function"&&n.setTimeout&&setTimeout(l.unload,911),An(Jn)}catch(as){jn(as.message)}})},E.API)E.API.hasOwnProperty(au)&&(au==="events"&&E.API.events.length?function(Nr,nn){var An,jn,Jn;for(Jn=nn.length-1;Jn!==-1;Jn--)An=nn[Jn][0],jn=nn[Jn][1],Nr.subscribe.apply(Nr,[An].concat(typeof jn=="function"?[jn]:jn))}(ms,E.API.events):cr[au]=E.API[au]);var Hl=cr.getPageWidth=function(Nr){return(os[Nr=Nr||br].mediaBox.topRightX-os[Nr].mediaBox.bottomLeftX)/Xn},Mu=cr.setPageWidth=function(Nr,nn){os[Nr].mediaBox.topRightX=nn*Xn+os[Nr].mediaBox.bottomLeftX},Cl=cr.getPageHeight=function(Nr){return(os[Nr=Nr||br].mediaBox.topRightY-os[Nr].mediaBox.bottomLeftY)/Xn},Ou=cr.setPageHeight=function(Nr,nn){os[Nr].mediaBox.topRightY=nn*Xn+os[Nr].mediaBox.bottomLeftY};return cr.internal={pdfEscape:Eo,getStyle:p0,getFont:_p,getFontSize:Ln,getCharSpace:bp,getTextColor:yp,getLineHeight:x0,getLineHeightFactor:_0,getLineWidth:ru,write:xn,getHorizontalCoordinate:qo,getVerticalCoordinate:Jo,getCoordinateString:wp,getVerticalCoordinateString:Tl,collections:{},newObject:ys,newAdditionalObject:Yr,newObjectDeferred:xs,newObjectDeferredBegin:Jr,getFilters:Tn,putStream:In,events:ms,scaleFactor:Xn,pageSize:{getWidth:function(){return Hl(br)},setWidth:function(Nr){Mu(br,Nr)},getHeight:function(){return Cl(br)},setHeight:function(Nr){Ou(br,Nr)}},encryptionOptions:lr,encryption:_o,getEncryptor:dp,output:eu,getNumberOfPages:lp,pages:_n,out:Qr,f2:Ir,f3:wr,getPageInfo:d0,getPageInfoByObjId:Ms,getCurrentPageInfo:pp,getPDFVersion:dr,Point:iu,Rectangle:Du,Matrix:Rn,hasHotfix:h0},Object.defineProperty(cr.internal.pageSize,"width",{get:function(){return Hl(br)},set:function(Nr){Mu(br,Nr)},enumerable:!0,configurable:!0}),Object.defineProperty(cr.internal.pageSize,"height",{get:function(){return Cl(br)},set:function(Nr){Ou(br,Nr)},enumerable:!0,configurable:!0}),sp.call(cr,on),ls="F1",c0(rr,er),ms.publish("initialized"),cr}I.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},I.prototype.toHexString=function(e){return e.split("").map(function(_e){return("0"+(255&_e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},I.prototype.hexToBytes=function(e){for(var _e=[],er=0;er<e.length;er+=2)_e.push(String.fromCharCode(parseInt(e.substr(er,2),16)));return _e.join("")},I.prototype.processOwnerPassword=function(e,_e){return P(x(_e).substr(0,5),e)},I.prototype.encryptor=function(e,_e){var er=x(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&_e,_e>>8&255)).substr(0,10);return function(tr){return P(er,tr)}},j.prototype.equals=function(e){var _e,er="id,objectNumber,equals";if(!e||_typeof(e)!==_typeof(this))return!1;var tr=0;for(_e in this)if(!(er.indexOf(_e)>=0)){if(this.hasOwnProperty(_e)&&!e.hasOwnProperty(_e)||this[_e]!==e[_e])return!1;tr++}for(_e in e)e.hasOwnProperty(_e)&&er.indexOf(_e)<0&&tr--;return tr===0},E.API={events:[]},E.version="2.5.2";var q=E.API,D=1,R=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},T=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},U=function(e){return e.toFixed(2)},z=function(e){return e.toFixed(5)};q.__acroform__={};var H=function(e,_e){e.prototype=Object.create(_e.prototype),e.prototype.constructor=e},W=function(e){return e*D},V=function(e){var _e=new ut,er=At.internal.getHeight(e)||0,tr=At.internal.getWidth(e)||0;return _e.BBox=[0,0,Number(U(tr)),Number(U(er))],_e},G=q.__acroform__.setBit=function(e,_e){if(e=e||0,_e=_e||0,isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<_e},Y=q.__acroform__.clearBit=function(e,_e){if(e=e||0,_e=_e||0,isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<_e)},J=q.__acroform__.getBit=function(e,_e){if(isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<_e?1:0},X=q.__acroform__.getBitForPdf=function(e,_e){if(isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return J(e,_e-1)},K=q.__acroform__.setBitForPdf=function(e,_e){if(isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return G(e,_e-1)},Z=q.__acroform__.clearBitForPdf=function(e,_e){if(isNaN(e)||isNaN(_e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Y(e,_e-1)},$$1=q.__acroform__.calculateCoordinates=function(e,_e){var er=_e.internal.getHorizontalCoordinate,tr=_e.internal.getVerticalCoordinate,rr=e[0],nr=e[1],ir=e[2],ar=e[3],sr={};return sr.lowerLeft_X=er(rr)||0,sr.lowerLeft_Y=tr(nr+ar)||0,sr.upperRight_X=er(rr+ir)||0,sr.upperRight_Y=tr(nr)||0,[Number(U(sr.lowerLeft_X)),Number(U(sr.lowerLeft_Y)),Number(U(sr.upperRight_X)),Number(U(sr.upperRight_Y))]},Q=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var _e=[],er=e._V||e.DV,tr=tt(e,er),rr=e.scope.internal.getFont(e.fontName,e.fontStyle).id;_e.push("/Tx BMC"),_e.push("q"),_e.push("BT"),_e.push(e.scope.__private__.encodeColorString(e.color)),_e.push("/"+rr+" "+U(tr.fontSize)+" Tf"),_e.push("1 0 0 1 0 0 Tm"),_e.push(tr.text),_e.push("ET"),_e.push("Q"),_e.push("EMC");var nr=V(e);return nr.scope=e.scope,nr.stream=_e.join(`
`),nr}},tt=function(e,_e){var er=e.fontSize===0?e.maxFontSize:e.fontSize,tr={text:"",fontSize:""},rr=(_e=(_e=_e.substr(0,1)=="("?_e.substr(1):_e).substr(_e.length-1)==")"?_e.substr(0,_e.length-1):_e).split(" ");rr=e.multiline?rr.map(function(wr){return wr.split(`
`)}):rr.map(function(wr){return[wr]});var nr=er,ir=At.internal.getHeight(e)||0;ir=ir<0?-ir:ir;var ar=At.internal.getWidth(e)||0;ar=ar<0?-ar:ar;var sr=function(wr,kr,Mr){if(wr+1<rr.length){var Hr=kr+" "+rr[wr+1][0];return et(Hr,e,Mr).width<=ar-4}return!1};nr++;e:for(;nr>0;){_e="",nr--;var or,lr,ur=et("3",e,nr).height,fr=e.multiline?ir-nr:(ir-ur)/2,cr=fr+=2,mr=0,dr=0,xr=0;if(nr<=0){_e=`(...) Tj
`,_e+="% Width of Text: "+et(_e,e,nr=12).width+", FieldWidth:"+ar+`
`;break}for(var pr="",gr=0,vr=0;vr<rr.length;vr++)if(rr.hasOwnProperty(vr)){var Cr=!1;if(rr[vr].length!==1&&xr!==rr[vr].length-1){if((ur+2)*(gr+2)+2>ir)continue e;pr+=rr[vr][xr],Cr=!0,dr=vr,vr--}else{pr=(pr+=rr[vr][xr]+" ").substr(pr.length-1)==" "?pr.substr(0,pr.length-1):pr;var Tr=parseInt(vr),Fr=sr(Tr,pr,nr),_r=vr>=rr.length-1;if(Fr&&!_r){pr+=" ",xr=0;continue}if(Fr||_r){if(_r)dr=Tr;else if(e.multiline&&(ur+2)*(gr+2)+2>ir)continue e}else{if(!e.multiline||(ur+2)*(gr+2)+2>ir)continue e;dr=Tr}}for(var Ar="",Pr=mr;Pr<=dr;Pr++){var Ir=rr[Pr];if(e.multiline){if(Pr===dr){Ar+=Ir[xr]+" ",xr=(xr+1)%Ir.length;continue}if(Pr===mr){Ar+=Ir[Ir.length-1]+" ";continue}}Ar+=Ir[0]+" "}switch(Ar=Ar.substr(Ar.length-1)==" "?Ar.substr(0,Ar.length-1):Ar,lr=et(Ar,e,nr).width,e.textAlign){case"right":or=ar-lr-2;break;case"center":or=(ar-lr)/2;break;case"left":default:or=2}_e+=U(or)+" "+U(cr)+` Td
`,_e+="("+R(Ar)+`) Tj
`,_e+=-U(or)+` 0 Td
`,cr=-(nr+2),lr=0,mr=Cr?dr:dr+1,gr++,pr=""}break}return tr.text=_e,tr.fontSize=nr,tr},et=function(e,_e,er){var tr=_e.scope.internal.getFont(_e.fontName,_e.fontStyle),rr=_e.scope.getStringUnitWidth(e,{font:tr,fontSize:parseFloat(er),charSpace:0})*parseFloat(er);return{height:_e.scope.getStringUnitWidth("3",{font:tr,fontSize:parseFloat(er),charSpace:0})*parseFloat(er)*1.5,width:rr}},rt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},nt=function(e,_e){var er={type:"reference",object:e};_e.internal.getPageInfo(e.page).pageContext.annotations.find(function(tr){return tr.type===er.type&&tr.object===er.object})===void 0&&_e.internal.getPageInfo(e.page).pageContext.annotations.push(er)},it=function(e,_e){for(var er in e)if(e.hasOwnProperty(er)){var tr=er,rr=e[er];_e.internal.newObjectDeferredBegin(rr.objId,!0),_typeof(rr)==="object"&&typeof rr.putStream=="function"&&rr.putStream(),delete e[tr]}},at=function(e,_e){if(_e.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(lt.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(rt)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");D=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new ht,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(er){er.internal.events.unsubscribe(er.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete er.internal.acroformPlugin.acroFormDictionaryRoot._eventID,er.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(er){er.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var tr=er.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var rr in tr)if(tr.hasOwnProperty(rr)){var nr=tr[rr];nr.objId=void 0,nr.hasAnnotation&&nt(nr,er)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(er){if(er.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");er.internal.write("/AcroForm "+er.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(er){(function(tr,rr){var nr=!tr;for(var ir in tr||(rr.internal.newObjectDeferredBegin(rr.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),rr.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),tr=tr||rr.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(tr.hasOwnProperty(ir)){var ar=tr[ir],sr=[],or=ar.Rect;if(ar.Rect&&(ar.Rect=$$1(ar.Rect,rr)),rr.internal.newObjectDeferredBegin(ar.objId,!0),ar.DA=At.createDefaultAppearanceStream(ar),_typeof(ar)==="object"&&typeof ar.getKeyValueListForStream=="function"&&(sr=ar.getKeyValueListForStream()),ar.Rect=or,ar.hasAppearanceStream&&!ar.appearanceStreamContent){var lr=Q(ar);sr.push({key:"AP",value:"<</N "+lr+">>"}),rr.internal.acroformPlugin.xForms.push(lr)}if(ar.appearanceStreamContent){var ur="";for(var fr in ar.appearanceStreamContent)if(ar.appearanceStreamContent.hasOwnProperty(fr)){var cr=ar.appearanceStreamContent[fr];if(ur+="/"+fr+" ",ur+="<<",Object.keys(cr).length>=1||Array.isArray(cr)){for(var ir in cr)if(cr.hasOwnProperty(ir)){var mr=cr[ir];typeof mr=="function"&&(mr=mr.call(rr,ar)),ur+="/"+ir+" "+mr+" ",rr.internal.acroformPlugin.xForms.indexOf(mr)>=0||rr.internal.acroformPlugin.xForms.push(mr)}}else typeof(mr=cr)=="function"&&(mr=mr.call(rr,ar)),ur+="/"+ir+" "+mr,rr.internal.acroformPlugin.xForms.indexOf(mr)>=0||rr.internal.acroformPlugin.xForms.push(mr);ur+=">>"}sr.push({key:"AP",value:`<<
`+ur+">>"})}rr.internal.putStream({additionalKeyValues:sr,objectId:ar.objId}),rr.internal.out("endobj")}nr&&it(rr.internal.acroformPlugin.xForms,rr)})(er,e)}),e.internal.acroformPlugin.isInitialized=!0}},ot=q.__acroform__.arrayToPdfArray=function(e,_e,er){var tr=function(ir){return ir};if(Array.isArray(e)){for(var rr="[",nr=0;nr<e.length;nr++)switch(nr!==0&&(rr+=" "),_typeof(e[nr])){case"boolean":case"number":case"object":rr+=e[nr].toString();break;case"string":e[nr].substr(0,1)!=="/"?(_e!==void 0&&er&&(tr=er.internal.getEncryptor(_e)),rr+="("+R(tr(e[nr].toString()))+")"):rr+=e[nr].toString()}return rr+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},st=function(e,_e,er){var tr=function(rr){return rr};return _e!==void 0&&er&&(tr=er.internal.getEncryptor(_e)),(e=e||"").toString(),e="("+R(tr(e))+")"},ct=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ct.prototype.toString=function(){return this.objId+" 0 R"},ct.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ct.prototype.getKeyValueListForStream=function(){var e=[],_e=Object.getOwnPropertyNames(this).filter(function(nr){return nr!="content"&&nr!="appearanceStreamContent"&&nr!="scope"&&nr!="objId"&&nr.substring(0,1)!="_"});for(var er in _e)if(Object.getOwnPropertyDescriptor(this,_e[er]).configurable===!1){var tr=_e[er],rr=this[tr];rr&&(Array.isArray(rr)?e.push({key:tr,value:ot(rr,this.objId,this.scope)}):rr instanceof ct?(rr.scope=this.scope,e.push({key:tr,value:rr.objId+" 0 R"})):typeof rr!="function"&&e.push({key:tr,value:rr}))}return e};var ut=function(){ct.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,_e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return _e},set:function(er){_e=er}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(er){e=er.trim()},get:function(){return e||null}})};H(ut,ct);var ht=function(){ct.call(this);var e,_e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return _e.length>0?_e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return _e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var er=function(tr){return tr};return this.scope&&(er=this.scope.internal.getEncryptor(this.objId)),"("+R(er(e))+")"}},set:function(er){e=er}})};H(ht,ct);var lt=function e(){ct.call(this);var _e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return _e},set:function(pr){if(isNaN(pr))throw new Error('Invalid value "'+pr+'" for attribute F supplied.');_e=pr}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!X(_e,3)},set:function(pr){pr?this.F=K(_e,3):this.F=Z(_e,3)}});var er=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return er},set:function(pr){if(isNaN(pr))throw new Error('Invalid value "'+pr+'" for attribute Ff supplied.');er=pr}});var tr=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(tr.length!==0)return tr},set:function(pr){tr=pr!==void 0?pr:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!tr||isNaN(tr[0])?0:tr[0]},set:function(pr){tr[0]=pr}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!tr||isNaN(tr[1])?0:tr[1]},set:function(pr){tr[1]=pr}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!tr||isNaN(tr[2])?0:tr[2]},set:function(pr){tr[2]=pr}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!tr||isNaN(tr[3])?0:tr[3]},set:function(pr){tr[3]=pr}});var rr="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return rr},set:function(pr){switch(pr){case"/Btn":case"/Tx":case"/Ch":case"/Sig":rr=pr;break;default:throw new Error('Invalid value "'+pr+'" for attribute FT supplied.')}}});var nr=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!nr||nr.length<1){if(this instanceof yt)return;nr="FieldObject"+e.FieldNum++}var pr=function(gr){return gr};return this.scope&&(pr=this.scope.internal.getEncryptor(this.objId)),"("+R(pr(nr))+")"},set:function(pr){nr=pr.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return nr},set:function(pr){nr=pr}});var ir="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return ir},set:function(pr){ir=pr}});var ar="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return ar},set:function(pr){ar=pr}});var sr=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return sr},set:function(pr){sr=pr}});var or=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return or===void 0?50/D:or},set:function(pr){or=pr}});var lr="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return lr},set:function(pr){lr=pr}});var ur="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!ur||this instanceof yt||this instanceof Nt))return st(ur,this.objId,this.scope)},set:function(pr){pr=pr.toString(),ur=pr}});var fr=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(fr)return this instanceof mt?fr:st(fr,this.objId,this.scope)},set:function(pr){pr=pr.toString(),fr=this instanceof mt?pr:pr.substr(0,1)==="("?T(pr.substr(1,pr.length-2)):T(pr)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt?T(fr.substr(1,fr.length-1)):fr},set:function(pr){pr=pr.toString(),fr=this instanceof mt?"/"+pr:pr}});var cr=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(cr)return cr},set:function(pr){this.V=pr}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(cr)return this instanceof mt?cr:st(cr,this.objId,this.scope)},set:function(pr){pr=pr.toString(),cr=this instanceof mt?pr:pr.substr(0,1)==="("?T(pr.substr(1,pr.length-2)):T(pr)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt?T(cr.substr(1,cr.length-1)):cr},set:function(pr){pr=pr.toString(),cr=this instanceof mt?"/"+pr:pr}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var mr,dr=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return dr},set:function(pr){pr=!!pr,dr=pr}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(mr)return mr},set:function(pr){mr=pr}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,1)},set:function(pr){pr?this.Ff=K(this.Ff,1):this.Ff=Z(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,2)},set:function(pr){pr?this.Ff=K(this.Ff,2):this.Ff=Z(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,3)},set:function(pr){pr?this.Ff=K(this.Ff,3):this.Ff=Z(this.Ff,3)}});var xr=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(xr!==null)return xr},set:function(pr){if([0,1,2].indexOf(pr)===-1)throw new Error('Invalid value "'+pr+'" for attribute Q supplied.');xr=pr}}),Object.defineProperty(this,"textAlign",{get:function(){var pr;switch(xr){case 0:default:pr="left";break;case 1:pr="center";break;case 2:pr="right"}return pr},configurable:!0,enumerable:!0,set:function(pr){switch(pr){case"right":case 2:xr=2;break;case"center":case 1:xr=1;break;case"left":case 0:default:xr=0}}})};H(lt,ct);var ft=function(){lt.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(er){e=er}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(er){e=er}});var _e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ot(_e,this.objId,this.scope)},set:function(er){var tr,rr;rr=[],typeof(tr=er)=="string"&&(rr=function(nr,ir,ar){ar||(ar=1);for(var sr,or=[];sr=ir.exec(nr);)or.push(sr[ar]);return or}(tr,/\((.*?)\)/g)),_e=rr}}),this.getOptions=function(){return _e},this.setOptions=function(er){_e=er,this.sort&&_e.sort()},this.addOption=function(er){er=(er=er||"").toString(),_e.push(er),this.sort&&_e.sort()},this.removeOption=function(er,tr){for(tr=tr||!1,er=(er=er||"").toString();_e.indexOf(er)!==-1&&(_e.splice(_e.indexOf(er),1),tr!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,18)},set:function(er){er?this.Ff=K(this.Ff,18):this.Ff=Z(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,19)},set:function(er){this.combo===!0&&(er?this.Ff=K(this.Ff,19):this.Ff=Z(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,20)},set:function(er){er?(this.Ff=K(this.Ff,20),_e.sort()):this.Ff=Z(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,22)},set:function(er){er?this.Ff=K(this.Ff,22):this.Ff=Z(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,23)},set:function(er){er?this.Ff=K(this.Ff,23):this.Ff=Z(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,27)},set:function(er){er?this.Ff=K(this.Ff,27):this.Ff=Z(this.Ff,27)}}),this.hasAppearanceStream=!1};H(ft,lt);var dt=function(){ft.call(this),this.fontName="helvetica",this.combo=!1};H(dt,ft);var pt=function(){dt.call(this),this.combo=!0};H(pt,dt);var gt=function(){pt.call(this),this.edit=!0};H(gt,pt);var mt=function(){lt.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,15)},set:function(er){er?this.Ff=K(this.Ff,15):this.Ff=Z(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,16)},set:function(er){er?this.Ff=K(this.Ff,16):this.Ff=Z(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,17)},set:function(er){er?this.Ff=K(this.Ff,17):this.Ff=Z(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,26)},set:function(er){er?this.Ff=K(this.Ff,26):this.Ff=Z(this.Ff,26)}});var e,_e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var er=function(nr){return nr};if(this.scope&&(er=this.scope.internal.getEncryptor(this.objId)),Object.keys(_e).length!==0){var tr,rr=[];for(tr in rr.push("<<"),_e)rr.push("/"+tr+" ("+R(er(_e[tr]))+")");return rr.push(">>"),rr.join(`
`)}},set:function(er){_typeof(er)==="object"&&(_e=er)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return _e.CA||""},set:function(er){typeof er=="string"&&(_e.CA=er)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(er){e=er}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(er){e="/"+er}})};H(mt,lt);var vt=function(){mt.call(this),this.pushButton=!0};H(vt,mt);var bt=function(){mt.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(_e){e=_e!==void 0?_e:[]}})};H(bt,mt);var yt=function(){var e,_e;lt.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(rr){e=rr}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return _e},set:function(rr){_e=rr}});var er,tr={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var rr=function(ar){return ar};this.scope&&(rr=this.scope.internal.getEncryptor(this.objId));var nr,ir=[];for(nr in ir.push("<<"),tr)ir.push("/"+nr+" ("+R(rr(tr[nr]))+")");return ir.push(">>"),ir.join(`
`)},set:function(rr){_typeof(rr)==="object"&&(tr=rr)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return tr.CA||""},set:function(rr){typeof rr=="string"&&(tr.CA=rr)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return er},set:function(rr){er=rr}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return er.substr(1,er.length-1)},set:function(rr){er="/"+rr}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=At.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};H(yt,lt),bt.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var _e in this.Kids)if(this.Kids.hasOwnProperty(_e)){var er=this.Kids[_e];er.appearanceStreamContent=e.createAppearanceStream(er.optionName),er.caption=e.getCA()}},bt.prototype.createOption=function(e){var _e=new yt;return _e.Parent=this,_e.optionName=e,this.Kids.push(_e),xt.call(this.scope,_e),_e};var wt=function(){mt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=At.CheckBox.createAppearanceStream()};H(wt,mt);var Nt=function(){lt.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,13)},set:function(_e){_e?this.Ff=K(this.Ff,13):this.Ff=Z(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,21)},set:function(_e){_e?this.Ff=K(this.Ff,21):this.Ff=Z(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,23)},set:function(_e){_e?this.Ff=K(this.Ff,23):this.Ff=Z(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,24)},set:function(_e){_e?this.Ff=K(this.Ff,24):this.Ff=Z(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,25)},set:function(_e){_e?this.Ff=K(this.Ff,25):this.Ff=Z(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,26)},set:function(_e){_e?this.Ff=K(this.Ff,26):this.Ff=Z(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(_e){e=_e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(_e){Number.isInteger(_e)&&(e=_e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};H(Nt,lt);var Lt=function(){Nt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!X(this.Ff,14)},set:function(e){e?this.Ff=K(this.Ff,14):this.Ff=Z(this.Ff,14)}}),this.password=!0};H(Lt,Nt);var At={CheckBox:{createAppearanceStream:function(){return{N:{On:At.CheckBox.YesNormal},D:{On:At.CheckBox.YesPushDown,Off:At.CheckBox.OffPushDown}}},YesPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=[],tr=e.scope.internal.getFont(e.fontName,e.fontStyle).id,rr=e.scope.__private__.encodeColorString(e.color),nr=tt(e,e.caption);return er.push("0.749023 g"),er.push("0 0 "+U(At.internal.getWidth(e))+" "+U(At.internal.getHeight(e))+" re"),er.push("f"),er.push("BMC"),er.push("q"),er.push("0 0 1 rg"),er.push("/"+tr+" "+U(nr.fontSize)+" Tf "+rr),er.push("BT"),er.push(nr.text),er.push("ET"),er.push("Q"),er.push("EMC"),_e.stream=er.join(`
`),_e},YesNormal:function(e){var _e=V(e);_e.scope=e.scope;var er=e.scope.internal.getFont(e.fontName,e.fontStyle).id,tr=e.scope.__private__.encodeColorString(e.color),rr=[],nr=At.internal.getHeight(e),ir=At.internal.getWidth(e),ar=tt(e,e.caption);return rr.push("1 g"),rr.push("0 0 "+U(ir)+" "+U(nr)+" re"),rr.push("f"),rr.push("q"),rr.push("0 0 1 rg"),rr.push("0 0 "+U(ir-1)+" "+U(nr-1)+" re"),rr.push("W"),rr.push("n"),rr.push("0 g"),rr.push("BT"),rr.push("/"+er+" "+U(ar.fontSize)+" Tf "+tr),rr.push(ar.text),rr.push("ET"),rr.push("Q"),_e.stream=rr.join(`
`),_e},OffPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=[];return er.push("0.749023 g"),er.push("0 0 "+U(At.internal.getWidth(e))+" "+U(At.internal.getHeight(e))+" re"),er.push("f"),_e.stream=er.join(`
`),_e}},RadioButton:{Circle:{createAppearanceStream:function(e){var _e={D:{Off:At.RadioButton.Circle.OffPushDown},N:{}};return _e.N[e]=At.RadioButton.Circle.YesNormal,_e.D[e]=At.RadioButton.Circle.YesPushDown,_e},getCA:function(){return"l"},YesNormal:function(e){var _e=V(e);_e.scope=e.scope;var er=[],tr=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;tr=Number((.9*tr).toFixed(5));var rr=At.internal.Bezier_C,nr=Number((tr*rr).toFixed(5));return er.push("q"),er.push("1 0 0 1 "+z(At.internal.getWidth(e)/2)+" "+z(At.internal.getHeight(e)/2)+" cm"),er.push(tr+" 0 m"),er.push(tr+" "+nr+" "+nr+" "+tr+" 0 "+tr+" c"),er.push("-"+nr+" "+tr+" -"+tr+" "+nr+" -"+tr+" 0 c"),er.push("-"+tr+" -"+nr+" -"+nr+" -"+tr+" 0 -"+tr+" c"),er.push(nr+" -"+tr+" "+tr+" -"+nr+" "+tr+" 0 c"),er.push("f"),er.push("Q"),_e.stream=er.join(`
`),_e},YesPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=[],tr=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;tr=Number((.9*tr).toFixed(5));var rr=Number((2*tr).toFixed(5)),nr=Number((rr*At.internal.Bezier_C).toFixed(5)),ir=Number((tr*At.internal.Bezier_C).toFixed(5));return er.push("0.749023 g"),er.push("q"),er.push("1 0 0 1 "+z(At.internal.getWidth(e)/2)+" "+z(At.internal.getHeight(e)/2)+" cm"),er.push(rr+" 0 m"),er.push(rr+" "+nr+" "+nr+" "+rr+" 0 "+rr+" c"),er.push("-"+nr+" "+rr+" -"+rr+" "+nr+" -"+rr+" 0 c"),er.push("-"+rr+" -"+nr+" -"+nr+" -"+rr+" 0 -"+rr+" c"),er.push(nr+" -"+rr+" "+rr+" -"+nr+" "+rr+" 0 c"),er.push("f"),er.push("Q"),er.push("0 g"),er.push("q"),er.push("1 0 0 1 "+z(At.internal.getWidth(e)/2)+" "+z(At.internal.getHeight(e)/2)+" cm"),er.push(tr+" 0 m"),er.push(tr+" "+ir+" "+ir+" "+tr+" 0 "+tr+" c"),er.push("-"+ir+" "+tr+" -"+tr+" "+ir+" -"+tr+" 0 c"),er.push("-"+tr+" -"+ir+" -"+ir+" -"+tr+" 0 -"+tr+" c"),er.push(ir+" -"+tr+" "+tr+" -"+ir+" "+tr+" 0 c"),er.push("f"),er.push("Q"),_e.stream=er.join(`
`),_e},OffPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=[],tr=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;tr=Number((.9*tr).toFixed(5));var rr=Number((2*tr).toFixed(5)),nr=Number((rr*At.internal.Bezier_C).toFixed(5));return er.push("0.749023 g"),er.push("q"),er.push("1 0 0 1 "+z(At.internal.getWidth(e)/2)+" "+z(At.internal.getHeight(e)/2)+" cm"),er.push(rr+" 0 m"),er.push(rr+" "+nr+" "+nr+" "+rr+" 0 "+rr+" c"),er.push("-"+nr+" "+rr+" -"+rr+" "+nr+" -"+rr+" 0 c"),er.push("-"+rr+" -"+nr+" -"+nr+" -"+rr+" 0 -"+rr+" c"),er.push(nr+" -"+rr+" "+rr+" -"+nr+" "+rr+" 0 c"),er.push("f"),er.push("Q"),_e.stream=er.join(`
`),_e}},Cross:{createAppearanceStream:function(e){var _e={D:{Off:At.RadioButton.Cross.OffPushDown},N:{}};return _e.N[e]=At.RadioButton.Cross.YesNormal,_e.D[e]=At.RadioButton.Cross.YesPushDown,_e},getCA:function(){return"8"},YesNormal:function(e){var _e=V(e);_e.scope=e.scope;var er=[],tr=At.internal.calculateCross(e);return er.push("q"),er.push("1 1 "+U(At.internal.getWidth(e)-2)+" "+U(At.internal.getHeight(e)-2)+" re"),er.push("W"),er.push("n"),er.push(U(tr.x1.x)+" "+U(tr.x1.y)+" m"),er.push(U(tr.x2.x)+" "+U(tr.x2.y)+" l"),er.push(U(tr.x4.x)+" "+U(tr.x4.y)+" m"),er.push(U(tr.x3.x)+" "+U(tr.x3.y)+" l"),er.push("s"),er.push("Q"),_e.stream=er.join(`
`),_e},YesPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=At.internal.calculateCross(e),tr=[];return tr.push("0.749023 g"),tr.push("0 0 "+U(At.internal.getWidth(e))+" "+U(At.internal.getHeight(e))+" re"),tr.push("f"),tr.push("q"),tr.push("1 1 "+U(At.internal.getWidth(e)-2)+" "+U(At.internal.getHeight(e)-2)+" re"),tr.push("W"),tr.push("n"),tr.push(U(er.x1.x)+" "+U(er.x1.y)+" m"),tr.push(U(er.x2.x)+" "+U(er.x2.y)+" l"),tr.push(U(er.x4.x)+" "+U(er.x4.y)+" m"),tr.push(U(er.x3.x)+" "+U(er.x3.y)+" l"),tr.push("s"),tr.push("Q"),_e.stream=tr.join(`
`),_e},OffPushDown:function(e){var _e=V(e);_e.scope=e.scope;var er=[];return er.push("0.749023 g"),er.push("0 0 "+U(At.internal.getWidth(e))+" "+U(At.internal.getHeight(e))+" re"),er.push("f"),_e.stream=er.join(`
`),_e}}},createDefaultAppearanceStream:function(e){var _e=e.scope.internal.getFont(e.fontName,e.fontStyle).id,er=e.scope.__private__.encodeColorString(e.color);return"/"+_e+" "+e.fontSize+" Tf "+er}};At.internal={Bezier_C:.551915024494,calculateCross:function(e){var _e=At.internal.getWidth(e),er=At.internal.getHeight(e),tr=Math.min(_e,er);return{x1:{x:(_e-tr)/2,y:(er-tr)/2+tr},x2:{x:(_e-tr)/2+tr,y:(er-tr)/2},x3:{x:(_e-tr)/2,y:(er-tr)/2},x4:{x:(_e-tr)/2+tr,y:(er-tr)/2+tr}}}},At.internal.getWidth=function(e){var _e=0;return _typeof(e)==="object"&&(_e=W(e.Rect[2])),_e},At.internal.getHeight=function(e){var _e=0;return _typeof(e)==="object"&&(_e=W(e.Rect[3])),_e};var xt=q.addField=function(e){if(at(this,e),!(e instanceof lt))throw new Error("Invalid argument passed to jsPDF.addField.");var _e;return(_e=e).scope.internal.acroformPlugin.printedOut&&(_e.scope.internal.acroformPlugin.printedOut=!1,_e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),_e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(_e),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};q.AcroFormChoiceField=ft,q.AcroFormListBox=dt,q.AcroFormComboBox=pt,q.AcroFormEditBox=gt,q.AcroFormButton=mt,q.AcroFormPushButton=vt,q.AcroFormRadioButton=bt,q.AcroFormCheckBox=wt,q.AcroFormTextField=Nt,q.AcroFormPasswordField=Lt,q.AcroFormAppearance=At,q.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:At},E.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:At};var St=E.AcroForm;function _t(e){return e.reduce(function(_e,er,tr){return _e[er]=tr,_e},{})}(function(e){e.__addimage__={};var _e="UNKNOWN",er={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},tr=e.__addimage__.getImageFileTypeByImageData=function(wr,kr){var Mr,Hr,Gr,zr,Br,Vr=_e;if((kr=kr||_e)==="RGBA"||wr.data!==void 0&&wr.data instanceof Uint8ClampedArray&&"height"in wr&&"width"in wr)return"RGBA";if(Fr(wr))for(Br in er)for(Gr=er[Br],Mr=0;Mr<Gr.length;Mr+=1){for(zr=!0,Hr=0;Hr<Gr[Mr].length;Hr+=1)if(Gr[Mr][Hr]!==void 0&&Gr[Mr][Hr]!==wr[Hr]){zr=!1;break}if(zr===!0){Vr=Br;break}}else for(Br in er)for(Gr=er[Br],Mr=0;Mr<Gr.length;Mr+=1){for(zr=!0,Hr=0;Hr<Gr[Mr].length;Hr+=1)if(Gr[Mr][Hr]!==void 0&&Gr[Mr][Hr]!==wr.charCodeAt(Hr)){zr=!1;break}if(zr===!0){Vr=Br;break}}return Vr===_e&&kr!==_e&&(Vr=kr),Vr},rr=function wr(kr){for(var Mr=this.internal.write,Hr=this.internal.putStream,Gr=(0,this.internal.getFilters)();Gr.indexOf("FlateEncode")!==-1;)Gr.splice(Gr.indexOf("FlateEncode"),1);kr.objectId=this.internal.newObject();var zr=[];if(zr.push({key:"Type",value:"/XObject"}),zr.push({key:"Subtype",value:"/Image"}),zr.push({key:"Width",value:kr.width}),zr.push({key:"Height",value:kr.height}),kr.colorSpace===xr.INDEXED?zr.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(kr.palette.length/3-1)+" "+("sMask"in kr&&kr.sMask!==void 0?kr.objectId+2:kr.objectId+1)+" 0 R]"}):(zr.push({key:"ColorSpace",value:"/"+kr.colorSpace}),kr.colorSpace===xr.DEVICE_CMYK&&zr.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),zr.push({key:"BitsPerComponent",value:kr.bitsPerComponent}),"decodeParameters"in kr&&kr.decodeParameters!==void 0&&zr.push({key:"DecodeParms",value:"<<"+kr.decodeParameters+">>"}),"transparency"in kr&&Array.isArray(kr.transparency)){for(var Br="",Vr=0,Rr=kr.transparency.length;Vr<Rr;Vr++)Br+=kr.transparency[Vr]+" "+kr.transparency[Vr]+" ";zr.push({key:"Mask",value:"["+Br+"]"})}kr.sMask!==void 0&&zr.push({key:"SMask",value:kr.objectId+1+" 0 R"});var Xr=kr.filter!==void 0?["/"+kr.filter]:void 0;if(Hr({data:kr.data,additionalKeyValues:zr,alreadyAppliedFilters:Xr,objectId:kr.objectId}),Mr("endobj"),"sMask"in kr&&kr.sMask!==void 0){var an="/Predictor "+kr.predictor+" /Colors 1 /BitsPerComponent "+kr.bitsPerComponent+" /Columns "+kr.width,yr={width:kr.width,height:kr.height,colorSpace:"DeviceGray",bitsPerComponent:kr.bitsPerComponent,decodeParameters:an,data:kr.sMask};"filter"in kr&&(yr.filter=kr.filter),wr.call(this,yr)}if(kr.colorSpace===xr.INDEXED){var br=this.internal.newObject();Hr({data:Ar(new Uint8Array(kr.palette)),objectId:br}),Mr("endobj")}},nr=function(){var wr=this.internal.collections.addImage_images;for(var kr in wr)rr.call(this,wr[kr])},ir=function(){var wr,kr=this.internal.collections.addImage_images,Mr=this.internal.write;for(var Hr in kr)Mr("/I"+(wr=kr[Hr]).index,wr.objectId,"0","R")},ar=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",nr),this.internal.events.subscribe("putXobjectDict",ir))},sr=function(){var wr=this.internal.collections.addImage_images;return ar.call(this),wr},or=function(){return Object.keys(this.internal.collections.addImage_images).length},lr=function(wr){return typeof e["process"+wr.toUpperCase()]=="function"},ur=function(wr){return _typeof(wr)==="object"&&wr.nodeType===1},fr=function(wr,kr){if(wr.nodeName==="IMG"&&wr.hasAttribute("src")){var Mr=""+wr.getAttribute("src");if(Mr.indexOf("data:image/")===0)return u(unescape(Mr).split("base64,").pop());var Hr=e.loadFile(Mr,!0);if(Hr!==void 0)return Hr}if(wr.nodeName==="CANVAS"){if(wr.width===0||wr.height===0)throw new Error("Given canvas must have data. Canvas width: "+wr.width+", height: "+wr.height);var Gr;switch(kr){case"PNG":Gr="image/png";break;case"WEBP":Gr="image/webp";break;case"JPEG":case"JPG":default:Gr="image/jpeg"}return u(wr.toDataURL(Gr,1).split("base64,").pop())}},cr=function(wr){var kr=this.internal.collections.addImage_images;if(kr){for(var Mr in kr)if(wr===kr[Mr].alias)return kr[Mr]}},mr=function(wr,kr,Mr){return wr||kr||(wr=-96,kr=-96),wr<0&&(wr=-1*Mr.width*72/wr/this.internal.scaleFactor),kr<0&&(kr=-1*Mr.height*72/kr/this.internal.scaleFactor),wr===0&&(wr=kr*Mr.width/Mr.height),kr===0&&(kr=wr*Mr.height/Mr.width),[wr,kr]},dr=function(wr,kr,Mr,Hr,Gr,zr){var Br=mr.call(this,Mr,Hr,Gr),Vr=this.internal.getCoordinateString,Rr=this.internal.getVerticalCoordinateString,Xr=sr.call(this);if(Mr=Br[0],Hr=Br[1],Xr[Gr.index]=Gr,zr){zr*=Math.PI/180;var an=Math.cos(zr),yr=Math.sin(zr),br=function(Lr){return Lr.toFixed(4)},Er=[br(an),br(yr),br(-1*yr),br(an),0,0,"cm"]}this.internal.write("q"),zr?(this.internal.write([1,"0","0",1,Vr(wr),Rr(kr+Hr),"cm"].join(" ")),this.internal.write(Er.join(" ")),this.internal.write([Vr(Mr),"0","0",Vr(Hr),"0","0","cm"].join(" "))):this.internal.write([Vr(Mr),"0","0",Vr(Hr),Vr(wr),Rr(kr+Hr),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Gr.index+" Do"),this.internal.write("Q")},xr=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var pr=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},gr=e.__addimage__.sHashCode=function(wr){var kr,Mr,Hr=0;if(typeof wr=="string")for(Mr=wr.length,kr=0;kr<Mr;kr++)Hr=(Hr<<5)-Hr+wr.charCodeAt(kr),Hr|=0;else if(Fr(wr))for(Mr=wr.byteLength/2,kr=0;kr<Mr;kr++)Hr=(Hr<<5)-Hr+wr[kr],Hr|=0;return Hr},vr=e.__addimage__.validateStringAsBase64=function(wr){(wr=wr||"").toString().trim();var kr=!0;return wr.length===0&&(kr=!1),wr.length%4!=0&&(kr=!1),/^[A-Za-z0-9+/]+$/.test(wr.substr(0,wr.length-2))===!1&&(kr=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(wr.substr(-2))===!1&&(kr=!1),kr},Cr=e.__addimage__.extractImageFromDataUrl=function(wr){var kr=(wr=wr||"").split("base64,"),Mr=null;if(kr.length===2){var Hr=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(kr[0]);Array.isArray(Hr)&&(Mr={mimeType:Hr[1],charset:Hr[2],data:kr[1]})}return Mr},Tr=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(wr){return Tr()&&wr instanceof ArrayBuffer};var Fr=e.__addimage__.isArrayBufferView=function(wr){return Tr()&&typeof Uint32Array<"u"&&(wr instanceof Int8Array||wr instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&wr instanceof Uint8ClampedArray||wr instanceof Int16Array||wr instanceof Uint16Array||wr instanceof Int32Array||wr instanceof Uint32Array||wr instanceof Float32Array||wr instanceof Float64Array)},_r=e.__addimage__.binaryStringToUint8Array=function(wr){for(var kr=wr.length,Mr=new Uint8Array(kr),Hr=0;Hr<kr;Hr++)Mr[Hr]=wr.charCodeAt(Hr);return Mr},Ar=e.__addimage__.arrayBufferToBinaryString=function(wr){for(var kr="",Mr=Fr(wr)?wr:new Uint8Array(wr),Hr=0;Hr<Mr.length;Hr+=8192)kr+=String.fromCharCode.apply(null,Mr.subarray(Hr,Hr+8192));return kr};e.addImage=function(){var wr,kr,Mr,Hr,Gr,zr,Br,Vr,Rr;if(typeof arguments[1]=="number"?(kr=_e,Mr=arguments[1],Hr=arguments[2],Gr=arguments[3],zr=arguments[4],Br=arguments[5],Vr=arguments[6],Rr=arguments[7]):(kr=arguments[1],Mr=arguments[2],Hr=arguments[3],Gr=arguments[4],zr=arguments[5],Br=arguments[6],Vr=arguments[7],Rr=arguments[8]),_typeof(wr=arguments[0])==="object"&&!ur(wr)&&"imageData"in wr){var Xr=wr;wr=Xr.imageData,kr=Xr.format||kr||_e,Mr=Xr.x||Mr||0,Hr=Xr.y||Hr||0,Gr=Xr.w||Xr.width||Gr,zr=Xr.h||Xr.height||zr,Br=Xr.alias||Br,Vr=Xr.compression||Vr,Rr=Xr.rotation||Xr.angle||Rr}var an=this.internal.getFilters();if(Vr===void 0&&an.indexOf("FlateEncode")!==-1&&(Vr="SLOW"),isNaN(Mr)||isNaN(Hr))throw new Error("Invalid coordinates passed to jsPDF.addImage");ar.call(this);var yr=Pr.call(this,wr,kr,Br,Vr);return dr.call(this,Mr,Hr,Gr,zr,yr,Rr),this};var Pr=function(wr,kr,Mr,Hr){var Gr,zr,Br;if(typeof wr=="string"&&tr(wr)===_e){wr=unescape(wr);var Vr=Ir(wr,!1);(Vr!==""||(Vr=e.loadFile(wr,!0))!==void 0)&&(wr=Vr)}if(ur(wr)&&(wr=fr(wr,kr)),kr=tr(wr,kr),!lr(kr))throw new Error("addImage does not support files of type '"+kr+"', please ensure that a plugin for '"+kr+"' support is added.");if(((Br=Mr)==null||Br.length===0)&&(Mr=function(Rr){return typeof Rr=="string"||Fr(Rr)?gr(Rr):Fr(Rr.data)?gr(Rr.data):null}(wr)),(Gr=cr.call(this,Mr))||(Tr()&&(wr instanceof Uint8Array||kr==="RGBA"||(zr=wr,wr=_r(wr))),Gr=this["process"+kr.toUpperCase()](wr,or.call(this),Mr,function(Rr){return Rr&&typeof Rr=="string"&&(Rr=Rr.toUpperCase()),Rr in e.image_compression?Rr:pr.NONE}(Hr),zr)),!Gr)throw new Error("An unknown error occurred whilst processing the image.");return Gr},Ir=e.__addimage__.convertBase64ToBinaryString=function(wr,kr){var Mr;kr=typeof kr!="boolean"||kr;var Hr,Gr="";if(typeof wr=="string"){Hr=(Mr=Cr(wr))!==null?Mr.data:wr;try{Gr=u(Hr)}catch(zr){if(kr)throw vr(Hr)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+zr.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Gr};e.getImageProperties=function(wr){var kr,Mr,Hr="";if(ur(wr)&&(wr=fr(wr)),typeof wr=="string"&&tr(wr)===_e&&((Hr=Ir(wr,!1))===""&&(Hr=e.loadFile(wr)||""),wr=Hr),Mr=tr(wr),!lr(Mr))throw new Error("addImage does not support files of type '"+Mr+"', please ensure that a plugin for '"+Mr+"' support is added.");if(!Tr()||wr instanceof Uint8Array||(wr=_r(wr)),!(kr=this["process"+Mr.toUpperCase()](wr)))throw new Error("An unknown error occurred whilst processing the image");return kr.fileType=Mr,kr}})(E.API),function(e){var _e=function(er){if(er!==void 0&&er!="")return!0};E.API.events.push(["addPage",function(er){this.internal.getPageInfo(er.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(er){for(var tr,rr,nr,ir=this.internal.getCoordinateString,ar=this.internal.getVerticalCoordinateString,sr=this.internal.getPageInfoByObjId(er.objId),or=er.pageContext.annotations,lr=!1,ur=0;ur<or.length&&!lr;ur++)switch((tr=or[ur]).type){case"link":(_e(tr.options.url)||_e(tr.options.pageNumber))&&(lr=!0);break;case"reference":case"text":case"freetext":lr=!0}if(lr!=0){this.internal.write("/Annots [");for(var fr=0;fr<or.length;fr++){tr=or[fr];var cr=this.internal.pdfEscape,mr=this.internal.getEncryptor(er.objId);switch(tr.type){case"reference":this.internal.write(" "+tr.object.objId+" 0 R ");break;case"text":var dr=this.internal.newAdditionalObject(),xr=this.internal.newAdditionalObject(),pr=this.internal.getEncryptor(dr.objId),gr=tr.title||"Note";nr="<</Type /Annot /Subtype /Text "+(rr="/Rect ["+ir(tr.bounds.x)+" "+ar(tr.bounds.y+tr.bounds.h)+" "+ir(tr.bounds.x+tr.bounds.w)+" "+ar(tr.bounds.y)+"] ")+"/Contents ("+cr(pr(tr.contents))+")",nr+=" /Popup "+xr.objId+" 0 R",nr+=" /P "+sr.objId+" 0 R",nr+=" /T ("+cr(pr(gr))+") >>",dr.content=nr;var vr=dr.objId+" 0 R";nr="<</Type /Annot /Subtype /Popup "+(rr="/Rect ["+ir(tr.bounds.x+30)+" "+ar(tr.bounds.y+tr.bounds.h)+" "+ir(tr.bounds.x+tr.bounds.w+30)+" "+ar(tr.bounds.y)+"] ")+" /Parent "+vr,tr.open&&(nr+=" /Open true"),nr+=" >>",xr.content=nr,this.internal.write(dr.objId,"0 R",xr.objId,"0 R");break;case"freetext":rr="/Rect ["+ir(tr.bounds.x)+" "+ar(tr.bounds.y)+" "+ir(tr.bounds.x+tr.bounds.w)+" "+ar(tr.bounds.y+tr.bounds.h)+"] ";var Cr=tr.color||"#000000";nr="<</Type /Annot /Subtype /FreeText "+rr+"/Contents ("+cr(mr(tr.contents))+")",nr+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Cr+")",nr+=" /Border [0 0 0]",nr+=" >>",this.internal.write(nr);break;case"link":if(tr.options.name){var Tr=this.annotations._nameMap[tr.options.name];tr.options.pageNumber=Tr.page,tr.options.top=Tr.y}else tr.options.top||(tr.options.top=0);if(rr="/Rect ["+tr.finalBounds.x+" "+tr.finalBounds.y+" "+tr.finalBounds.w+" "+tr.finalBounds.h+"] ",nr="",tr.options.url)nr="<</Type /Annot /Subtype /Link "+rr+"/Border [0 0 0] /A <</S /URI /URI ("+cr(mr(tr.options.url))+") >>";else if(tr.options.pageNumber)switch(nr="<</Type /Annot /Subtype /Link "+rr+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(tr.options.pageNumber).objId+" 0 R",tr.options.magFactor=tr.options.magFactor||"XYZ",tr.options.magFactor){case"Fit":nr+=" /Fit]";break;case"FitH":nr+=" /FitH "+tr.options.top+"]";break;case"FitV":tr.options.left=tr.options.left||0,nr+=" /FitV "+tr.options.left+"]";break;case"XYZ":default:var Fr=ar(tr.options.top);tr.options.left=tr.options.left||0,tr.options.zoom===void 0&&(tr.options.zoom=0),nr+=" /XYZ "+tr.options.left+" "+Fr+" "+tr.options.zoom+"]"}nr!=""&&(nr+=" >>",this.internal.write(nr))}}this.internal.write("]")}}]),e.createAnnotation=function(er){var tr=this.internal.getCurrentPageInfo();switch(er.type){case"link":this.link(er.bounds.x,er.bounds.y,er.bounds.w,er.bounds.h,er);break;case"text":case"freetext":tr.pageContext.annotations.push(er)}},e.link=function(er,tr,rr,nr,ir){var ar=this.internal.getCurrentPageInfo(),sr=this.internal.getCoordinateString,or=this.internal.getVerticalCoordinateString;ar.pageContext.annotations.push({finalBounds:{x:sr(er),y:or(tr),w:sr(er+rr),h:or(tr+nr)},options:ir,type:"link"})},e.textWithLink=function(er,tr,rr,nr){var ir,ar,sr=this.getTextWidth(er),or=this.internal.getLineHeight()/this.internal.scaleFactor;if(nr.maxWidth!==void 0){ar=nr.maxWidth;var lr=this.splitTextToSize(er,ar).length;ir=Math.ceil(or*lr)}else ar=sr,ir=or;return this.text(er,tr,rr,nr),rr+=.2*or,nr.align==="center"&&(tr-=sr/2),nr.align==="right"&&(tr-=sr),this.link(tr,rr-or,ar,ir,nr),sr},e.getTextWidth=function(er){var tr=this.internal.getFontSize();return this.getStringUnitWidth(er)*tr/this.internal.scaleFactor}}(E.API),function(e){var _e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},er={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},tr={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},rr=[1570,1571,1573,1575];e.__arabicParser__={};var nr=e.__arabicParser__.isInArabicSubstitutionA=function(dr){return _e[dr.charCodeAt(0)]!==void 0},ir=e.__arabicParser__.isArabicLetter=function(dr){return typeof dr=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(dr)},ar=e.__arabicParser__.isArabicEndLetter=function(dr){return ir(dr)&&nr(dr)&&_e[dr.charCodeAt(0)].length<=2},sr=e.__arabicParser__.isArabicAlfLetter=function(dr){return ir(dr)&&rr.indexOf(dr.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(dr){return ir(dr)&&nr(dr)&&_e[dr.charCodeAt(0)].length>=1};var or=e.__arabicParser__.arabicLetterHasFinalForm=function(dr){return ir(dr)&&nr(dr)&&_e[dr.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(dr){return ir(dr)&&nr(dr)&&_e[dr.charCodeAt(0)].length>=3};var lr=e.__arabicParser__.arabicLetterHasMedialForm=function(dr){return ir(dr)&&nr(dr)&&_e[dr.charCodeAt(0)].length==4},ur=e.__arabicParser__.resolveLigatures=function(dr){var xr=0,pr=er,gr="",vr=0;for(xr=0;xr<dr.length;xr+=1)pr[dr.charCodeAt(xr)]!==void 0?(vr++,typeof(pr=pr[dr.charCodeAt(xr)])=="number"&&(gr+=String.fromCharCode(pr),pr=er,vr=0),xr===dr.length-1&&(pr=er,gr+=dr.charAt(xr-(vr-1)),xr-=vr-1,vr=0)):(pr=er,gr+=dr.charAt(xr-vr),xr-=vr,vr=0);return gr};e.__arabicParser__.isArabicDiacritic=function(dr){return dr!==void 0&&tr[dr.charCodeAt(0)]!==void 0};var fr=e.__arabicParser__.getCorrectForm=function(dr,xr,pr){return ir(dr)?nr(dr)===!1?-1:!or(dr)||!ir(xr)&&!ir(pr)||!ir(pr)&&ar(xr)||ar(dr)&&!ir(xr)||ar(dr)&&sr(xr)||ar(dr)&&ar(xr)?0:lr(dr)&&ir(xr)&&!ar(xr)&&ir(pr)&&or(pr)?3:ar(dr)||!ir(pr)?1:2:-1},cr=function(dr){var xr=0,pr=0,gr=0,vr="",Cr="",Tr="",Fr=(dr=dr||"").split("\\s+"),_r=[];for(xr=0;xr<Fr.length;xr+=1){for(_r.push(""),pr=0;pr<Fr[xr].length;pr+=1)vr=Fr[xr][pr],Cr=Fr[xr][pr-1],Tr=Fr[xr][pr+1],ir(vr)?(gr=fr(vr,Cr,Tr),_r[xr]+=gr!==-1?String.fromCharCode(_e[vr.charCodeAt(0)][gr]):vr):_r[xr]+=vr;_r[xr]=ur(_r[xr])}return _r.join(" ")},mr=e.__arabicParser__.processArabic=e.processArabic=function(){var dr,xr=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,pr=[];if(Array.isArray(xr)){var gr=0;for(pr=[],gr=0;gr<xr.length;gr+=1)Array.isArray(xr[gr])?pr.push([cr(xr[gr][0]),xr[gr][1],xr[gr][2]]):pr.push([cr(xr[gr])]);dr=pr}else dr=cr(xr);return typeof arguments[0]=="string"?dr:(arguments[0].text=dr,arguments[0])};e.events.push(["preProcessText",mr])}(E.API),E.API.autoPrint=function(e){var _e;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){_e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+_e+" 0 R")})}return this},function(e){var _e=function(){var er=void 0;Object.defineProperty(this,"pdf",{get:function(){return er},set:function(ar){er=ar}});var tr=150;Object.defineProperty(this,"width",{get:function(){return tr},set:function(ar){tr=isNaN(ar)||Number.isInteger(ar)===!1||ar<0?150:ar,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=tr+1)}});var rr=300;Object.defineProperty(this,"height",{get:function(){return rr},set:function(ar){rr=isNaN(ar)||Number.isInteger(ar)===!1||ar<0?300:ar,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=rr+1)}});var nr=[];Object.defineProperty(this,"childNodes",{get:function(){return nr},set:function(ar){nr=ar}});var ir={};Object.defineProperty(this,"style",{get:function(){return ir},set:function(ar){ir=ar}}),Object.defineProperty(this,"parentNode",{})};_e.prototype.getContext=function(er,tr){var rr;if((er=er||"2d")!=="2d")return null;for(rr in tr)this.pdf.context2d.hasOwnProperty(rr)&&(this.pdf.context2d[rr]=tr[rr]);return this.pdf.context2d._canvas=this,this.pdf.context2d},_e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new _e,this.canvas.pdf=this}])}(E.API),function(e){var _e={left:0,top:0,bottom:0,right:0},er=!1,tr=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},_e),this.internal.__cell__.margins.width=this.getPageWidth(),rr.call(this))},rr=function(){this.internal.__cell__.lastCell=new nr,this.internal.__cell__.pages=1},nr=function(){var sr=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return sr},set:function(dr){sr=dr}});var or=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return or},set:function(dr){or=dr}});var lr=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return lr},set:function(dr){lr=dr}});var ur=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return ur},set:function(dr){ur=dr}});var fr=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return fr},set:function(dr){fr=dr}});var cr=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return cr},set:function(dr){cr=dr}});var mr=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return mr},set:function(dr){mr=dr}}),this};nr.prototype.clone=function(){return new nr(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},nr.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(sr){return tr.call(this),this.internal.__cell__.headerFunction=typeof sr=="function"?sr:void 0,this},e.getTextDimensions=function(sr,or){tr.call(this);var lr=(or=or||{}).fontSize||this.getFontSize(),ur=or.font||this.getFont(),fr=or.scaleFactor||this.internal.scaleFactor,cr=0,mr=0,dr=0,xr=this;if(!Array.isArray(sr)&&typeof sr!="string"){if(typeof sr!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");sr=String(sr)}var pr=or.maxWidth;pr>0?typeof sr=="string"?sr=this.splitTextToSize(sr,pr):Object.prototype.toString.call(sr)==="[object Array]"&&(sr=sr.reduce(function(vr,Cr){return vr.concat(xr.splitTextToSize(Cr,pr))},[])):sr=Array.isArray(sr)?sr:[sr];for(var gr=0;gr<sr.length;gr++)cr<(dr=this.getStringUnitWidth(sr[gr],{font:ur})*lr)&&(cr=dr);return cr!==0&&(mr=sr.length),{w:cr/=fr,h:Math.max((mr*lr*this.getLineHeightFactor()-lr*(this.getLineHeightFactor()-1))/fr,0)}},e.cellAddPage=function(){tr.call(this),this.addPage();var sr=this.internal.__cell__.margins||_e;return this.internal.__cell__.lastCell=new nr(sr.left,sr.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var ir=e.cell=function(){var sr;sr=arguments[0]instanceof nr?arguments[0]:new nr(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),tr.call(this);var or=this.internal.__cell__.lastCell,lr=this.internal.__cell__.padding,ur=this.internal.__cell__.margins||_e,fr=this.internal.__cell__.tableHeaderRow,cr=this.internal.__cell__.printHeaders;return or.lineNumber!==void 0&&(or.lineNumber===sr.lineNumber?(sr.x=(or.x||0)+(or.width||0),sr.y=or.y||0):or.y+or.height+sr.height+ur.bottom>this.getPageHeight()?(this.cellAddPage(),sr.y=ur.top,cr&&fr&&(this.printHeaderRow(sr.lineNumber,!0),sr.y+=fr[0].height)):sr.y=or.y+or.height||sr.y),sr.text[0]!==void 0&&(this.rect(sr.x,sr.y,sr.width,sr.height,er===!0?"FD":void 0),sr.align==="right"?this.text(sr.text,sr.x+sr.width-lr,sr.y+lr,{align:"right",baseline:"top"}):sr.align==="center"?this.text(sr.text,sr.x+sr.width/2,sr.y+lr,{align:"center",baseline:"top",maxWidth:sr.width-lr-lr}):this.text(sr.text,sr.x+lr,sr.y+lr,{align:"left",baseline:"top",maxWidth:sr.width-lr-lr})),this.internal.__cell__.lastCell=sr,this};e.table=function(sr,or,lr,ur,fr){if(tr.call(this),!lr)throw new Error("No data for PDF table.");var cr,mr,dr,xr,pr=[],gr=[],vr=[],Cr={},Tr={},Fr=[],_r=[],Ar=(fr=fr||{}).autoSize||!1,Pr=fr.printHeaders!==!1,Ir=fr.css&&fr.css["font-size"]!==void 0?16*fr.css["font-size"]:fr.fontSize||12,wr=fr.margins||Object.assign({width:this.getPageWidth()},_e),kr=typeof fr.padding=="number"?fr.padding:3,Mr=fr.headerBackgroundColor||"#c8c8c8",Hr=fr.headerTextColor||"#000";if(rr.call(this),this.internal.__cell__.printHeaders=Pr,this.internal.__cell__.margins=wr,this.internal.__cell__.table_font_size=Ir,this.internal.__cell__.padding=kr,this.internal.__cell__.headerBackgroundColor=Mr,this.internal.__cell__.headerTextColor=Hr,this.setFontSize(Ir),ur==null)gr=pr=Object.keys(lr[0]),vr=pr.map(function(){return"left"});else if(Array.isArray(ur)&&_typeof(ur[0])==="object")for(pr=ur.map(function(Xr){return Xr.name}),gr=ur.map(function(Xr){return Xr.prompt||Xr.name||""}),vr=ur.map(function(Xr){return Xr.align||"left"}),cr=0;cr<ur.length;cr+=1)Tr[ur[cr].name]=ur[cr].width*(19.049976/25.4);else Array.isArray(ur)&&typeof ur[0]=="string"&&(gr=pr=ur,vr=pr.map(function(){return"left"}));if(Ar||Array.isArray(ur)&&typeof ur[0]=="string")for(cr=0;cr<pr.length;cr+=1){for(Cr[xr=pr[cr]]=lr.map(function(Xr){return Xr[xr]}),this.setFont(void 0,"bold"),Fr.push(this.getTextDimensions(gr[cr],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),mr=Cr[xr],this.setFont(void 0,"normal"),dr=0;dr<mr.length;dr+=1)Fr.push(this.getTextDimensions(mr[dr],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Tr[xr]=Math.max.apply(null,Fr)+kr+kr,Fr=[]}if(Pr){var Gr={};for(cr=0;cr<pr.length;cr+=1)Gr[pr[cr]]={},Gr[pr[cr]].text=gr[cr],Gr[pr[cr]].align=vr[cr];var zr=ar.call(this,Gr,Tr);_r=pr.map(function(Xr){return new nr(sr,or,Tr[Xr],zr,Gr[Xr].text,void 0,Gr[Xr].align)}),this.setTableHeaderRow(_r),this.printHeaderRow(1,!1)}var Br=ur.reduce(function(Xr,an){return Xr[an.name]=an.align,Xr},{});for(cr=0;cr<lr.length;cr+=1){"rowStart"in fr&&fr.rowStart instanceof Function&&fr.rowStart({row:cr,data:lr[cr]},this);var Vr=ar.call(this,lr[cr],Tr);for(dr=0;dr<pr.length;dr+=1){var Rr=lr[cr][pr[dr]];"cellStart"in fr&&fr.cellStart instanceof Function&&fr.cellStart({row:cr,col:dr,data:Rr},this),ir.call(this,new nr(sr,or,Tr[pr[dr]],Vr,Rr,cr+2,Br[pr[dr]]))}}return this.internal.__cell__.table_x=sr,this.internal.__cell__.table_y=or,this};var ar=function(sr,or){var lr=this.internal.__cell__.padding,ur=this.internal.__cell__.table_font_size,fr=this.internal.scaleFactor;return Object.keys(sr).map(function(cr){var mr=sr[cr];return this.splitTextToSize(mr.hasOwnProperty("text")?mr.text:mr,or[cr]-lr-lr)},this).map(function(cr){return this.getLineHeightFactor()*cr.length*ur/fr+lr+lr},this).reduce(function(cr,mr){return Math.max(cr,mr)},0)};e.setTableHeaderRow=function(sr){tr.call(this),this.internal.__cell__.tableHeaderRow=sr},e.printHeaderRow=function(sr,or){if(tr.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var lr;if(er=!0,typeof this.internal.__cell__.headerFunction=="function"){var ur=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new nr(ur[0],ur[1],ur[2],ur[3],void 0,-1)}this.setFont(void 0,"bold");for(var fr=[],cr=0;cr<this.internal.__cell__.tableHeaderRow.length;cr+=1){lr=this.internal.__cell__.tableHeaderRow[cr].clone(),or&&(lr.y=this.internal.__cell__.margins.top||0,fr.push(lr)),lr.lineNumber=sr;var mr=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),ir.call(this,lr),this.setTextColor(mr)}fr.length>0&&this.setTableHeaderRow(fr),this.setFont(void 0,"normal"),er=!1}}(E.API);var Pt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kt=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],It=_t(kt),Ft=[100,200,300,400,500,600,700,800,900],Ct=_t(Ft);function jt(e){var _e=e.family.replace(/"|'/g,"").toLowerCase(),er=function(nr){return Pt[nr=nr||"normal"]?nr:"normal"}(e.style),tr=function(nr){if(!nr)return 400;if(typeof nr=="number")return nr>=100&&nr<=900&&nr%100==0?nr:400;if(/^\d00$/.test(nr))return parseInt(nr);switch(nr){case"bold":return 700;case"normal":default:return 400}}(e.weight),rr=function(nr){return typeof It[nr=nr||"normal"]=="number"?nr:"normal"}(e.stretch);return{family:_e,style:er,weight:tr,stretch:rr,src:e.src||[],ref:e.ref||{name:_e,style:[rr,er,tr].join(" ")}}}function Ot(e,_e,er,tr){var rr;for(rr=er;rr>=0&&rr<_e.length;rr+=tr)if(e[_e[rr]])return e[_e[rr]];for(rr=er;rr>=0&&rr<_e.length;rr-=tr)if(e[_e[rr]])return e[_e[rr]]}var Bt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Et(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function qt(e,_e,er){for(var tr=(er=er||{}).defaultFontFamily||"times",rr=Object.assign({},Bt,er.genericFontFamilies||{}),nr=null,ir=null,ar=0;ar<_e.length;++ar)if(rr[(nr=jt(_e[ar])).family]&&(nr.family=rr[nr.family]),e.hasOwnProperty(nr.family)){ir=e[nr.family];break}if(!(ir=ir||e[tr]))throw new Error("Could not find a font-family for the rule '"+Et(nr)+"' and default family '"+tr+"'.");if(ir=function(sr,or){if(or[sr])return or[sr];var lr=It[sr],ur=lr<=It.normal?-1:1,fr=Ot(or,kt,lr,ur);if(!fr)throw new Error("Could not find a matching font-stretch value for "+sr);return fr}(nr.stretch,ir),ir=function(sr,or){if(or[sr])return or[sr];for(var lr=Pt[sr],ur=0;ur<lr.length;++ur)if(or[lr[ur]])return or[lr[ur]];throw new Error("Could not find a matching font-style for "+sr)}(nr.style,ir),!(ir=function(sr,or){if(or[sr])return or[sr];if(sr===400&&or[500])return or[500];if(sr===500&&or[400])return or[400];var lr=Ct[sr],ur=Ot(or,Ft,lr,sr<400?-1:1);if(!ur)throw new Error("Could not find a matching font-weight for value "+sr);return ur}(nr.weight,ir)))throw new Error("Failed to resolve a font for the rule '"+Et(nr)+"'.");return ir}function Dt(e){return e.trimLeft()}function Rt(e,_e){for(var er=0;er<e.length;){if(e.charAt(er)===_e)return[e.substring(0,er),e.substring(er+1)];er+=1}return null}function Tt(e){var _e=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return _e===null?null:[_e[0],e.substring(_e[0].length)]}var Ut,zt,Ht,Wt=["times"];(function(e){var _e,er,tr,rr,nr,ir,ar,sr,or,lr=function(yr){return yr=yr||{},this.isStrokeTransparent=yr.isStrokeTransparent||!1,this.strokeOpacity=yr.strokeOpacity||1,this.strokeStyle=yr.strokeStyle||"#000000",this.fillStyle=yr.fillStyle||"#000000",this.isFillTransparent=yr.isFillTransparent||!1,this.fillOpacity=yr.fillOpacity||1,this.font=yr.font||"10px sans-serif",this.textBaseline=yr.textBaseline||"alphabetic",this.textAlign=yr.textAlign||"left",this.lineWidth=yr.lineWidth||1,this.lineJoin=yr.lineJoin||"miter",this.lineCap=yr.lineCap||"butt",this.path=yr.path||[],this.transform=yr.transform!==void 0?yr.transform.clone():new sr,this.globalCompositeOperation=yr.globalCompositeOperation||"normal",this.globalAlpha=yr.globalAlpha||1,this.clip_path=yr.clip_path||[],this.currentPoint=yr.currentPoint||new ir,this.miterLimit=yr.miterLimit||10,this.lastPoint=yr.lastPoint||new ir,this.lineDashOffset=yr.lineDashOffset||0,this.lineDash=yr.lineDash||[],this.margin=yr.margin||[0,0,0,0],this.prevPageLastElemOffset=yr.prevPageLastElemOffset||0,this.ignoreClearRect=typeof yr.ignoreClearRect!="boolean"||yr.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new ur(this),_e=this.internal.f2,er=this.internal.getCoordinateString,tr=this.internal.getVerticalCoordinateString,rr=this.internal.getHorizontalCoordinate,nr=this.internal.getVerticalCoordinate,ir=this.internal.Point,ar=this.internal.Rectangle,sr=this.internal.Matrix,or=new lr}]);var ur=function(yr){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var br=yr;Object.defineProperty(this,"pdf",{get:function(){return br}});var Er=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Er},set:function(wn){Er=!!wn}});var Lr=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Lr},set:function(wn){Lr=!!wn}});var Or=0;Object.defineProperty(this,"posX",{get:function(){return Or},set:function(wn){isNaN(wn)||(Or=wn)}});var Ur=0;Object.defineProperty(this,"posY",{get:function(){return Ur},set:function(wn){isNaN(wn)||(Ur=wn)}}),Object.defineProperty(this,"margin",{get:function(){return or.margin},set:function(wn){var Qr;typeof wn=="number"?Qr=[wn,wn,wn,wn]:((Qr=new Array(4))[0]=wn[0],Qr[1]=wn.length>=2?wn[1]:Qr[0],Qr[2]=wn.length>=3?wn[2]:Qr[0],Qr[3]=wn.length>=4?wn[3]:Qr[1]),or.margin=Qr}});var $r=!1;Object.defineProperty(this,"autoPaging",{get:function(){return $r},set:function(wn){$r=wn}});var Zr=0;Object.defineProperty(this,"lastBreak",{get:function(){return Zr},set:function(wn){Zr=wn}});var fn=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fn},set:function(wn){fn=wn}}),Object.defineProperty(this,"ctx",{get:function(){return or},set:function(wn){wn instanceof lr&&(or=wn)}}),Object.defineProperty(this,"path",{get:function(){return or.path},set:function(wn){or.path=wn}});var _n=[];Object.defineProperty(this,"ctxStack",{get:function(){return _n},set:function(wn){_n=wn}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(wn){var Qr;Qr=fr(wn),this.ctx.fillStyle=Qr.style,this.ctx.isFillTransparent=Qr.a===0,this.ctx.fillOpacity=Qr.a,this.pdf.setFillColor(Qr.r,Qr.g,Qr.b,{a:Qr.a}),this.pdf.setTextColor(Qr.r,Qr.g,Qr.b,{a:Qr.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(wn){var Qr=fr(wn);this.ctx.strokeStyle=Qr.style,this.ctx.isStrokeTransparent=Qr.a===0,this.ctx.strokeOpacity=Qr.a,Qr.a===0?this.pdf.setDrawColor(255,255,255):(Qr.a,this.pdf.setDrawColor(Qr.r,Qr.g,Qr.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(wn){["butt","round","square"].indexOf(wn)!==-1&&(this.ctx.lineCap=wn,this.pdf.setLineCap(wn))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(wn){isNaN(wn)||(this.ctx.lineWidth=wn,this.pdf.setLineWidth(wn))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(wn){["bevel","round","miter"].indexOf(wn)!==-1&&(this.ctx.lineJoin=wn,this.pdf.setLineJoin(wn))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(wn){isNaN(wn)||(this.ctx.miterLimit=wn,this.pdf.setMiterLimit(wn))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(wn){this.ctx.textBaseline=wn}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(wn){["right","end","center","left","start"].indexOf(wn)!==-1&&(this.ctx.textAlign=wn)}});var Kr=null;function Cn(wn,Qr){if(Kr===null){var xn=function(tn){var on=[];return Object.keys(tn).forEach(function(vn){tn[vn].forEach(function(Sn){var Ln=null;switch(Sn){case"bold":Ln={family:vn,weight:"bold"};break;case"italic":Ln={family:vn,style:"italic"};break;case"bolditalic":Ln={family:vn,weight:"bold",style:"italic"};break;case"":case"normal":Ln={family:vn}}Ln!==null&&(Ln.ref={name:vn,style:Sn},on.push(Ln))})}),on}(wn.getFontList());Kr=function(tn){for(var on={},vn=0;vn<tn.length;++vn){var Sn=jt(tn[vn]),Ln=Sn.family,Wn=Sn.stretch,$n=Sn.style,En=Sn.weight;on[Ln]=on[Ln]||{},on[Ln][Wn]=on[Ln][Wn]||{},on[Ln][Wn][$n]=on[Ln][Wn][$n]||{},on[Ln][Wn][$n][En]=Sn}return on}(xn.concat(Qr))}return Kr}var Dn=null;Object.defineProperty(this,"fontFaces",{get:function(){return Dn},set:function(wn){Kr=null,Dn=wn}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(wn){var Qr;if(this.ctx.font=wn,(Qr=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(wn))!==null){var xn=Qr[1],tn=(Qr[2],Qr[3]),on=Qr[4],vn=(Qr[5],Qr[6]),Sn=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(on)[2];on=Math.floor(Sn==="px"?parseFloat(on)*this.pdf.internal.scaleFactor:Sn==="em"?parseFloat(on)*this.pdf.getFontSize():parseFloat(on)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(on);var Ln=function(es){var ls,Xn,ws=[],ds=es.trim();if(ds==="")return Wt;if(ds in Mt)return[Mt[ds]];for(;ds!=="";){switch(Xn=null,ls=(ds=Dt(ds)).charAt(0)){case'"':case"'":Xn=Rt(ds.substring(1),ls);break;default:Xn=Tt(ds)}if(Xn===null||(ws.push(Xn[0]),(ds=Dt(Xn[1]))!==""&&ds.charAt(0)!==","))return Wt;ds=ds.replace(/^,/,"")}return ws}(vn);if(this.fontFaces){var Wn=qt(Cn(this.pdf,this.fontFaces),Ln.map(function(es){return{family:es,stretch:"normal",weight:tn,style:xn}}));this.pdf.setFont(Wn.ref.name,Wn.ref.style)}else{var $n="";(tn==="bold"||parseInt(tn,10)>=700||xn==="bold")&&($n="bold"),xn==="italic"&&($n+="italic"),$n.length===0&&($n="normal");for(var En="",ba={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Qn=0;Qn<Ln.length;Qn++){if(this.pdf.internal.getFont(Ln[Qn],$n,{noFallback:!0,disableWarning:!0})!==void 0){En=Ln[Qn];break}if($n==="bolditalic"&&this.pdf.internal.getFont(Ln[Qn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)En=Ln[Qn],$n="bold";else if(this.pdf.internal.getFont(Ln[Qn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){En=Ln[Qn],$n="normal";break}}if(En===""){for(var vs=0;vs<Ln.length;vs++)if(ba[Ln[vs]]){En=ba[Ln[vs]];break}}En=En===""?"Times":En,this.pdf.setFont(En,$n)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(wn){this.ctx.globalCompositeOperation=wn}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(wn){this.ctx.globalAlpha=wn}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(wn){this.ctx.lineDashOffset=wn,an.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(wn){this.ctx.lineDash=wn,an.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(wn){this.ctx.ignoreClearRect=!!wn}})};ur.prototype.setLineDash=function(yr){this.lineDash=yr},ur.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},ur.prototype.fill=function(){Cr.call(this,"fill",!1)},ur.prototype.stroke=function(){Cr.call(this,"stroke",!1)},ur.prototype.beginPath=function(){this.path=[{type:"begin"}]},ur.prototype.moveTo=function(yr,br){if(isNaN(yr)||isNaN(br))throw a.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Er=this.ctx.transform.applyToPoint(new ir(yr,br));this.path.push({type:"mt",x:Er.x,y:Er.y}),this.ctx.lastPoint=new ir(yr,br)},ur.prototype.closePath=function(){var yr=new ir(0,0),br=0;for(br=this.path.length-1;br!==-1;br--)if(this.path[br].type==="begin"&&_typeof(this.path[br+1])==="object"&&typeof this.path[br+1].x=="number"){yr=new ir(this.path[br+1].x,this.path[br+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new ir(yr.x,yr.y)},ur.prototype.lineTo=function(yr,br){if(isNaN(yr)||isNaN(br))throw a.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Er=this.ctx.transform.applyToPoint(new ir(yr,br));this.path.push({type:"lt",x:Er.x,y:Er.y}),this.ctx.lastPoint=new ir(Er.x,Er.y)},ur.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Cr.call(this,null,!0)},ur.prototype.quadraticCurveTo=function(yr,br,Er,Lr){if(isNaN(Er)||isNaN(Lr)||isNaN(yr)||isNaN(br))throw a.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Or=this.ctx.transform.applyToPoint(new ir(Er,Lr)),Ur=this.ctx.transform.applyToPoint(new ir(yr,br));this.path.push({type:"qct",x1:Ur.x,y1:Ur.y,x:Or.x,y:Or.y}),this.ctx.lastPoint=new ir(Or.x,Or.y)},ur.prototype.bezierCurveTo=function(yr,br,Er,Lr,Or,Ur){if(isNaN(Or)||isNaN(Ur)||isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr))throw a.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var $r=this.ctx.transform.applyToPoint(new ir(Or,Ur)),Zr=this.ctx.transform.applyToPoint(new ir(yr,br)),fn=this.ctx.transform.applyToPoint(new ir(Er,Lr));this.path.push({type:"bct",x1:Zr.x,y1:Zr.y,x2:fn.x,y2:fn.y,x:$r.x,y:$r.y}),this.ctx.lastPoint=new ir($r.x,$r.y)},ur.prototype.arc=function(yr,br,Er,Lr,Or,Ur){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr)||isNaN(Or))throw a.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ur=!!Ur,!this.ctx.transform.isIdentity){var $r=this.ctx.transform.applyToPoint(new ir(yr,br));yr=$r.x,br=$r.y;var Zr=this.ctx.transform.applyToPoint(new ir(0,Er)),fn=this.ctx.transform.applyToPoint(new ir(0,0));Er=Math.sqrt(Math.pow(Zr.x-fn.x,2)+Math.pow(Zr.y-fn.y,2))}Math.abs(Or-Lr)>=2*Math.PI&&(Lr=0,Or=2*Math.PI),this.path.push({type:"arc",x:yr,y:br,radius:Er,startAngle:Lr,endAngle:Or,counterclockwise:Ur})},ur.prototype.arcTo=function(yr,br,Er,Lr,Or){throw new Error("arcTo not implemented.")},ur.prototype.rect=function(yr,br,Er,Lr){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr))throw a.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(yr,br),this.lineTo(yr+Er,br),this.lineTo(yr+Er,br+Lr),this.lineTo(yr,br+Lr),this.lineTo(yr,br),this.lineTo(yr+Er,br),this.lineTo(yr,br)},ur.prototype.fillRect=function(yr,br,Er,Lr){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr))throw a.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!cr.call(this)){var Or={};this.lineCap!=="butt"&&(Or.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Or.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(yr,br,Er,Lr),this.fill(),Or.hasOwnProperty("lineCap")&&(this.lineCap=Or.lineCap),Or.hasOwnProperty("lineJoin")&&(this.lineJoin=Or.lineJoin)}},ur.prototype.strokeRect=function(yr,br,Er,Lr){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr))throw a.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");mr.call(this)||(this.beginPath(),this.rect(yr,br,Er,Lr),this.stroke())},ur.prototype.clearRect=function(yr,br,Er,Lr){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr))throw a.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(yr,br,Er,Lr))},ur.prototype.save=function(yr){yr=typeof yr!="boolean"||yr;for(var br=this.pdf.internal.getCurrentPageInfo().pageNumber,Er=0;Er<this.pdf.internal.getNumberOfPages();Er++)this.pdf.setPage(Er+1),this.pdf.internal.out("q");if(this.pdf.setPage(br),yr){this.ctx.fontSize=this.pdf.internal.getFontSize();var Lr=new lr(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Lr}},ur.prototype.restore=function(yr){yr=typeof yr!="boolean"||yr;for(var br=this.pdf.internal.getCurrentPageInfo().pageNumber,Er=0;Er<this.pdf.internal.getNumberOfPages();Er++)this.pdf.setPage(Er+1),this.pdf.internal.out("Q");this.pdf.setPage(br),yr&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},ur.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var fr=function(yr){var br,Er,Lr,Or;if(yr.isCanvasGradient===!0&&(yr=yr.getColor()),!yr)return{r:0,g:0,b:0,a:0,style:yr};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(yr))br=0,Er=0,Lr=0,Or=0;else{var Ur=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(yr);if(Ur!==null)br=parseInt(Ur[1]),Er=parseInt(Ur[2]),Lr=parseInt(Ur[3]),Or=1;else if((Ur=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(yr))!==null)br=parseInt(Ur[1]),Er=parseInt(Ur[2]),Lr=parseInt(Ur[3]),Or=parseFloat(Ur[4]);else{if(Or=1,typeof yr=="string"&&yr.charAt(0)!=="#"){var $r=new f(yr);yr=$r.ok?$r.toHex():"#000000"}yr.length===4?(br=yr.substring(1,2),br+=br,Er=yr.substring(2,3),Er+=Er,Lr=yr.substring(3,4),Lr+=Lr):(br=yr.substring(1,3),Er=yr.substring(3,5),Lr=yr.substring(5,7)),br=parseInt(br,16),Er=parseInt(Er,16),Lr=parseInt(Lr,16)}}return{r:br,g:Er,b:Lr,a:Or,style:yr}},cr=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},mr=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};ur.prototype.fillText=function(yr,br,Er,Lr){if(isNaN(br)||isNaN(Er)||typeof yr!="string")throw a.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Lr=isNaN(Lr)?void 0:Lr,!cr.call(this)){var Or=Vr(this.ctx.transform.rotation),Ur=this.ctx.transform.scaleX;kr.call(this,{text:yr,x:br,y:Er,scale:Ur,angle:Or,align:this.textAlign,maxWidth:Lr})}},ur.prototype.strokeText=function(yr,br,Er,Lr){if(isNaN(br)||isNaN(Er)||typeof yr!="string")throw a.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!mr.call(this)){Lr=isNaN(Lr)?void 0:Lr;var Or=Vr(this.ctx.transform.rotation),Ur=this.ctx.transform.scaleX;kr.call(this,{text:yr,x:br,y:Er,scale:Ur,renderingMode:"stroke",angle:Or,align:this.textAlign,maxWidth:Lr})}},ur.prototype.measureText=function(yr){if(typeof yr!="string")throw a.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var br=this.pdf,Er=this.pdf.internal.scaleFactor,Lr=br.internal.getFontSize(),Or=br.getStringUnitWidth(yr)*Lr/br.internal.scaleFactor,Ur=function($r){var Zr=($r=$r||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Zr}}),this};return new Ur({width:Or*=Math.round(96*Er/72*1e4)/1e4})},ur.prototype.scale=function(yr,br){if(isNaN(yr)||isNaN(br))throw a.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Er=new sr(yr,0,0,br,0,0);this.ctx.transform=this.ctx.transform.multiply(Er)},ur.prototype.rotate=function(yr){if(isNaN(yr))throw a.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var br=new sr(Math.cos(yr),Math.sin(yr),-Math.sin(yr),Math.cos(yr),0,0);this.ctx.transform=this.ctx.transform.multiply(br)},ur.prototype.translate=function(yr,br){if(isNaN(yr)||isNaN(br))throw a.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Er=new sr(1,0,0,1,yr,br);this.ctx.transform=this.ctx.transform.multiply(Er)},ur.prototype.transform=function(yr,br,Er,Lr,Or,Ur){if(isNaN(yr)||isNaN(br)||isNaN(Er)||isNaN(Lr)||isNaN(Or)||isNaN(Ur))throw a.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var $r=new sr(yr,br,Er,Lr,Or,Ur);this.ctx.transform=this.ctx.transform.multiply($r)},ur.prototype.setTransform=function(yr,br,Er,Lr,Or,Ur){yr=isNaN(yr)?1:yr,br=isNaN(br)?0:br,Er=isNaN(Er)?0:Er,Lr=isNaN(Lr)?1:Lr,Or=isNaN(Or)?0:Or,Ur=isNaN(Ur)?0:Ur,this.ctx.transform=new sr(yr,br,Er,Lr,Or,Ur)};var dr=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};ur.prototype.drawImage=function(yr,br,Er,Lr,Or,Ur,$r,Zr,fn){var _n=this.pdf.getImageProperties(yr),Kr=1,Cn=1,Dn=1,wn=1;Lr!==void 0&&Zr!==void 0&&(Dn=Zr/Lr,wn=fn/Or,Kr=_n.width/Lr*Zr/Lr,Cn=_n.height/Or*fn/Or),Ur===void 0&&(Ur=br,$r=Er,br=0,Er=0),Lr!==void 0&&Zr===void 0&&(Zr=Lr,fn=Or),Lr===void 0&&Zr===void 0&&(Zr=_n.width,fn=_n.height);for(var Qr,xn=this.ctx.transform.decompose(),tn=Vr(xn.rotate.shx),on=new sr,vn=(on=(on=(on=on.multiply(xn.translate)).multiply(xn.skew)).multiply(xn.scale)).applyToRectangle(new ar(Ur-br*Dn,$r-Er*wn,Lr*Kr,Or*Cn)),Sn=xr.call(this,vn),Ln=[],Wn=0;Wn<Sn.length;Wn+=1)Ln.indexOf(Sn[Wn])===-1&&Ln.push(Sn[Wn]);if(vr(Ln),this.autoPaging)for(var $n=Ln[0],En=Ln[Ln.length-1],ba=$n;ba<En+1;ba++){this.pdf.setPage(ba);var Qn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],vs=ba===1?this.posY+this.margin[0]:this.margin[0],es=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ls=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xn=ba===1?0:es+(ba-2)*ls;if(this.ctx.clip_path.length!==0){var ws=this.path;Qr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gr(Qr,this.posX+this.margin[3],-Xn+vs+this.ctx.prevPageLastElemOffset),Tr.call(this,"fill",!0),this.path=ws}var ds=JSON.parse(JSON.stringify(vn));ds=gr([ds],this.posX+this.margin[3],-Xn+vs+this.ctx.prevPageLastElemOffset)[0];var Ps=(ba>$n||ba<En)&&dr.call(this);Ps&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qn,ls,null).clip().discardPath()),this.pdf.addImage(yr,"JPEG",ds.x,ds.y,ds.w,ds.h,null,null,tn),Ps&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(yr,"JPEG",vn.x,vn.y,vn.w,vn.h,null,null,tn)};var xr=function(yr,br,Er){var Lr=[];br=br||this.pdf.internal.pageSize.width,Er=Er||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Or=this.posY+this.ctx.prevPageLastElemOffset;switch(yr.type){default:case"mt":case"lt":Lr.push(Math.floor((yr.y+Or)/Er)+1);break;case"arc":Lr.push(Math.floor((yr.y+Or-yr.radius)/Er)+1),Lr.push(Math.floor((yr.y+Or+yr.radius)/Er)+1);break;case"qct":var Ur=Rr(this.ctx.lastPoint.x,this.ctx.lastPoint.y,yr.x1,yr.y1,yr.x,yr.y);Lr.push(Math.floor((Ur.y+Or)/Er)+1),Lr.push(Math.floor((Ur.y+Ur.h+Or)/Er)+1);break;case"bct":var $r=Xr(this.ctx.lastPoint.x,this.ctx.lastPoint.y,yr.x1,yr.y1,yr.x2,yr.y2,yr.x,yr.y);Lr.push(Math.floor(($r.y+Or)/Er)+1),Lr.push(Math.floor(($r.y+$r.h+Or)/Er)+1);break;case"rect":Lr.push(Math.floor((yr.y+Or)/Er)+1),Lr.push(Math.floor((yr.y+yr.h+Or)/Er)+1)}for(var Zr=0;Zr<Lr.length;Zr+=1)for(;this.pdf.internal.getNumberOfPages()<Lr[Zr];)pr.call(this);return Lr},pr=function(){var yr=this.fillStyle,br=this.strokeStyle,Er=this.font,Lr=this.lineCap,Or=this.lineWidth,Ur=this.lineJoin;this.pdf.addPage(),this.fillStyle=yr,this.strokeStyle=br,this.font=Er,this.lineCap=Lr,this.lineWidth=Or,this.lineJoin=Ur},gr=function(yr,br,Er){for(var Lr=0;Lr<yr.length;Lr++)switch(yr[Lr].type){case"bct":yr[Lr].x2+=br,yr[Lr].y2+=Er;case"qct":yr[Lr].x1+=br,yr[Lr].y1+=Er;case"mt":case"lt":case"arc":default:yr[Lr].x+=br,yr[Lr].y+=Er}return yr},vr=function(yr){return yr.sort(function(br,Er){return br-Er})},Cr=function(yr,br){for(var Er,Lr,Or=this.fillStyle,Ur=this.strokeStyle,$r=this.lineCap,Zr=this.lineWidth,fn=Math.abs(Zr*this.ctx.transform.scaleX),_n=this.lineJoin,Kr=JSON.parse(JSON.stringify(this.path)),Cn=JSON.parse(JSON.stringify(this.path)),Dn=[],wn=0;wn<Cn.length;wn++)if(Cn[wn].x!==void 0)for(var Qr=xr.call(this,Cn[wn]),xn=0;xn<Qr.length;xn+=1)Dn.indexOf(Qr[xn])===-1&&Dn.push(Qr[xn]);for(var tn=0;tn<Dn.length;tn++)for(;this.pdf.internal.getNumberOfPages()<Dn[tn];)pr.call(this);if(vr(Dn),this.autoPaging)for(var on=Dn[0],vn=Dn[Dn.length-1],Sn=on;Sn<vn+1;Sn++){this.pdf.setPage(Sn),this.fillStyle=Or,this.strokeStyle=Ur,this.lineCap=$r,this.lineWidth=fn,this.lineJoin=_n;var Ln=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Wn=Sn===1?this.posY+this.margin[0]:this.margin[0],$n=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],En=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ba=Sn===1?0:$n+(Sn-2)*En;if(this.ctx.clip_path.length!==0){var Qn=this.path;Er=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gr(Er,this.posX+this.margin[3],-ba+Wn+this.ctx.prevPageLastElemOffset),Tr.call(this,yr,!0),this.path=Qn}if(Lr=JSON.parse(JSON.stringify(Kr)),this.path=gr(Lr,this.posX+this.margin[3],-ba+Wn+this.ctx.prevPageLastElemOffset),br===!1||Sn===0){var vs=(Sn>on||Sn<vn)&&dr.call(this);vs&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ln,En,null).clip().discardPath()),Tr.call(this,yr,br),vs&&this.pdf.restoreGraphicsState()}this.lineWidth=Zr}else this.lineWidth=fn,Tr.call(this,yr,br),this.lineWidth=Zr;this.path=Kr},Tr=function(yr,br){if((yr!=="stroke"||br||!mr.call(this))&&(yr==="stroke"||br||!cr.call(this))){for(var Er,Lr,Or=[],Ur=this.path,$r=0;$r<Ur.length;$r++){var Zr=Ur[$r];switch(Zr.type){case"begin":Or.push({begin:!0});break;case"close":Or.push({close:!0});break;case"mt":Or.push({start:Zr,deltas:[],abs:[]});break;case"lt":var fn=Or.length;if(Ur[$r-1]&&!isNaN(Ur[$r-1].x)&&(Er=[Zr.x-Ur[$r-1].x,Zr.y-Ur[$r-1].y],fn>0)){for(;fn>=0;fn--)if(Or[fn-1].close!==!0&&Or[fn-1].begin!==!0){Or[fn-1].deltas.push(Er),Or[fn-1].abs.push(Zr);break}}break;case"bct":Er=[Zr.x1-Ur[$r-1].x,Zr.y1-Ur[$r-1].y,Zr.x2-Ur[$r-1].x,Zr.y2-Ur[$r-1].y,Zr.x-Ur[$r-1].x,Zr.y-Ur[$r-1].y],Or[Or.length-1].deltas.push(Er);break;case"qct":var _n=Ur[$r-1].x+2/3*(Zr.x1-Ur[$r-1].x),Kr=Ur[$r-1].y+2/3*(Zr.y1-Ur[$r-1].y),Cn=Zr.x+2/3*(Zr.x1-Zr.x),Dn=Zr.y+2/3*(Zr.y1-Zr.y),wn=Zr.x,Qr=Zr.y;Er=[_n-Ur[$r-1].x,Kr-Ur[$r-1].y,Cn-Ur[$r-1].x,Dn-Ur[$r-1].y,wn-Ur[$r-1].x,Qr-Ur[$r-1].y],Or[Or.length-1].deltas.push(Er);break;case"arc":Or.push({deltas:[],abs:[],arc:!0}),Array.isArray(Or[Or.length-1].abs)&&Or[Or.length-1].abs.push(Zr)}}Lr=br?null:yr==="stroke"?"stroke":"fill";for(var xn=!1,tn=0;tn<Or.length;tn++)if(Or[tn].arc)for(var on=Or[tn].abs,vn=0;vn<on.length;vn++){var Sn=on[vn];Sn.type==="arc"?Ar.call(this,Sn.x,Sn.y,Sn.radius,Sn.startAngle,Sn.endAngle,Sn.counterclockwise,void 0,br,!xn):Mr.call(this,Sn.x,Sn.y),xn=!0}else if(Or[tn].close===!0)this.pdf.internal.out("h"),xn=!1;else if(Or[tn].begin!==!0){var Ln=Or[tn].start.x,Wn=Or[tn].start.y;Hr.call(this,Or[tn].deltas,Ln,Wn),xn=!0}Lr&&Pr.call(this,Lr),br&&Ir.call(this)}},Fr=function(yr){var br=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Er=br*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return yr-Er;case"top":return yr+br-Er;case"hanging":return yr+br-2*Er;case"middle":return yr+br/2-Er;case"ideographic":return yr;case"alphabetic":default:return yr}},_r=function(yr){return yr+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};ur.prototype.createLinearGradient=function(){var yr=function(){};return yr.colorStops=[],yr.addColorStop=function(br,Er){this.colorStops.push([br,Er])},yr.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},yr.isCanvasGradient=!0,yr},ur.prototype.createPattern=function(){return this.createLinearGradient()},ur.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Ar=function(yr,br,Er,Lr,Or,Ur,$r,Zr,fn){for(var _n=zr.call(this,Er,Lr,Or,Ur),Kr=0;Kr<_n.length;Kr++){var Cn=_n[Kr];Kr===0&&(fn?wr.call(this,Cn.x1+yr,Cn.y1+br):Mr.call(this,Cn.x1+yr,Cn.y1+br)),Gr.call(this,yr,br,Cn.x2,Cn.y2,Cn.x3,Cn.y3,Cn.x4,Cn.y4)}Zr?Ir.call(this):Pr.call(this,$r)},Pr=function(yr){switch(yr){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Ir=function(){this.pdf.clip(),this.pdf.discardPath()},wr=function(yr,br){this.pdf.internal.out(er(yr)+" "+tr(br)+" m")},kr=function(yr){var br;switch(yr.align){case"right":case"end":br="right";break;case"center":br="center";break;case"left":case"start":default:br="left"}var Er=this.pdf.getTextDimensions(yr.text),Lr=Fr.call(this,yr.y),Or=_r.call(this,Lr)-Er.h,Ur=this.ctx.transform.applyToPoint(new ir(yr.x,Lr)),$r=this.ctx.transform.decompose(),Zr=new sr;Zr=(Zr=(Zr=Zr.multiply($r.translate)).multiply($r.skew)).multiply($r.scale);for(var fn,_n,Kr,Cn=this.ctx.transform.applyToRectangle(new ar(yr.x,Lr,Er.w,Er.h)),Dn=Zr.applyToRectangle(new ar(yr.x,Or,Er.w,Er.h)),wn=xr.call(this,Dn),Qr=[],xn=0;xn<wn.length;xn+=1)Qr.indexOf(wn[xn])===-1&&Qr.push(wn[xn]);if(vr(Qr),this.autoPaging)for(var tn=Qr[0],on=Qr[Qr.length-1],vn=tn;vn<on+1;vn++){this.pdf.setPage(vn);var Sn=vn===1?this.posY+this.margin[0]:this.margin[0],Ln=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Wn=this.pdf.internal.pageSize.height-this.margin[2],$n=Wn-this.margin[0],En=this.pdf.internal.pageSize.width-this.margin[1],ba=En-this.margin[3],Qn=vn===1?0:Ln+(vn-2)*$n;if(this.ctx.clip_path.length!==0){var vs=this.path;fn=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gr(fn,this.posX+this.margin[3],-1*Qn+Sn),Tr.call(this,"fill",!0),this.path=vs}var es=gr([JSON.parse(JSON.stringify(Dn))],this.posX+this.margin[3],-Qn+Sn+this.ctx.prevPageLastElemOffset)[0];yr.scale>=.01&&(_n=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_n*yr.scale),Kr=this.lineWidth,this.lineWidth=Kr*yr.scale);var ls=this.autoPaging!=="text";if(ls||es.y+es.h<=Wn){if(ls||es.y>=Sn&&es.x<=En){var Xn=ls?yr.text:this.pdf.splitTextToSize(yr.text,yr.maxWidth||En-es.x)[0],ws=gr([JSON.parse(JSON.stringify(Cn))],this.posX+this.margin[3],-Qn+Sn+this.ctx.prevPageLastElemOffset)[0],ds=ls&&(vn>tn||vn<on)&&dr.call(this);ds&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ba,$n,null).clip().discardPath()),this.pdf.text(Xn,ws.x,ws.y,{angle:yr.angle,align:br,renderingMode:yr.renderingMode}),ds&&this.pdf.restoreGraphicsState()}}else es.y<Wn&&(this.ctx.prevPageLastElemOffset+=Wn-es.y);yr.scale>=.01&&(this.pdf.setFontSize(_n),this.lineWidth=Kr)}else yr.scale>=.01&&(_n=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_n*yr.scale),Kr=this.lineWidth,this.lineWidth=Kr*yr.scale),this.pdf.text(yr.text,Ur.x+this.posX,Ur.y+this.posY,{angle:yr.angle,align:br,renderingMode:yr.renderingMode,maxWidth:yr.maxWidth}),yr.scale>=.01&&(this.pdf.setFontSize(_n),this.lineWidth=Kr)},Mr=function(yr,br,Er,Lr){Er=Er||0,Lr=Lr||0,this.pdf.internal.out(er(yr+Er)+" "+tr(br+Lr)+" l")},Hr=function(yr,br,Er){return this.pdf.lines(yr,br,Er,null,null)},Gr=function(yr,br,Er,Lr,Or,Ur,$r,Zr){this.pdf.internal.out([_e(rr(Er+yr)),_e(nr(Lr+br)),_e(rr(Or+yr)),_e(nr(Ur+br)),_e(rr($r+yr)),_e(nr(Zr+br)),"c"].join(" "))},zr=function(yr,br,Er,Lr){for(var Or=2*Math.PI,Ur=Math.PI/2;br>Er;)br-=Or;var $r=Math.abs(Er-br);$r<Or&&Lr&&($r=Or-$r);for(var Zr=[],fn=Lr?-1:1,_n=br;$r>1e-5;){var Kr=_n+fn*Math.min($r,Ur);Zr.push(Br.call(this,yr,_n,Kr)),$r-=Math.abs(Kr-_n),_n=Kr}return Zr},Br=function(yr,br,Er){var Lr=(Er-br)/2,Or=yr*Math.cos(Lr),Ur=yr*Math.sin(Lr),$r=Or,Zr=-Ur,fn=$r*$r+Zr*Zr,_n=fn+$r*Or+Zr*Ur,Kr=4/3*(Math.sqrt(2*fn*_n)-_n)/($r*Ur-Zr*Or),Cn=$r-Kr*Zr,Dn=Zr+Kr*$r,wn=Cn,Qr=-Dn,xn=Lr+br,tn=Math.cos(xn),on=Math.sin(xn);return{x1:yr*Math.cos(br),y1:yr*Math.sin(br),x2:Cn*tn-Dn*on,y2:Cn*on+Dn*tn,x3:wn*tn-Qr*on,y3:wn*on+Qr*tn,x4:yr*Math.cos(Er),y4:yr*Math.sin(Er)}},Vr=function(yr){return 180*yr/Math.PI},Rr=function(yr,br,Er,Lr,Or,Ur){var $r=yr+.5*(Er-yr),Zr=br+.5*(Lr-br),fn=Or+.5*(Er-Or),_n=Ur+.5*(Lr-Ur),Kr=Math.min(yr,Or,$r,fn),Cn=Math.max(yr,Or,$r,fn),Dn=Math.min(br,Ur,Zr,_n),wn=Math.max(br,Ur,Zr,_n);return new ar(Kr,Dn,Cn-Kr,wn-Dn)},Xr=function(yr,br,Er,Lr,Or,Ur,$r,Zr){var fn,_n,Kr,Cn,Dn,wn,Qr,xn,tn,on,vn,Sn,Ln,Wn,$n=Er-yr,En=Lr-br,ba=Or-Er,Qn=Ur-Lr,vs=$r-Or,es=Zr-Ur;for(_n=0;_n<41;_n++)tn=(Qr=(Kr=yr+(fn=_n/40)*$n)+fn*((Dn=Er+fn*ba)-Kr))+fn*(Dn+fn*(Or+fn*vs-Dn)-Qr),on=(xn=(Cn=br+fn*En)+fn*((wn=Lr+fn*Qn)-Cn))+fn*(wn+fn*(Ur+fn*es-wn)-xn),_n==0?(vn=tn,Sn=on,Ln=tn,Wn=on):(vn=Math.min(vn,tn),Sn=Math.min(Sn,on),Ln=Math.max(Ln,tn),Wn=Math.max(Wn,on));return new ar(Math.round(vn),Math.round(Sn),Math.round(Ln-vn),Math.round(Wn-Sn))},an=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var yr,br,Er=(yr=this.ctx.lineDash,br=this.ctx.lineDashOffset,JSON.stringify({lineDash:yr,lineDashOffset:br}));this.prevLineDash!==Er&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Er)}}})(E.API),function(e){var _e=function(nr){var ir,ar,sr,or,lr,ur,fr,cr,mr,dr;for(ar=[],sr=0,or=(nr+=ir="\0\0\0\0".slice(nr.length%4||4)).length;or>sr;sr+=4)(lr=(nr.charCodeAt(sr)<<24)+(nr.charCodeAt(sr+1)<<16)+(nr.charCodeAt(sr+2)<<8)+nr.charCodeAt(sr+3))!==0?(ur=(lr=((lr=((lr=((lr=(lr-(dr=lr%85))/85)-(mr=lr%85))/85)-(cr=lr%85))/85)-(fr=lr%85))/85)%85,ar.push(ur+33,fr+33,cr+33,mr+33,dr+33)):ar.push(122);return function(xr,pr){for(var gr=pr;gr>0;gr--)xr.pop()}(ar,ir.length),String.fromCharCode.apply(String,ar)+"~>"},er=function(nr){var ir,ar,sr,or,lr,ur=String,fr="length",cr=255,mr="charCodeAt",dr="slice",xr="replace";for(nr[dr](-2),nr=nr[dr](0,-2)[xr](/\s/g,"")[xr]("z","!!!!!"),sr=[],or=0,lr=(nr+=ir="uuuuu"[dr](nr[fr]%5||5))[fr];lr>or;or+=5)ar=52200625*(nr[mr](or)-33)+614125*(nr[mr](or+1)-33)+7225*(nr[mr](or+2)-33)+85*(nr[mr](or+3)-33)+(nr[mr](or+4)-33),sr.push(cr&ar>>24,cr&ar>>16,cr&ar>>8,cr&ar);return function(pr,gr){for(var vr=gr;vr>0;vr--)pr.pop()}(sr,ir[fr]),ur.fromCharCode.apply(ur,sr)},tr=function(nr){var ir=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((nr=nr.replace(/\s/g,"")).indexOf(">")!==-1&&(nr=nr.substr(0,nr.indexOf(">"))),nr.length%2&&(nr+="0"),ir.test(nr)===!1)return"";for(var ar="",sr=0;sr<nr.length;sr+=2)ar+=String.fromCharCode("0x"+(nr[sr]+nr[sr+1]));return ar},rr=function(nr){for(var ir=new Uint8Array(nr.length),ar=nr.length;ar--;)ir[ar]=nr.charCodeAt(ar);return nr=(ir=zlibSync(ir)).reduce(function(sr,or){return sr+String.fromCharCode(or)},"")};e.processDataByFilters=function(nr,ir){var ar=0,sr=nr||"",or=[];for(typeof(ir=ir||[])=="string"&&(ir=[ir]),ar=0;ar<ir.length;ar+=1)switch(ir[ar]){case"ASCII85Decode":case"/ASCII85Decode":sr=er(sr),or.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":sr=_e(sr),or.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":sr=tr(sr),or.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":sr=sr.split("").map(function(lr){return("0"+lr.charCodeAt().toString(16)).slice(-2)}).join("")+">",or.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":sr=rr(sr),or.push("/FlateDecode");break;default:throw new Error('The filter: "'+ir[ar]+'" is not implemented')}return{data:sr,reverseChain:or.reverse().join(" ")}}}(E.API),function(e){e.loadFile=function(_e,er,tr){return function(rr,nr,ir){nr=nr!==!1,ir=typeof ir=="function"?ir:function(){};var ar=void 0;try{ar=function(sr,or,lr){var ur=new XMLHttpRequest,fr=0,cr=function(mr){var dr=mr.length,xr=[],pr=String.fromCharCode;for(fr=0;fr<dr;fr+=1)xr.push(pr(255&mr.charCodeAt(fr)));return xr.join("")};if(ur.open("GET",sr,!or),ur.overrideMimeType("text/plain; charset=x-user-defined"),or===!1&&(ur.onload=function(){ur.status===200?lr(cr(this.responseText)):lr(void 0)}),ur.send(null),or&&ur.status===200)return cr(ur.responseText)}(rr,nr,ir)}catch{}return ar}(_e,er,tr)},e.loadImageFile=e.loadFile}(E.API),function(e){function _e(){return(n.html2canvas?Promise.resolve(n.html2canvas):__vitePreload(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(ir){return Promise.reject(new Error("Could not load html2canvas: "+ir))}).then(function(ir){return ir.default?ir.default:ir})}function er(){return(n.DOMPurify?Promise.resolve(n.DOMPurify):__vitePreload(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(ir){return Promise.reject(new Error("Could not load dompurify: "+ir))}).then(function(ir){return ir.default?ir.default:ir})}var tr=function(ir){var ar=_typeof(ir);return ar==="undefined"?"undefined":ar==="string"||ir instanceof String?"string":ar==="number"||ir instanceof Number?"number":ar==="function"||ir instanceof Function?"function":ir&&ir.constructor===Array?"array":ir&&ir.nodeType===1?"element":ar==="object"?"object":"unknown"},rr=function(ir,ar){var sr=document.createElement(ir);for(var or in ar.className&&(sr.className=ar.className),ar.innerHTML&&ar.dompurify&&(sr.innerHTML=ar.dompurify.sanitize(ar.innerHTML)),ar.style)sr.style[or]=ar.style[or];return sr},nr=function ir(ar){var sr=Object.assign(ir.convert(Promise.resolve()),JSON.parse(JSON.stringify(ir.template))),or=ir.convert(Promise.resolve(),sr);return or=(or=or.setProgress(1,ir,1,[ir])).set(ar)};(nr.prototype=Object.create(Promise.prototype)).constructor=nr,nr.convert=function(ir,ar){return ir.__proto__=ar||nr.prototype,ir},nr.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},nr.prototype.from=function(ir,ar){return this.then(function(){switch(ar=ar||function(sr){switch(tr(sr)){case"string":return"string";case"element":return sr.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(ir)){case"string":return this.then(er).then(function(sr){return this.set({src:rr("div",{innerHTML:ir,dompurify:sr})})});case"element":return this.set({src:ir});case"canvas":return this.set({canvas:ir});case"img":return this.set({img:ir});default:return this.error("Unknown source type.")}})},nr.prototype.to=function(ir){switch(ir){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},nr.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var ir={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},ar=function sr(or,lr){for(var ur=or.nodeType===3?document.createTextNode(or.nodeValue):or.cloneNode(!1),fr=or.firstChild;fr;fr=fr.nextSibling)lr!==!0&&fr.nodeType===1&&fr.nodeName==="SCRIPT"||ur.appendChild(sr(fr,lr));return or.nodeType===1&&(or.nodeName==="CANVAS"?(ur.width=or.width,ur.height=or.height,ur.getContext("2d").drawImage(or,0,0)):or.nodeName!=="TEXTAREA"&&or.nodeName!=="SELECT"||(ur.value=or.value),ur.addEventListener("load",function(){ur.scrollTop=or.scrollTop,ur.scrollLeft=or.scrollLeft},!0)),ur}(this.prop.src,this.opt.html2canvas.javascriptEnabled);ar.tagName==="BODY"&&(ir.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=rr("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=rr("div",{className:"html2pdf__container",style:ir}),this.prop.container.appendChild(ar),this.prop.container.firstChild.appendChild(rr("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},nr.prototype.toCanvas=function(){var ir=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(ir).then(_e).then(function(ar){var sr=Object.assign({},this.opt.html2canvas);return delete sr.onrendered,ar(this.prop.container,sr)}).then(function(ar){(this.opt.html2canvas.onrendered||function(){})(ar),this.prop.canvas=ar,document.body.removeChild(this.prop.overlay)})},nr.prototype.toContext2d=function(){var ir=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(ir).then(_e).then(function(ar){var sr=this.opt.jsPDF,or=this.opt.fontFaces,lr=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,ur=Object.assign({async:!0,allowTaint:!0,scale:lr,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete ur.onrendered,sr.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,sr.context2d.posX=this.opt.x,sr.context2d.posY=this.opt.y,sr.context2d.margin=this.opt.margin,sr.context2d.fontFaces=or,or)for(var fr=0;fr<or.length;++fr){var cr=or[fr],mr=cr.src.find(function(dr){return dr.format==="truetype"});mr&&sr.addFont(mr.url,cr.ref.name,cr.ref.style)}return ur.windowHeight=ur.windowHeight||0,ur.windowHeight=ur.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):ur.windowHeight,sr.context2d.save(!0),ar(this.prop.container,ur)}).then(function(ar){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(ar),this.prop.canvas=ar,document.body.removeChild(this.prop.overlay)})},nr.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var ir=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=ir})},nr.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},nr.prototype.output=function(ir,ar,sr){return(sr=sr||"pdf").toLowerCase()==="img"||sr.toLowerCase()==="image"?this.outputImg(ir,ar):this.outputPdf(ir,ar)},nr.prototype.outputPdf=function(ir,ar){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(ir,ar)})},nr.prototype.outputImg=function(ir){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(ir){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+ir+'" is not supported.'}})},nr.prototype.save=function(ir){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(ir?{filename:ir}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},nr.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},nr.prototype.set=function(ir){if(tr(ir)!=="object")return this;var ar=Object.keys(ir||{}).map(function(sr){if(sr in nr.template.prop)return function(){this.prop[sr]=ir[sr]};switch(sr){case"margin":return this.setMargin.bind(this,ir.margin);case"jsPDF":return function(){return this.opt.jsPDF=ir.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,ir.pageSize);default:return function(){this.opt[sr]=ir[sr]}}},this);return this.then(function(){return this.thenList(ar)})},nr.prototype.get=function(ir,ar){return this.then(function(){var sr=ir in nr.template.prop?this.prop[ir]:this.opt[ir];return ar?ar(sr):sr})},nr.prototype.setMargin=function(ir){return this.then(function(){switch(tr(ir)){case"number":ir=[ir,ir,ir,ir];case"array":if(ir.length===2&&(ir=[ir[0],ir[1],ir[0],ir[1]]),ir.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=ir}).then(this.setPageSize)},nr.prototype.setPageSize=function(ir){function ar(sr,or){return Math.floor(sr*or/72*96)}return this.then(function(){(ir=ir||E.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(ir.inner={width:ir.width-this.opt.margin[1]-this.opt.margin[3],height:ir.height-this.opt.margin[0]-this.opt.margin[2]},ir.inner.px={width:ar(ir.inner.width,ir.k),height:ar(ir.inner.height,ir.k)},ir.inner.ratio=ir.inner.height/ir.inner.width),this.prop.pageSize=ir})},nr.prototype.setProgress=function(ir,ar,sr,or){return ir!=null&&(this.progress.val=ir),ar!=null&&(this.progress.state=ar),sr!=null&&(this.progress.n=sr),or!=null&&(this.progress.stack=or),this.progress.ratio=this.progress.val/this.progress.state,this},nr.prototype.updateProgress=function(ir,ar,sr,or){return this.setProgress(ir?this.progress.val+ir:null,ar||null,sr?this.progress.n+sr:null,or?this.progress.stack.concat(or):null)},nr.prototype.then=function(ir,ar){var sr=this;return this.thenCore(ir,ar,function(or,lr){return sr.updateProgress(null,null,1,[or]),Promise.prototype.then.call(this,function(ur){return sr.updateProgress(null,or),ur}).then(or,lr).then(function(ur){return sr.updateProgress(1),ur})})},nr.prototype.thenCore=function(ir,ar,sr){sr=sr||Promise.prototype.then,ir&&(ir=ir.bind(this)),ar&&(ar=ar.bind(this));var or=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:nr.convert(Object.assign({},this),Promise.prototype),lr=sr.call(or,ir,ar);return nr.convert(lr,this.__proto__)},nr.prototype.thenExternal=function(ir,ar){return Promise.prototype.then.call(this,ir,ar)},nr.prototype.thenList=function(ir){var ar=this;return ir.forEach(function(sr){ar=ar.thenCore(sr)}),ar},nr.prototype.catch=function(ir){ir&&(ir=ir.bind(this));var ar=Promise.prototype.catch.call(this,ir);return nr.convert(ar,this)},nr.prototype.catchExternal=function(ir){return Promise.prototype.catch.call(this,ir)},nr.prototype.error=function(ir){return this.then(function(){throw new Error(ir)})},nr.prototype.using=nr.prototype.set,nr.prototype.saveAs=nr.prototype.save,nr.prototype.export=nr.prototype.output,nr.prototype.run=nr.prototype.then,E.getPageSize=function(ir,ar,sr){if(_typeof(ir)==="object"){var or=ir;ir=or.orientation,ar=or.unit||ar,sr=or.format||sr}ar=ar||"mm",sr=sr||"a4",ir=(""+(ir||"P")).toLowerCase();var lr,ur=(""+sr).toLowerCase(),fr={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(ar){case"pt":lr=1;break;case"mm":lr=72/25.4;break;case"cm":lr=72/2.54;break;case"in":lr=72;break;case"px":lr=.75;break;case"pc":case"em":lr=12;break;case"ex":lr=6;break;default:throw"Invalid unit: "+ar}var cr,mr=0,dr=0;if(fr.hasOwnProperty(ur))mr=fr[ur][1]/lr,dr=fr[ur][0]/lr;else try{mr=sr[1],dr=sr[0]}catch{throw new Error("Invalid format: "+sr)}if(ir==="p"||ir==="portrait")ir="p",dr>mr&&(cr=dr,dr=mr,mr=cr);else{if(ir!=="l"&&ir!=="landscape")throw"Invalid orientation: "+ir;ir="l",mr>dr&&(cr=dr,dr=mr,mr=cr)}return{width:dr,height:mr,unit:ar,k:lr,orientation:ir}},e.html=function(ir,ar){(ar=ar||{}).callback=ar.callback||function(){},ar.html2canvas=ar.html2canvas||{},ar.html2canvas.canvas=ar.html2canvas.canvas||this.canvas,ar.jsPDF=ar.jsPDF||this,ar.fontFaces=ar.fontFaces?ar.fontFaces.map(jt):null;var sr=new nr(ar);return ar.worker?sr:sr.from(ir).doCallback()}}(E.API),E.API.addJS=function(e){return Ht=e,this.internal.events.subscribe("postPutResources",function(){Ut=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ut+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ht+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ut!==void 0&&zt!==void 0&&this.internal.out("/Names <</JavaScript "+Ut+" 0 R>>")}),this},function(e){var _e;e.events.push(["postPutResources",function(){var er=this,tr=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var rr=er.outline.render().split(/\r\n/),nr=0;nr<rr.length;nr++){var ir=rr[nr],ar=tr.exec(ir);if(ar!=null){var sr=ar[1];er.internal.newObjectDeferredBegin(sr,!1)}er.internal.write(ir)}if(this.outline.createNamedDestinations){var or=this.internal.pages.length,lr=[];for(nr=0;nr<or;nr++){var ur=er.internal.newObject();lr.push(ur);var fr=er.internal.getPageInfo(nr+1);er.internal.write("<< /D["+fr.objId+" 0 R /XYZ null null null]>> endobj")}var cr=er.internal.newObject();for(er.internal.write("<< /Names [ "),nr=0;nr<lr.length;nr++)er.internal.write("(page_"+(nr+1)+")"+lr[nr]+" 0 R");er.internal.write(" ] >>","endobj"),_e=er.internal.newObject(),er.internal.write("<< /Dests "+cr+" 0 R"),er.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+_e+" 0 R"))}]),e.events.push(["initialized",function(){var er=this;er.outline={createNamedDestinations:!1,root:{children:[]}},er.outline.add=function(tr,rr,nr){var ir={title:rr,options:nr,children:[]};return tr==null&&(tr=this.root),tr.children.push(ir),ir},er.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=er,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},er.outline.genIds_r=function(tr){tr.id=er.internal.newObjectDeferred();for(var rr=0;rr<tr.children.length;rr++)this.genIds_r(tr.children[rr])},er.outline.renderRoot=function(tr){this.objStart(tr),this.line("/Type /Outlines"),tr.children.length>0&&(this.line("/First "+this.makeRef(tr.children[0])),this.line("/Last "+this.makeRef(tr.children[tr.children.length-1]))),this.line("/Count "+this.count_r({count:0},tr)),this.objEnd()},er.outline.renderItems=function(tr){for(var rr=this.ctx.pdf.internal.getVerticalCoordinateString,nr=0;nr<tr.children.length;nr++){var ir=tr.children[nr];this.objStart(ir),this.line("/Title "+this.makeString(ir.title)),this.line("/Parent "+this.makeRef(tr)),nr>0&&this.line("/Prev "+this.makeRef(tr.children[nr-1])),nr<tr.children.length-1&&this.line("/Next "+this.makeRef(tr.children[nr+1])),ir.children.length>0&&(this.line("/First "+this.makeRef(ir.children[0])),this.line("/Last "+this.makeRef(ir.children[ir.children.length-1])));var ar=this.count=this.count_r({count:0},ir);if(ar>0&&this.line("/Count "+ar),ir.options&&ir.options.pageNumber){var sr=er.internal.getPageInfo(ir.options.pageNumber);this.line("/Dest ["+sr.objId+" 0 R /XYZ 0 "+rr(0)+" 0]")}this.objEnd()}for(var or=0;or<tr.children.length;or++)this.renderItems(tr.children[or])},er.outline.line=function(tr){this.ctx.val+=tr+`\r
`},er.outline.makeRef=function(tr){return tr.id+" 0 R"},er.outline.makeString=function(tr){return"("+er.internal.pdfEscape(tr)+")"},er.outline.objStart=function(tr){this.ctx.val+=`\r
`+tr.id+` 0 obj\r
<<\r
`},er.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},er.outline.count_r=function(tr,rr){for(var nr=0;nr<rr.children.length;nr++)tr.count++,this.count_r(tr,rr.children[nr]);return tr.count}}])}(E.API),function(e){var _e=[192,193,194,195,196,197,198,199];e.processJPEG=function(er,tr,rr,nr,ir,ar){var sr,or=this.decode.DCT_DECODE,lr=null;if(typeof er=="string"||this.__addimage__.isArrayBuffer(er)||this.__addimage__.isArrayBufferView(er)){switch(er=ir||er,er=this.__addimage__.isArrayBuffer(er)?new Uint8Array(er):er,(sr=function(ur){for(var fr,cr=256*ur.charCodeAt(4)+ur.charCodeAt(5),mr=ur.length,dr={width:0,height:0,numcomponents:1},xr=4;xr<mr;xr+=2){if(xr+=cr,_e.indexOf(ur.charCodeAt(xr+1))!==-1){fr=256*ur.charCodeAt(xr+5)+ur.charCodeAt(xr+6),dr={width:256*ur.charCodeAt(xr+7)+ur.charCodeAt(xr+8),height:fr,numcomponents:ur.charCodeAt(xr+9)};break}cr=256*ur.charCodeAt(xr+2)+ur.charCodeAt(xr+3)}return dr}(er=this.__addimage__.isArrayBufferView(er)?this.__addimage__.arrayBufferToBinaryString(er):er)).numcomponents){case 1:ar=this.color_spaces.DEVICE_GRAY;break;case 4:ar=this.color_spaces.DEVICE_CMYK;break;case 3:ar=this.color_spaces.DEVICE_RGB}lr={data:er,width:sr.width,height:sr.height,colorSpace:ar,bitsPerComponent:8,filter:or,index:tr,alias:rr}}return lr}}(E.API);var Vt,Gt,Yt,Jt,Xt,Kt=function(){var e,_e,er;function tr(nr){var ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr,pr,gr,vr;for(this.data=nr,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},ur=null;;){switch(ir=this.readUInt32(),mr=(function(){var Cr,Tr;for(Tr=[],Cr=0;Cr<4;++Cr)Tr.push(String.fromCharCode(this.data[this.pos++]));return Tr}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(ir);break;case"fcTL":ur&&this.animation.frames.push(ur),this.pos+=4,ur={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},lr=this.readUInt16(),or=this.readUInt16()||100,ur.delay=1e3*lr/or,ur.disposeOp=this.data[this.pos++],ur.blendOp=this.data[this.pos++],ur.data=[];break;case"IDAT":case"fdAT":for(mr==="fdAT"&&(this.pos+=4,ir-=4),nr=(ur!=null?ur.data:void 0)||this.imgData,pr=0;0<=ir?pr<ir:pr>ir;0<=ir?++pr:--pr)nr.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(sr=this.palette.length/3,this.transparency.indexed=this.read(ir),this.transparency.indexed.length>sr)throw new Error("More transparent colors than palette size");if((dr=sr-this.transparency.indexed.length)>0)for(gr=0;0<=dr?gr<dr:gr>dr;0<=dr?++gr:--gr)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(ir)[0];break;case 2:this.transparency.rgb=this.read(ir)}break;case"tEXt":fr=(xr=this.read(ir)).indexOf(0),cr=String.fromCharCode.apply(String,xr.slice(0,fr)),this.text[cr]=String.fromCharCode.apply(String,xr.slice(fr+1));break;case"IEND":return ur&&this.animation.frames.push(ur),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(vr=this.colorType)===4||vr===6,ar=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*ar,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=ir}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}tr.prototype.read=function(nr){var ir,ar;for(ar=[],ir=0;0<=nr?ir<nr:ir>nr;0<=nr?++ir:--ir)ar.push(this.data[this.pos++]);return ar},tr.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},tr.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},tr.prototype.decodePixels=function(nr){var ir=this.pixelBitlength/8,ar=new Uint8Array(this.width*this.height*ir),sr=0,or=this;if(nr==null&&(nr=this.imgData),nr.length===0)return new Uint8Array(0);function lr(ur,fr,cr,mr){var dr,xr,pr,gr,vr,Cr,Tr,Fr,_r,Ar,Pr,Ir,wr,kr,Mr,Hr,Gr,zr,Br,Vr,Rr,Xr=Math.ceil((or.width-ur)/cr),an=Math.ceil((or.height-fr)/mr),yr=or.width==Xr&&or.height==an;for(kr=ir*Xr,Ir=yr?ar:new Uint8Array(kr*an),Cr=nr.length,wr=0,xr=0;wr<an&&sr<Cr;){switch(nr[sr++]){case 0:for(gr=Gr=0;Gr<kr;gr=Gr+=1)Ir[xr++]=nr[sr++];break;case 1:for(gr=zr=0;zr<kr;gr=zr+=1)dr=nr[sr++],vr=gr<ir?0:Ir[xr-ir],Ir[xr++]=(dr+vr)%256;break;case 2:for(gr=Br=0;Br<kr;gr=Br+=1)dr=nr[sr++],pr=(gr-gr%ir)/ir,Mr=wr&&Ir[(wr-1)*kr+pr*ir+gr%ir],Ir[xr++]=(Mr+dr)%256;break;case 3:for(gr=Vr=0;Vr<kr;gr=Vr+=1)dr=nr[sr++],pr=(gr-gr%ir)/ir,vr=gr<ir?0:Ir[xr-ir],Mr=wr&&Ir[(wr-1)*kr+pr*ir+gr%ir],Ir[xr++]=(dr+Math.floor((vr+Mr)/2))%256;break;case 4:for(gr=Rr=0;Rr<kr;gr=Rr+=1)dr=nr[sr++],pr=(gr-gr%ir)/ir,vr=gr<ir?0:Ir[xr-ir],wr===0?Mr=Hr=0:(Mr=Ir[(wr-1)*kr+pr*ir+gr%ir],Hr=pr&&Ir[(wr-1)*kr+(pr-1)*ir+gr%ir]),Tr=vr+Mr-Hr,Fr=Math.abs(Tr-vr),Ar=Math.abs(Tr-Mr),Pr=Math.abs(Tr-Hr),_r=Fr<=Ar&&Fr<=Pr?vr:Ar<=Pr?Mr:Hr,Ir[xr++]=(dr+_r)%256;break;default:throw new Error("Invalid filter algorithm: "+nr[sr-1])}if(!yr){var br=((fr+wr*mr)*or.width+ur)*ir,Er=wr*kr;for(gr=0;gr<Xr;gr+=1){for(var Lr=0;Lr<ir;Lr+=1)ar[br++]=Ir[Er++];br+=(cr-1)*ir}}wr++}}return nr=unzlibSync(nr),or.interlaceMethod==1?(lr(0,0,8,8),lr(4,0,8,8),lr(0,4,4,8),lr(2,0,4,4),lr(0,2,2,4),lr(1,0,2,2),lr(0,1,1,2)):lr(0,0,1,1),ar},tr.prototype.decodePalette=function(){var nr,ir,ar,sr,or,lr,ur,fr,cr;for(ar=this.palette,lr=this.transparency.indexed||[],or=new Uint8Array((lr.length||0)+ar.length),sr=0,nr=0,ir=ur=0,fr=ar.length;ur<fr;ir=ur+=3)or[sr++]=ar[ir],or[sr++]=ar[ir+1],or[sr++]=ar[ir+2],or[sr++]=(cr=lr[nr++])!=null?cr:255;return or},tr.prototype.copyToImageData=function(nr,ir){var ar,sr,or,lr,ur,fr,cr,mr,dr,xr,pr;if(sr=this.colors,dr=null,ar=this.hasAlphaChannel,this.palette.length&&(dr=(pr=this._decodedPalette)!=null?pr:this._decodedPalette=this.decodePalette(),sr=4,ar=!0),mr=(or=nr.data||nr).length,ur=dr||ir,lr=fr=0,sr===1)for(;lr<mr;)cr=dr?4*ir[lr/4]:fr,xr=ur[cr++],or[lr++]=xr,or[lr++]=xr,or[lr++]=xr,or[lr++]=ar?ur[cr++]:255,fr=cr;else for(;lr<mr;)cr=dr?4*ir[lr/4]:fr,or[lr++]=ur[cr++],or[lr++]=ur[cr++],or[lr++]=ur[cr++],or[lr++]=ar?ur[cr++]:255,fr=cr},tr.prototype.decode=function(){var nr;return nr=new Uint8Array(this.width*this.height*4),this.copyToImageData(nr,this.decodePixels()),nr};var rr=function(){if(Object.prototype.toString.call(n)==="[object Window]"){try{_e=n.document.createElement("canvas"),er=_e.getContext("2d")}catch{return!1}return!0}return!1};return rr(),e=function(nr){var ir;if(rr()===!0)return er.width=nr.width,er.height=nr.height,er.clearRect(0,0,nr.width,nr.height),er.putImageData(nr,0,0),(ir=new Image).src=_e.toDataURL(),ir;throw new Error("This method requires a Browser with Canvas-capability.")},tr.prototype.decodeFrames=function(nr){var ir,ar,sr,or,lr,ur,fr,cr;if(this.animation){for(cr=[],ar=lr=0,ur=(fr=this.animation.frames).length;lr<ur;ar=++lr)ir=fr[ar],sr=nr.createImageData(ir.width,ir.height),or=this.decodePixels(new Uint8Array(ir.data)),this.copyToImageData(sr,or),ir.imageData=sr,cr.push(ir.image=e(sr));return cr}},tr.prototype.renderFrame=function(nr,ir){var ar,sr,or;return ar=(sr=this.animation.frames)[ir],or=sr[ir-1],ir===0&&nr.clearRect(0,0,this.width,this.height),(or!=null?or.disposeOp:void 0)===1?nr.clearRect(or.xOffset,or.yOffset,or.width,or.height):(or!=null?or.disposeOp:void 0)===2&&nr.putImageData(or.imageData,or.xOffset,or.yOffset),ar.blendOp===0&&nr.clearRect(ar.xOffset,ar.yOffset,ar.width,ar.height),nr.drawImage(ar.image,ar.xOffset,ar.yOffset)},tr.prototype.animate=function(nr){var ir,ar,sr,or,lr,ur,fr=this;return ar=0,ur=this.animation,or=ur.numFrames,sr=ur.frames,lr=ur.numPlays,(ir=function(){var cr,mr;if(cr=ar++%or,mr=sr[cr],fr.renderFrame(nr,cr),or>1&&ar/or<lr)return fr.animation._timeout=setTimeout(ir,mr.delay)})()},tr.prototype.stopAnimation=function(){var nr;return clearTimeout((nr=this.animation)!=null?nr._timeout:void 0)},tr.prototype.render=function(nr){var ir,ar;return nr._png&&nr._png.stopAnimation(),nr._png=this,nr.width=this.width,nr.height=this.height,ir=nr.getContext("2d"),this.animation?(this.decodeFrames(ir),this.animate(ir)):(ar=ir.createImageData(this.width,this.height),this.copyToImageData(ar,this.decodePixels()),ir.putImageData(ar,0,0))},tr}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Zt(e){var _e=0;if(e[_e++]!==71||e[_e++]!==73||e[_e++]!==70||e[_e++]!==56||(e[_e++]+1&253)!=56||e[_e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var er=e[_e++]|e[_e++]<<8,tr=e[_e++]|e[_e++]<<8,rr=e[_e++],nr=rr>>7,ir=1<<(7&rr)+1;e[_e++],e[_e++];var ar=null,sr=null;nr&&(ar=_e,sr=ir,_e+=3*ir);var or=!0,lr=[],ur=0,fr=null,cr=0,mr=null;for(this.width=er,this.height=tr;or&&_e<e.length;)switch(e[_e++]){case 33:switch(e[_e++]){case 255:if(e[_e]!==11||e[_e+1]==78&&e[_e+2]==69&&e[_e+3]==84&&e[_e+4]==83&&e[_e+5]==67&&e[_e+6]==65&&e[_e+7]==80&&e[_e+8]==69&&e[_e+9]==50&&e[_e+10]==46&&e[_e+11]==48&&e[_e+12]==3&&e[_e+13]==1&&e[_e+16]==0)_e+=14,mr=e[_e++]|e[_e++]<<8,_e++;else for(_e+=12;;){if(!((wr=e[_e++])>=0))throw Error("Invalid block size");if(wr===0)break;_e+=wr}break;case 249:if(e[_e++]!==4||e[_e+4]!==0)throw new Error("Invalid graphics extension block.");var dr=e[_e++];ur=e[_e++]|e[_e++]<<8,fr=e[_e++],!(1&dr)&&(fr=null),cr=dr>>2&7,_e++;break;case 254:for(;;){if(!((wr=e[_e++])>=0))throw Error("Invalid block size");if(wr===0)break;_e+=wr}break;default:throw new Error("Unknown graphic control label: 0x"+e[_e-1].toString(16))}break;case 44:var xr=e[_e++]|e[_e++]<<8,pr=e[_e++]|e[_e++]<<8,gr=e[_e++]|e[_e++]<<8,vr=e[_e++]|e[_e++]<<8,Cr=e[_e++],Tr=Cr>>6&1,Fr=1<<(7&Cr)+1,_r=ar,Ar=sr,Pr=!1;Cr>>7&&(Pr=!0,_r=_e,Ar=Fr,_e+=3*Fr);var Ir=_e;for(_e++;;){var wr;if(!((wr=e[_e++])>=0))throw Error("Invalid block size");if(wr===0)break;_e+=wr}lr.push({x:xr,y:pr,width:gr,height:vr,has_local_palette:Pr,palette_offset:_r,palette_size:Ar,data_offset:Ir,data_length:_e-Ir,transparent_index:fr,interlaced:!!Tr,delay:ur,disposal:cr});break;case 59:or=!1;break;default:throw new Error("Unknown gif block: 0x"+e[_e-1].toString(16))}this.numFrames=function(){return lr.length},this.loopCount=function(){return mr},this.frameInfo=function(kr){if(kr<0||kr>=lr.length)throw new Error("Frame index out of range.");return lr[kr]},this.decodeAndBlitFrameBGRA=function(kr,Mr){var Hr=this.frameInfo(kr),Gr=Hr.width*Hr.height,zr=new Uint8Array(Gr);$t(e,Hr.data_offset,zr,Gr);var Br=Hr.palette_offset,Vr=Hr.transparent_index;Vr===null&&(Vr=256);var Rr=Hr.width,Xr=er-Rr,an=Rr,yr=4*(Hr.y*er+Hr.x),br=4*((Hr.y+Hr.height)*er+Hr.x),Er=yr,Lr=4*Xr;Hr.interlaced===!0&&(Lr+=4*er*7);for(var Or=8,Ur=0,$r=zr.length;Ur<$r;++Ur){var Zr=zr[Ur];if(an===0&&(an=Rr,(Er+=Lr)>=br&&(Lr=4*Xr+4*er*(Or-1),Er=yr+(Rr+Xr)*(Or<<1),Or>>=1)),Zr===Vr)Er+=4;else{var fn=e[Br+3*Zr],_n=e[Br+3*Zr+1],Kr=e[Br+3*Zr+2];Mr[Er++]=Kr,Mr[Er++]=_n,Mr[Er++]=fn,Mr[Er++]=255}--an}},this.decodeAndBlitFrameRGBA=function(kr,Mr){var Hr=this.frameInfo(kr),Gr=Hr.width*Hr.height,zr=new Uint8Array(Gr);$t(e,Hr.data_offset,zr,Gr);var Br=Hr.palette_offset,Vr=Hr.transparent_index;Vr===null&&(Vr=256);var Rr=Hr.width,Xr=er-Rr,an=Rr,yr=4*(Hr.y*er+Hr.x),br=4*((Hr.y+Hr.height)*er+Hr.x),Er=yr,Lr=4*Xr;Hr.interlaced===!0&&(Lr+=4*er*7);for(var Or=8,Ur=0,$r=zr.length;Ur<$r;++Ur){var Zr=zr[Ur];if(an===0&&(an=Rr,(Er+=Lr)>=br&&(Lr=4*Xr+4*er*(Or-1),Er=yr+(Rr+Xr)*(Or<<1),Or>>=1)),Zr===Vr)Er+=4;else{var fn=e[Br+3*Zr],_n=e[Br+3*Zr+1],Kr=e[Br+3*Zr+2];Mr[Er++]=fn,Mr[Er++]=_n,Mr[Er++]=Kr,Mr[Er++]=255}--an}}}function $t(e,_e,er,tr){for(var rr=e[_e++],nr=1<<rr,ir=nr+1,ar=ir+1,sr=rr+1,or=(1<<sr)-1,lr=0,ur=0,fr=0,cr=e[_e++],mr=new Int32Array(4096),dr=null;;){for(;lr<16&&cr!==0;)ur|=e[_e++]<<lr,lr+=8,cr===1?cr=e[_e++]:--cr;if(lr<sr)break;var xr=ur&or;if(ur>>=sr,lr-=sr,xr!==nr){if(xr===ir)break;for(var pr=xr<ar?xr:dr,gr=0,vr=pr;vr>nr;)vr=mr[vr]>>8,++gr;var Cr=vr;if(fr+gr+(pr!==xr?1:0)>tr)return void a.log("Warning, gif stream longer than expected.");er[fr++]=Cr;var Tr=fr+=gr;for(pr!==xr&&(er[fr++]=Cr),vr=pr;gr--;)vr=mr[vr],er[--Tr]=255&vr,vr>>=8;dr!==null&&ar<4096&&(mr[ar++]=dr<<8|Cr,ar>=or+1&&sr<12&&(++sr,or=or<<1|1)),dr=xr}else ar=ir+1,or=(1<<(sr=rr+1))-1,dr=null}return fr!==tr&&a.log("Warning, gif stream shorter than expected."),er}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Qt(e){var _e,er,tr,rr,nr,ir=Math.floor,ar=new Array(64),sr=new Array(64),or=new Array(64),lr=new Array(64),ur=new Array(65535),fr=new Array(65535),cr=new Array(64),mr=new Array(64),dr=[],xr=0,pr=7,gr=new Array(64),vr=new Array(64),Cr=new Array(64),Tr=new Array(256),Fr=new Array(2048),_r=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ar=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Pr=[0,1,2,3,4,5,6,7,8,9,10,11],Ir=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],wr=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],kr=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Mr=[0,1,2,3,4,5,6,7,8,9,10,11],Hr=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Gr=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function zr(yr,br){for(var Er=0,Lr=0,Or=new Array,Ur=1;Ur<=16;Ur++){for(var $r=1;$r<=yr[Ur];$r++)Or[br[Lr]]=[],Or[br[Lr]][0]=Er,Or[br[Lr]][1]=Ur,Lr++,Er++;Er*=2}return Or}function Br(yr){for(var br=yr[0],Er=yr[1]-1;Er>=0;)br&1<<Er&&(xr|=1<<pr),Er--,--pr<0&&(xr==255?(Vr(255),Vr(0)):Vr(xr),pr=7,xr=0)}function Vr(yr){dr.push(yr)}function Rr(yr){Vr(yr>>8&255),Vr(255&yr)}function Xr(yr,br,Er,Lr,Or){for(var Ur,$r=Or[0],Zr=Or[240],fn=function(on,vn){var Sn,Ln,Wn,$n,En,ba,Qn,vs,es,ls,Xn=0;for(es=0;es<8;++es){Sn=on[Xn],Ln=on[Xn+1],Wn=on[Xn+2],$n=on[Xn+3],En=on[Xn+4],ba=on[Xn+5],Qn=on[Xn+6];var ws=Sn+(vs=on[Xn+7]),ds=Sn-vs,Ps=Ln+Qn,Zn=Ln-Qn,Mn=Wn+ba,zn=Wn-ba,cs=$n+En,Ls=$n-En,As=ws+cs,yn=ws-cs,_i=Ps+Mn,rs=Ps-Mn;on[Xn]=As+_i,on[Xn+4]=As-_i;var os=.707106781*(rs+yn);on[Xn+2]=yn+os,on[Xn+6]=yn-os;var ms=.382683433*((As=Ls+zn)-(rs=Zn+ds)),bs=.5411961*As+ms,gn=1.306562965*rs+ms,pn=.707106781*(_i=zn+Zn),Pn=ds+pn,Rn=ds-pn;on[Xn+5]=Rn+bs,on[Xn+3]=Rn-bs,on[Xn+1]=Pn+gn,on[Xn+7]=Pn-gn,Xn+=8}for(Xn=0,es=0;es<8;++es){Sn=on[Xn],Ln=on[Xn+8],Wn=on[Xn+16],$n=on[Xn+24],En=on[Xn+32],ba=on[Xn+40],Qn=on[Xn+48];var Yn=Sn+(vs=on[Xn+56]),xa=Sn-vs,$a=Ln+Qn,ys=Ln-Qn,xs=Wn+ba,Jr=Wn-ba,Yr=$n+En,qr=$n-En,en=Yn+Yr,sn=Yn-Yr,un=$a+xs,Tn=$a-xs;on[Xn]=en+un,on[Xn+32]=en-un;var In=.707106781*(Tn+sn);on[Xn+16]=sn+In,on[Xn+48]=sn-In;var Fn=.382683433*((en=qr+Jr)-(Tn=ys+xa)),kn=.5411961*en+Fn,Nn=1.306562965*Tn+Fn,Kn=.707106781*(un=Jr+ys),is=xa+Kn,ps=xa-Kn;on[Xn+40]=ps+kn,on[Xn+24]=ps-kn,on[Xn+8]=is+Nn,on[Xn+56]=is-Nn,Xn++}for(es=0;es<64;++es)ls=on[es]*vn[es],cr[es]=ls>0?ls+.5|0:ls-.5|0;return cr}(yr,br),_n=0;_n<64;++_n)mr[_r[_n]]=fn[_n];var Kr=mr[0]-Er;Er=mr[0],Kr==0?Br(Lr[0]):(Br(Lr[fr[Ur=32767+Kr]]),Br(ur[Ur]));for(var Cn=63;Cn>0&&mr[Cn]==0;)Cn--;if(Cn==0)return Br($r),Er;for(var Dn,wn=1;wn<=Cn;){for(var Qr=wn;mr[wn]==0&&wn<=Cn;)++wn;var xn=wn-Qr;if(xn>=16){Dn=xn>>4;for(var tn=1;tn<=Dn;++tn)Br(Zr);xn&=15}Ur=32767+mr[wn],Br(Or[(xn<<4)+fr[Ur]]),Br(ur[Ur]),wn++}return Cn!=63&&Br($r),Er}function an(yr){yr=Math.min(Math.max(yr,1),100),nr!=yr&&(function(br){for(var Er=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Lr=0;Lr<64;Lr++){var Or=ir((Er[Lr]*br+50)/100);Or=Math.min(Math.max(Or,1),255),ar[_r[Lr]]=Or}for(var Ur=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],$r=0;$r<64;$r++){var Zr=ir((Ur[$r]*br+50)/100);Zr=Math.min(Math.max(Zr,1),255),sr[_r[$r]]=Zr}for(var fn=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],_n=0,Kr=0;Kr<8;Kr++)for(var Cn=0;Cn<8;Cn++)or[_n]=1/(ar[_r[_n]]*fn[Kr]*fn[Cn]*8),lr[_n]=1/(sr[_r[_n]]*fn[Kr]*fn[Cn]*8),_n++}(yr<50?Math.floor(5e3/yr):Math.floor(200-2*yr)),nr=yr)}this.encode=function(yr,br){br&&an(br),dr=new Array,xr=0,pr=7,Rr(65496),Rr(65504),Rr(16),Vr(74),Vr(70),Vr(73),Vr(70),Vr(0),Vr(1),Vr(1),Vr(0),Rr(1),Rr(1),Vr(0),Vr(0),function(){Rr(65499),Rr(132),Vr(0);for(var Ln=0;Ln<64;Ln++)Vr(ar[Ln]);Vr(1);for(var Wn=0;Wn<64;Wn++)Vr(sr[Wn])}(),function(Ln,Wn){Rr(65472),Rr(17),Vr(8),Rr(Wn),Rr(Ln),Vr(3),Vr(1),Vr(17),Vr(0),Vr(2),Vr(17),Vr(1),Vr(3),Vr(17),Vr(1)}(yr.width,yr.height),function(){Rr(65476),Rr(418),Vr(0);for(var Ln=0;Ln<16;Ln++)Vr(Ar[Ln+1]);for(var Wn=0;Wn<=11;Wn++)Vr(Pr[Wn]);Vr(16);for(var $n=0;$n<16;$n++)Vr(Ir[$n+1]);for(var En=0;En<=161;En++)Vr(wr[En]);Vr(1);for(var ba=0;ba<16;ba++)Vr(kr[ba+1]);for(var Qn=0;Qn<=11;Qn++)Vr(Mr[Qn]);Vr(17);for(var vs=0;vs<16;vs++)Vr(Hr[vs+1]);for(var es=0;es<=161;es++)Vr(Gr[es])}(),Rr(65498),Rr(12),Vr(3),Vr(1),Vr(0),Vr(2),Vr(17),Vr(3),Vr(17),Vr(0),Vr(63),Vr(0);var Er=0,Lr=0,Or=0;xr=0,pr=7,this.encode.displayName="_encode_";for(var Ur,$r,Zr,fn,_n,Kr,Cn,Dn,wn,Qr=yr.data,xn=yr.width,tn=yr.height,on=4*xn,vn=0;vn<tn;){for(Ur=0;Ur<on;){for(_n=on*vn+Ur,Cn=-1,Dn=0,wn=0;wn<64;wn++)Kr=_n+(Dn=wn>>3)*on+(Cn=4*(7&wn)),vn+Dn>=tn&&(Kr-=on*(vn+1+Dn-tn)),Ur+Cn>=on&&(Kr-=Ur+Cn-on+4),$r=Qr[Kr++],Zr=Qr[Kr++],fn=Qr[Kr++],gr[wn]=(Fr[$r]+Fr[Zr+256>>0]+Fr[fn+512>>0]>>16)-128,vr[wn]=(Fr[$r+768>>0]+Fr[Zr+1024>>0]+Fr[fn+1280>>0]>>16)-128,Cr[wn]=(Fr[$r+1280>>0]+Fr[Zr+1536>>0]+Fr[fn+1792>>0]>>16)-128;Er=Xr(gr,or,Er,_e,tr),Lr=Xr(vr,lr,Lr,er,rr),Or=Xr(Cr,lr,Or,er,rr),Ur+=32}vn+=8}if(pr>=0){var Sn=[];Sn[1]=pr+1,Sn[0]=(1<<pr+1)-1,Br(Sn)}return Rr(65497),new Uint8Array(dr)},e=e||50,function(){for(var yr=String.fromCharCode,br=0;br<256;br++)Tr[br]=yr(br)}(),_e=zr(Ar,Pr),er=zr(kr,Mr),tr=zr(Ir,wr),rr=zr(Hr,Gr),function(){for(var yr=1,br=2,Er=1;Er<=15;Er++){for(var Lr=yr;Lr<br;Lr++)fr[32767+Lr]=Er,ur[32767+Lr]=[],ur[32767+Lr][1]=Er,ur[32767+Lr][0]=Lr;for(var Or=-(br-1);Or<=-yr;Or++)fr[32767+Or]=Er,ur[32767+Or]=[],ur[32767+Or][1]=Er,ur[32767+Or][0]=br-1+Or;yr<<=1,br<<=1}}(),function(){for(var yr=0;yr<256;yr++)Fr[yr]=19595*yr,Fr[yr+256>>0]=38470*yr,Fr[yr+512>>0]=7471*yr+32768,Fr[yr+768>>0]=-11059*yr,Fr[yr+1024>>0]=-21709*yr,Fr[yr+1280>>0]=32768*yr+8421375,Fr[yr+1536>>0]=-27439*yr,Fr[yr+1792>>0]=-5329*yr}(),an(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function te(e,_e){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!_e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ee(e){function _e(Ar){if(!Ar)throw Error("assert :P")}function er(Ar,Pr,Ir){for(var wr=0;4>wr;wr++)if(Ar[Pr+wr]!=Ir.charCodeAt(wr))return!0;return!1}function tr(Ar,Pr,Ir,wr,kr){for(var Mr=0;Mr<kr;Mr++)Ar[Pr+Mr]=Ir[wr+Mr]}function rr(Ar,Pr,Ir,wr){for(var kr=0;kr<wr;kr++)Ar[Pr+kr]=Ir}function nr(Ar){return new Int32Array(Ar)}function ir(Ar,Pr){for(var Ir=[],wr=0;wr<Ar;wr++)Ir.push(new Pr);return Ir}function ar(Ar,Pr){var Ir=[];return function wr(kr,Mr,Hr){for(var Gr=Hr[Mr],zr=0;zr<Gr&&(kr.push(Hr.length>Mr+1?[]:new Pr),!(Hr.length<Mr+1));zr++)wr(kr[zr],Mr+1,Hr)}(Ir,0,Ar),Ir}var sr=function(){var Ar=this;function Pr(hr,Sr){for(var Dr=1<<Sr-1>>>0;hr&Dr;)Dr>>>=1;return Dr?(hr&Dr-1)+Dr:hr}function Ir(hr,Sr,Dr,Wr,rn){_e(!(Wr%Dr));do hr[Sr+(Wr-=Dr)]=rn;while(0<Wr)}function wr(hr,Sr,Dr,Wr,rn){if(_e(2328>=rn),512>=rn)var cn=nr(512);else if((cn=nr(rn))==null)return 0;return function(hn,dn,mn,bn,Bn,na){var ga,qn,hs=dn,ts=1<<mn,Un=nr(16),Hn=nr(16);for(_e(Bn!=0),_e(bn!=null),_e(hn!=null),_e(0<mn),qn=0;qn<Bn;++qn){if(15<bn[qn])return 0;++Un[bn[qn]]}if(Un[0]==Bn)return 0;for(Hn[1]=0,ga=1;15>ga;++ga){if(Un[ga]>1<<ga)return 0;Hn[ga+1]=Hn[ga]+Un[ga]}for(qn=0;qn<Bn;++qn)ga=bn[qn],0<bn[qn]&&(na[Hn[ga]++]=qn);if(Hn[15]==1)return(bn=new kr).g=0,bn.value=na[0],Ir(hn,hs,1,ts,bn),ts;var us,gs=-1,fs=ts-1,Fs=0,Es=1,Ds=1,Ts=1<<mn;for(qn=0,ga=1,Bn=2;ga<=mn;++ga,Bn<<=1){if(Es+=Ds<<=1,0>(Ds-=Un[ga]))return 0;for(;0<Un[ga];--Un[ga])(bn=new kr).g=ga,bn.value=na[qn++],Ir(hn,hs+Fs,Bn,Ts,bn),Fs=Pr(Fs,ga)}for(ga=mn+1,Bn=2;15>=ga;++ga,Bn<<=1){if(Es+=Ds<<=1,0>(Ds-=Un[ga]))return 0;for(;0<Un[ga];--Un[ga]){if(bn=new kr,(Fs&fs)!=gs){for(hs+=Ts,us=1<<(gs=ga)-mn;15>gs&&!(0>=(us-=Un[gs]));)++gs,us<<=1;ts+=Ts=1<<(us=gs-mn),hn[dn+(gs=Fs&fs)].g=us+mn,hn[dn+gs].value=hs-dn-gs}bn.g=ga-mn,bn.value=na[qn++],Ir(hn,hs+(Fs>>mn),Bn,Ts,bn),Fs=Pr(Fs,ga)}}return Es!=2*Hn[15]-1?0:ts}(hr,Sr,Dr,Wr,rn,cn)}function kr(){this.value=this.g=0}function Mr(){this.value=this.g=0}function Hr(){this.G=ir(5,kr),this.H=nr(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=ir(xo,Mr)}function Gr(hr,Sr,Dr,Wr){_e(hr!=null),_e(Sr!=null),_e(2147483648>Wr),hr.Ca=254,hr.I=0,hr.b=-8,hr.Ka=0,hr.oa=Sr,hr.pa=Dr,hr.Jd=Sr,hr.Yc=Dr+Wr,hr.Zc=4<=Wr?Dr+Wr-4+1:Dr,Ur(hr)}function zr(hr,Sr){for(var Dr=0;0<Sr--;)Dr|=Zr(hr,128)<<Sr;return Dr}function Br(hr,Sr){var Dr=zr(hr,Sr);return $r(hr)?-Dr:Dr}function Vr(hr,Sr,Dr,Wr){var rn,cn=0;for(_e(hr!=null),_e(Sr!=null),_e(4294967288>Wr),hr.Sb=Wr,hr.Ra=0,hr.u=0,hr.h=0,4<Wr&&(Wr=4),rn=0;rn<Wr;++rn)cn+=Sr[Dr+rn]<<8*rn;hr.Ra=cn,hr.bb=Wr,hr.oa=Sr,hr.pa=Dr}function Rr(hr){for(;8<=hr.u&&hr.bb<hr.Sb;)hr.Ra>>>=8,hr.Ra+=hr.oa[hr.pa+hr.bb]<<uu-8>>>0,++hr.bb,hr.u-=8;Er(hr)&&(hr.h=1,hr.u=0)}function Xr(hr,Sr){if(_e(0<=Sr),!hr.h&&Sr<=cu){var Dr=br(hr)&lu[Sr];return hr.u+=Sr,Rr(hr),Dr}return hr.h=1,hr.u=0}function an(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function yr(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function br(hr){return hr.Ra>>>(hr.u&uu-1)>>>0}function Er(hr){return _e(hr.bb<=hr.Sb),hr.h||hr.bb==hr.Sb&&hr.u>uu}function Lr(hr,Sr){hr.u=Sr,hr.h=Er(hr)}function Or(hr){hr.u>=zu&&(_e(hr.u>=zu),Rr(hr))}function Ur(hr){_e(hr!=null&&hr.oa!=null),hr.pa<hr.Zc?(hr.I=(hr.oa[hr.pa++]|hr.I<<8)>>>0,hr.b+=8):(_e(hr!=null&&hr.oa!=null),hr.pa<hr.Yc?(hr.b+=8,hr.I=hr.oa[hr.pa++]|hr.I<<8):hr.Ka?hr.b=0:(hr.I<<=8,hr.b+=8,hr.Ka=1))}function $r(hr){return zr(hr,1)}function Zr(hr,Sr){var Dr=hr.Ca;0>hr.b&&Ur(hr);var Wr=hr.b,rn=Dr*Sr>>>8,cn=(hr.I>>>Wr>rn)+0;for(cn?(Dr-=rn,hr.I-=rn+1<<Wr>>>0):Dr=rn+1,Wr=Dr,rn=0;256<=Wr;)rn+=8,Wr>>=8;return Wr=7^rn+Ao[Wr],hr.b-=Wr,hr.Ca=(Dr<<Wr)-1,cn}function fn(hr,Sr,Dr){hr[Sr+0]=Dr>>24&255,hr[Sr+1]=Dr>>16&255,hr[Sr+2]=Dr>>8&255,hr[Sr+3]=Dr>>0&255}function _n(hr,Sr){return hr[Sr+0]<<0|hr[Sr+1]<<8}function Kr(hr,Sr){return _n(hr,Sr)|hr[Sr+2]<<16}function Cn(hr,Sr){return _n(hr,Sr)|_n(hr,Sr+2)<<16}function Dn(hr,Sr){var Dr=1<<Sr;return _e(hr!=null),_e(0<Sr),hr.X=nr(Dr),hr.X==null?0:(hr.Mb=32-Sr,hr.Xa=Sr,1)}function wn(hr,Sr){_e(hr!=null),_e(Sr!=null),_e(hr.Xa==Sr.Xa),tr(Sr.X,0,hr.X,0,1<<Sr.Xa)}function Qr(){this.X=[],this.Xa=this.Mb=0}function xn(hr,Sr,Dr,Wr){_e(Dr!=null),_e(Wr!=null);var rn=Dr[0],cn=Wr[0];return rn==0&&(rn=(hr*cn+Sr/2)/Sr),cn==0&&(cn=(Sr*rn+hr/2)/hr),0>=rn||0>=cn?0:(Dr[0]=rn,Wr[0]=cn,1)}function tn(hr,Sr){return hr+(1<<Sr)-1>>>Sr}function on(hr,Sr){return((4278255360&hr)+(4278255360&Sr)>>>0&4278255360)+((16711935&hr)+(16711935&Sr)>>>0&16711935)>>>0}function vn(hr,Sr){Ar[Sr]=function(Dr,Wr,rn,cn,hn,dn,mn){var bn;for(bn=0;bn<hn;++bn){var Bn=Ar[hr](dn[mn+bn-1],rn,cn+bn);dn[mn+bn]=on(Dr[Wr+bn],Bn)}}}function Sn(){this.ud=this.hd=this.jd=0}function Ln(hr,Sr){return((4278124286&(hr^Sr))>>>1)+(hr&Sr)>>>0}function Wn(hr){return 0<=hr&&256>hr?hr:0>hr?0:255<hr?255:void 0}function $n(hr,Sr){return Wn(hr+(hr-Sr+.5>>1))}function En(hr,Sr,Dr){return Math.abs(Sr-Dr)-Math.abs(hr-Dr)}function ba(hr,Sr,Dr,Wr,rn,cn,hn){for(Wr=cn[hn-1],Dr=0;Dr<rn;++Dr)cn[hn+Dr]=Wr=on(hr[Sr+Dr],Wr)}function Qn(hr,Sr,Dr,Wr,rn){var cn;for(cn=0;cn<Dr;++cn){var hn=hr[Sr+cn],dn=hn>>8&255,mn=16711935&(mn=(mn=16711935&hn)+((dn<<16)+dn));Wr[rn+cn]=(4278255360&hn)+mn>>>0}}function vs(hr,Sr){Sr.jd=hr>>0&255,Sr.hd=hr>>8&255,Sr.ud=hr>>16&255}function es(hr,Sr,Dr,Wr,rn,cn){var hn;for(hn=0;hn<Wr;++hn){var dn=Sr[Dr+hn],mn=dn>>>8,bn=dn,Bn=255&(Bn=(Bn=dn>>>16)+((hr.jd<<24>>24)*(mn<<24>>24)>>>5));bn=255&(bn=(bn=bn+((hr.hd<<24>>24)*(mn<<24>>24)>>>5))+((hr.ud<<24>>24)*(Bn<<24>>24)>>>5)),rn[cn+hn]=(4278255360&dn)+(Bn<<16)+bn}}function ls(hr,Sr,Dr,Wr,rn){Ar[Sr]=function(cn,hn,dn,mn,bn,Bn,na,ga,qn){for(mn=na;mn<ga;++mn)for(na=0;na<qn;++na)bn[Bn++]=rn(dn[Wr(cn[hn++])])},Ar[hr]=function(cn,hn,dn,mn,bn,Bn,na){var ga=8>>cn.b,qn=cn.Ea,hs=cn.K[0],ts=cn.w;if(8>ga)for(cn=(1<<cn.b)-1,ts=(1<<ga)-1;hn<dn;++hn){var Un,Hn=0;for(Un=0;Un<qn;++Un)Un&cn||(Hn=Wr(mn[bn++])),Bn[na++]=rn(hs[Hn&ts]),Hn>>=ga}else Ar["VP8LMapColor"+Dr](mn,bn,hs,ts,Bn,na,hn,dn,qn)}}function Xn(hr,Sr,Dr,Wr,rn){for(Dr=Sr+Dr;Sr<Dr;){var cn=hr[Sr++];Wr[rn++]=cn>>16&255,Wr[rn++]=cn>>8&255,Wr[rn++]=cn>>0&255}}function ws(hr,Sr,Dr,Wr,rn){for(Dr=Sr+Dr;Sr<Dr;){var cn=hr[Sr++];Wr[rn++]=cn>>16&255,Wr[rn++]=cn>>8&255,Wr[rn++]=cn>>0&255,Wr[rn++]=cn>>24&255}}function ds(hr,Sr,Dr,Wr,rn){for(Dr=Sr+Dr;Sr<Dr;){var cn=(hn=hr[Sr++])>>16&240|hn>>12&15,hn=hn>>0&240|hn>>28&15;Wr[rn++]=cn,Wr[rn++]=hn}}function Ps(hr,Sr,Dr,Wr,rn){for(Dr=Sr+Dr;Sr<Dr;){var cn=(hn=hr[Sr++])>>16&248|hn>>13&7,hn=hn>>5&224|hn>>3&31;Wr[rn++]=cn,Wr[rn++]=hn}}function Zn(hr,Sr,Dr,Wr,rn){for(Dr=Sr+Dr;Sr<Dr;){var cn=hr[Sr++];Wr[rn++]=cn>>0&255,Wr[rn++]=cn>>8&255,Wr[rn++]=cn>>16&255}}function Mn(hr,Sr,Dr,Wr,rn,cn){if(cn==0)for(Dr=Sr+Dr;Sr<Dr;)fn(Wr,((cn=hr[Sr++])[0]>>24|cn[1]>>8&65280|cn[2]<<8&16711680|cn[3]<<24)>>>0),rn+=32;else tr(Wr,rn,hr,Sr,Dr)}function zn(hr,Sr){Ar[Sr][0]=Ar[hr+"0"],Ar[Sr][1]=Ar[hr+"1"],Ar[Sr][2]=Ar[hr+"2"],Ar[Sr][3]=Ar[hr+"3"],Ar[Sr][4]=Ar[hr+"4"],Ar[Sr][5]=Ar[hr+"5"],Ar[Sr][6]=Ar[hr+"6"],Ar[Sr][7]=Ar[hr+"7"],Ar[Sr][8]=Ar[hr+"8"],Ar[Sr][9]=Ar[hr+"9"],Ar[Sr][10]=Ar[hr+"10"],Ar[Sr][11]=Ar[hr+"11"],Ar[Sr][12]=Ar[hr+"12"],Ar[Sr][13]=Ar[hr+"13"],Ar[Sr][14]=Ar[hr+"0"],Ar[Sr][15]=Ar[hr+"0"]}function cs(hr){return hr==Tp||hr==Cp||hr==R0||hr==Fp}function Ls(){this.eb=[],this.size=this.A=this.fb=0}function As(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function yn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ls,this.f.kb=new As,this.sd=null}function _i(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function rs(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function os(hr){return alert("todo:WebPSamplerProcessPlane"),hr.T}function ms(hr,Sr){var Dr=hr.T,Wr=Sr.ba.f.RGBA,rn=Wr.eb,cn=Wr.fb+hr.ka*Wr.A,hn=jo[Sr.ba.S],dn=hr.y,mn=hr.O,bn=hr.f,Bn=hr.N,na=hr.ea,ga=hr.W,qn=Sr.cc,hs=Sr.dc,ts=Sr.Mc,Un=Sr.Nc,Hn=hr.ka,us=hr.ka+hr.T,gs=hr.U,fs=gs+1>>1;for(Hn==0?hn(dn,mn,null,null,bn,Bn,na,ga,bn,Bn,na,ga,rn,cn,null,null,gs):(hn(Sr.ec,Sr.fc,dn,mn,qn,hs,ts,Un,bn,Bn,na,ga,rn,cn-Wr.A,rn,cn,gs),++Dr);Hn+2<us;Hn+=2)qn=bn,hs=Bn,ts=na,Un=ga,Bn+=hr.Rc,ga+=hr.Rc,cn+=2*Wr.A,hn(dn,(mn+=2*hr.fa)-hr.fa,dn,mn,qn,hs,ts,Un,bn,Bn,na,ga,rn,cn-Wr.A,rn,cn,gs);return mn+=hr.fa,hr.j+us<hr.o?(tr(Sr.ec,Sr.fc,dn,mn,gs),tr(Sr.cc,Sr.dc,bn,Bn,fs),tr(Sr.Mc,Sr.Nc,na,ga,fs),Dr--):1&us||hn(dn,mn,null,null,bn,Bn,na,ga,bn,Bn,na,ga,rn,cn+Wr.A,null,null,gs),Dr}function bs(hr,Sr,Dr){var Wr=hr.F,rn=[hr.J];if(Wr!=null){var cn=hr.U,hn=Sr.ba.S,dn=hn==N0||hn==R0;Sr=Sr.ba.f.RGBA;var mn=[0],bn=hr.ka;mn[0]=hr.T,hr.Kb&&(bn==0?--mn[0]:(--bn,rn[0]-=hr.width),hr.j+hr.ka+hr.T==hr.o&&(mn[0]=hr.o-hr.j-bn));var Bn=Sr.eb;bn=Sr.fb+bn*Sr.A,hr=to(Wr,rn[0],hr.width,cn,mn,Bn,bn+(dn?0:3),Sr.A),_e(Dr==mn),hr&&cs(hn)&&Mo(Bn,bn,dn,cn,mn,Sr.A)}return 0}function gn(hr){var Sr=hr.ma,Dr=Sr.ba.S,Wr=11>Dr,rn=Dr==P0||Dr==L0||Dr==N0||Dr==kp||Dr==12||cs(Dr);if(Sr.memory=null,Sr.Ib=null,Sr.Jb=null,Sr.Nd=null,!Uu(Sr.Oa,hr,rn?11:12))return 0;if(rn&&cs(Dr)&&_s(),hr.da)alert("todo:use_scaling");else{if(Wr){if(Sr.Ib=os,hr.Kb){if(Dr=hr.U+1>>1,Sr.memory=nr(hr.U+2*Dr),Sr.memory==null)return 0;Sr.ec=Sr.memory,Sr.fc=0,Sr.cc=Sr.ec,Sr.dc=Sr.fc+hr.U,Sr.Mc=Sr.cc,Sr.Nc=Sr.dc+Dr,Sr.Ib=ms,_s()}}else alert("todo:EmitYUV");rn&&(Sr.Jb=bs,Wr&&Jn())}if(Wr&&!N1){for(hr=0;256>hr;++hr)Ym[hr]=89858*(hr-128)+I0>>D0,Zm[hr]=-22014*(hr-128)+I0,Jm[hr]=-45773*(hr-128),Km[hr]=113618*(hr-128)+I0>>D0;for(hr=Yu;hr<Np;++hr)Sr=76283*(hr-16)+I0>>D0,Qm[hr-Yu]=Fo(Sr,255),_g[hr-Yu]=Fo(Sr+8>>4,15);N1=1}return 1}function pn(hr){var Sr=hr.ma,Dr=hr.U,Wr=hr.T;return _e(!(1&hr.ka)),0>=Dr||0>=Wr?0:(Dr=Sr.Ib(hr,Sr),Sr.Jb!=null&&Sr.Jb(hr,Sr,Dr),Sr.Dc+=Dr,1)}function Pn(hr){hr.ma.memory=null}function Rn(hr,Sr,Dr,Wr){return Xr(hr,8)!=47?0:(Sr[0]=Xr(hr,14)+1,Dr[0]=Xr(hr,14)+1,Wr[0]=Xr(hr,1),Xr(hr,3)!=0?0:!hr.h)}function Yn(hr,Sr){if(4>hr)return hr+1;var Dr=hr-2>>1;return(2+(1&hr)<<Dr)+Xr(Sr,Dr)+1}function xa(hr,Sr){return 120<Sr?Sr-120:1<=(Dr=((Dr=Im[Sr-1])>>4)*hr+(8-(15&Dr)))?Dr:1;var Dr}function $a(hr,Sr,Dr){var Wr=br(Dr),rn=hr[Sr+=255&Wr].g-8;return 0<rn&&(Lr(Dr,Dr.u+8),Wr=br(Dr),Sr+=hr[Sr].value,Sr+=Wr&(1<<rn)-1),Lr(Dr,Dr.u+hr[Sr].g),hr[Sr].value}function ys(hr,Sr,Dr){return Dr.g+=hr.g,Dr.value+=hr.value<<Sr>>>0,_e(8>=Dr.g),hr.g}function xs(hr,Sr,Dr){var Wr=hr.xc;return _e((Sr=Wr==0?0:hr.vc[hr.md*(Dr>>Wr)+(Sr>>Wr)])<hr.Wb),hr.Ya[Sr]}function Jr(hr,Sr,Dr,Wr){var rn=hr.ab,cn=hr.c*Sr,hn=hr.C;Sr=hn+Sr;var dn=Dr,mn=Wr;for(Wr=hr.Ta,Dr=hr.Ua;0<rn--;){var bn=hr.gc[rn],Bn=hn,na=Sr,ga=dn,qn=mn,hs=(mn=Wr,dn=Dr,bn.Ea);switch(_e(Bn<na),_e(na<=bn.nc),bn.hc){case 2:S0(ga,qn,(na-Bn)*hs,mn,dn);break;case 0:var ts=Bn,Un=na,Hn=mn,us=dn,gs=(Ts=bn).Ea;ts==0&&(Ep(ga,qn,null,null,1,Hn,us),ba(ga,qn+1,0,0,gs-1,Hn,us+1),qn+=gs,us+=gs,++ts);for(var fs=1<<Ts.b,Fs=fs-1,Es=tn(gs,Ts.b),Ds=Ts.K,Ts=Ts.w+(ts>>Ts.b)*Es;ts<Un;){var Vs=Ds,Ys=Ts,$s=1;for($u(ga,qn,Hn,us-gs,1,Hn,us);$s<gs;){var Ws=($s&~Fs)+fs;Ws>gs&&(Ws=gs),(0,Fl[Vs[Ys++]>>8&15])(ga,qn+ +$s,Hn,us+$s-gs,Ws-$s,Hn,us+$s),$s=Ws}qn+=gs,us+=gs,++ts&Fs||(Ts+=Es)}na!=bn.nc&&tr(mn,dn-hs,mn,dn+(na-Bn-1)*hs,hs);break;case 1:for(hs=ga,Un=qn,gs=(ga=bn.Ea)-(us=ga&~(Hn=(qn=1<<bn.b)-1)),ts=tn(ga,bn.b),fs=bn.K,bn=bn.w+(Bn>>bn.b)*ts;Bn<na;){for(Fs=fs,Es=bn,Ds=new Sn,Ts=Un+us,Vs=Un+ga;Un<Ts;)vs(Fs[Es++],Ds),Vl(Ds,hs,Un,qn,mn,dn),Un+=qn,dn+=qn;Un<Vs&&(vs(Fs[Es++],Ds),Vl(Ds,hs,Un,gs,mn,dn),Un+=gs,dn+=gs),++Bn&Hn||(bn+=ts)}break;case 3:if(ga==mn&&qn==dn&&0<bn.b){for(Un=mn,ga=hs=dn+(na-Bn)*hs-(us=(na-Bn)*tn(bn.Ea,bn.b)),qn=mn,Hn=dn,ts=[],us=(gs=us)-1;0<=us;--us)ts[us]=qn[Hn+us];for(us=gs-1;0<=us;--us)Un[ga+us]=ts[us];Ro(bn,Bn,na,mn,hs,mn,dn)}else Ro(bn,Bn,na,ga,qn,mn,dn)}dn=Wr,mn=Dr}mn!=Dr&&tr(Wr,Dr,dn,mn,cn)}function Yr(hr,Sr){var Dr=hr.V,Wr=hr.Ba+hr.c*hr.C,rn=Sr-hr.C;if(_e(Sr<=hr.l.o),_e(16>=rn),0<rn){var cn=hr.l,hn=hr.Ta,dn=hr.Ua,mn=cn.width;if(Jr(hr,rn,Dr,Wr),rn=dn=[dn],_e((Dr=hr.C)<(Wr=Sr)),_e(cn.v<cn.va),Wr>cn.o&&(Wr=cn.o),Dr<cn.j){var bn=cn.j-Dr;Dr=cn.j,rn[0]+=bn*mn}if(Dr>=Wr?Dr=0:(rn[0]+=4*cn.v,cn.ka=Dr-cn.j,cn.U=cn.va-cn.v,cn.T=Wr-Dr,Dr=1),Dr){if(dn=dn[0],11>(Dr=hr.ca).S){var Bn=Dr.f.RGBA,na=(Wr=Dr.S,rn=cn.U,cn=cn.T,bn=Bn.eb,Bn.A),ga=cn;for(Bn=Bn.fb+hr.Ma*Bn.A;0<ga--;){var qn=hn,hs=dn,ts=rn,Un=bn,Hn=Bn;switch(Wr){case F0:ko(qn,hs,ts,Un,Hn);break;case P0:yo(qn,hs,ts,Un,Hn);break;case Tp:yo(qn,hs,ts,Un,Hn),Mo(Un,Hn,0,ts,1,0);break;case S1:Qo(qn,hs,ts,Un,Hn);break;case L0:Mn(qn,hs,ts,Un,Hn,1);break;case Cp:Mn(qn,hs,ts,Un,Hn,1),Mo(Un,Hn,0,ts,1,0);break;case N0:Mn(qn,hs,ts,Un,Hn,0);break;case R0:Mn(qn,hs,ts,Un,Hn,0),Mo(Un,Hn,1,ts,1,0);break;case kp:Pl(qn,hs,ts,Un,Hn);break;case Fp:Pl(qn,hs,ts,Un,Hn),eo(Un,Hn,ts,1,0);break;case E1:Zo(qn,hs,ts,Un,Hn);break;default:_e(0)}dn+=mn,Bn+=na}hr.Ma+=cn}else alert("todo:EmitRescaledRowsYUVA");_e(hr.Ma<=Dr.height)}}hr.C=Sr,_e(hr.C<=hr.i)}function qr(hr){var Sr;if(0<hr.ua)return 0;for(Sr=0;Sr<hr.Wb;++Sr){var Dr=hr.Ya[Sr].G,Wr=hr.Ya[Sr].H;if(0<Dr[1][Wr[1]+0].g||0<Dr[2][Wr[2]+0].g||0<Dr[3][Wr[3]+0].g)return 0}return 1}function en(hr,Sr,Dr,Wr,rn,cn){if(hr.Z!=0){var hn=hr.qd,dn=hr.rd;for(_e(Dl[hr.Z]!=null);Sr<Dr;++Sr)Dl[hr.Z](hn,dn,Wr,rn,Wr,rn,cn),hn=Wr,dn=rn,rn+=cn;hr.qd=hn,hr.rd=dn}}function sn(hr,Sr){var Dr=hr.l.ma,Wr=Dr.Z==0||Dr.Z==1?hr.l.j:hr.C;if(Wr=hr.C<Wr?Wr:hr.C,_e(Sr<=hr.l.o),Sr>Wr){var rn=hr.l.width,cn=Dr.ca,hn=Dr.tb+rn*Wr,dn=hr.V,mn=hr.Ba+hr.c*Wr,bn=hr.gc;_e(hr.ab==1),_e(bn[0].hc==3),E0(bn[0],Wr,Sr,dn,mn,cn,hn),en(Dr,Wr,Sr,cn,hn,rn)}hr.C=hr.Ma=Sr}function un(hr,Sr,Dr,Wr,rn,cn,hn){var dn=hr.$/Wr,mn=hr.$%Wr,bn=hr.m,Bn=hr.s,na=Dr+hr.$,ga=na;rn=Dr+Wr*rn;var qn=Dr+Wr*cn,hs=280+Bn.ua,ts=hr.Pb?dn:16777216,Un=0<Bn.ua?Bn.Wa:null,Hn=Bn.wc,us=na<qn?xs(Bn,mn,dn):null;_e(hr.C<cn),_e(qn<=rn);var gs=!1;e:for(;;){for(;gs||na<qn;){var fs=0;if(dn>=ts){var Fs=na-Dr;_e((ts=hr).Pb),ts.wd=ts.m,ts.xd=Fs,0<ts.s.ua&&wn(ts.s.Wa,ts.s.vb),ts=dn+Om}if(mn&Hn||(us=xs(Bn,mn,dn)),_e(us!=null),us.Qb&&(Sr[na]=us.qb,gs=!0),!gs)if(Or(bn),us.jc){fs=bn,Fs=Sr;var Es=na,Ds=us.pd[br(fs)&xo-1];_e(us.jc),256>Ds.g?(Lr(fs,fs.u+Ds.g),Fs[Es]=Ds.value,fs=0):(Lr(fs,fs.u+Ds.g-256),_e(256<=Ds.value),fs=Ds.value),fs==0&&(gs=!0)}else fs=$a(us.G[0],us.H[0],bn);if(bn.h)break;if(gs||256>fs){if(!gs)if(us.nd)Sr[na]=(us.qb|fs<<8)>>>0;else{if(Or(bn),gs=$a(us.G[1],us.H[1],bn),Or(bn),Fs=$a(us.G[2],us.H[2],bn),Es=$a(us.G[3],us.H[3],bn),bn.h)break;Sr[na]=(Es<<24|gs<<16|fs<<8|Fs)>>>0}if(gs=!1,++na,++mn>=Wr&&(mn=0,++dn,hn!=null&&dn<=cn&&!(dn%16)&&hn(hr,dn),Un!=null))for(;ga<na;)fs=Sr[ga++],Un.X[(506832829*fs&4294967295)>>>Un.Mb]=fs}else if(280>fs){if(fs=Yn(fs-256,bn),Fs=$a(us.G[4],us.H[4],bn),Or(bn),Fs=xa(Wr,Fs=Yn(Fs,bn)),bn.h)break;if(na-Dr<Fs||rn-na<fs)break e;for(Es=0;Es<fs;++Es)Sr[na+Es]=Sr[na+Es-Fs];for(na+=fs,mn+=fs;mn>=Wr;)mn-=Wr,++dn,hn!=null&&dn<=cn&&!(dn%16)&&hn(hr,dn);if(_e(na<=rn),mn&Hn&&(us=xs(Bn,mn,dn)),Un!=null)for(;ga<na;)fs=Sr[ga++],Un.X[(506832829*fs&4294967295)>>>Un.Mb]=fs}else{if(!(fs<hs))break e;for(gs=fs-280,_e(Un!=null);ga<na;)fs=Sr[ga++],Un.X[(506832829*fs&4294967295)>>>Un.Mb]=fs;fs=na,_e(!(gs>>>(Fs=Un).Xa)),Sr[fs]=Fs.X[gs],gs=!0}gs||_e(bn.h==Er(bn))}if(hr.Pb&&bn.h&&na<rn)_e(hr.m.h),hr.a=5,hr.m=hr.wd,hr.$=hr.xd,0<hr.s.ua&&wn(hr.s.vb,hr.s.Wa);else{if(bn.h)break e;hn!=null&&hn(hr,dn>cn?cn:dn),hr.a=0,hr.$=na-Dr}return 1}return hr.a=3,0}function Tn(hr){_e(hr!=null),hr.vc=null,hr.yc=null,hr.Ya=null;var Sr=hr.Wa;Sr!=null&&(Sr.X=null),hr.vb=null,_e(hr!=null)}function In(){var hr=new Sp;return hr==null?null:(hr.a=0,hr.xb=T1,zn("Predictor","VP8LPredictors"),zn("Predictor","VP8LPredictors_C"),zn("PredictorAdd","VP8LPredictorsAdd"),zn("PredictorAdd","VP8LPredictorsAdd_C"),S0=Qn,Vl=es,ko=Xn,yo=ws,Pl=ds,Zo=Ps,Qo=Zn,Ar.VP8LMapColor32b=fu,Ar.VP8LMapColor8b=A0,hr)}function Fn(hr,Sr,Dr,Wr,rn){var cn=1,hn=[hr],dn=[Sr],mn=Wr.m,bn=Wr.s,Bn=null,na=0;e:for(;;){if(Dr)for(;cn&&Xr(mn,1);){var ga=hn,qn=dn,hs=Wr,ts=1,Un=hs.m,Hn=hs.gc[hs.ab],us=Xr(Un,2);if(hs.Oc&1<<us)cn=0;else{switch(hs.Oc|=1<<us,Hn.hc=us,Hn.Ea=ga[0],Hn.nc=qn[0],Hn.K=[null],++hs.ab,_e(4>=hs.ab),us){case 0:case 1:Hn.b=Xr(Un,3)+2,ts=Fn(tn(Hn.Ea,Hn.b),tn(Hn.nc,Hn.b),0,hs,Hn.K),Hn.K=Hn.K[0];break;case 3:var gs,fs=Xr(Un,8)+1,Fs=16<fs?0:4<fs?1:2<fs?2:3;if(ga[0]=tn(Hn.Ea,Fs),Hn.b=Fs,gs=ts=Fn(fs,1,0,hs,Hn.K)){var Es,Ds=fs,Ts=Hn,Vs=1<<(8>>Ts.b),Ys=nr(Vs);if(Ys==null)gs=0;else{var $s=Ts.K[0],Ws=Ts.w;for(Ys[0]=Ts.K[0][0],Es=1;Es<1*Ds;++Es)Ys[Es]=on($s[Ws+Es],Ys[Es-1]);for(;Es<4*Vs;++Es)Ys[Es]=0;Ts.K[0]=null,Ts.K[0]=Ys,gs=1}}ts=gs;break;case 2:break;default:_e(0)}cn=ts}}if(hn=hn[0],dn=dn[0],cn&&Xr(mn,1)&&!(cn=1<=(na=Xr(mn,4))&&11>=na)){Wr.a=3;break e}var Zs;if(Zs=cn)t:{var Js,Bs,uo,To=Wr,fo=hn,Co=dn,Ks=na,Lo=Dr,No=To.m,mo=To.s,vo=[null],So=1,Bo=0,Yo=Mm[Ks];r:for(;;){if(Lo&&Xr(No,1)){var go=Xr(No,3)+2,yl=tn(fo,go),Jl=tn(Co,go),gu=yl*Jl;if(!Fn(yl,Jl,0,To,vo))break r;for(vo=vo[0],mo.xc=go,Js=0;Js<gu;++Js){var Il=vo[Js]>>8&65535;vo[Js]=Il,Il>=So&&(So=Il+1)}}if(No.h)break r;for(Bs=0;5>Bs;++Bs){var ao=A1[Bs];!Bs&&0<Ks&&(ao+=1<<Ks),Bo<ao&&(Bo=ao)}var Rp=ir(So*Yo,kr),I1=So,M1=ir(I1,Hr);if(M1==null)var O0=null;else _e(65536>=I1),O0=M1;var Ku=nr(Bo);if(O0==null||Ku==null||Rp==null){To.a=1;break r}var j0=Rp;for(Js=uo=0;Js<So;++Js){var Vo=O0[Js],xu=Vo.G,vu=Vo.H,O1=0,B0=1,j1=0;for(Bs=0;5>Bs;++Bs){ao=A1[Bs],xu[Bs]=j0,vu[Bs]=uo,!Bs&&0<Ks&&(ao+=1<<Ks);i:{var U0,Dp=ao,W0=To,Ju=Ku,r2=j0,n2=uo,Ip=0,Ml=W0.m,i2=Xr(Ml,1);if(rr(Ju,0,0,Dp),i2){var a2=Xr(Ml,1)+1,s2=Xr(Ml,1),B1=Xr(Ml,s2==0?1:8);Ju[B1]=1,a2==2&&(Ju[B1=Xr(Ml,8)]=1);var z0=1}else{var U1=nr(19),W1=Xr(Ml,4)+4;if(19<W1){W0.a=3;var $0=0;break i}for(U0=0;U0<W1;++U0)U1[Dm[U0]]=Xr(Ml,3);var Mp=void 0,Zu=void 0,z1=W0,o2=U1,H0=Dp,$1=Ju,Op=0,Ol=z1.m,H1=8,V1=ir(128,kr);n:for(;wr(V1,0,7,o2,19);){if(Xr(Ol,1)){var l2=2+2*Xr(Ol,3);if((Mp=2+Xr(Ol,l2))>H0)break n}else Mp=H0;for(Zu=0;Zu<H0&&Mp--;){Or(Ol);var X1=V1[0+(127&br(Ol))];Lr(Ol,Ol.u+X1.g);var _u=X1.value;if(16>_u)$1[Zu++]=_u,_u!=0&&(H1=_u);else{var c2=_u==16,q1=_u-16,u2=Nm[q1],G1=Xr(Ol,Lm[q1])+u2;if(Zu+G1>H0)break n;for(var f2=c2?H1:0;0<G1--;)$1[Zu++]=f2}}Op=1;break n}Op||(z1.a=3),z0=Op}(z0=z0&&!Ml.h)&&(Ip=wr(r2,n2,8,Ju,Dp)),z0&&Ip!=0?$0=Ip:(W0.a=3,$0=0)}if($0==0)break r;if(B0&&Rm[Bs]==1&&(B0=j0[uo].g==0),O1+=j0[uo].g,uo+=$0,3>=Bs){var Qu,jp=Ku[0];for(Qu=1;Qu<ao;++Qu)Ku[Qu]>jp&&(jp=Ku[Qu]);j1+=jp}}if(Vo.nd=B0,Vo.Qb=0,B0&&(Vo.qb=(xu[3][vu[3]+0].value<<24|xu[1][vu[1]+0].value<<16|xu[2][vu[2]+0].value)>>>0,O1==0&&256>xu[0][vu[0]+0].value&&(Vo.Qb=1,Vo.qb+=xu[0][vu[0]+0].value<<8)),Vo.jc=!Vo.Qb&&6>j1,Vo.jc){var V0,Sl=Vo;for(V0=0;V0<xo;++V0){var Bl=V0,Ul=Sl.pd[Bl],X0=Sl.G[0][Sl.H[0]+Bl];256<=X0.value?(Ul.g=X0.g+256,Ul.value=X0.value):(Ul.g=0,Ul.value=0,Bl>>=ys(X0,8,Ul),Bl>>=ys(Sl.G[1][Sl.H[1]+Bl],16,Ul),Bl>>=ys(Sl.G[2][Sl.H[2]+Bl],0,Ul),ys(Sl.G[3][Sl.H[3]+Bl],24,Ul))}}}mo.vc=vo,mo.Wb=So,mo.Ya=O0,mo.yc=Rp,Zs=1;break t}Zs=0}if(!(cn=Zs)){Wr.a=3;break e}if(0<na){if(bn.ua=1<<na,!Dn(bn.Wa,na)){Wr.a=1,cn=0;break e}}else bn.ua=0;var Bp=Wr,Y1=hn,h2=dn,Up=Bp.s,Wp=Up.xc;if(Bp.c=Y1,Bp.i=h2,Up.md=tn(Y1,Wp),Up.wc=Wp==0?-1:(1<<Wp)-1,Dr){Wr.xb=Hm;break e}if((Bn=nr(hn*dn))==null){Wr.a=1,cn=0;break e}cn=(cn=un(Wr,Bn,0,hn,dn,dn,null))&&!mn.h;break e}return cn?(rn!=null?rn[0]=Bn:(_e(Bn==null),_e(Dr)),Wr.$=0,Dr||Tn(bn)):Tn(bn),cn}function kn(hr,Sr){var Dr=hr.c*hr.i,Wr=Dr+Sr+16*Sr;return _e(hr.c<=Sr),hr.V=nr(Wr),hr.V==null?(hr.Ta=null,hr.Ua=0,hr.a=1,0):(hr.Ta=hr.V,hr.Ua=hr.Ba+Dr+Sr,1)}function Nn(hr,Sr){var Dr=hr.C,Wr=Sr-Dr,rn=hr.V,cn=hr.Ba+hr.c*Dr;for(_e(Sr<=hr.l.o);0<Wr;){var hn=16<Wr?16:Wr,dn=hr.l.ma,mn=hr.l.width,bn=mn*hn,Bn=dn.ca,na=dn.tb+mn*Dr,ga=hr.Ta,qn=hr.Ua;Jr(hr,hn,rn,cn),lo(ga,qn,Bn,na,bn),en(dn,Dr,Dr+hn,Bn,na,mn),Wr-=hn,rn+=hn*hr.c,Dr+=hn}_e(Dr==Sr),hr.C=hr.Ma=Sr}function Kn(){this.ub=this.yd=this.td=this.Rb=0}function is(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ps(){this.Fb=this.Bb=this.Cb=0,this.Zb=nr(4),this.Lb=nr(4)}function ns(){this.Yb=function(){var hr=[];return function Sr(Dr,Wr,rn){for(var cn=rn[Wr],hn=0;hn<cn&&(Dr.push(rn.length>Wr+1?[]:0),!(rn.length<Wr+1));hn++)Sr(Dr[hn],Wr+1,rn)}(hr,0,[3,11]),hr}()}function ss(){this.jb=nr(3),this.Wc=ar([4,8],ns),this.Xc=ar([4,17],ns)}function Ss(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new nr(4),this.od=new nr(4)}function ks(){this.ld=this.La=this.dd=this.tc=0}function Ns(){this.Na=this.la=0}function Us(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Is(){this.ad=nr(384),this.Za=0,this.Ob=nr(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Gs(){this.uc=this.M=this.Nb=0,this.wa=Array(new ks),this.Y=0,this.ya=Array(new Is),this.aa=0,this.l=new Qs}function so(){this.y=nr(16),this.f=nr(8),this.ea=nr(8)}function ro(){this.cb=this.a=0,this.sc="",this.m=new an,this.Od=new Kn,this.Kc=new is,this.ed=new Ss,this.Qa=new ps,this.Ic=this.$c=this.Aa=0,this.D=new Gs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=ir(8,an),this.ia=0,this.pb=ir(4,Us),this.Pa=new ss,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new so),this.Hd=0,this.rb=Array(new Ns),this.sb=0,this.wa=Array(new ks),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Is),this.L=this.aa=0,this.gd=ar([4,2],ks),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function qs(){var hr=new ro;return hr!=null&&(hr.a=0,hr.sc="OK",hr.cb=0,hr.Xb=0,Gu||(Gu=l0)),hr}function Hs(hr,Sr,Dr){return hr.a==0&&(hr.a=Sr,hr.sc=Dr,hr.cb=0),0}function s0(hr,Sr,Dr){return 3<=Dr&&hr[Sr+0]==157&&hr[Sr+1]==1&&hr[Sr+2]==42}function o0(hr,Sr){if(hr==null)return 0;if(hr.a=0,hr.sc="OK",Sr==null)return Hs(hr,2,"null VP8Io passed to VP8GetHeaders()");var Dr=Sr.data,Wr=Sr.w,rn=Sr.ha;if(4>rn)return Hs(hr,7,"Truncated header.");var cn=Dr[Wr+0]|Dr[Wr+1]<<8|Dr[Wr+2]<<16,hn=hr.Od;if(hn.Rb=!(1&cn),hn.td=cn>>1&7,hn.yd=cn>>4&1,hn.ub=cn>>5,3<hn.td)return Hs(hr,3,"Incorrect keyframe parameters.");if(!hn.yd)return Hs(hr,4,"Frame not displayable.");Wr+=3,rn-=3;var dn=hr.Kc;if(hn.Rb){if(7>rn)return Hs(hr,7,"cannot parse picture header");if(!s0(Dr,Wr,rn))return Hs(hr,3,"Bad code word");dn.c=16383&(Dr[Wr+4]<<8|Dr[Wr+3]),dn.Td=Dr[Wr+4]>>6,dn.i=16383&(Dr[Wr+6]<<8|Dr[Wr+5]),dn.Ud=Dr[Wr+6]>>6,Wr+=7,rn-=7,hr.za=dn.c+15>>4,hr.Ub=dn.i+15>>4,Sr.width=dn.c,Sr.height=dn.i,Sr.Da=0,Sr.j=0,Sr.v=0,Sr.va=Sr.width,Sr.o=Sr.height,Sr.da=0,Sr.ib=Sr.width,Sr.hb=Sr.height,Sr.U=Sr.width,Sr.T=Sr.height,rr((cn=hr.Pa).jb,0,255,cn.jb.length),_e((cn=hr.Qa)!=null),cn.Cb=0,cn.Bb=0,cn.Fb=1,rr(cn.Zb,0,0,cn.Zb.length),rr(cn.Lb,0,0,cn.Lb)}if(hn.ub>rn)return Hs(hr,7,"bad partition length");Gr(cn=hr.m,Dr,Wr,hn.ub),Wr+=hn.ub,rn-=hn.ub,hn.Rb&&(dn.Ld=$r(cn),dn.Kd=$r(cn)),dn=hr.Qa;var mn,bn=hr.Pa;if(_e(cn!=null),_e(dn!=null),dn.Cb=$r(cn),dn.Cb){if(dn.Bb=$r(cn),$r(cn)){for(dn.Fb=$r(cn),mn=0;4>mn;++mn)dn.Zb[mn]=$r(cn)?Br(cn,7):0;for(mn=0;4>mn;++mn)dn.Lb[mn]=$r(cn)?Br(cn,6):0}if(dn.Bb)for(mn=0;3>mn;++mn)bn.jb[mn]=$r(cn)?zr(cn,8):255}else dn.Bb=0;if(cn.Ka)return Hs(hr,3,"cannot parse segment header");if((dn=hr.ed).zd=$r(cn),dn.Tb=zr(cn,6),dn.wb=zr(cn,3),dn.Pc=$r(cn),dn.Pc&&$r(cn)){for(bn=0;4>bn;++bn)$r(cn)&&(dn.vd[bn]=Br(cn,6));for(bn=0;4>bn;++bn)$r(cn)&&(dn.od[bn]=Br(cn,6))}if(hr.L=dn.Tb==0?0:dn.zd?1:2,cn.Ka)return Hs(hr,3,"cannot parse filter header");var Bn=rn;if(rn=mn=Wr,Wr=mn+Bn,dn=Bn,hr.Xb=(1<<zr(hr.m,2))-1,Bn<3*(bn=hr.Xb))Dr=7;else{for(mn+=3*bn,dn-=3*bn,Bn=0;Bn<bn;++Bn){var na=Dr[rn+0]|Dr[rn+1]<<8|Dr[rn+2]<<16;na>dn&&(na=dn),Gr(hr.Jc[+Bn],Dr,mn,na),mn+=na,dn-=na,rn+=3}Gr(hr.Jc[+bn],Dr,mn,dn),Dr=mn<Wr?0:5}if(Dr!=0)return Hs(hr,Dr,"cannot parse partitions");for(Dr=zr(mn=hr.m,7),rn=$r(mn)?Br(mn,4):0,Wr=$r(mn)?Br(mn,4):0,dn=$r(mn)?Br(mn,4):0,bn=$r(mn)?Br(mn,4):0,mn=$r(mn)?Br(mn,4):0,Bn=hr.Qa,na=0;4>na;++na){if(Bn.Cb){var ga=Bn.Zb[na];Bn.Fb||(ga+=Dr)}else{if(0<na){hr.pb[na]=hr.pb[0];continue}ga=Dr}var qn=hr.pb[na];qn.Sc[0]=Pp[Fo(ga+rn,127)],qn.Sc[1]=Lp[Fo(ga+0,127)],qn.Eb[0]=2*Pp[Fo(ga+Wr,127)],qn.Eb[1]=101581*Lp[Fo(ga+dn,127)]>>16,8>qn.Eb[1]&&(qn.Eb[1]=8),qn.Qc[0]=Pp[Fo(ga+bn,117)],qn.Qc[1]=Lp[Fo(ga+mn,127)],qn.lc=ga+mn}if(!hn.Rb)return Hs(hr,4,"Not a key frame.");for($r(cn),hn=hr.Pa,Dr=0;4>Dr;++Dr){for(rn=0;8>rn;++rn)for(Wr=0;3>Wr;++Wr)for(dn=0;11>dn;++dn)bn=Zr(cn,zm[Dr][rn][Wr][dn])?zr(cn,8):Um[Dr][rn][Wr][dn],hn.Wc[Dr][rn].Yb[Wr][dn]=bn;for(rn=0;17>rn;++rn)hn.Xc[Dr][rn]=hn.Wc[Dr][$m[rn]]}return hr.kc=$r(cn),hr.kc&&(hr.Bd=zr(cn,8)),hr.cb=1}function l0(hr,Sr,Dr,Wr,rn,cn,hn){var dn=Sr[rn].Yb[Dr];for(Dr=0;16>rn;++rn){if(!Zr(hr,dn[Dr+0]))return rn;for(;!Zr(hr,dn[Dr+1]);)if(dn=Sr[++rn].Yb[0],Dr=0,rn==16)return 16;var mn=Sr[rn+1].Yb;if(Zr(hr,dn[Dr+2])){var bn=hr,Bn=0;if(Zr(bn,(ga=dn)[(na=Dr)+3]))if(Zr(bn,ga[na+6])){for(dn=0,na=2*(Bn=Zr(bn,ga[na+8]))+(ga=Zr(bn,ga[na+9+Bn])),Bn=0,ga=jm[na];ga[dn];++dn)Bn+=Bn+Zr(bn,ga[dn]);Bn+=3+(8<<na)}else Zr(bn,ga[na+7])?(Bn=7+2*Zr(bn,165),Bn+=Zr(bn,145)):Bn=5+Zr(bn,159);else Bn=Zr(bn,ga[na+4])?3+Zr(bn,ga[na+5]):2;dn=mn[2]}else Bn=1,dn=mn[1];mn=hn+Bm[rn],0>(bn=hr).b&&Ur(bn);var na,ga=bn.b,qn=(na=bn.Ca>>1)-(bn.I>>ga)>>31;--bn.b,bn.Ca+=qn,bn.Ca|=1,bn.I-=(na+1&qn)<<ga,cn[mn]=((Bn^qn)-qn)*Wr[(0<rn)+0]}return 16}function Au(hr){var Sr=hr.rb[hr.sb-1];Sr.la=0,Sr.Na=0,rr(hr.zc,0,0,hr.zc.length),hr.ja=0}function sp(hr,Sr){if(hr==null)return 0;if(Sr==null)return Hs(hr,2,"NULL VP8Io parameter in VP8Decode().");if(!hr.cb&&!o0(hr,Sr))return 0;if(_e(hr.cb),Sr.ac==null||Sr.ac(Sr)){Sr.ob&&(hr.L=0);var Dr=M0[hr.L];if(hr.L==2?(hr.yb=0,hr.zb=0):(hr.yb=Sr.v-Dr>>4,hr.zb=Sr.j-Dr>>4,0>hr.yb&&(hr.yb=0),0>hr.zb&&(hr.zb=0)),hr.Va=Sr.o+15+Dr>>4,hr.Hb=Sr.va+15+Dr>>4,hr.Hb>hr.za&&(hr.Hb=hr.za),hr.Va>hr.Ub&&(hr.Va=hr.Ub),0<hr.L){var Wr=hr.ed;for(Dr=0;4>Dr;++Dr){var rn;if(hr.Qa.Cb){var cn=hr.Qa.Lb[Dr];hr.Qa.Fb||(cn+=Wr.Tb)}else cn=Wr.Tb;for(rn=0;1>=rn;++rn){var hn=hr.gd[Dr][rn],dn=cn;if(Wr.Pc&&(dn+=Wr.vd[0],rn&&(dn+=Wr.od[0])),0<(dn=0>dn?0:63<dn?63:dn)){var mn=dn;0<Wr.wb&&(mn=4<Wr.wb?mn>>2:mn>>1)>9-Wr.wb&&(mn=9-Wr.wb),1>mn&&(mn=1),hn.dd=mn,hn.tc=2*dn+mn,hn.ld=40<=dn?2:15<=dn?1:0}else hn.tc=0;hn.La=rn}}}Dr=0}else Hs(hr,6,"Frame setup failed"),Dr=hr.a;if(Dr=Dr==0){if(Dr){hr.$c=0,0<hr.Aa||(hr.Ic=t2);e:{Dr=hr.Ic,Wr=4*(mn=hr.za);var bn=32*mn,Bn=mn+1,na=0<hr.L?mn*(0<hr.Aa?2:1):0,ga=(hr.Aa==2?2:1)*mn;if((hn=Wr+832+(rn=3*(16*Dr+M0[hr.L])/2*bn)+(cn=hr.Fa!=null&&0<hr.Fa.length?hr.Kc.c*hr.Kc.i:0))!=hn)Dr=0;else{if(hn>hr.Vb){if(hr.Vb=0,hr.Ec=nr(hn),hr.Fc=0,hr.Ec==null){Dr=Hs(hr,1,"no memory during frame initialization.");break e}hr.Vb=hn}hn=hr.Ec,dn=hr.Fc,hr.Ac=hn,hr.Bc=dn,dn+=Wr,hr.Gd=ir(bn,so),hr.Hd=0,hr.rb=ir(Bn+1,Ns),hr.sb=1,hr.wa=na?ir(na,ks):null,hr.Y=0,hr.D.Nb=0,hr.D.wa=hr.wa,hr.D.Y=hr.Y,0<hr.Aa&&(hr.D.Y+=mn),_e(!0),hr.oc=hn,hr.pc=dn,dn+=832,hr.ya=ir(ga,Is),hr.aa=0,hr.D.ya=hr.ya,hr.D.aa=hr.aa,hr.Aa==2&&(hr.D.aa+=mn),hr.R=16*mn,hr.B=8*mn,mn=(bn=M0[hr.L])*hr.R,bn=bn/2*hr.B,hr.sa=hn,hr.ta=dn+mn,hr.qa=hr.sa,hr.ra=hr.ta+16*Dr*hr.R+bn,hr.Ha=hr.qa,hr.Ia=hr.ra+8*Dr*hr.B+bn,hr.$c=0,dn+=rn,hr.mb=cn?hn:null,hr.nb=cn?dn:null,_e(dn+cn<=hr.Fc+hr.Vb),Au(hr),rr(hr.Ac,hr.Bc,0,Wr),Dr=1}}if(Dr){if(Sr.ka=0,Sr.y=hr.sa,Sr.O=hr.ta,Sr.f=hr.qa,Sr.N=hr.ra,Sr.ea=hr.Ha,Sr.Vd=hr.Ia,Sr.fa=hr.R,Sr.Rc=hr.B,Sr.F=null,Sr.J=0,!T0){for(Dr=-255;255>=Dr;++Dr)ho[255+Dr]=0>Dr?-Dr:Dr;for(Dr=-1020;1020>=Dr;++Dr)_l[1020+Dr]=-128>Dr?-128:127<Dr?127:Dr;for(Dr=-112;112>=Dr;++Dr)qu[112+Dr]=-16>Dr?-16:15<Dr?15:Dr;for(Dr=-255;510>=Dr;++Dr)mu[255+Dr]=0>Dr?0:255<Dr?255:Dr;T0=1}hu=cp,xl=op,Hu=u0,bo=lp,Do=f0,oo=c0,du=Lu,k0=$l,Vu=bp,Xl=Nu,Gl=yp,Ll=nu,Yl=Ru,pu=w0,Kl=_0,Nl=qo,Xu=Jo,Io=wp,Ho[0]=Xo,Ho[1]=up,Ho[2]=pp,Ho[3]=mp,Ho[4]=p0,Ho[5]=tu,Ho[6]=m0,Ho[7]=Cu,Ho[8]=xp,Ho[9]=gp,Rl[0]=h0,Rl[1]=hp,Rl[2]=Ko,Rl[3]=_c,Rl[4]=_o,Rl[5]=dp,Rl[6]=d0,wl[0]=Al,wl[1]=fp,wl[2]=vp,wl[3]=Fu,wl[4]=zl,wl[5]=_p,wl[6]=Pu,Dr=1}else Dr=0}Dr&&(Dr=function(qn,hs){for(qn.M=0;qn.M<qn.Va;++qn.M){var ts,Un=qn.Jc[qn.M&qn.Xb],Hn=qn.m,us=qn;for(ts=0;ts<us.za;++ts){var gs=Hn,fs=us,Fs=fs.Ac,Es=fs.Bc+4*ts,Ds=fs.zc,Ts=fs.ya[fs.aa+ts];if(fs.Qa.Bb?Ts.$b=Zr(gs,fs.Pa.jb[0])?2+Zr(gs,fs.Pa.jb[2]):Zr(gs,fs.Pa.jb[1]):Ts.$b=0,fs.kc&&(Ts.Ad=Zr(gs,fs.Bd)),Ts.Za=!Zr(gs,145)+0,Ts.Za){var Vs=Ts.Ob,Ys=0;for(fs=0;4>fs;++fs){var $s,Ws=Ds[0+fs];for($s=0;4>$s;++$s){Ws=Wm[Fs[Es+$s]][Ws];for(var Zs=k1[Zr(gs,Ws[0])];0<Zs;)Zs=k1[2*Zs+Zr(gs,Ws[Zs])];Ws=-Zs,Fs[Es+$s]=Ws}tr(Vs,Ys,Fs,Es,4),Ys+=4,Ds[0+fs]=Ws}}else Ws=Zr(gs,156)?Zr(gs,128)?1:3:Zr(gs,163)?2:0,Ts.Ob[0]=Ws,rr(Fs,Es,Ws,4),rr(Ds,0,Ws,4);Ts.Dd=Zr(gs,142)?Zr(gs,114)?Zr(gs,183)?1:3:2:0}if(us.m.Ka)return Hs(qn,7,"Premature end-of-partition0 encountered.");for(;qn.ja<qn.za;++qn.ja){if(us=Un,gs=(Hn=qn).rb[Hn.sb-1],Fs=Hn.rb[Hn.sb+Hn.ja],ts=Hn.ya[Hn.aa+Hn.ja],Es=Hn.kc?ts.Ad:0)gs.la=Fs.la=0,ts.Za||(gs.Na=Fs.Na=0),ts.Hc=0,ts.Gc=0,ts.ia=0;else{var Js,Bs;if(gs=Fs,Fs=us,Es=Hn.Pa.Xc,Ds=Hn.ya[Hn.aa+Hn.ja],Ts=Hn.pb[Ds.$b],fs=Ds.ad,Vs=0,Ys=Hn.rb[Hn.sb-1],Ws=$s=0,rr(fs,Vs,0,384),Ds.Za)var uo=0,To=Es[3];else{Zs=nr(16);var fo=gs.Na+Ys.Na;if(fo=Gu(Fs,Es[1],fo,Ts.Eb,0,Zs,0),gs.Na=Ys.Na=(0<fo)+0,1<fo)hu(Zs,0,fs,Vs);else{var Co=Zs[0]+3>>3;for(Zs=0;256>Zs;Zs+=16)fs[Vs+Zs]=Co}uo=1,To=Es[0]}var Ks=15&gs.la,Lo=15&Ys.la;for(Zs=0;4>Zs;++Zs){var No=1&Lo;for(Co=Bs=0;4>Co;++Co)Ks=Ks>>1|(No=(fo=Gu(Fs,To,fo=No+(1&Ks),Ts.Sc,uo,fs,Vs))>uo)<<7,Bs=Bs<<2|(3<fo?3:1<fo?2:fs[Vs+0]!=0),Vs+=16;Ks>>=4,Lo=Lo>>1|No<<7,$s=($s<<8|Bs)>>>0}for(To=Ks,uo=Lo>>4,Js=0;4>Js;Js+=2){for(Bs=0,Ks=gs.la>>4+Js,Lo=Ys.la>>4+Js,Zs=0;2>Zs;++Zs){for(No=1&Lo,Co=0;2>Co;++Co)fo=No+(1&Ks),Ks=Ks>>1|(No=0<(fo=Gu(Fs,Es[2],fo,Ts.Qc,0,fs,Vs)))<<3,Bs=Bs<<2|(3<fo?3:1<fo?2:fs[Vs+0]!=0),Vs+=16;Ks>>=2,Lo=Lo>>1|No<<5}Ws|=Bs<<4*Js,To|=Ks<<4<<Js,uo|=(240&Lo)<<Js}gs.la=To,Ys.la=uo,Ds.Hc=$s,Ds.Gc=Ws,Ds.ia=43690&Ws?0:Ts.ia,Es=!($s|Ws)}if(0<Hn.L&&(Hn.wa[Hn.Y+Hn.ja]=Hn.gd[ts.$b][ts.Za],Hn.wa[Hn.Y+Hn.ja].La|=!Es),us.Ka)return Hs(qn,7,"Premature end-of-file encountered.")}if(Au(qn),Hn=hs,us=1,ts=(Un=qn).D,gs=0<Un.L&&Un.M>=Un.zb&&Un.M<=Un.Va,Un.Aa==0)e:{if(ts.M=Un.M,ts.uc=gs,Bu(Un,ts),us=1,ts=(Bs=Un.D).Nb,gs=(Ws=M0[Un.L])*Un.R,Fs=Ws/2*Un.B,Zs=16*ts*Un.R,Co=8*ts*Un.B,Es=Un.sa,Ds=Un.ta-gs+Zs,Ts=Un.qa,fs=Un.ra-Fs+Co,Vs=Un.Ha,Ys=Un.Ia-Fs+Co,Lo=(Ks=Bs.M)==0,$s=Ks>=Un.Va-1,Un.Aa==2&&Bu(Un,Bs),Bs.uc)for(No=(fo=Un).D.M,_e(fo.D.uc),Bs=fo.yb;Bs<fo.Hb;++Bs){uo=Bs,To=No;var mo=(vo=(ao=fo).D).Nb;Js=ao.R;var vo=vo.wa[vo.Y+uo],So=ao.sa,Bo=ao.ta+16*mo*Js+16*uo,Yo=vo.dd,go=vo.tc;if(go!=0)if(_e(3<=go),ao.L==1)0<uo&&Nl(So,Bo,Js,go+4),vo.La&&Io(So,Bo,Js,go),0<To&&Kl(So,Bo,Js,go+4),vo.La&&Xu(So,Bo,Js,go);else{var yl=ao.B,Jl=ao.qa,gu=ao.ra+8*mo*yl+8*uo,Il=ao.Ha,ao=ao.Ia+8*mo*yl+8*uo;mo=vo.ld,0<uo&&(k0(So,Bo,Js,go+4,Yo,mo),Xl(Jl,gu,Il,ao,yl,go+4,Yo,mo)),vo.La&&(Ll(So,Bo,Js,go,Yo,mo),pu(Jl,gu,Il,ao,yl,go,Yo,mo)),0<To&&(du(So,Bo,Js,go+4,Yo,mo),Vu(Jl,gu,Il,ao,yl,go+4,Yo,mo)),vo.La&&(Gl(So,Bo,Js,go,Yo,mo),Yl(Jl,gu,Il,ao,yl,go,Yo,mo))}}if(Un.ia&&alert("todo:DitherRow"),Hn.put!=null){if(Bs=16*Ks,Ks=16*(Ks+1),Lo?(Hn.y=Un.sa,Hn.O=Un.ta+Zs,Hn.f=Un.qa,Hn.N=Un.ra+Co,Hn.ea=Un.Ha,Hn.W=Un.Ia+Co):(Bs-=Ws,Hn.y=Es,Hn.O=Ds,Hn.f=Ts,Hn.N=fs,Hn.ea=Vs,Hn.W=Ys),$s||(Ks-=Ws),Ks>Hn.o&&(Ks=Hn.o),Hn.F=null,Hn.J=null,Un.Fa!=null&&0<Un.Fa.length&&Bs<Ks&&(Hn.J=Ou(Un,Hn,Bs,Ks-Bs),Hn.F=Un.mb,Hn.F==null&&Hn.F.length==0)){us=Hs(Un,3,"Could not decode alpha data.");break e}Bs<Hn.j&&(Ws=Hn.j-Bs,Bs=Hn.j,_e(!(1&Ws)),Hn.O+=Un.R*Ws,Hn.N+=Un.B*(Ws>>1),Hn.W+=Un.B*(Ws>>1),Hn.F!=null&&(Hn.J+=Hn.width*Ws)),Bs<Ks&&(Hn.O+=Hn.v,Hn.N+=Hn.v>>1,Hn.W+=Hn.v>>1,Hn.F!=null&&(Hn.J+=Hn.v),Hn.ka=Bs-Hn.j,Hn.U=Hn.va-Hn.v,Hn.T=Ks-Bs,us=Hn.put(Hn))}ts+1!=Un.Ic||$s||(tr(Un.sa,Un.ta-gs,Es,Ds+16*Un.R,gs),tr(Un.qa,Un.ra-Fs,Ts,fs+8*Un.B,Fs),tr(Un.Ha,Un.Ia-Fs,Vs,Ys+8*Un.B,Fs))}if(!us)return Hs(qn,6,"Output aborted.")}return 1}(hr,Sr)),Sr.bc!=null&&Sr.bc(Sr),Dr&=1}return Dr?(hr.cb=0,Dr):0}function Wo(hr,Sr,Dr,Wr,rn){rn=hr[Sr+Dr+32*Wr]+(rn>>3),hr[Sr+Dr+32*Wr]=-256&rn?0>rn?0:255:rn}function Ql(hr,Sr,Dr,Wr,rn,cn){Wo(hr,Sr,0,Dr,Wr+rn),Wo(hr,Sr,1,Dr,Wr+cn),Wo(hr,Sr,2,Dr,Wr-cn),Wo(hr,Sr,3,Dr,Wr-rn)}function Eo(hr){return(20091*hr>>16)+hr}function ku(hr,Sr,Dr,Wr){var rn,cn=0,hn=nr(16);for(rn=0;4>rn;++rn){var dn=hr[Sr+0]+hr[Sr+8],mn=hr[Sr+0]-hr[Sr+8],bn=(35468*hr[Sr+4]>>16)-Eo(hr[Sr+12]),Bn=Eo(hr[Sr+4])+(35468*hr[Sr+12]>>16);hn[cn+0]=dn+Bn,hn[cn+1]=mn+bn,hn[cn+2]=mn-bn,hn[cn+3]=dn-Bn,cn+=4,Sr++}for(rn=cn=0;4>rn;++rn)dn=(hr=hn[cn+0]+4)+hn[cn+8],mn=hr-hn[cn+8],bn=(35468*hn[cn+4]>>16)-Eo(hn[cn+12]),Wo(Dr,Wr,0,0,dn+(Bn=Eo(hn[cn+4])+(35468*hn[cn+12]>>16))),Wo(Dr,Wr,1,0,mn+bn),Wo(Dr,Wr,2,0,mn-bn),Wo(Dr,Wr,3,0,dn-Bn),cn++,Wr+=32}function c0(hr,Sr,Dr,Wr){var rn=hr[Sr+0]+4,cn=35468*hr[Sr+4]>>16,hn=Eo(hr[Sr+4]),dn=35468*hr[Sr+1]>>16;Ql(Dr,Wr,0,rn+hn,hr=Eo(hr[Sr+1]),dn),Ql(Dr,Wr,1,rn+cn,hr,dn),Ql(Dr,Wr,2,rn-cn,hr,dn),Ql(Dr,Wr,3,rn-hn,hr,dn)}function op(hr,Sr,Dr,Wr,rn){ku(hr,Sr,Dr,Wr),rn&&ku(hr,Sr+16,Dr,Wr+4)}function u0(hr,Sr,Dr,Wr){xl(hr,Sr+0,Dr,Wr,1),xl(hr,Sr+32,Dr,Wr+128,1)}function lp(hr,Sr,Dr,Wr){var rn;for(hr=hr[Sr+0]+4,rn=0;4>rn;++rn)for(Sr=0;4>Sr;++Sr)Wo(Dr,Wr,Sr,rn,hr)}function f0(hr,Sr,Dr,Wr){hr[Sr+0]&&bo(hr,Sr+0,Dr,Wr),hr[Sr+16]&&bo(hr,Sr+16,Dr,Wr+4),hr[Sr+32]&&bo(hr,Sr+32,Dr,Wr+128),hr[Sr+48]&&bo(hr,Sr+48,Dr,Wr+128+4)}function cp(hr,Sr,Dr,Wr){var rn,cn=nr(16);for(rn=0;4>rn;++rn){var hn=hr[Sr+0+rn]+hr[Sr+12+rn],dn=hr[Sr+4+rn]+hr[Sr+8+rn],mn=hr[Sr+4+rn]-hr[Sr+8+rn],bn=hr[Sr+0+rn]-hr[Sr+12+rn];cn[0+rn]=hn+dn,cn[8+rn]=hn-dn,cn[4+rn]=bn+mn,cn[12+rn]=bn-mn}for(rn=0;4>rn;++rn)hn=(hr=cn[0+4*rn]+3)+cn[3+4*rn],dn=cn[1+4*rn]+cn[2+4*rn],mn=cn[1+4*rn]-cn[2+4*rn],bn=hr-cn[3+4*rn],Dr[Wr+0]=hn+dn>>3,Dr[Wr+16]=bn+mn>>3,Dr[Wr+32]=hn-dn>>3,Dr[Wr+48]=bn-mn>>3,Wr+=64}function Tu(hr,Sr,Dr){var Wr,rn=Sr-32,cn=Po,hn=255-hr[rn-1];for(Wr=0;Wr<Dr;++Wr){var dn,mn=cn,bn=hn+hr[Sr-1];for(dn=0;dn<Dr;++dn)hr[Sr+dn]=mn[bn+hr[rn+dn]];Sr+=32}}function up(hr,Sr){Tu(hr,Sr,4)}function fp(hr,Sr){Tu(hr,Sr,8)}function hp(hr,Sr){Tu(hr,Sr,16)}function Ko(hr,Sr){var Dr;for(Dr=0;16>Dr;++Dr)tr(hr,Sr+32*Dr,hr,Sr-32,16)}function _c(hr,Sr){var Dr;for(Dr=16;0<Dr;--Dr)rr(hr,Sr,hr[Sr-1],16),Sr+=32}function eu(hr,Sr,Dr){var Wr;for(Wr=0;16>Wr;++Wr)rr(Sr,Dr+32*Wr,hr,16)}function h0(hr,Sr){var Dr,Wr=16;for(Dr=0;16>Dr;++Dr)Wr+=hr[Sr-1+32*Dr]+hr[Sr+Dr-32];eu(Wr>>5,hr,Sr)}function _o(hr,Sr){var Dr,Wr=8;for(Dr=0;16>Dr;++Dr)Wr+=hr[Sr-1+32*Dr];eu(Wr>>4,hr,Sr)}function dp(hr,Sr){var Dr,Wr=8;for(Dr=0;16>Dr;++Dr)Wr+=hr[Sr+Dr-32];eu(Wr>>4,hr,Sr)}function d0(hr,Sr){eu(128,hr,Sr)}function Ms(hr,Sr,Dr){return hr+2*Sr+Dr+2>>2}function pp(hr,Sr){var Dr,Wr=Sr-32;for(Wr=new Uint8Array([Ms(hr[Wr-1],hr[Wr+0],hr[Wr+1]),Ms(hr[Wr+0],hr[Wr+1],hr[Wr+2]),Ms(hr[Wr+1],hr[Wr+2],hr[Wr+3]),Ms(hr[Wr+2],hr[Wr+3],hr[Wr+4])]),Dr=0;4>Dr;++Dr)tr(hr,Sr+32*Dr,Wr,0,Wr.length)}function mp(hr,Sr){var Dr=hr[Sr-1],Wr=hr[Sr-1+32],rn=hr[Sr-1+64],cn=hr[Sr-1+96];fn(hr,Sr+0,16843009*Ms(hr[Sr-1-32],Dr,Wr)),fn(hr,Sr+32,16843009*Ms(Dr,Wr,rn)),fn(hr,Sr+64,16843009*Ms(Wr,rn,cn)),fn(hr,Sr+96,16843009*Ms(rn,cn,cn))}function Xo(hr,Sr){var Dr,Wr=4;for(Dr=0;4>Dr;++Dr)Wr+=hr[Sr+Dr-32]+hr[Sr-1+32*Dr];for(Wr>>=3,Dr=0;4>Dr;++Dr)rr(hr,Sr+32*Dr,Wr,4)}function p0(hr,Sr){var Dr=hr[Sr-1+0],Wr=hr[Sr-1+32],rn=hr[Sr-1+64],cn=hr[Sr-1-32],hn=hr[Sr+0-32],dn=hr[Sr+1-32],mn=hr[Sr+2-32],bn=hr[Sr+3-32];hr[Sr+0+96]=Ms(Wr,rn,hr[Sr-1+96]),hr[Sr+1+96]=hr[Sr+0+64]=Ms(Dr,Wr,rn),hr[Sr+2+96]=hr[Sr+1+64]=hr[Sr+0+32]=Ms(cn,Dr,Wr),hr[Sr+3+96]=hr[Sr+2+64]=hr[Sr+1+32]=hr[Sr+0+0]=Ms(hn,cn,Dr),hr[Sr+3+64]=hr[Sr+2+32]=hr[Sr+1+0]=Ms(dn,hn,cn),hr[Sr+3+32]=hr[Sr+2+0]=Ms(mn,dn,hn),hr[Sr+3+0]=Ms(bn,mn,dn)}function m0(hr,Sr){var Dr=hr[Sr+1-32],Wr=hr[Sr+2-32],rn=hr[Sr+3-32],cn=hr[Sr+4-32],hn=hr[Sr+5-32],dn=hr[Sr+6-32],mn=hr[Sr+7-32];hr[Sr+0+0]=Ms(hr[Sr+0-32],Dr,Wr),hr[Sr+1+0]=hr[Sr+0+32]=Ms(Dr,Wr,rn),hr[Sr+2+0]=hr[Sr+1+32]=hr[Sr+0+64]=Ms(Wr,rn,cn),hr[Sr+3+0]=hr[Sr+2+32]=hr[Sr+1+64]=hr[Sr+0+96]=Ms(rn,cn,hn),hr[Sr+3+32]=hr[Sr+2+64]=hr[Sr+1+96]=Ms(cn,hn,dn),hr[Sr+3+64]=hr[Sr+2+96]=Ms(hn,dn,mn),hr[Sr+3+96]=Ms(dn,mn,mn)}function tu(hr,Sr){var Dr=hr[Sr-1+0],Wr=hr[Sr-1+32],rn=hr[Sr-1+64],cn=hr[Sr-1-32],hn=hr[Sr+0-32],dn=hr[Sr+1-32],mn=hr[Sr+2-32],bn=hr[Sr+3-32];hr[Sr+0+0]=hr[Sr+1+64]=cn+hn+1>>1,hr[Sr+1+0]=hr[Sr+2+64]=hn+dn+1>>1,hr[Sr+2+0]=hr[Sr+3+64]=dn+mn+1>>1,hr[Sr+3+0]=mn+bn+1>>1,hr[Sr+0+96]=Ms(rn,Wr,Dr),hr[Sr+0+64]=Ms(Wr,Dr,cn),hr[Sr+0+32]=hr[Sr+1+96]=Ms(Dr,cn,hn),hr[Sr+1+32]=hr[Sr+2+96]=Ms(cn,hn,dn),hr[Sr+2+32]=hr[Sr+3+96]=Ms(hn,dn,mn),hr[Sr+3+32]=Ms(dn,mn,bn)}function Cu(hr,Sr){var Dr=hr[Sr+0-32],Wr=hr[Sr+1-32],rn=hr[Sr+2-32],cn=hr[Sr+3-32],hn=hr[Sr+4-32],dn=hr[Sr+5-32],mn=hr[Sr+6-32],bn=hr[Sr+7-32];hr[Sr+0+0]=Dr+Wr+1>>1,hr[Sr+1+0]=hr[Sr+0+64]=Wr+rn+1>>1,hr[Sr+2+0]=hr[Sr+1+64]=rn+cn+1>>1,hr[Sr+3+0]=hr[Sr+2+64]=cn+hn+1>>1,hr[Sr+0+32]=Ms(Dr,Wr,rn),hr[Sr+1+32]=hr[Sr+0+96]=Ms(Wr,rn,cn),hr[Sr+2+32]=hr[Sr+1+96]=Ms(rn,cn,hn),hr[Sr+3+32]=hr[Sr+2+96]=Ms(cn,hn,dn),hr[Sr+3+64]=Ms(hn,dn,mn),hr[Sr+3+96]=Ms(dn,mn,bn)}function gp(hr,Sr){var Dr=hr[Sr-1+0],Wr=hr[Sr-1+32],rn=hr[Sr-1+64],cn=hr[Sr-1+96];hr[Sr+0+0]=Dr+Wr+1>>1,hr[Sr+2+0]=hr[Sr+0+32]=Wr+rn+1>>1,hr[Sr+2+32]=hr[Sr+0+64]=rn+cn+1>>1,hr[Sr+1+0]=Ms(Dr,Wr,rn),hr[Sr+3+0]=hr[Sr+1+32]=Ms(Wr,rn,cn),hr[Sr+3+32]=hr[Sr+1+64]=Ms(rn,cn,cn),hr[Sr+3+64]=hr[Sr+2+64]=hr[Sr+0+96]=hr[Sr+1+96]=hr[Sr+2+96]=hr[Sr+3+96]=cn}function xp(hr,Sr){var Dr=hr[Sr-1+0],Wr=hr[Sr-1+32],rn=hr[Sr-1+64],cn=hr[Sr-1+96],hn=hr[Sr-1-32],dn=hr[Sr+0-32],mn=hr[Sr+1-32],bn=hr[Sr+2-32];hr[Sr+0+0]=hr[Sr+2+32]=Dr+hn+1>>1,hr[Sr+0+32]=hr[Sr+2+64]=Wr+Dr+1>>1,hr[Sr+0+64]=hr[Sr+2+96]=rn+Wr+1>>1,hr[Sr+0+96]=cn+rn+1>>1,hr[Sr+3+0]=Ms(dn,mn,bn),hr[Sr+2+0]=Ms(hn,dn,mn),hr[Sr+1+0]=hr[Sr+3+32]=Ms(Dr,hn,dn),hr[Sr+1+32]=hr[Sr+3+64]=Ms(Wr,Dr,hn),hr[Sr+1+64]=hr[Sr+3+96]=Ms(rn,Wr,Dr),hr[Sr+1+96]=Ms(cn,rn,Wr)}function vp(hr,Sr){var Dr;for(Dr=0;8>Dr;++Dr)tr(hr,Sr+32*Dr,hr,Sr-32,8)}function Fu(hr,Sr){var Dr;for(Dr=0;8>Dr;++Dr)rr(hr,Sr,hr[Sr-1],8),Sr+=32}function Wl(hr,Sr,Dr){var Wr;for(Wr=0;8>Wr;++Wr)rr(Sr,Dr+32*Wr,hr,8)}function Al(hr,Sr){var Dr,Wr=8;for(Dr=0;8>Dr;++Dr)Wr+=hr[Sr+Dr-32]+hr[Sr-1+32*Dr];Wl(Wr>>4,hr,Sr)}function _p(hr,Sr){var Dr,Wr=4;for(Dr=0;8>Dr;++Dr)Wr+=hr[Sr+Dr-32];Wl(Wr>>3,hr,Sr)}function zl(hr,Sr){var Dr,Wr=4;for(Dr=0;8>Dr;++Dr)Wr+=hr[Sr-1+32*Dr];Wl(Wr>>3,hr,Sr)}function Pu(hr,Sr){Wl(128,hr,Sr)}function ru(hr,Sr,Dr){var Wr=hr[Sr-Dr],rn=hr[Sr+0],cn=3*(rn-Wr)+Ap[1020+hr[Sr-2*Dr]-hr[Sr+Dr]],hn=C0[112+(cn+4>>3)];hr[Sr-Dr]=Po[255+Wr+C0[112+(cn+3>>3)]],hr[Sr+0]=Po[255+rn-hn]}function g0(hr,Sr,Dr,Wr){var rn=hr[Sr+0],cn=hr[Sr+Dr];return Oo[255+hr[Sr-2*Dr]-hr[Sr-Dr]]>Wr||Oo[255+cn-rn]>Wr}function x0(hr,Sr,Dr,Wr){return 4*Oo[255+hr[Sr-Dr]-hr[Sr+0]]+Oo[255+hr[Sr-2*Dr]-hr[Sr+Dr]]<=Wr}function v0(hr,Sr,Dr,Wr,rn){var cn=hr[Sr-3*Dr],hn=hr[Sr-2*Dr],dn=hr[Sr-Dr],mn=hr[Sr+0],bn=hr[Sr+Dr],Bn=hr[Sr+2*Dr],na=hr[Sr+3*Dr];return 4*Oo[255+dn-mn]+Oo[255+hn-bn]>Wr?0:Oo[255+hr[Sr-4*Dr]-cn]<=rn&&Oo[255+cn-hn]<=rn&&Oo[255+hn-dn]<=rn&&Oo[255+na-Bn]<=rn&&Oo[255+Bn-bn]<=rn&&Oo[255+bn-mn]<=rn}function _0(hr,Sr,Dr,Wr){var rn=2*Wr+1;for(Wr=0;16>Wr;++Wr)x0(hr,Sr+Wr,Dr,rn)&&ru(hr,Sr+Wr,Dr)}function qo(hr,Sr,Dr,Wr){var rn=2*Wr+1;for(Wr=0;16>Wr;++Wr)x0(hr,Sr+Wr*Dr,1,rn)&&ru(hr,Sr+Wr*Dr,1)}function Jo(hr,Sr,Dr,Wr){var rn;for(rn=3;0<rn;--rn)_0(hr,Sr+=4*Dr,Dr,Wr)}function wp(hr,Sr,Dr,Wr){var rn;for(rn=3;0<rn;--rn)qo(hr,Sr+=4,Dr,Wr)}function Tl(hr,Sr,Dr,Wr,rn,cn,hn,dn){for(cn=2*cn+1;0<rn--;){if(v0(hr,Sr,Dr,cn,hn))if(g0(hr,Sr,Dr,dn))ru(hr,Sr,Dr);else{var mn=hr,bn=Sr,Bn=Dr,na=mn[bn-2*Bn],ga=mn[bn-Bn],qn=mn[bn+0],hs=mn[bn+Bn],ts=mn[bn+2*Bn],Un=27*(us=Ap[1020+3*(qn-ga)+Ap[1020+na-hs]])+63>>7,Hn=18*us+63>>7,us=9*us+63>>7;mn[bn-3*Bn]=Po[255+mn[bn-3*Bn]+us],mn[bn-2*Bn]=Po[255+na+Hn],mn[bn-Bn]=Po[255+ga+Un],mn[bn+0]=Po[255+qn-Un],mn[bn+Bn]=Po[255+hs-Hn],mn[bn+2*Bn]=Po[255+ts-us]}Sr+=Wr}}function zo(hr,Sr,Dr,Wr,rn,cn,hn,dn){for(cn=2*cn+1;0<rn--;){if(v0(hr,Sr,Dr,cn,hn))if(g0(hr,Sr,Dr,dn))ru(hr,Sr,Dr);else{var mn=hr,bn=Sr,Bn=Dr,na=mn[bn-Bn],ga=mn[bn+0],qn=mn[bn+Bn],hs=C0[112+((ts=3*(ga-na))+4>>3)],ts=C0[112+(ts+3>>3)],Un=hs+1>>1;mn[bn-2*Bn]=Po[255+mn[bn-2*Bn]+Un],mn[bn-Bn]=Po[255+na+ts],mn[bn+0]=Po[255+ga-hs],mn[bn+Bn]=Po[255+qn-Un]}Sr+=Wr}}function Lu(hr,Sr,Dr,Wr,rn,cn){Tl(hr,Sr,Dr,1,16,Wr,rn,cn)}function $l(hr,Sr,Dr,Wr,rn,cn){Tl(hr,Sr,1,Dr,16,Wr,rn,cn)}function yp(hr,Sr,Dr,Wr,rn,cn){var hn;for(hn=3;0<hn;--hn)zo(hr,Sr+=4*Dr,Dr,1,16,Wr,rn,cn)}function nu(hr,Sr,Dr,Wr,rn,cn){var hn;for(hn=3;0<hn;--hn)zo(hr,Sr+=4,1,Dr,16,Wr,rn,cn)}function bp(hr,Sr,Dr,Wr,rn,cn,hn,dn){Tl(hr,Sr,rn,1,8,cn,hn,dn),Tl(Dr,Wr,rn,1,8,cn,hn,dn)}function Nu(hr,Sr,Dr,Wr,rn,cn,hn,dn){Tl(hr,Sr,1,rn,8,cn,hn,dn),Tl(Dr,Wr,1,rn,8,cn,hn,dn)}function Ru(hr,Sr,Dr,Wr,rn,cn,hn,dn){zo(hr,Sr+4*rn,rn,1,8,cn,hn,dn),zo(Dr,Wr+4*rn,rn,1,8,cn,hn,dn)}function w0(hr,Sr,Dr,Wr,rn,cn,hn,dn){zo(hr,Sr+4,1,rn,8,cn,hn,dn),zo(Dr,Wr+4,1,rn,8,cn,hn,dn)}function iu(){this.ba=new yn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new rs,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Du(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Iu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function y0(){this.ua=0,this.Wa=new Qr,this.vb=new Qr,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Hr,this.yc=new kr}function Sp(){this.xb=this.a=0,this.l=new Qs,this.ca=new yn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new yr,this.Pb=0,this.wd=new yr,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new y0,this.ab=0,this.gc=ir(4,Iu),this.Oc=0}function au(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Hl(hr,Sr,Dr,Wr,rn,cn,hn){for(hr=hr==null?0:hr[Sr+0],Sr=0;Sr<hn;++Sr)rn[cn+Sr]=hr+Dr[Wr+Sr]&255,hr=rn[cn+Sr]}function Mu(hr,Sr,Dr,Wr,rn,cn,hn){var dn;if(hr==null)Hl(null,null,Dr,Wr,rn,cn,hn);else for(dn=0;dn<hn;++dn)rn[cn+dn]=hr[Sr+dn]+Dr[Wr+dn]&255}function Cl(hr,Sr,Dr,Wr,rn,cn,hn){if(hr==null)Hl(null,null,Dr,Wr,rn,cn,hn);else{var dn,mn=hr[Sr+0],bn=mn,Bn=mn;for(dn=0;dn<hn;++dn)bn=Bn+(mn=hr[Sr+dn])-bn,Bn=Dr[Wr+dn]+(-256&bn?0>bn?0:255:bn)&255,bn=mn,rn[cn+dn]=Bn}}function Ou(hr,Sr,Dr,Wr){var rn=Sr.width,cn=Sr.o;if(_e(hr!=null&&Sr!=null),0>Dr||0>=Wr||Dr+Wr>cn)return null;if(!hr.Cc){if(hr.ga==null){var hn;if(hr.ga=new au,(hn=hr.ga==null)||(hn=Sr.width*Sr.o,_e(hr.Gb.length==0),hr.Gb=nr(hn),hr.Uc=0,hr.Gb==null?hn=0:(hr.mb=hr.Gb,hr.nb=hr.Uc,hr.rc=null,hn=1),hn=!hn),!hn){hn=hr.ga;var dn=hr.Fa,mn=hr.P,bn=hr.qc,Bn=hr.mb,na=hr.nb,ga=mn+1,qn=bn-1,hs=hn.l;if(_e(dn!=null&&Bn!=null&&Sr!=null),Dl[0]=null,Dl[1]=Hl,Dl[2]=Mu,Dl[3]=Cl,hn.ca=Bn,hn.tb=na,hn.c=Sr.width,hn.i=Sr.height,_e(0<hn.c&&0<hn.i),1>=bn)Sr=0;else if(hn.$a=dn[mn+0]>>0&3,hn.Z=dn[mn+0]>>2&3,hn.Lc=dn[mn+0]>>4&3,mn=dn[mn+0]>>6&3,0>hn.$a||1<hn.$a||4<=hn.Z||1<hn.Lc||mn)Sr=0;else if(hs.put=pn,hs.ac=gn,hs.bc=Pn,hs.ma=hn,hs.width=Sr.width,hs.height=Sr.height,hs.Da=Sr.Da,hs.v=Sr.v,hs.va=Sr.va,hs.j=Sr.j,hs.o=Sr.o,hn.$a)e:{_e(hn.$a==1),Sr=In();t:for(;;){if(Sr==null){Sr=0;break e}if(_e(hn!=null),hn.mc=Sr,Sr.c=hn.c,Sr.i=hn.i,Sr.l=hn.l,Sr.l.ma=hn,Sr.l.width=hn.c,Sr.l.height=hn.i,Sr.a=0,Vr(Sr.m,dn,ga,qn),!Fn(hn.c,hn.i,1,Sr,null)||(Sr.ab==1&&Sr.gc[0].hc==3&&qr(Sr.s)?(hn.ic=1,dn=Sr.c*Sr.i,Sr.Ta=null,Sr.Ua=0,Sr.V=nr(dn),Sr.Ba=0,Sr.V==null?(Sr.a=1,Sr=0):Sr=1):(hn.ic=0,Sr=kn(Sr,hn.c)),!Sr))break t;Sr=1;break e}hn.mc=null,Sr=0}else Sr=qn>=hn.c*hn.i;hn=!Sr}if(hn)return null;hr.ga.Lc!=1?hr.Ga=0:Wr=cn-Dr}_e(hr.ga!=null),_e(Dr+Wr<=cn);e:{if(Sr=(dn=hr.ga).c,cn=dn.l.o,dn.$a==0){if(ga=hr.rc,qn=hr.Vc,hs=hr.Fa,mn=hr.P+1+Dr*Sr,bn=hr.mb,Bn=hr.nb+Dr*Sr,_e(mn<=hr.P+hr.qc),dn.Z!=0)for(_e(Dl[dn.Z]!=null),hn=0;hn<Wr;++hn)Dl[dn.Z](ga,qn,hs,mn,bn,Bn,Sr),ga=bn,qn=Bn,Bn+=Sr,mn+=Sr;else for(hn=0;hn<Wr;++hn)tr(bn,Bn,hs,mn,Sr),ga=bn,qn=Bn,Bn+=Sr,mn+=Sr;hr.rc=ga,hr.Vc=qn}else{if(_e(dn.mc!=null),Sr=Dr+Wr,_e((hn=dn.mc)!=null),_e(Sr<=hn.i),hn.C>=Sr)Sr=1;else if(dn.ic||Jn(),dn.ic){dn=hn.V,ga=hn.Ba,qn=hn.c;var ts=hn.i,Un=(hs=1,mn=hn.$/qn,bn=hn.$%qn,Bn=hn.m,na=hn.s,hn.$),Hn=qn*ts,us=qn*Sr,gs=na.wc,fs=Un<us?xs(na,bn,mn):null;_e(Un<=Hn),_e(Sr<=ts),_e(qr(na));t:for(;;){for(;!Bn.h&&Un<us;){if(bn&gs||(fs=xs(na,bn,mn)),_e(fs!=null),Or(Bn),256>(ts=$a(fs.G[0],fs.H[0],Bn)))dn[ga+Un]=ts,++Un,++bn>=qn&&(bn=0,++mn<=Sr&&!(mn%16)&&sn(hn,mn));else{if(!(280>ts)){hs=0;break t}ts=Yn(ts-256,Bn);var Fs,Es=$a(fs.G[4],fs.H[4],Bn);if(Or(Bn),!(Un>=(Es=xa(qn,Es=Yn(Es,Bn)))&&Hn-Un>=ts)){hs=0;break t}for(Fs=0;Fs<ts;++Fs)dn[ga+Un+Fs]=dn[ga+Un+Fs-Es];for(Un+=ts,bn+=ts;bn>=qn;)bn-=qn,++mn<=Sr&&!(mn%16)&&sn(hn,mn);Un<us&&bn&gs&&(fs=xs(na,bn,mn))}_e(Bn.h==Er(Bn))}sn(hn,mn>Sr?Sr:mn);break t}!hs||Bn.h&&Un<Hn?(hs=0,hn.a=Bn.h?5:3):hn.$=Un,Sr=hs}else Sr=un(hn,hn.V,hn.Ba,hn.c,hn.i,Sr,Nn);if(!Sr){Wr=0;break e}}Dr+Wr>=cn&&(hr.Cc=1),Wr=1}if(!Wr)return null;if(hr.Cc&&((Wr=hr.ga)!=null&&(Wr.mc=null),hr.ga=null,0<hr.Ga))return alert("todo:WebPDequantizeLevels"),null}return hr.nb+Dr*rn}function Nr(hr,Sr,Dr,Wr,rn,cn){for(;0<rn--;){var hn,dn=hr,mn=Sr+(Dr?1:0),bn=hr,Bn=Sr+(Dr?0:3);for(hn=0;hn<Wr;++hn){var na=bn[Bn+4*hn];na!=255&&(na*=32897,dn[mn+4*hn+0]=dn[mn+4*hn+0]*na>>23,dn[mn+4*hn+1]=dn[mn+4*hn+1]*na>>23,dn[mn+4*hn+2]=dn[mn+4*hn+2]*na>>23)}Sr+=cn}}function nn(hr,Sr,Dr,Wr,rn){for(;0<Wr--;){var cn;for(cn=0;cn<Dr;++cn){var hn=hr[Sr+2*cn+0],dn=15&(bn=hr[Sr+2*cn+1]),mn=4369*dn,bn=(240&bn|bn>>4)*mn>>16;hr[Sr+2*cn+0]=(240&hn|hn>>4)*mn>>16&240|(15&hn|hn<<4)*mn>>16>>4&15,hr[Sr+2*cn+1]=240&bn|dn}Sr+=rn}}function An(hr,Sr,Dr,Wr,rn,cn,hn,dn){var mn,bn,Bn=255;for(bn=0;bn<rn;++bn){for(mn=0;mn<Wr;++mn){var na=hr[Sr+mn];cn[hn+4*mn]=na,Bn&=na}Sr+=Dr,hn+=dn}return Bn!=255}function jn(hr,Sr,Dr,Wr,rn){var cn;for(cn=0;cn<rn;++cn)Dr[Wr+cn]=hr[Sr+cn]>>8}function Jn(){Mo=Nr,eo=nn,to=An,lo=jn}function as(hr,Sr,Dr){Ar[hr]=function(Wr,rn,cn,hn,dn,mn,bn,Bn,na,ga,qn,hs,ts,Un,Hn,us,gs){var fs,Fs=gs-1>>1,Es=dn[mn+0]|bn[Bn+0]<<16,Ds=na[ga+0]|qn[hs+0]<<16;_e(Wr!=null);var Ts=3*Es+Ds+131074>>2;for(Sr(Wr[rn+0],255&Ts,Ts>>16,ts,Un),cn!=null&&(Ts=3*Ds+Es+131074>>2,Sr(cn[hn+0],255&Ts,Ts>>16,Hn,us)),fs=1;fs<=Fs;++fs){var Vs=dn[mn+fs]|bn[Bn+fs]<<16,Ys=na[ga+fs]|qn[hs+fs]<<16,$s=Es+Vs+Ds+Ys+524296,Ws=$s+2*(Vs+Ds)>>3;Ts=Ws+Es>>1,Es=($s=$s+2*(Es+Ys)>>3)+Vs>>1,Sr(Wr[rn+2*fs-1],255&Ts,Ts>>16,ts,Un+(2*fs-1)*Dr),Sr(Wr[rn+2*fs-0],255&Es,Es>>16,ts,Un+(2*fs-0)*Dr),cn!=null&&(Ts=$s+Ds>>1,Es=Ws+Ys>>1,Sr(cn[hn+2*fs-1],255&Ts,Ts>>16,Hn,us+(2*fs-1)*Dr),Sr(cn[hn+2*fs+0],255&Es,Es>>16,Hn,us+(2*fs+0)*Dr)),Es=Vs,Ds=Ys}1&gs||(Ts=3*Es+Ds+131074>>2,Sr(Wr[rn+gs-1],255&Ts,Ts>>16,ts,Un+(gs-1)*Dr),cn!=null&&(Ts=3*Ds+Es+131074>>2,Sr(cn[hn+gs-1],255&Ts,Ts>>16,Hn,us+(gs-1)*Dr)))}}function _s(){jo[F0]=Vm,jo[P0]=C1,jo[S1]=Xm,jo[L0]=F1,jo[N0]=P1,jo[kp]=L1,jo[E1]=qm,jo[Tp]=C1,jo[Cp]=F1,jo[R0]=P1,jo[Fp]=L1}function Cs(hr){return hr&-16384?0>hr?0:255:hr>>Gm}function Rs(hr,Sr){return Cs((19077*hr>>8)+(26149*Sr>>8)-14234)}function js(hr,Sr,Dr){return Cs((19077*hr>>8)-(6419*Sr>>8)-(13320*Dr>>8)+8708)}function Os(hr,Sr){return Cs((19077*hr>>8)+(33050*Sr>>8)-17685)}function zs(hr,Sr,Dr,Wr,rn){Wr[rn+0]=Rs(hr,Dr),Wr[rn+1]=js(hr,Sr,Dr),Wr[rn+2]=Os(hr,Sr)}function no(hr,Sr,Dr,Wr,rn){Wr[rn+0]=Os(hr,Sr),Wr[rn+1]=js(hr,Sr,Dr),Wr[rn+2]=Rs(hr,Dr)}function io(hr,Sr,Dr,Wr,rn){var cn=js(hr,Sr,Dr);Sr=cn<<3&224|Os(hr,Sr)>>3,Wr[rn+0]=248&Rs(hr,Dr)|cn>>5,Wr[rn+1]=Sr}function co(hr,Sr,Dr,Wr,rn){var cn=240&Os(hr,Sr)|15;Wr[rn+0]=240&Rs(hr,Dr)|js(hr,Sr,Dr)>>4,Wr[rn+1]=cn}function wo(hr,Sr,Dr,Wr,rn){Wr[rn+0]=255,zs(hr,Sr,Dr,Wr,rn+1)}function po(hr,Sr,Dr,Wr,rn){no(hr,Sr,Dr,Wr,rn),Wr[rn+3]=255}function $o(hr,Sr,Dr,Wr,rn){zs(hr,Sr,Dr,Wr,rn),Wr[rn+3]=255}function Fo(hr,Sr){return 0>hr?0:hr>Sr?Sr:hr}function Go(hr,Sr,Dr){Ar[hr]=function(Wr,rn,cn,hn,dn,mn,bn,Bn,na){for(var ga=Bn+(-2&na)*Dr;Bn!=ga;)Sr(Wr[rn+0],cn[hn+0],dn[mn+0],bn,Bn),Sr(Wr[rn+1],cn[hn+0],dn[mn+0],bn,Bn+Dr),rn+=2,++hn,++mn,Bn+=2*Dr;1&na&&Sr(Wr[rn+0],cn[hn+0],dn[mn+0],bn,Bn)}}function b0(hr,Sr,Dr){return Dr==0?hr==0?Sr==0?6:5:Sr==0?4:0:Dr}function ju(hr,Sr,Dr,Wr,rn){switch(hr>>>30){case 3:xl(Sr,Dr,Wr,rn,0);break;case 2:oo(Sr,Dr,Wr,rn);break;case 1:bo(Sr,Dr,Wr,rn)}}function Bu(hr,Sr){var Dr,Wr,rn=Sr.M,cn=Sr.Nb,hn=hr.oc,dn=hr.pc+40,mn=hr.oc,bn=hr.pc+584,Bn=hr.oc,na=hr.pc+600;for(Dr=0;16>Dr;++Dr)hn[dn+32*Dr-1]=129;for(Dr=0;8>Dr;++Dr)mn[bn+32*Dr-1]=129,Bn[na+32*Dr-1]=129;for(0<rn?hn[dn-1-32]=mn[bn-1-32]=Bn[na-1-32]=129:(rr(hn,dn-32-1,127,21),rr(mn,bn-32-1,127,9),rr(Bn,na-32-1,127,9)),Wr=0;Wr<hr.za;++Wr){var ga=Sr.ya[Sr.aa+Wr];if(0<Wr){for(Dr=-1;16>Dr;++Dr)tr(hn,dn+32*Dr-4,hn,dn+32*Dr+12,4);for(Dr=-1;8>Dr;++Dr)tr(mn,bn+32*Dr-4,mn,bn+32*Dr+4,4),tr(Bn,na+32*Dr-4,Bn,na+32*Dr+4,4)}var qn=hr.Gd,hs=hr.Hd+Wr,ts=ga.ad,Un=ga.Hc;if(0<rn&&(tr(hn,dn-32,qn[hs].y,0,16),tr(mn,bn-32,qn[hs].f,0,8),tr(Bn,na-32,qn[hs].ea,0,8)),ga.Za){var Hn=hn,us=dn-32+16;for(0<rn&&(Wr>=hr.za-1?rr(Hn,us,qn[hs].y[15],4):tr(Hn,us,qn[hs+1].y,0,4)),Dr=0;4>Dr;Dr++)Hn[us+128+Dr]=Hn[us+256+Dr]=Hn[us+384+Dr]=Hn[us+0+Dr];for(Dr=0;16>Dr;++Dr,Un<<=2)Hn=hn,us=dn+R1[Dr],Ho[ga.Ob[Dr]](Hn,us),ju(Un,ts,16*+Dr,Hn,us)}else if(Hn=b0(Wr,rn,ga.Ob[0]),Rl[Hn](hn,dn),Un!=0)for(Dr=0;16>Dr;++Dr,Un<<=2)ju(Un,ts,16*+Dr,hn,dn+R1[Dr]);for(Dr=ga.Gc,Hn=b0(Wr,rn,ga.Dd),wl[Hn](mn,bn),wl[Hn](Bn,na),Un=ts,Hn=mn,us=bn,255&(ga=Dr>>0)&&(170&ga?Hu(Un,256,Hn,us):Do(Un,256,Hn,us)),ga=Bn,Un=na,255&(Dr>>=8)&&(170&Dr?Hu(ts,320,ga,Un):Do(ts,320,ga,Un)),rn<hr.Ub-1&&(tr(qn[hs].y,0,hn,dn+480,16),tr(qn[hs].f,0,mn,bn+224,8),tr(qn[hs].ea,0,Bn,na+224,8)),Dr=8*cn*hr.B,qn=hr.sa,hs=hr.ta+16*Wr+16*cn*hr.R,ts=hr.qa,ga=hr.ra+8*Wr+Dr,Un=hr.Ha,Hn=hr.Ia+8*Wr+Dr,Dr=0;16>Dr;++Dr)tr(qn,hs+Dr*hr.R,hn,dn+32*Dr,16);for(Dr=0;8>Dr;++Dr)tr(ts,ga+Dr*hr.B,mn,bn+32*Dr,8),tr(Un,Hn+Dr*hr.B,Bn,na+32*Dr,8)}}function su(hr,Sr,Dr,Wr,rn,cn,hn,dn,mn){var bn=[0],Bn=[0],na=0,ga=mn!=null?mn.kd:0,qn=mn??new Du;if(hr==null||12>Dr)return 7;qn.data=hr,qn.w=Sr,qn.ha=Dr,Sr=[Sr],Dr=[Dr],qn.gb=[qn.gb];e:{var hs=Sr,ts=Dr,Un=qn.gb;if(_e(hr!=null),_e(ts!=null),_e(Un!=null),Un[0]=0,12<=ts[0]&&!er(hr,hs[0],"RIFF")){if(er(hr,hs[0]+8,"WEBP")){Un=3;break e}var Hn=Cn(hr,hs[0]+4);if(12>Hn||4294967286<Hn){Un=3;break e}if(ga&&Hn>ts[0]-8){Un=7;break e}Un[0]=Hn,hs[0]+=12,ts[0]-=12}Un=0}if(Un!=0)return Un;for(Hn=0<qn.gb[0],Dr=Dr[0];;){e:{var us=hr;ts=Sr,Un=Dr;var gs=bn,fs=Bn,Fs=hs=[0];if((Ts=na=[na])[0]=0,8>Un[0])Un=7;else{if(!er(us,ts[0],"VP8X")){if(Cn(us,ts[0]+4)!=10){Un=3;break e}if(18>Un[0]){Un=7;break e}var Es=Cn(us,ts[0]+8),Ds=1+Kr(us,ts[0]+12);if(2147483648<=Ds*(us=1+Kr(us,ts[0]+15))){Un=3;break e}Fs!=null&&(Fs[0]=Es),gs!=null&&(gs[0]=Ds),fs!=null&&(fs[0]=us),ts[0]+=18,Un[0]-=18,Ts[0]=1}Un=0}}if(na=na[0],hs=hs[0],Un!=0)return Un;if(ts=!!(2&hs),!Hn&&na)return 3;if(cn!=null&&(cn[0]=!!(16&hs)),hn!=null&&(hn[0]=ts),dn!=null&&(dn[0]=0),hn=bn[0],hs=Bn[0],na&&ts&&mn==null){Un=0;break}if(4>Dr){Un=7;break}if(Hn&&na||!Hn&&!na&&!er(hr,Sr[0],"ALPH")){Dr=[Dr],qn.na=[qn.na],qn.P=[qn.P],qn.Sa=[qn.Sa];e:{Es=hr,Un=Sr,Hn=Dr;var Ts=qn.gb;gs=qn.na,fs=qn.P,Fs=qn.Sa,Ds=22,_e(Es!=null),_e(Hn!=null),us=Un[0];var Vs=Hn[0];for(_e(gs!=null),_e(Fs!=null),gs[0]=null,fs[0]=null,Fs[0]=0;;){if(Un[0]=us,Hn[0]=Vs,8>Vs){Un=7;break e}var Ys=Cn(Es,us+4);if(4294967286<Ys){Un=3;break e}var $s=8+Ys+1&-2;if(Ds+=$s,0<Ts&&Ds>Ts){Un=3;break e}if(!er(Es,us,"VP8 ")||!er(Es,us,"VP8L")){Un=0;break e}if(Vs[0]<$s){Un=7;break e}er(Es,us,"ALPH")||(gs[0]=Es,fs[0]=us+8,Fs[0]=Ys),us+=$s,Vs-=$s}}if(Dr=Dr[0],qn.na=qn.na[0],qn.P=qn.P[0],qn.Sa=qn.Sa[0],Un!=0)break}Dr=[Dr],qn.Ja=[qn.Ja],qn.xa=[qn.xa];e:if(Ts=hr,Un=Sr,Hn=Dr,gs=qn.gb[0],fs=qn.Ja,Fs=qn.xa,Es=Un[0],us=!er(Ts,Es,"VP8 "),Ds=!er(Ts,Es,"VP8L"),_e(Ts!=null),_e(Hn!=null),_e(fs!=null),_e(Fs!=null),8>Hn[0])Un=7;else{if(us||Ds){if(Ts=Cn(Ts,Es+4),12<=gs&&Ts>gs-12){Un=3;break e}if(ga&&Ts>Hn[0]-8){Un=7;break e}fs[0]=Ts,Un[0]+=8,Hn[0]-=8,Fs[0]=Ds}else Fs[0]=5<=Hn[0]&&Ts[Es+0]==47&&!(Ts[Es+4]>>5),fs[0]=Hn[0];Un=0}if(Dr=Dr[0],qn.Ja=qn.Ja[0],qn.xa=qn.xa[0],Sr=Sr[0],Un!=0)break;if(4294967286<qn.Ja)return 3;if(dn==null||ts||(dn[0]=qn.xa?2:1),hn=[hn],hs=[hs],qn.xa){if(5>Dr){Un=7;break}dn=hn,ga=hs,ts=cn,hr==null||5>Dr?hr=0:5<=Dr&&hr[Sr+0]==47&&!(hr[Sr+4]>>5)?(Hn=[0],Ts=[0],gs=[0],Vr(fs=new yr,hr,Sr,Dr),Rn(fs,Hn,Ts,gs)?(dn!=null&&(dn[0]=Hn[0]),ga!=null&&(ga[0]=Ts[0]),ts!=null&&(ts[0]=gs[0]),hr=1):hr=0):hr=0}else{if(10>Dr){Un=7;break}dn=hs,hr==null||10>Dr||!s0(hr,Sr+3,Dr-3)?hr=0:(ga=hr[Sr+0]|hr[Sr+1]<<8|hr[Sr+2]<<16,ts=16383&(hr[Sr+7]<<8|hr[Sr+6]),hr=16383&(hr[Sr+9]<<8|hr[Sr+8]),1&ga||3<(ga>>1&7)||!(ga>>4&1)||ga>>5>=qn.Ja||!ts||!hr?hr=0:(hn&&(hn[0]=ts),dn&&(dn[0]=hr),hr=1))}if(!hr||(hn=hn[0],hs=hs[0],na&&(bn[0]!=hn||Bn[0]!=hs)))return 3;mn!=null&&(mn[0]=qn,mn.offset=Sr-mn.w,_e(4294967286>Sr-mn.w),_e(mn.offset==mn.ha-Dr));break}return Un==0||Un==7&&na&&mn==null?(cn!=null&&(cn[0]|=qn.na!=null&&0<qn.na.length),Wr!=null&&(Wr[0]=hn),rn!=null&&(rn[0]=hs),0):Un}function Uu(hr,Sr,Dr){var Wr=Sr.width,rn=Sr.height,cn=0,hn=0,dn=Wr,mn=rn;if(Sr.Da=hr!=null&&0<hr.Da,Sr.Da&&(dn=hr.cd,mn=hr.bd,cn=hr.v,hn=hr.j,11>Dr||(cn&=-2,hn&=-2),0>cn||0>hn||0>=dn||0>=mn||cn+dn>Wr||hn+mn>rn))return 0;if(Sr.v=cn,Sr.j=hn,Sr.va=cn+dn,Sr.o=hn+mn,Sr.U=dn,Sr.T=mn,Sr.da=hr!=null&&0<hr.da,Sr.da){if(!xn(dn,mn,Dr=[hr.ib],cn=[hr.hb]))return 0;Sr.ib=Dr[0],Sr.hb=cn[0]}return Sr.ob=hr!=null&&hr.ob,Sr.Kb=hr==null||!hr.Sd,Sr.da&&(Sr.ob=Sr.ib<3*Wr/4&&Sr.hb<3*rn/4,Sr.Kb=0),1}function Wu(hr){if(hr==null)return 2;if(11>hr.S){var Sr=hr.f.RGBA;Sr.fb+=(hr.height-1)*Sr.A,Sr.A=-Sr.A}else Sr=hr.f.kb,hr=hr.height,Sr.O+=(hr-1)*Sr.fa,Sr.fa=-Sr.fa,Sr.N+=(hr-1>>1)*Sr.Ab,Sr.Ab=-Sr.Ab,Sr.W+=(hr-1>>1)*Sr.Db,Sr.Db=-Sr.Db,Sr.F!=null&&(Sr.J+=(hr-1)*Sr.lb,Sr.lb=-Sr.lb);return 0}function ou(hr,Sr,Dr,Wr){if(Wr==null||0>=hr||0>=Sr)return 2;if(Dr!=null){if(Dr.Da){var rn=Dr.cd,cn=Dr.bd,hn=-2&Dr.v,dn=-2&Dr.j;if(0>hn||0>dn||0>=rn||0>=cn||hn+rn>hr||dn+cn>Sr)return 2;hr=rn,Sr=cn}if(Dr.da){if(!xn(hr,Sr,rn=[Dr.ib],cn=[Dr.hb]))return 2;hr=rn[0],Sr=cn[0]}}Wr.width=hr,Wr.height=Sr;e:{var mn=Wr.width,bn=Wr.height;if(hr=Wr.S,0>=mn||0>=bn||!(hr>=F0&&13>hr))hr=2;else{if(0>=Wr.Rd&&Wr.sd==null){hn=cn=rn=Sr=0;var Bn=(dn=mn*D1[hr])*bn;if(11>hr||(cn=(bn+1)/2*(Sr=(mn+1)/2),hr==12&&(hn=(rn=mn)*bn)),(bn=nr(Bn+2*cn+hn))==null){hr=1;break e}Wr.sd=bn,11>hr?((mn=Wr.f.RGBA).eb=bn,mn.fb=0,mn.A=dn,mn.size=Bn):((mn=Wr.f.kb).y=bn,mn.O=0,mn.fa=dn,mn.Fd=Bn,mn.f=bn,mn.N=0+Bn,mn.Ab=Sr,mn.Cd=cn,mn.ea=bn,mn.W=0+Bn+cn,mn.Db=Sr,mn.Ed=cn,hr==12&&(mn.F=bn,mn.J=0+Bn+2*cn),mn.Tc=hn,mn.lb=rn)}if(Sr=1,rn=Wr.S,cn=Wr.width,hn=Wr.height,rn>=F0&&13>rn)if(11>rn)hr=Wr.f.RGBA,Sr&=(dn=Math.abs(hr.A))*(hn-1)+cn<=hr.size,Sr&=dn>=cn*D1[rn],Sr&=hr.eb!=null;else{hr=Wr.f.kb,dn=(cn+1)/2,Bn=(hn+1)/2,mn=Math.abs(hr.fa),bn=Math.abs(hr.Ab);var na=Math.abs(hr.Db),ga=Math.abs(hr.lb),qn=ga*(hn-1)+cn;Sr&=mn*(hn-1)+cn<=hr.Fd,Sr&=bn*(Bn-1)+dn<=hr.Cd,Sr=(Sr&=na*(Bn-1)+dn<=hr.Ed)&mn>=cn&bn>=dn&na>=dn,Sr&=hr.y!=null,Sr&=hr.f!=null,Sr&=hr.ea!=null,rn==12&&(Sr&=ga>=cn,Sr&=qn<=hr.Tc,Sr&=hr.F!=null)}else Sr=0;hr=Sr?0:2}}return hr!=0||Dr!=null&&Dr.fd&&(hr=Wu(Wr)),hr}var xo=64,lu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],cu=24,uu=32,zu=8,Ao=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vn("Predictor0","PredictorAdd0"),Ar.Predictor0=function(){return 4278190080},Ar.Predictor1=function(hr){return hr},Ar.Predictor2=function(hr,Sr,Dr){return Sr[Dr+0]},Ar.Predictor3=function(hr,Sr,Dr){return Sr[Dr+1]},Ar.Predictor4=function(hr,Sr,Dr){return Sr[Dr-1]},Ar.Predictor5=function(hr,Sr,Dr){return Ln(Ln(hr,Sr[Dr+1]),Sr[Dr+0])},Ar.Predictor6=function(hr,Sr,Dr){return Ln(hr,Sr[Dr-1])},Ar.Predictor7=function(hr,Sr,Dr){return Ln(hr,Sr[Dr+0])},Ar.Predictor8=function(hr,Sr,Dr){return Ln(Sr[Dr-1],Sr[Dr+0])},Ar.Predictor9=function(hr,Sr,Dr){return Ln(Sr[Dr+0],Sr[Dr+1])},Ar.Predictor10=function(hr,Sr,Dr){return Ln(Ln(hr,Sr[Dr-1]),Ln(Sr[Dr+0],Sr[Dr+1]))},Ar.Predictor11=function(hr,Sr,Dr){var Wr=Sr[Dr+0];return 0>=En(Wr>>24&255,hr>>24&255,(Sr=Sr[Dr-1])>>24&255)+En(Wr>>16&255,hr>>16&255,Sr>>16&255)+En(Wr>>8&255,hr>>8&255,Sr>>8&255)+En(255&Wr,255&hr,255&Sr)?Wr:hr},Ar.Predictor12=function(hr,Sr,Dr){var Wr=Sr[Dr+0];return(Wn((hr>>24&255)+(Wr>>24&255)-((Sr=Sr[Dr-1])>>24&255))<<24|Wn((hr>>16&255)+(Wr>>16&255)-(Sr>>16&255))<<16|Wn((hr>>8&255)+(Wr>>8&255)-(Sr>>8&255))<<8|Wn((255&hr)+(255&Wr)-(255&Sr)))>>>0},Ar.Predictor13=function(hr,Sr,Dr){var Wr=Sr[Dr-1];return($n((hr=Ln(hr,Sr[Dr+0]))>>24&255,Wr>>24&255)<<24|$n(hr>>16&255,Wr>>16&255)<<16|$n(hr>>8&255,Wr>>8&255)<<8|$n(hr>>0&255,Wr>>0&255))>>>0};var Ep=Ar.PredictorAdd0;Ar.PredictorAdd1=ba,vn("Predictor2","PredictorAdd2"),vn("Predictor3","PredictorAdd3"),vn("Predictor4","PredictorAdd4"),vn("Predictor5","PredictorAdd5"),vn("Predictor6","PredictorAdd6"),vn("Predictor7","PredictorAdd7"),vn("Predictor8","PredictorAdd8"),vn("Predictor9","PredictorAdd9"),vn("Predictor10","PredictorAdd10"),vn("Predictor11","PredictorAdd11"),vn("Predictor12","PredictorAdd12"),vn("Predictor13","PredictorAdd13");var $u=Ar.PredictorAdd2;ls("ColorIndexInverseTransform","MapARGB","32b",function(hr){return hr>>8&255},function(hr){return hr}),ls("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(hr){return hr},function(hr){return hr>>8&255});var S0,Ro=Ar.ColorIndexInverseTransform,fu=Ar.MapARGB,E0=Ar.VP8LColorIndexInverseTransformAlpha,A0=Ar.MapAlpha,Fl=Ar.VP8LPredictorsAdd=[];Fl.length=16,(Ar.VP8LPredictors=[]).length=16,(Ar.VP8LPredictorsAdd_C=[]).length=16,(Ar.VP8LPredictors_C=[]).length=16;var Vl,ko,yo,Pl,Zo,Qo,hu,xl,oo,Hu,bo,Do,du,k0,Vu,Xl,Gl,Ll,Yl,pu,Kl,Nl,Xu,Io,Mo,eo,to,lo,ho=nr(511),_l=nr(2041),qu=nr(225),mu=nr(767),T0=0,Ap=_l,C0=qu,Po=mu,Oo=ho,F0=0,P0=1,S1=2,L0=3,N0=4,kp=5,E1=6,Tp=7,Cp=8,R0=9,Fp=10,Lm=[2,3,7],Nm=[3,3,11],A1=[280,256,256,256,40],Rm=[0,1,1,1,0],Dm=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Im=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Mm=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Om=8,Pp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Lp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Gu=null,jm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Bm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],k1=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Um=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Wm=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],zm=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],$m=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Rl=[],Ho=[],wl=[],Hm=1,T1=2,Dl=[],jo=[];as("UpsampleRgbLinePair",zs,3),as("UpsampleBgrLinePair",no,3),as("UpsampleRgbaLinePair",$o,4),as("UpsampleBgraLinePair",po,4),as("UpsampleArgbLinePair",wo,4),as("UpsampleRgba4444LinePair",co,2),as("UpsampleRgb565LinePair",io,2);var Vm=Ar.UpsampleRgbLinePair,Xm=Ar.UpsampleBgrLinePair,C1=Ar.UpsampleRgbaLinePair,F1=Ar.UpsampleBgraLinePair,P1=Ar.UpsampleArgbLinePair,L1=Ar.UpsampleRgba4444LinePair,qm=Ar.UpsampleRgb565LinePair,D0=16,I0=1<<D0-1,Yu=-227,Np=482,Gm=6,N1=0,Ym=nr(256),Km=nr(256),Jm=nr(256),Zm=nr(256),Qm=nr(Np-Yu),_g=nr(Np-Yu);Go("YuvToRgbRow",zs,3),Go("YuvToBgrRow",no,3),Go("YuvToRgbaRow",$o,4),Go("YuvToBgraRow",po,4),Go("YuvToArgbRow",wo,4),Go("YuvToRgba4444Row",co,2),Go("YuvToRgb565Row",io,2);var R1=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],M0=[0,2,8],e2=[8,7,6,4,4,2,2,2,1,1,1,1],t2=1;this.WebPDecodeRGBA=function(hr,Sr,Dr,Wr,rn){var cn=P0,hn=new iu,dn=new yn;hn.ba=dn,dn.S=cn,dn.width=[dn.width],dn.height=[dn.height];var mn=dn.width,bn=dn.height,Bn=new _i;if(Bn==null||hr==null)var na=2;else _e(Bn!=null),na=su(hr,Sr,Dr,Bn.width,Bn.height,Bn.Pd,Bn.Qd,Bn.format,null);if(na!=0?mn=0:(mn!=null&&(mn[0]=Bn.width[0]),bn!=null&&(bn[0]=Bn.height[0]),mn=1),mn){dn.width=dn.width[0],dn.height=dn.height[0],Wr!=null&&(Wr[0]=dn.width),rn!=null&&(rn[0]=dn.height);e:{if(Wr=new Qs,(rn=new Du).data=hr,rn.w=Sr,rn.ha=Dr,rn.kd=1,Sr=[0],_e(rn!=null),((hr=su(rn.data,rn.w,rn.ha,null,null,null,Sr,null,rn))==0||hr==7)&&Sr[0]&&(hr=4),(Sr=hr)==0){if(_e(hn!=null),Wr.data=rn.data,Wr.w=rn.w+rn.offset,Wr.ha=rn.ha-rn.offset,Wr.put=pn,Wr.ac=gn,Wr.bc=Pn,Wr.ma=hn,rn.xa){if((hr=In())==null){hn=1;break e}if(function(ga,qn){var hs=[0],ts=[0],Un=[0];t:for(;;){if(ga==null)return 0;if(qn==null)return ga.a=2,0;if(ga.l=qn,ga.a=0,Vr(ga.m,qn.data,qn.w,qn.ha),!Rn(ga.m,hs,ts,Un)){ga.a=3;break t}if(ga.xb=T1,qn.width=hs[0],qn.height=ts[0],!Fn(hs[0],ts[0],1,ga,null))break t;return 1}return _e(ga.a!=0),0}(hr,Wr)){if(Wr=(Sr=ou(Wr.width,Wr.height,hn.Oa,hn.ba))==0){t:{Wr=hr;r:for(;;){if(Wr==null){Wr=0;break t}if(_e(Wr.s.yc!=null),_e(Wr.s.Ya!=null),_e(0<Wr.s.Wb),_e((Dr=Wr.l)!=null),_e((rn=Dr.ma)!=null),Wr.xb!=0){if(Wr.ca=rn.ba,Wr.tb=rn.tb,_e(Wr.ca!=null),!Uu(rn.Oa,Dr,L0)){Wr.a=2;break r}if(!kn(Wr,Dr.width)||Dr.da)break r;if((Dr.da||cs(Wr.ca.S))&&Jn(),11>Wr.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Wr.ca.f.kb.F!=null&&Jn()),Wr.Pb&&0<Wr.s.ua&&Wr.s.vb.X==null&&!Dn(Wr.s.vb,Wr.s.Wa.Xa)){Wr.a=1;break r}Wr.xb=0}if(!un(Wr,Wr.V,Wr.Ba,Wr.c,Wr.i,Dr.o,Yr))break r;rn.Dc=Wr.Ma,Wr=1;break t}_e(Wr.a!=0),Wr=0}Wr=!Wr}Wr&&(Sr=hr.a)}else Sr=hr.a}else{if((hr=new qs)==null){hn=1;break e}if(hr.Fa=rn.na,hr.P=rn.P,hr.qc=rn.Sa,o0(hr,Wr)){if((Sr=ou(Wr.width,Wr.height,hn.Oa,hn.ba))==0){if(hr.Aa=0,Dr=hn.Oa,_e((rn=hr)!=null),Dr!=null){if(0<(mn=0>(mn=Dr.Md)?0:100<mn?255:255*mn/100)){for(bn=Bn=0;4>bn;++bn)12>(na=rn.pb[bn]).lc&&(na.ia=mn*e2[0>na.lc?0:na.lc]>>3),Bn|=na.ia;Bn&&(alert("todo:VP8InitRandom"),rn.ia=1)}rn.Ga=Dr.Id,100<rn.Ga?rn.Ga=100:0>rn.Ga&&(rn.Ga=0)}sp(hr,Wr)||(Sr=hr.a)}}else Sr=hr.a}Sr==0&&hn.Oa!=null&&hn.Oa.fd&&(Sr=Wu(hn.ba))}hn=Sr}cn=hn!=0?null:11>cn?dn.f.RGBA.eb:dn.f.kb.y}else cn=null;return cn};var D1=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function or(Ar,Pr){for(var Ir="",wr=0;wr<4;wr++)Ir+=String.fromCharCode(Ar[Pr++]);return Ir}function lr(Ar,Pr){return(Ar[Pr+0]<<0|Ar[Pr+1]<<8|Ar[Pr+2]<<16)>>>0}function ur(Ar,Pr){return(Ar[Pr+0]<<0|Ar[Pr+1]<<8|Ar[Pr+2]<<16|Ar[Pr+3]<<24)>>>0}new sr;var fr=[0],cr=[0],mr=[],dr=new sr,xr=e,pr=function(Ar,Pr){var Ir={},wr=0,kr=!1,Mr=0,Hr=0;if(Ir.frames=[],!function(br,Er,Lr,Or){for(var Ur=0;Ur<Or;Ur++)if(br[Er+Ur]!=Lr.charCodeAt(Ur))return!0;return!1}(Ar,Pr,"RIFF",4)){var Gr,zr;for(ur(Ar,Pr+=4),Pr+=8;Pr<Ar.length;){var Br=or(Ar,Pr),Vr=ur(Ar,Pr+=4);Pr+=4;var Rr=Vr+(1&Vr);switch(Br){case"VP8 ":case"VP8L":Ir.frames[wr]===void 0&&(Ir.frames[wr]={}),(yr=Ir.frames[wr]).src_off=kr?Hr:Pr-8,yr.src_size=Mr+Vr+8,wr++,kr&&(kr=!1,Mr=0,Hr=0);break;case"VP8X":(yr=Ir.header={}).feature_flags=Ar[Pr];var Xr=Pr+4;yr.canvas_width=1+lr(Ar,Xr),Xr+=3,yr.canvas_height=1+lr(Ar,Xr),Xr+=3;break;case"ALPH":kr=!0,Mr=Rr+8,Hr=Pr-8;break;case"ANIM":(yr=Ir.header).bgcolor=ur(Ar,Pr),Xr=Pr+4,yr.loop_count=(Gr=Ar)[(zr=Xr)+0]<<0|Gr[zr+1]<<8,Xr+=2;break;case"ANMF":var an,yr;(yr=Ir.frames[wr]={}).offset_x=2*lr(Ar,Pr),Pr+=3,yr.offset_y=2*lr(Ar,Pr),Pr+=3,yr.width=1+lr(Ar,Pr),Pr+=3,yr.height=1+lr(Ar,Pr),Pr+=3,yr.duration=lr(Ar,Pr),Pr+=3,an=Ar[Pr++],yr.dispose=1&an,yr.blend=an>>1&1}Br!="ANMF"&&(Pr+=Rr)}return Ir}}(xr,0);pr.response=xr,pr.rgbaoutput=!0,pr.dataurl=!1;var gr=pr.header?pr.header:null,vr=pr.frames?pr.frames:null;if(gr){gr.loop_counter=gr.loop_count,fr=[gr.canvas_height],cr=[gr.canvas_width];for(var Cr=0;Cr<vr.length&&vr[Cr].blend!=0;Cr++);}var Tr=vr[0],Fr=dr.WebPDecodeRGBA(xr,Tr.src_off,Tr.src_size,cr,fr);Tr.rgba=Fr,Tr.imgwidth=cr[0],Tr.imgheight=fr[0];for(var _r=0;_r<cr[0]*fr[0]*4;_r++)mr[_r]=Fr[_r];return this.width=cr,this.height=fr,this.data=mr,this}(function(e){var _e=function(){return typeof zlibSync=="function"},er=function(fr,cr,mr,dr){var xr=4,pr=ir;switch(dr){case e.image_compression.FAST:xr=1,pr=nr;break;case e.image_compression.MEDIUM:xr=6,pr=ar;break;case e.image_compression.SLOW:xr=9,pr=sr}fr=tr(fr,cr,mr,pr);var gr=zlibSync(fr,{level:xr});return e.__addimage__.arrayBufferToBinaryString(gr)},tr=function(fr,cr,mr,dr){for(var xr,pr,gr,vr=fr.length/cr,Cr=new Uint8Array(fr.length+vr),Tr=lr(),Fr=0;Fr<vr;Fr+=1){if(gr=Fr*cr,xr=fr.subarray(gr,gr+cr),dr)Cr.set(dr(xr,mr,pr),gr+Fr);else{for(var _r,Ar=Tr.length,Pr=[];_r<Ar;_r+=1)Pr[_r]=Tr[_r](xr,mr,pr);var Ir=ur(Pr.concat());Cr.set(Pr[Ir],gr+Fr)}pr=xr}return Cr},rr=function(fr){var cr=Array.apply([],fr);return cr.unshift(0),cr},nr=function(fr,cr){var mr,dr=[],xr=fr.length;dr[0]=1;for(var pr=0;pr<xr;pr+=1)mr=fr[pr-cr]||0,dr[pr+1]=fr[pr]-mr+256&255;return dr},ir=function(fr,cr,mr){var dr,xr=[],pr=fr.length;xr[0]=2;for(var gr=0;gr<pr;gr+=1)dr=mr&&mr[gr]||0,xr[gr+1]=fr[gr]-dr+256&255;return xr},ar=function(fr,cr,mr){var dr,xr,pr=[],gr=fr.length;pr[0]=3;for(var vr=0;vr<gr;vr+=1)dr=fr[vr-cr]||0,xr=mr&&mr[vr]||0,pr[vr+1]=fr[vr]+256-(dr+xr>>>1)&255;return pr},sr=function(fr,cr,mr){var dr,xr,pr,gr,vr=[],Cr=fr.length;vr[0]=4;for(var Tr=0;Tr<Cr;Tr+=1)dr=fr[Tr-cr]||0,xr=mr&&mr[Tr]||0,pr=mr&&mr[Tr-cr]||0,gr=or(dr,xr,pr),vr[Tr+1]=fr[Tr]-gr+256&255;return vr},or=function(fr,cr,mr){if(fr===cr&&cr===mr)return fr;var dr=Math.abs(cr-mr),xr=Math.abs(fr-mr),pr=Math.abs(fr+cr-mr-mr);return dr<=xr&&dr<=pr?fr:xr<=pr?cr:mr},lr=function(){return[rr,nr,ir,ar,sr]},ur=function(fr){var cr=fr.map(function(mr){return mr.reduce(function(dr,xr){return dr+Math.abs(xr)},0)});return cr.indexOf(Math.min.apply(null,cr))};e.processPNG=function(fr,cr,mr,dr){var xr,pr,gr,vr,Cr,Tr,Fr,_r,Ar,Pr,Ir,wr,kr,Mr,Hr,Gr=this.decode.FLATE_DECODE,zr="";if(this.__addimage__.isArrayBuffer(fr)&&(fr=new Uint8Array(fr)),this.__addimage__.isArrayBufferView(fr)){if(fr=(gr=new Kt(fr)).imgData,pr=gr.bits,xr=gr.colorSpace,Cr=gr.colors,[4,6].indexOf(gr.colorType)!==-1){if(gr.bits===8){Ar=(_r=gr.pixelBitlength==32?new Uint32Array(gr.decodePixels().buffer):gr.pixelBitlength==16?new Uint16Array(gr.decodePixels().buffer):new Uint8Array(gr.decodePixels().buffer)).length,Ir=new Uint8Array(Ar*gr.colors),Pr=new Uint8Array(Ar);var Br,Vr=gr.pixelBitlength-gr.bits;for(Mr=0,Hr=0;Mr<Ar;Mr++){for(kr=_r[Mr],Br=0;Br<Vr;)Ir[Hr++]=kr>>>Br&255,Br+=gr.bits;Pr[Mr]=kr>>>Br&255}}if(gr.bits===16){Ar=(_r=new Uint32Array(gr.decodePixels().buffer)).length,Ir=new Uint8Array(Ar*(32/gr.pixelBitlength)*gr.colors),Pr=new Uint8Array(Ar*(32/gr.pixelBitlength)),wr=gr.colors>1,Mr=0,Hr=0;for(var Rr=0;Mr<Ar;)kr=_r[Mr++],Ir[Hr++]=kr>>>0&255,wr&&(Ir[Hr++]=kr>>>16&255,kr=_r[Mr++],Ir[Hr++]=kr>>>0&255),Pr[Rr++]=kr>>>16&255;pr=8}dr!==e.image_compression.NONE&&_e()?(fr=er(Ir,gr.width*gr.colors,gr.colors,dr),Fr=er(Pr,gr.width,1,dr)):(fr=Ir,Fr=Pr,Gr=void 0)}if(gr.colorType===3&&(xr=this.color_spaces.INDEXED,Tr=gr.palette,gr.transparency.indexed)){var Xr=gr.transparency.indexed,an=0;for(Mr=0,Ar=Xr.length;Mr<Ar;++Mr)an+=Xr[Mr];if((an/=255)===Ar-1&&Xr.indexOf(0)!==-1)vr=[Xr.indexOf(0)];else if(an!==Ar){for(_r=gr.decodePixels(),Pr=new Uint8Array(_r.length),Mr=0,Ar=_r.length;Mr<Ar;Mr++)Pr[Mr]=Xr[_r[Mr]];Fr=er(Pr,gr.width,1)}}var yr=function(br){var Er;switch(br){case e.image_compression.FAST:Er=11;break;case e.image_compression.MEDIUM:Er=13;break;case e.image_compression.SLOW:Er=14;break;default:Er=12}return Er}(dr);return Gr===this.decode.FLATE_DECODE&&(zr="/Predictor "+yr+" "),zr+="/Colors "+Cr+" /BitsPerComponent "+pr+" /Columns "+gr.width,(this.__addimage__.isArrayBuffer(fr)||this.__addimage__.isArrayBufferView(fr))&&(fr=this.__addimage__.arrayBufferToBinaryString(fr)),(Fr&&this.__addimage__.isArrayBuffer(Fr)||this.__addimage__.isArrayBufferView(Fr))&&(Fr=this.__addimage__.arrayBufferToBinaryString(Fr)),{alias:mr,data:fr,index:cr,filter:Gr,decodeParameters:zr,transparency:vr,palette:Tr,sMask:Fr,predictor:yr,width:gr.width,height:gr.height,bitsPerComponent:pr,colorSpace:xr}}}})(E.API),function(e){e.processGIF89A=function(_e,er,tr,rr){var nr=new Zt(_e),ir=nr.width,ar=nr.height,sr=[];nr.decodeAndBlitFrameRGBA(0,sr);var or={data:sr,width:ir,height:ar},lr=new Qt(100).encode(or,100);return e.processJPEG.call(this,lr,er,tr,rr)},e.processGIF87A=e.processGIF89A}(E.API),te.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var _e=0;_e<e;_e++){var er=this.datav.getUint8(this.pos++,!0),tr=this.datav.getUint8(this.pos++,!0),rr=this.datav.getUint8(this.pos++,!0),nr=this.datav.getUint8(this.pos++,!0);this.palette[_e]={red:rr,green:tr,blue:er,quad:nr}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},te.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,_e=this.width*this.height*4;this.data=new Uint8Array(_e),this[e]()}catch(er){a.log("bit decode error:"+er)}},te.prototype.bit1=function(){var e,_e=Math.ceil(this.width/8),er=_e%4;for(e=this.height-1;e>=0;e--){for(var tr=this.bottom_up?e:this.height-1-e,rr=0;rr<_e;rr++)for(var nr=this.datav.getUint8(this.pos++,!0),ir=tr*this.width*4+8*rr*4,ar=0;ar<8&&8*rr+ar<this.width;ar++){var sr=this.palette[nr>>7-ar&1];this.data[ir+4*ar]=sr.blue,this.data[ir+4*ar+1]=sr.green,this.data[ir+4*ar+2]=sr.red,this.data[ir+4*ar+3]=255}er!==0&&(this.pos+=4-er)}},te.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),_e=e%4,er=this.height-1;er>=0;er--){for(var tr=this.bottom_up?er:this.height-1-er,rr=0;rr<e;rr++){var nr=this.datav.getUint8(this.pos++,!0),ir=tr*this.width*4+2*rr*4,ar=nr>>4,sr=15&nr,or=this.palette[ar];if(this.data[ir]=or.blue,this.data[ir+1]=or.green,this.data[ir+2]=or.red,this.data[ir+3]=255,2*rr+1>=this.width)break;or=this.palette[sr],this.data[ir+4]=or.blue,this.data[ir+4+1]=or.green,this.data[ir+4+2]=or.red,this.data[ir+4+3]=255}_e!==0&&(this.pos+=4-_e)}},te.prototype.bit8=function(){for(var e=this.width%4,_e=this.height-1;_e>=0;_e--){for(var er=this.bottom_up?_e:this.height-1-_e,tr=0;tr<this.width;tr++){var rr=this.datav.getUint8(this.pos++,!0),nr=er*this.width*4+4*tr;if(rr<this.palette.length){var ir=this.palette[rr];this.data[nr]=ir.red,this.data[nr+1]=ir.green,this.data[nr+2]=ir.blue,this.data[nr+3]=255}else this.data[nr]=255,this.data[nr+1]=255,this.data[nr+2]=255,this.data[nr+3]=255}e!==0&&(this.pos+=4-e)}},te.prototype.bit15=function(){for(var e=this.width%3,_e=parseInt("11111",2),er=this.height-1;er>=0;er--){for(var tr=this.bottom_up?er:this.height-1-er,rr=0;rr<this.width;rr++){var nr=this.datav.getUint16(this.pos,!0);this.pos+=2;var ir=(nr&_e)/_e*255|0,ar=(nr>>5&_e)/_e*255|0,sr=(nr>>10&_e)/_e*255|0,or=nr>>15?255:0,lr=tr*this.width*4+4*rr;this.data[lr]=sr,this.data[lr+1]=ar,this.data[lr+2]=ir,this.data[lr+3]=or}this.pos+=e}},te.prototype.bit16=function(){for(var e=this.width%3,_e=parseInt("11111",2),er=parseInt("111111",2),tr=this.height-1;tr>=0;tr--){for(var rr=this.bottom_up?tr:this.height-1-tr,nr=0;nr<this.width;nr++){var ir=this.datav.getUint16(this.pos,!0);this.pos+=2;var ar=(ir&_e)/_e*255|0,sr=(ir>>5&er)/er*255|0,or=(ir>>11)/_e*255|0,lr=rr*this.width*4+4*nr;this.data[lr]=or,this.data[lr+1]=sr,this.data[lr+2]=ar,this.data[lr+3]=255}this.pos+=e}},te.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var _e=this.bottom_up?e:this.height-1-e,er=0;er<this.width;er++){var tr=this.datav.getUint8(this.pos++,!0),rr=this.datav.getUint8(this.pos++,!0),nr=this.datav.getUint8(this.pos++,!0),ir=_e*this.width*4+4*er;this.data[ir]=nr,this.data[ir+1]=rr,this.data[ir+2]=tr,this.data[ir+3]=255}this.pos+=this.width%4}},te.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var _e=this.bottom_up?e:this.height-1-e,er=0;er<this.width;er++){var tr=this.datav.getUint8(this.pos++,!0),rr=this.datav.getUint8(this.pos++,!0),nr=this.datav.getUint8(this.pos++,!0),ir=this.datav.getUint8(this.pos++,!0),ar=_e*this.width*4+4*er;this.data[ar]=nr,this.data[ar+1]=rr,this.data[ar+2]=tr,this.data[ar+3]=ir}},te.prototype.getData=function(){return this.data},function(e){e.processBMP=function(_e,er,tr,rr){var nr=new te(_e,!1),ir=nr.width,ar=nr.height,sr={data:nr.getData(),width:ir,height:ar},or=new Qt(100).encode(sr,100);return e.processJPEG.call(this,or,er,tr,rr)}}(E.API),ee.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(_e,er,tr,rr){var nr=new ee(_e),ir=nr.width,ar=nr.height,sr={data:nr.getData(),width:ir,height:ar},or=new Qt(100).encode(sr,100);return e.processJPEG.call(this,or,er,tr,rr)}}(E.API),E.API.processRGBA=function(e,_e,er){for(var tr=e.data,rr=tr.length,nr=new Uint8Array(rr/4*3),ir=new Uint8Array(rr/4),ar=0,sr=0,or=0;or<rr;or+=4){var lr=tr[or],ur=tr[or+1],fr=tr[or+2],cr=tr[or+3];nr[ar++]=lr,nr[ar++]=ur,nr[ar++]=fr,ir[sr++]=cr}var mr=this.__addimage__.arrayBufferToBinaryString(nr);return{alpha:this.__addimage__.arrayBufferToBinaryString(ir),data:mr,index:_e,alias:er,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},E.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Vt=E.API,Gt=Vt.getCharWidthsArray=function(e,_e){var er,tr,rr=(_e=_e||{}).font||this.internal.getFont(),nr=_e.fontSize||this.internal.getFontSize(),ir=_e.charSpace||this.internal.getCharSpace(),ar=_e.widths?_e.widths:rr.metadata.Unicode.widths,sr=ar.fof?ar.fof:1,or=_e.kerning?_e.kerning:rr.metadata.Unicode.kerning,lr=or.fof?or.fof:1,ur=_e.doKerning!==!1,fr=0,cr=e.length,mr=0,dr=ar[0]||sr,xr=[];for(er=0;er<cr;er++)tr=e.charCodeAt(er),typeof rr.metadata.widthOfString=="function"?xr.push((rr.metadata.widthOfGlyph(rr.metadata.characterToGlyph(tr))+ir*(1e3/nr)||0)/1e3):(fr=ur&&_typeof(or[tr])==="object"&&!isNaN(parseInt(or[tr][mr],10))?or[tr][mr]/lr:0,xr.push((ar[tr]||dr)/sr+fr)),mr=tr;return xr},Yt=Vt.getStringUnitWidth=function(e,_e){var er=(_e=_e||{}).fontSize||this.internal.getFontSize(),tr=_e.font||this.internal.getFont(),rr=_e.charSpace||this.internal.getCharSpace();return Vt.processArabic&&(e=Vt.processArabic(e)),typeof tr.metadata.widthOfString=="function"?tr.metadata.widthOfString(e,er,rr)/er:Gt.apply(this,arguments).reduce(function(nr,ir){return nr+ir},0)},Jt=function(e,_e,er,tr){for(var rr=[],nr=0,ir=e.length,ar=0;nr!==ir&&ar+_e[nr]<er;)ar+=_e[nr],nr++;rr.push(e.slice(0,nr));var sr=nr;for(ar=0;nr!==ir;)ar+_e[nr]>tr&&(rr.push(e.slice(sr,nr)),ar=0,sr=nr),ar+=_e[nr],nr++;return sr!==nr&&rr.push(e.slice(sr,nr)),rr},Xt=function(e,_e,er){er||(er={});var tr,rr,nr,ir,ar,sr,or,lr=[],ur=[lr],fr=er.textIndent||0,cr=0,mr=0,dr=e.split(" "),xr=Gt.apply(this,[" ",er])[0];if(sr=er.lineIndent===-1?dr[0].length+2:er.lineIndent||0){var pr=Array(sr).join(" "),gr=[];dr.map(function(Cr){(Cr=Cr.split(/\s*\n/)).length>1?gr=gr.concat(Cr.map(function(Tr,Fr){return(Fr&&Tr.length?`
`:"")+Tr})):gr.push(Cr[0])}),dr=gr,sr=Yt.apply(this,[pr,er])}for(nr=0,ir=dr.length;nr<ir;nr++){var vr=0;if(tr=dr[nr],sr&&tr[0]==`
`&&(tr=tr.substr(1),vr=1),fr+cr+(mr=(rr=Gt.apply(this,[tr,er])).reduce(function(Cr,Tr){return Cr+Tr},0))>_e||vr){if(mr>_e){for(ar=Jt.apply(this,[tr,rr,_e-(fr+cr),_e]),lr.push(ar.shift()),lr=[ar.pop()];ar.length;)ur.push([ar.shift()]);mr=rr.slice(tr.length-(lr[0]?lr[0].length:0)).reduce(function(Cr,Tr){return Cr+Tr},0)}else lr=[tr];ur.push(lr),fr=mr+sr,cr=xr}else lr.push(tr),fr+=cr+mr,cr=xr}return or=sr?function(Cr,Tr){return(Tr?pr:"")+Cr.join(" ")}:function(Cr){return Cr.join(" ")},ur.map(or)},Vt.splitTextToSize=function(e,_e,er){var tr,rr=(er=er||{}).fontSize||this.internal.getFontSize(),nr=(function(lr){if(lr.widths&&lr.kerning)return{widths:lr.widths,kerning:lr.kerning};var ur=this.internal.getFont(lr.fontName,lr.fontStyle);return ur.metadata.Unicode?{widths:ur.metadata.Unicode.widths||{0:1},kerning:ur.metadata.Unicode.kerning||{}}:{font:ur.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,er);tr=Array.isArray(e)?e:String(e).split(/\r?\n/);var ir=1*this.internal.scaleFactor*_e/rr;nr.textIndent=er.textIndent?1*er.textIndent*this.internal.scaleFactor/rr:0,nr.lineIndent=er.lineIndent;var ar,sr,or=[];for(ar=0,sr=tr.length;ar<sr;ar++)or=or.concat(Xt.apply(this,[tr[ar],ir,nr]));return or},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var _e="klmnopqrstuvwxyz",er={},tr={},rr=0;rr<_e.length;rr++)er[_e[rr]]="0123456789abcdef"[rr],tr["0123456789abcdef"[rr]]=_e[rr];var nr=function(ur){return"0x"+parseInt(ur,10).toString(16)},ir=e.__fontmetrics__.compress=function(ur){var fr,cr,mr,dr,xr=["{"];for(var pr in ur){if(fr=ur[pr],isNaN(parseInt(pr,10))?cr="'"+pr+"'":(pr=parseInt(pr,10),cr=(cr=nr(pr).slice(2)).slice(0,-1)+tr[cr.slice(-1)]),typeof fr=="number")fr<0?(mr=nr(fr).slice(3),dr="-"):(mr=nr(fr).slice(2),dr=""),mr=dr+mr.slice(0,-1)+tr[mr.slice(-1)];else{if(_typeof(fr)!=="object")throw new Error("Don't know what to do with value type "+_typeof(fr)+".");mr=ir(fr)}xr.push(cr+mr)}return xr.push("}"),xr.join("")},ar=e.__fontmetrics__.uncompress=function(ur){if(typeof ur!="string")throw new Error("Invalid argument passed to uncompress.");for(var fr,cr,mr,dr,xr={},pr=1,gr=xr,vr=[],Cr="",Tr="",Fr=ur.length-1,_r=1;_r<Fr;_r+=1)(dr=ur[_r])=="'"?fr?(mr=fr.join(""),fr=void 0):fr=[]:fr?fr.push(dr):dr=="{"?(vr.push([gr,mr]),gr={},mr=void 0):dr=="}"?((cr=vr.pop())[0][cr[1]]=gr,mr=void 0,gr=cr[0]):dr=="-"?pr=-1:mr===void 0?er.hasOwnProperty(dr)?(Cr+=er[dr],mr=parseInt(Cr,16)*pr,pr=1,Cr=""):Cr+=dr:er.hasOwnProperty(dr)?(Tr+=er[dr],gr[mr]=parseInt(Tr,16)*pr,pr=1,mr=void 0,Tr=""):Tr+=dr;return xr},sr={codePages:["WinAnsiEncoding"],WinAnsiEncoding:ar("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},or={Unicode:{Courier:sr,"Courier-Bold":sr,"Courier-BoldOblique":sr,"Courier-Oblique":sr,Helvetica:sr,"Helvetica-Bold":sr,"Helvetica-BoldOblique":sr,"Helvetica-Oblique":sr,"Times-Roman":sr,"Times-Bold":sr,"Times-BoldItalic":sr,"Times-Italic":sr}},lr={Unicode:{"Courier-Oblique":ar("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":ar("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":ar("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:ar("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":ar("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":ar("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:ar("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:ar("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":ar("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:ar("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":ar("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":ar("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":ar("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":ar("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(ur){var fr=ur.font,cr=lr.Unicode[fr.postScriptName];cr&&(fr.metadata.Unicode={},fr.metadata.Unicode.widths=cr.widths,fr.metadata.Unicode.kerning=cr.kerning);var mr=or.Unicode[fr.postScriptName];mr&&(fr.metadata.Unicode.encoding=mr,fr.encoding=mr.codePages[0])}])}(E.API),function(e){var _e=function(er){for(var tr=er.length,rr=new Uint8Array(tr),nr=0;nr<tr;nr++)rr[nr]=er.charCodeAt(nr);return rr};e.API.events.push(["addFont",function(er){var tr=void 0,rr=er.font,nr=er.instance;if(!rr.isStandardFont){if(nr===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+rr.postScriptName+"').");if(typeof(tr=nr.existsFileInVFS(rr.postScriptName)===!1?nr.loadFile(rr.postScriptName):nr.getFileFromVFS(rr.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+rr.postScriptName+"').");(function(ir,ar){ar=/^\x00\x01\x00\x00/.test(ar)?_e(ar):_e(u(ar)),ir.metadata=e.API.TTFFont.open(ar),ir.metadata.Unicode=ir.metadata.Unicode||{encoding:{},kerning:{},widths:[]},ir.metadata.glyIdsUsed=[0]})(rr,tr)}}])}(E),function(e){function _e(){return(n.canvg?Promise.resolve(n.canvg):__vitePreload(()=>import("./index.es-9jKEZWRa.js"),[])).catch(function(er){return Promise.reject(new Error("Could not load canvg: "+er))}).then(function(er){return er.default?er.default:er})}E.API.addSvgAsImage=function(er,tr,rr,nr,ir,ar,sr,or){if(isNaN(tr)||isNaN(rr))throw a.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(nr)||isNaN(ir))throw a.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var lr=document.createElement("canvas");lr.width=nr,lr.height=ir;var ur=lr.getContext("2d");ur.fillStyle="#fff",ur.fillRect(0,0,lr.width,lr.height);var fr={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},cr=this;return _e().then(function(mr){return mr.fromString(ur,er,fr)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(mr){return mr.render(fr)}).then(function(){cr.addImage(lr.toDataURL("image/jpeg",1),tr,rr,nr,ir,sr,or)})}}(),E.API.putTotalPages=function(e){var _e,er=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(_e=new RegExp(e,"g"),er=this.internal.getNumberOfPages()):(_e=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),er=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var tr=1;tr<=this.internal.getNumberOfPages();tr++)for(var rr=0;rr<this.internal.pages[tr].length;rr++)this.internal.pages[tr][rr]=this.internal.pages[tr][rr].replace(_e,er);return this},E.API.viewerPreferences=function(e,_e){var er;e=e||{},_e=_e||!1;var tr,rr,nr,ir={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},ar=Object.keys(ir),sr=[],or=0,lr=0,ur=0;function fr(mr,dr){var xr,pr=!1;for(xr=0;xr<mr.length;xr+=1)mr[xr]===dr&&(pr=!0);return pr}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(ir)),this.internal.viewerpreferences.isSubscribed=!1),er=this.internal.viewerpreferences.configuration,e==="reset"||_e===!0){var cr=ar.length;for(ur=0;ur<cr;ur+=1)er[ar[ur]].value=er[ar[ur]].defaultValue,er[ar[ur]].explicitSet=!1}if(_typeof(e)==="object"){for(rr in e)if(nr=e[rr],fr(ar,rr)&&nr!==void 0){if(er[rr].type==="boolean"&&typeof nr=="boolean")er[rr].value=nr;else if(er[rr].type==="name"&&fr(er[rr].valueSet,nr))er[rr].value=nr;else if(er[rr].type==="integer"&&Number.isInteger(nr))er[rr].value=nr;else if(er[rr].type==="array"){for(or=0;or<nr.length;or+=1)if(tr=!0,nr[or].length===1&&typeof nr[or][0]=="number")sr.push(String(nr[or]-1));else if(nr[or].length>1){for(lr=0;lr<nr[or].length;lr+=1)typeof nr[or][lr]!="number"&&(tr=!1);tr===!0&&sr.push([nr[or][0]-1,nr[or][1]-1].join(" "))}er[rr].value="["+sr.join(" ")+"]"}else er[rr].value=er[rr].defaultValue;er[rr].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var mr,dr=[];for(mr in er)er[mr].explicitSet===!0&&(er[mr].type==="name"?dr.push("/"+mr+" /"+er[mr].value):dr.push("/"+mr+" "+er[mr].value));dr.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+dr.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=er,this},function(e){var _e=function(){var tr='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',rr=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),nr=unescape(encodeURIComponent(tr)),ir=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),ar=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),sr=unescape(encodeURIComponent("</x:xmpmeta>")),or=nr.length+ir.length+ar.length+rr.length+sr.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+or+" >>"),this.internal.write("stream"),this.internal.write(rr+nr+ir+ar+sr),this.internal.write("endstream"),this.internal.write("endobj")},er=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(tr,rr){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:tr,namespaceuri:rr||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",er),this.internal.events.subscribe("postPutResources",_e)),this}}(E.API),function(e){var _e=e.API,er=_e.pdfEscape16=function(nr,ir){for(var ar,sr=ir.metadata.Unicode.widths,or=["","0","00","000","0000"],lr=[""],ur=0,fr=nr.length;ur<fr;++ur){if(ar=ir.metadata.characterToGlyph(nr.charCodeAt(ur)),ir.metadata.glyIdsUsed.push(ar),ir.metadata.toUnicode[ar]=nr.charCodeAt(ur),sr.indexOf(ar)==-1&&(sr.push(ar),sr.push([parseInt(ir.metadata.widthOfGlyph(ar),10)])),ar=="0")return lr.join("");ar=ar.toString(16),lr.push(or[4-ar.length],ar)}return lr.join("")},tr=function(nr){var ir,ar,sr,or,lr,ur,fr;for(lr=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,sr=[],ur=0,fr=(ar=Object.keys(nr).sort(function(cr,mr){return cr-mr})).length;ur<fr;ur++)ir=ar[ur],sr.length>=100&&(lr+=`
`+sr.length+` beginbfchar
`+sr.join(`
`)+`
endbfchar`,sr=[]),nr[ir]!==void 0&&nr[ir]!==null&&typeof nr[ir].toString=="function"&&(or=("0000"+nr[ir].toString(16)).slice(-4),ir=("0000"+(+ir).toString(16)).slice(-4),sr.push("<"+ir+"><"+or+">"));return sr.length&&(lr+=`
`+sr.length+` beginbfchar
`+sr.join(`
`)+`
endbfchar
`),lr+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};_e.events.push(["putFont",function(nr){(function(ir){var ar=ir.font,sr=ir.out,or=ir.newObject,lr=ir.putStream;if(ar.metadata instanceof e.API.TTFFont&&ar.encoding==="Identity-H"){for(var ur=ar.metadata.Unicode.widths,fr=ar.metadata.subset.encode(ar.metadata.glyIdsUsed,1),cr="",mr=0;mr<fr.length;mr++)cr+=String.fromCharCode(fr[mr]);var dr=or();lr({data:cr,addLength1:!0,objectId:dr}),sr("endobj");var xr=or();lr({data:tr(ar.metadata.toUnicode),addLength1:!0,objectId:xr}),sr("endobj");var pr=or();sr("<<"),sr("/Type /FontDescriptor"),sr("/FontName /"+F(ar.fontName)),sr("/FontFile2 "+dr+" 0 R"),sr("/FontBBox "+e.API.PDFObject.convert(ar.metadata.bbox)),sr("/Flags "+ar.metadata.flags),sr("/StemV "+ar.metadata.stemV),sr("/ItalicAngle "+ar.metadata.italicAngle),sr("/Ascent "+ar.metadata.ascender),sr("/Descent "+ar.metadata.decender),sr("/CapHeight "+ar.metadata.capHeight),sr(">>"),sr("endobj");var gr=or();sr("<<"),sr("/Type /Font"),sr("/BaseFont /"+F(ar.fontName)),sr("/FontDescriptor "+pr+" 0 R"),sr("/W "+e.API.PDFObject.convert(ur)),sr("/CIDToGIDMap /Identity"),sr("/DW 1000"),sr("/Subtype /CIDFontType2"),sr("/CIDSystemInfo"),sr("<<"),sr("/Supplement 0"),sr("/Registry (Adobe)"),sr("/Ordering ("+ar.encoding+")"),sr(">>"),sr(">>"),sr("endobj"),ar.objectNumber=or(),sr("<<"),sr("/Type /Font"),sr("/Subtype /Type0"),sr("/ToUnicode "+xr+" 0 R"),sr("/BaseFont /"+F(ar.fontName)),sr("/Encoding /"+ar.encoding),sr("/DescendantFonts ["+gr+" 0 R]"),sr(">>"),sr("endobj"),ar.isAlreadyPutted=!0}})(nr)}]),_e.events.push(["putFont",function(nr){(function(ir){var ar=ir.font,sr=ir.out,or=ir.newObject,lr=ir.putStream;if(ar.metadata instanceof e.API.TTFFont&&ar.encoding==="WinAnsiEncoding"){for(var ur=ar.metadata.rawData,fr="",cr=0;cr<ur.length;cr++)fr+=String.fromCharCode(ur[cr]);var mr=or();lr({data:fr,addLength1:!0,objectId:mr}),sr("endobj");var dr=or();lr({data:tr(ar.metadata.toUnicode),addLength1:!0,objectId:dr}),sr("endobj");var xr=or();sr("<<"),sr("/Descent "+ar.metadata.decender),sr("/CapHeight "+ar.metadata.capHeight),sr("/StemV "+ar.metadata.stemV),sr("/Type /FontDescriptor"),sr("/FontFile2 "+mr+" 0 R"),sr("/Flags 96"),sr("/FontBBox "+e.API.PDFObject.convert(ar.metadata.bbox)),sr("/FontName /"+F(ar.fontName)),sr("/ItalicAngle "+ar.metadata.italicAngle),sr("/Ascent "+ar.metadata.ascender),sr(">>"),sr("endobj"),ar.objectNumber=or();for(var pr=0;pr<ar.metadata.hmtx.widths.length;pr++)ar.metadata.hmtx.widths[pr]=parseInt(ar.metadata.hmtx.widths[pr]*(1e3/ar.metadata.head.unitsPerEm));sr("<</Subtype/TrueType/Type/Font/ToUnicode "+dr+" 0 R/BaseFont/"+F(ar.fontName)+"/FontDescriptor "+xr+" 0 R/Encoding/"+ar.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(ar.metadata.hmtx.widths)+">>"),sr("endobj"),ar.isAlreadyPutted=!0}})(nr)}]);var rr=function(nr){var ir,ar=nr.text||"",sr=nr.x,or=nr.y,lr=nr.options||{},ur=nr.mutex||{},fr=ur.pdfEscape,cr=ur.activeFontKey,mr=ur.fonts,dr=cr,xr="",pr=0,gr="",vr=mr[dr].encoding;if(mr[dr].encoding!=="Identity-H")return{text:ar,x:sr,y:or,options:lr,mutex:ur};for(gr=ar,dr=cr,Array.isArray(ar)&&(gr=ar[0]),pr=0;pr<gr.length;pr+=1)mr[dr].metadata.hasOwnProperty("cmap")&&(ir=mr[dr].metadata.cmap.unicode.codeMap[gr[pr].charCodeAt(0)]),ir||gr[pr].charCodeAt(0)<256&&mr[dr].metadata.hasOwnProperty("Unicode")?xr+=gr[pr]:xr+="";var Cr="";return parseInt(dr.slice(1))<14||vr==="WinAnsiEncoding"?Cr=fr(xr,dr).split("").map(function(Tr){return Tr.charCodeAt(0).toString(16)}).join(""):vr==="Identity-H"&&(Cr=er(xr,mr[dr])),ur.isHex=!0,{text:Cr,x:sr,y:or,options:lr,mutex:ur}};_e.events.push(["postProcessText",function(nr){var ir=nr.text||"",ar=[],sr={text:ir,x:nr.x,y:nr.y,options:nr.options,mutex:nr.mutex};if(Array.isArray(ir)){var or=0;for(or=0;or<ir.length;or+=1)Array.isArray(ir[or])&&ir[or].length===3?ar.push([rr(Object.assign({},sr,{text:ir[or][0]})).text,ir[or][1],ir[or][2]]):ar.push(rr(Object.assign({},sr,{text:ir[or]})).text);nr.text=ar}else nr.text=rr(Object.assign({},sr,{text:ir})).text}])}(E),function(e){var _e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(er){return _e.call(this),this.internal.vFS[er]!==void 0},e.addFileToVFS=function(er,tr){return _e.call(this),this.internal.vFS[er]=tr,this},e.getFileFromVFS=function(er){return _e.call(this),this.internal.vFS[er]!==void 0?this.internal.vFS[er]:null}}(E.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(tr){var rr,nr,ir,ar,sr,or,lr,ur=_e,fr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],cr=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],mr={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},dr={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},xr=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],pr=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),gr=!1,vr=0;this.__bidiEngine__={};var Cr=function(wr){var kr=wr.charCodeAt(),Mr=kr>>8,Hr=dr[Mr];return Hr!==void 0?ur[256*Hr+(255&kr)]:Mr===252||Mr===253?"AL":pr.test(Mr)?"L":Mr===8?"R":"N"},Tr=function(wr){for(var kr,Mr=0;Mr<wr.length;Mr++){if((kr=Cr(wr.charAt(Mr)))==="L")return!1;if(kr==="R")return!0}return!1},Fr=function(wr,kr,Mr,Hr){var Gr,zr,Br,Vr,Rr=kr[Hr];switch(Rr){case"L":case"R":gr=!1;break;case"N":case"AN":break;case"EN":gr&&(Rr="AN");break;case"AL":gr=!0,Rr="R";break;case"WS":Rr="N";break;case"CS":Hr<1||Hr+1>=kr.length||(Gr=Mr[Hr-1])!=="EN"&&Gr!=="AN"||(zr=kr[Hr+1])!=="EN"&&zr!=="AN"?Rr="N":gr&&(zr="AN"),Rr=zr===Gr?zr:"N";break;case"ES":Rr=(Gr=Hr>0?Mr[Hr-1]:"B")==="EN"&&Hr+1<kr.length&&kr[Hr+1]==="EN"?"EN":"N";break;case"ET":if(Hr>0&&Mr[Hr-1]==="EN"){Rr="EN";break}if(gr){Rr="N";break}for(Br=Hr+1,Vr=kr.length;Br<Vr&&kr[Br]==="ET";)Br++;Rr=Br<Vr&&kr[Br]==="EN"?"EN":"N";break;case"NSM":if(ir&&!ar){for(Vr=kr.length,Br=Hr+1;Br<Vr&&kr[Br]==="NSM";)Br++;if(Br<Vr){var Xr=wr[Hr],an=Xr>=1425&&Xr<=2303||Xr===64286;if(Gr=kr[Br],an&&(Gr==="R"||Gr==="AL")){Rr="R";break}}}Rr=Hr<1||(Gr=kr[Hr-1])==="B"?"N":Mr[Hr-1];break;case"B":gr=!1,rr=!0,Rr=vr;break;case"S":nr=!0,Rr="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":gr=!1;break;case"BN":Rr="N"}return Rr},_r=function(wr,kr,Mr){var Hr=wr.split("");return Mr&&Ar(Hr,Mr,{hiLevel:vr}),Hr.reverse(),kr&&kr.reverse(),Hr.join("")},Ar=function(wr,kr,Mr){var Hr,Gr,zr,Br,Vr,Rr=-1,Xr=wr.length,an=0,yr=[],br=vr?cr:fr,Er=[];for(gr=!1,rr=!1,nr=!1,Gr=0;Gr<Xr;Gr++)Er[Gr]=Cr(wr[Gr]);for(zr=0;zr<Xr;zr++){if(Vr=an,yr[zr]=Fr(wr,Er,yr,zr),Hr=240&(an=br[Vr][mr[yr[zr]]]),an&=15,kr[zr]=Br=br[an][5],Hr>0)if(Hr===16){for(Gr=Rr;Gr<zr;Gr++)kr[Gr]=1;Rr=-1}else Rr=-1;if(br[an][6])Rr===-1&&(Rr=zr);else if(Rr>-1){for(Gr=Rr;Gr<zr;Gr++)kr[Gr]=Br;Rr=-1}Er[zr]==="B"&&(kr[zr]=0),Mr.hiLevel|=Br}nr&&function(Lr,Or,Ur){for(var $r=0;$r<Ur;$r++)if(Lr[$r]==="S"){Or[$r]=vr;for(var Zr=$r-1;Zr>=0&&Lr[Zr]==="WS";Zr--)Or[Zr]=vr}}(Er,kr,Xr)},Pr=function(wr,kr,Mr,Hr,Gr){if(!(Gr.hiLevel<wr)){if(wr===1&&vr===1&&!rr)return kr.reverse(),void(Mr&&Mr.reverse());for(var zr,Br,Vr,Rr,Xr=kr.length,an=0;an<Xr;){if(Hr[an]>=wr){for(Vr=an+1;Vr<Xr&&Hr[Vr]>=wr;)Vr++;for(Rr=an,Br=Vr-1;Rr<Br;Rr++,Br--)zr=kr[Rr],kr[Rr]=kr[Br],kr[Br]=zr,Mr&&(zr=Mr[Rr],Mr[Rr]=Mr[Br],Mr[Br]=zr);an=Vr}an++}}},Ir=function(wr,kr,Mr){var Hr=wr.split(""),Gr={hiLevel:vr};return Mr||(Mr=[]),Ar(Hr,Mr,Gr),function(zr,Br,Vr){if(Vr.hiLevel!==0&&lr)for(var Rr,Xr=0;Xr<zr.length;Xr++)Br[Xr]===1&&(Rr=xr.indexOf(zr[Xr]))>=0&&(zr[Xr]=xr[Rr+1])}(Hr,Mr,Gr),Pr(2,Hr,kr,Mr,Gr),Pr(1,Hr,kr,Mr,Gr),Hr.join("")};return this.__bidiEngine__.doBidiReorder=function(wr,kr,Mr){if(function(Gr,zr){if(zr)for(var Br=0;Br<Gr.length;Br++)zr[Br]=Br;ar===void 0&&(ar=Tr(Gr)),or===void 0&&(or=Tr(Gr))}(wr,kr),ir||!sr||or)if(ir&&sr&&ar^or)vr=ar?1:0,wr=_r(wr,kr,Mr);else if(!ir&&sr&&or)vr=ar?1:0,wr=Ir(wr,kr,Mr),wr=_r(wr,kr);else if(!ir||ar||sr||or){if(ir&&!sr&&ar^or)wr=_r(wr,kr),ar?(vr=0,wr=Ir(wr,kr,Mr)):(vr=1,wr=Ir(wr,kr,Mr),wr=_r(wr,kr));else if(ir&&ar&&!sr&&or)vr=1,wr=Ir(wr,kr,Mr),wr=_r(wr,kr);else if(!ir&&!sr&&ar^or){var Hr=lr;ar?(vr=1,wr=Ir(wr,kr,Mr),vr=0,lr=!1,wr=Ir(wr,kr,Mr),lr=Hr):(vr=0,wr=Ir(wr,kr,Mr),wr=_r(wr,kr),vr=1,lr=!1,wr=Ir(wr,kr,Mr),lr=Hr,wr=_r(wr,kr))}}else vr=0,wr=Ir(wr,kr,Mr);else vr=ar?1:0,wr=Ir(wr,kr,Mr);return wr},this.__bidiEngine__.setOptions=function(wr){wr&&(ir=wr.isInputVisual,sr=wr.isOutputVisual,ar=wr.isInputRtl,or=wr.isOutputRtl,lr=wr.isSymmetricSwapping)},this.__bidiEngine__.setOptions(tr),this.__bidiEngine__};var _e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],er=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(tr){var rr=tr.text,nr=(tr.x,tr.y,tr.options||{}),ir=(tr.mutex,nr.lang,[]);if(nr.isInputVisual=typeof nr.isInputVisual!="boolean"||nr.isInputVisual,er.setOptions(nr),Object.prototype.toString.call(rr)==="[object Array]"){var ar=0;for(ir=[],ar=0;ar<rr.length;ar+=1)Object.prototype.toString.call(rr[ar])==="[object Array]"?ir.push([er.doBidiReorder(rr[ar][0]),rr[ar][1],rr[ar][2]]):ir.push([er.doBidiReorder(rr[ar])]);tr.text=ir}else tr.text=er.doBidiReorder(rr);er.setOptions({isInputVisual:!0})}])}(E),E.API.TTFFont=function(){function e(_e){var er;if(this.rawData=_e,er=this.contents=new ne(_e),this.contents.pos=4,er.readString(4)==="ttcf")throw new Error("TTCF not supported.");er.pos=0,this.parse(),this.subset=new Le(this),this.registerTTF()}return e.open=function(_e){return new e(_e)},e.prototype.parse=function(){return this.directory=new ie(this.contents),this.head=new se(this),this.name=new pe(this),this.cmap=new ue(this),this.toUnicode={},this.hhea=new he(this),this.maxp=new ge(this),this.hmtx=new me(this),this.post=new fe(this),this.os2=new le(this),this.loca=new Ne(this),this.glyf=new be(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var _e,er,tr,rr,nr;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var ir,ar,sr,or;for(or=[],ir=0,ar=(sr=this.bbox).length;ir<ar;ir++)_e=sr[ir],or.push(Math.round(_e*this.scaleFactor));return or}).call(this),this.stemV=0,this.post.exists?(tr=255&(rr=this.post.italic_angle),32768&(er=rr>>16)&&(er=-(1+(65535^er))),this.italicAngle=+(er+"."+tr)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(nr=this.familyClass)===1||nr===2||nr===3||nr===4||nr===5||nr===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(_e){var er;return((er=this.cmap.unicode)!=null?er.codeMap[_e]:void 0)||0},e.prototype.widthOfGlyph=function(_e){var er;return er=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(_e).advance*er},e.prototype.widthOfString=function(_e,er,tr){var rr,nr,ir,ar;for(ir=0,nr=0,ar=(_e=""+_e).length;0<=ar?nr<ar:nr>ar;nr=0<=ar?++nr:--nr)rr=_e.charCodeAt(nr),ir+=this.widthOfGlyph(this.characterToGlyph(rr))+tr*(1e3/er)||0;return ir*(er/1e3)},e.prototype.lineHeight=function(_e,er){var tr;return er==null&&(er=!1),tr=er?this.lineGap:0,(this.ascender+tr-this.decender)/1e3*_e},e}();var re,ne=function(){function e(_e){this.data=_e??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(_e){return this.data[this.pos++]=_e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(_e){return this.writeByte(_e>>>24&255),this.writeByte(_e>>16&255),this.writeByte(_e>>8&255),this.writeByte(255&_e)},e.prototype.readInt32=function(){var _e;return(_e=this.readUInt32())>=2147483648?_e-4294967296:_e},e.prototype.writeInt32=function(_e){return _e<0&&(_e+=4294967296),this.writeUInt32(_e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(_e){return this.writeByte(_e>>8&255),this.writeByte(255&_e)},e.prototype.readInt16=function(){var _e;return(_e=this.readUInt16())>=32768?_e-65536:_e},e.prototype.writeInt16=function(_e){return _e<0&&(_e+=65536),this.writeUInt16(_e)},e.prototype.readString=function(_e){var er,tr;for(tr=[],er=0;0<=_e?er<_e:er>_e;er=0<=_e?++er:--er)tr[er]=String.fromCharCode(this.readByte());return tr.join("")},e.prototype.writeString=function(_e){var er,tr,rr;for(rr=[],er=0,tr=_e.length;0<=tr?er<tr:er>tr;er=0<=tr?++er:--er)rr.push(this.writeByte(_e.charCodeAt(er)));return rr},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(_e){return this.writeInt16(_e)},e.prototype.readLongLong=function(){var _e,er,tr,rr,nr,ir,ar,sr;return _e=this.readByte(),er=this.readByte(),tr=this.readByte(),rr=this.readByte(),nr=this.readByte(),ir=this.readByte(),ar=this.readByte(),sr=this.readByte(),128&_e?-1*(72057594037927940*(255^_e)+281474976710656*(255^er)+1099511627776*(255^tr)+4294967296*(255^rr)+16777216*(255^nr)+65536*(255^ir)+256*(255^ar)+(255^sr)+1):72057594037927940*_e+281474976710656*er+1099511627776*tr+4294967296*rr+16777216*nr+65536*ir+256*ar+sr},e.prototype.writeLongLong=function(_e){var er,tr;return er=Math.floor(_e/4294967296),tr=4294967295&_e,this.writeByte(er>>24&255),this.writeByte(er>>16&255),this.writeByte(er>>8&255),this.writeByte(255&er),this.writeByte(tr>>24&255),this.writeByte(tr>>16&255),this.writeByte(tr>>8&255),this.writeByte(255&tr)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(_e){return this.writeInt32(_e)},e.prototype.read=function(_e){var er,tr;for(er=[],tr=0;0<=_e?tr<_e:tr>_e;tr=0<=_e?++tr:--tr)er.push(this.readByte());return er},e.prototype.write=function(_e){var er,tr,rr,nr;for(nr=[],tr=0,rr=_e.length;tr<rr;tr++)er=_e[tr],nr.push(this.writeByte(er));return nr},e}(),ie=function(){var e;function _e(er){var tr,rr,nr;for(this.scalarType=er.readInt(),this.tableCount=er.readShort(),this.searchRange=er.readShort(),this.entrySelector=er.readShort(),this.rangeShift=er.readShort(),this.tables={},rr=0,nr=this.tableCount;0<=nr?rr<nr:rr>nr;rr=0<=nr?++rr:--rr)tr={tag:er.readString(4),checksum:er.readInt(),offset:er.readInt(),length:er.readInt()},this.tables[tr.tag]=tr}return _e.prototype.encode=function(er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr;for(dr in cr=Object.keys(er).length,sr=Math.log(2),ur=16*Math.floor(Math.log(cr)/sr),ir=Math.floor(ur/sr),lr=16*cr-ur,(rr=new ne).writeInt(this.scalarType),rr.writeShort(cr),rr.writeShort(ur),rr.writeShort(ir),rr.writeShort(lr),nr=16*cr,or=rr.pos+nr,ar=null,mr=[],er)for(fr=er[dr],rr.writeString(dr),rr.writeInt(e(fr)),rr.writeInt(or),rr.writeInt(fr.length),mr=mr.concat(fr),dr==="head"&&(ar=or),or+=fr.length;or%4;)mr.push(0),or++;return rr.write(mr),tr=2981146554-e(rr.data),rr.pos=ar+8,rr.writeUInt32(tr),rr.data},e=function(er){var tr,rr,nr,ir;for(er=ve.call(er);er.length%4;)er.push(0);for(nr=new ne(er),rr=0,tr=0,ir=er.length;tr<ir;tr=tr+=4)rr+=nr.readUInt32();return 4294967295&rr},_e}(),ae={}.hasOwnProperty,oe=function(e,_e){for(var er in _e)ae.call(_e,er)&&(e[er]=_e[er]);function tr(){this.constructor=e}return tr.prototype=_e.prototype,e.prototype=new tr,e.__super__=_e.prototype,e};re=function(){function e(_e){var er;this.file=_e,er=this.file.directory.tables[this.tag],this.exists=!!er,er&&(this.offset=er.offset,this.length=er.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var se=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="head",_e.prototype.parse=function(er){return er.pos=this.offset,this.version=er.readInt(),this.revision=er.readInt(),this.checkSumAdjustment=er.readInt(),this.magicNumber=er.readInt(),this.flags=er.readShort(),this.unitsPerEm=er.readShort(),this.created=er.readLongLong(),this.modified=er.readLongLong(),this.xMin=er.readShort(),this.yMin=er.readShort(),this.xMax=er.readShort(),this.yMax=er.readShort(),this.macStyle=er.readShort(),this.lowestRecPPEM=er.readShort(),this.fontDirectionHint=er.readShort(),this.indexToLocFormat=er.readShort(),this.glyphDataFormat=er.readShort()},_e.prototype.encode=function(er){var tr;return(tr=new ne).writeInt(this.version),tr.writeInt(this.revision),tr.writeInt(this.checkSumAdjustment),tr.writeInt(this.magicNumber),tr.writeShort(this.flags),tr.writeShort(this.unitsPerEm),tr.writeLongLong(this.created),tr.writeLongLong(this.modified),tr.writeShort(this.xMin),tr.writeShort(this.yMin),tr.writeShort(this.xMax),tr.writeShort(this.yMax),tr.writeShort(this.macStyle),tr.writeShort(this.lowestRecPPEM),tr.writeShort(this.fontDirectionHint),tr.writeShort(er),tr.writeShort(this.glyphDataFormat),tr.data},_e}(),ce=function(){function e(_e,er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr,pr,gr,vr;switch(this.platformID=_e.readUInt16(),this.encodingID=_e.readShort(),this.offset=er+_e.readInt(),ur=_e.pos,_e.pos=this.offset,this.format=_e.readUInt16(),this.length=_e.readUInt16(),this.language=_e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(sr=0;sr<256;++sr)this.codeMap[sr]=_e.readByte();break;case 4:for(cr=_e.readUInt16(),fr=cr/2,_e.pos+=6,nr=function(){var Cr,Tr;for(Tr=[],sr=Cr=0;0<=fr?Cr<fr:Cr>fr;sr=0<=fr?++Cr:--Cr)Tr.push(_e.readUInt16());return Tr}(),_e.pos+=2,dr=function(){var Cr,Tr;for(Tr=[],sr=Cr=0;0<=fr?Cr<fr:Cr>fr;sr=0<=fr?++Cr:--Cr)Tr.push(_e.readUInt16());return Tr}(),or=function(){var Cr,Tr;for(Tr=[],sr=Cr=0;0<=fr?Cr<fr:Cr>fr;sr=0<=fr?++Cr:--Cr)Tr.push(_e.readUInt16());return Tr}(),lr=function(){var Cr,Tr;for(Tr=[],sr=Cr=0;0<=fr?Cr<fr:Cr>fr;sr=0<=fr?++Cr:--Cr)Tr.push(_e.readUInt16());return Tr}(),rr=(this.length-_e.pos+this.offset)/2,ar=function(){var Cr,Tr;for(Tr=[],sr=Cr=0;0<=rr?Cr<rr:Cr>rr;sr=0<=rr?++Cr:--Cr)Tr.push(_e.readUInt16());return Tr}(),sr=pr=0,vr=nr.length;pr<vr;sr=++pr)for(xr=nr[sr],tr=gr=mr=dr[sr];mr<=xr?gr<=xr:gr>=xr;tr=mr<=xr?++gr:--gr)lr[sr]===0?ir=tr+or[sr]:(ir=ar[lr[sr]/2+(tr-mr)-(fr-sr)]||0)!==0&&(ir+=or[sr]),this.codeMap[tr]=65535&ir}_e.pos=ur}return e.encode=function(_e,er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr,pr,gr,vr,Cr,Tr,Fr,_r,Ar,Pr,Ir,wr,kr,Mr,Hr,Gr,zr,Br,Vr,Rr,Xr,an,yr,br,Er,Lr,Or,Ur,$r,Zr,fn,_n,Kr;switch(Hr=new ne,ir=Object.keys(_e).sort(function(Cn,Dn){return Cn-Dn}),er){case"macroman":for(dr=0,xr=function(){var Cn=[];for(mr=0;mr<256;++mr)Cn.push(0);return Cn}(),gr={0:0},nr={},Gr=0,Rr=ir.length;Gr<Rr;Gr++)gr[Zr=_e[rr=ir[Gr]]]==null&&(gr[Zr]=++dr),nr[rr]={old:_e[rr],new:gr[_e[rr]]},xr[rr]=gr[_e[rr]];return Hr.writeUInt16(1),Hr.writeUInt16(0),Hr.writeUInt32(12),Hr.writeUInt16(0),Hr.writeUInt16(262),Hr.writeUInt16(0),Hr.write(xr),{charMap:nr,subtable:Hr.data,maxGlyphID:dr+1};case"unicode":for(kr=[],ur=[],vr=0,gr={},tr={},pr=or=null,zr=0,Xr=ir.length;zr<Xr;zr++)gr[Tr=_e[rr=ir[zr]]]==null&&(gr[Tr]=++vr),tr[rr]={old:Tr,new:gr[Tr]},ar=gr[Tr]-rr,pr!=null&&ar===or||(pr&&ur.push(pr),kr.push(rr),or=ar),pr=rr;for(pr&&ur.push(pr),ur.push(65535),kr.push(65535),Ir=2*(Pr=kr.length),Ar=2*Math.pow(Math.log(Pr)/Math.LN2,2),fr=Math.log(Ar/2)/Math.LN2,_r=2*Pr-Ar,sr=[],Fr=[],cr=[],mr=Br=0,an=kr.length;Br<an;mr=++Br){if(wr=kr[mr],lr=ur[mr],wr===65535){sr.push(0),Fr.push(0);break}if(wr-(Mr=tr[wr].new)>=32768)for(sr.push(0),Fr.push(2*(cr.length+Pr-mr)),rr=Vr=wr;wr<=lr?Vr<=lr:Vr>=lr;rr=wr<=lr?++Vr:--Vr)cr.push(tr[rr].new);else sr.push(Mr-wr),Fr.push(0)}for(Hr.writeUInt16(3),Hr.writeUInt16(1),Hr.writeUInt32(12),Hr.writeUInt16(4),Hr.writeUInt16(16+8*Pr+2*cr.length),Hr.writeUInt16(0),Hr.writeUInt16(Ir),Hr.writeUInt16(Ar),Hr.writeUInt16(fr),Hr.writeUInt16(_r),Ur=0,yr=ur.length;Ur<yr;Ur++)rr=ur[Ur],Hr.writeUInt16(rr);for(Hr.writeUInt16(0),$r=0,br=kr.length;$r<br;$r++)rr=kr[$r],Hr.writeUInt16(rr);for(fn=0,Er=sr.length;fn<Er;fn++)ar=sr[fn],Hr.writeUInt16(ar);for(_n=0,Lr=Fr.length;_n<Lr;_n++)Cr=Fr[_n],Hr.writeUInt16(Cr);for(Kr=0,Or=cr.length;Kr<Or;Kr++)dr=cr[Kr],Hr.writeUInt16(dr);return{charMap:tr,subtable:Hr.data,maxGlyphID:vr+1}}},e}(),ue=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="cmap",_e.prototype.parse=function(er){var tr,rr,nr;for(er.pos=this.offset,this.version=er.readUInt16(),nr=er.readUInt16(),this.tables=[],this.unicode=null,rr=0;0<=nr?rr<nr:rr>nr;rr=0<=nr?++rr:--rr)tr=new ce(er,this.offset),this.tables.push(tr),tr.isUnicode&&this.unicode==null&&(this.unicode=tr);return!0},_e.encode=function(er,tr){var rr,nr;return tr==null&&(tr="macroman"),rr=ce.encode(er,tr),(nr=new ne).writeUInt16(0),nr.writeUInt16(1),rr.table=nr.data.concat(rr.subtable),rr},_e}(),he=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="hhea",_e.prototype.parse=function(er){return er.pos=this.offset,this.version=er.readInt(),this.ascender=er.readShort(),this.decender=er.readShort(),this.lineGap=er.readShort(),this.advanceWidthMax=er.readShort(),this.minLeftSideBearing=er.readShort(),this.minRightSideBearing=er.readShort(),this.xMaxExtent=er.readShort(),this.caretSlopeRise=er.readShort(),this.caretSlopeRun=er.readShort(),this.caretOffset=er.readShort(),er.pos+=8,this.metricDataFormat=er.readShort(),this.numberOfMetrics=er.readUInt16()},_e}(),le=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="OS/2",_e.prototype.parse=function(er){if(er.pos=this.offset,this.version=er.readUInt16(),this.averageCharWidth=er.readShort(),this.weightClass=er.readUInt16(),this.widthClass=er.readUInt16(),this.type=er.readShort(),this.ySubscriptXSize=er.readShort(),this.ySubscriptYSize=er.readShort(),this.ySubscriptXOffset=er.readShort(),this.ySubscriptYOffset=er.readShort(),this.ySuperscriptXSize=er.readShort(),this.ySuperscriptYSize=er.readShort(),this.ySuperscriptXOffset=er.readShort(),this.ySuperscriptYOffset=er.readShort(),this.yStrikeoutSize=er.readShort(),this.yStrikeoutPosition=er.readShort(),this.familyClass=er.readShort(),this.panose=function(){var tr,rr;for(rr=[],tr=0;tr<10;++tr)rr.push(er.readByte());return rr}(),this.charRange=function(){var tr,rr;for(rr=[],tr=0;tr<4;++tr)rr.push(er.readInt());return rr}(),this.vendorID=er.readString(4),this.selection=er.readShort(),this.firstCharIndex=er.readShort(),this.lastCharIndex=er.readShort(),this.version>0&&(this.ascent=er.readShort(),this.descent=er.readShort(),this.lineGap=er.readShort(),this.winAscent=er.readShort(),this.winDescent=er.readShort(),this.codePageRange=function(){var tr,rr;for(rr=[],tr=0;tr<2;tr=++tr)rr.push(er.readInt());return rr}(),this.version>1))return this.xHeight=er.readShort(),this.capHeight=er.readShort(),this.defaultChar=er.readShort(),this.breakChar=er.readShort(),this.maxContext=er.readShort()},_e}(),fe=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="post",_e.prototype.parse=function(er){var tr,rr,nr;switch(er.pos=this.offset,this.format=er.readInt(),this.italicAngle=er.readInt(),this.underlinePosition=er.readShort(),this.underlineThickness=er.readShort(),this.isFixedPitch=er.readInt(),this.minMemType42=er.readInt(),this.maxMemType42=er.readInt(),this.minMemType1=er.readInt(),this.maxMemType1=er.readInt(),this.format){case 65536:break;case 131072:var ir;for(rr=er.readUInt16(),this.glyphNameIndex=[],ir=0;0<=rr?ir<rr:ir>rr;ir=0<=rr?++ir:--ir)this.glyphNameIndex.push(er.readUInt16());for(this.names=[],nr=[];er.pos<this.offset+this.length;)tr=er.readByte(),nr.push(this.names.push(er.readString(tr)));return nr;case 151552:return rr=er.readUInt16(),this.offsets=er.read(rr);case 196608:break;case 262144:return this.map=(function(){var ar,sr,or;for(or=[],ir=ar=0,sr=this.file.maxp.numGlyphs;0<=sr?ar<sr:ar>sr;ir=0<=sr?++ar:--ar)or.push(er.readUInt32());return or}).call(this)}},_e}(),de=function(e,_e){this.raw=e,this.length=e.length,this.platformID=_e.platformID,this.encodingID=_e.encodingID,this.languageID=_e.languageID},pe=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="name",_e.prototype.parse=function(er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr;for(er.pos=this.offset,er.readShort(),tr=er.readShort(),sr=er.readShort(),rr=[],ir=0;0<=tr?ir<tr:ir>tr;ir=0<=tr?++ir:--ir)rr.push({platformID:er.readShort(),encodingID:er.readShort(),languageID:er.readShort(),nameID:er.readShort(),length:er.readShort(),offset:this.offset+sr+er.readShort()});for(or={},ir=ur=0,fr=rr.length;ur<fr;ir=++ur)nr=rr[ir],er.pos=nr.offset,lr=er.readString(nr.length),ar=new de(lr,nr),or[cr=nr.nameID]==null&&(or[cr]=[]),or[nr.nameID].push(ar);this.strings=or,this.copyright=or[0],this.fontFamily=or[1],this.fontSubfamily=or[2],this.uniqueSubfamily=or[3],this.fontName=or[4],this.version=or[5];try{this.postscriptName=or[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=or[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=or[7],this.manufacturer=or[8],this.designer=or[9],this.description=or[10],this.vendorUrl=or[11],this.designerUrl=or[12],this.license=or[13],this.licenseUrl=or[14],this.preferredFamily=or[15],this.preferredSubfamily=or[17],this.compatibleFull=or[18],this.sampleText=or[19]},_e}(),ge=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="maxp",_e.prototype.parse=function(er){return er.pos=this.offset,this.version=er.readInt(),this.numGlyphs=er.readUInt16(),this.maxPoints=er.readUInt16(),this.maxContours=er.readUInt16(),this.maxCompositePoints=er.readUInt16(),this.maxComponentContours=er.readUInt16(),this.maxZones=er.readUInt16(),this.maxTwilightPoints=er.readUInt16(),this.maxStorage=er.readUInt16(),this.maxFunctionDefs=er.readUInt16(),this.maxInstructionDefs=er.readUInt16(),this.maxStackElements=er.readUInt16(),this.maxSizeOfInstructions=er.readUInt16(),this.maxComponentElements=er.readUInt16(),this.maxComponentDepth=er.readUInt16()},_e}(),me=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="hmtx",_e.prototype.parse=function(er){var tr,rr,nr,ir,ar,sr,or;for(er.pos=this.offset,this.metrics=[],tr=0,sr=this.file.hhea.numberOfMetrics;0<=sr?tr<sr:tr>sr;tr=0<=sr?++tr:--tr)this.metrics.push({advance:er.readUInt16(),lsb:er.readInt16()});for(nr=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var lr,ur;for(ur=[],tr=lr=0;0<=nr?lr<nr:lr>nr;tr=0<=nr?++lr:--lr)ur.push(er.readInt16());return ur}(),this.widths=(function(){var lr,ur,fr,cr;for(cr=[],lr=0,ur=(fr=this.metrics).length;lr<ur;lr++)ir=fr[lr],cr.push(ir.advance);return cr}).call(this),rr=this.widths[this.widths.length-1],or=[],tr=ar=0;0<=nr?ar<nr:ar>nr;tr=0<=nr?++ar:--ar)or.push(this.widths.push(rr));return or},_e.prototype.forGlyph=function(er){return er in this.metrics?this.metrics[er]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[er-this.metrics.length]}},_e}(),ve=[].slice,be=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="glyf",_e.prototype.parse=function(){return this.cache={}},_e.prototype.glyphFor=function(er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr;return er in this.cache?this.cache[er]:(ir=this.file.loca,tr=this.file.contents,rr=ir.indexOf(er),(nr=ir.lengthOf(er))===0?this.cache[er]=null:(tr.pos=this.offset+rr,ar=(sr=new ne(tr.read(nr))).readShort(),lr=sr.readShort(),fr=sr.readShort(),or=sr.readShort(),ur=sr.readShort(),this.cache[er]=ar===-1?new we(sr,lr,fr,or,ur):new ye(sr,ar,lr,fr,or,ur),this.cache[er]))},_e.prototype.encode=function(er,tr,rr){var nr,ir,ar,sr,or;for(ar=[],ir=[],sr=0,or=tr.length;sr<or;sr++)nr=er[tr[sr]],ir.push(ar.length),nr&&(ar=ar.concat(nr.encode(rr)));return ir.push(ar.length),{table:ar,offsets:ir}},_e}(),ye=function(){function e(_e,er,tr,rr,nr,ir){this.raw=_e,this.numberOfContours=er,this.xMin=tr,this.yMin=rr,this.xMax=nr,this.yMax=ir,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),we=function(){function e(_e,er,tr,rr,nr){var ir,ar;for(this.raw=_e,this.xMin=er,this.yMin=tr,this.xMax=rr,this.yMax=nr,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],ir=this.raw;ar=ir.readShort(),this.glyphOffsets.push(ir.pos),this.glyphIDs.push(ir.readUInt16()),32&ar;)ir.pos+=1&ar?4:2,128&ar?ir.pos+=8:64&ar?ir.pos+=4:8&ar&&(ir.pos+=2)}return e.prototype.encode=function(){var _e,er,tr;for(er=new ne(ve.call(this.raw.data)),_e=0,tr=this.glyphIDs.length;_e<tr;++_e)er.pos=this.glyphOffsets[_e];return er.data},e}(),Ne=function(e){function _e(){return _e.__super__.constructor.apply(this,arguments)}return oe(_e,re),_e.prototype.tag="loca",_e.prototype.parse=function(er){var tr,rr;return er.pos=this.offset,tr=this.file.head.indexToLocFormat,this.offsets=tr===0?(function(){var nr,ir;for(ir=[],rr=0,nr=this.length;rr<nr;rr+=2)ir.push(2*er.readUInt16());return ir}).call(this):(function(){var nr,ir;for(ir=[],rr=0,nr=this.length;rr<nr;rr+=4)ir.push(er.readUInt32());return ir}).call(this)},_e.prototype.indexOf=function(er){return this.offsets[er]},_e.prototype.lengthOf=function(er){return this.offsets[er+1]-this.offsets[er]},_e.prototype.encode=function(er,tr){for(var rr=new Uint32Array(this.offsets.length),nr=0,ir=0,ar=0;ar<rr.length;++ar)if(rr[ar]=nr,ir<tr.length&&tr[ir]==ar){++ir,rr[ar]=nr;var sr=this.offsets[ar],or=this.offsets[ar+1]-sr;or>0&&(nr+=or)}for(var lr=new Array(4*rr.length),ur=0;ur<rr.length;++ur)lr[4*ur+3]=255&rr[ur],lr[4*ur+2]=(65280&rr[ur])>>8,lr[4*ur+1]=(16711680&rr[ur])>>16,lr[4*ur]=(4278190080&rr[ur])>>24;return lr},_e}(),Le=function(){function e(_e){this.font=_e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var _e,er,tr,rr,nr;for(er in rr=this.font.cmap.tables[0].codeMap,_e={},nr=this.subset)tr=nr[er],_e[er]=rr[tr];return _e},e.prototype.glyphsFor=function(_e){var er,tr,rr,nr,ir,ar,sr;for(rr={},ir=0,ar=_e.length;ir<ar;ir++)rr[nr=_e[ir]]=this.font.glyf.glyphFor(nr);for(nr in er=[],rr)(tr=rr[nr])!=null&&tr.compound&&er.push.apply(er,tr.glyphIDs);if(er.length>0)for(nr in sr=this.glyphsFor(er))tr=sr[nr],rr[nr]=tr;return rr},e.prototype.encode=function(_e,er){var tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr,pr;for(rr in tr=ue.encode(this.generateCmap(),"unicode"),ir=this.glyphsFor(_e),cr={0:0},pr=tr.charMap)cr[(sr=pr[rr]).old]=sr.new;for(mr in fr=tr.maxGlyphID,ir)mr in cr||(cr[mr]=fr++);return lr=function(gr){var vr,Cr;for(vr in Cr={},gr)Cr[gr[vr]]=vr;return Cr}(cr),ur=Object.keys(lr).sort(function(gr,vr){return gr-vr}),dr=function(){var gr,vr,Cr;for(Cr=[],gr=0,vr=ur.length;gr<vr;gr++)ar=ur[gr],Cr.push(lr[ar]);return Cr}(),nr=this.font.glyf.encode(ir,dr,cr),or=this.font.loca.encode(nr.offsets,dr),xr={cmap:this.font.cmap.raw(),glyf:nr.table,loca:or,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(er)},this.font.os2.exists&&(xr["OS/2"]=this.font.os2.raw()),this.font.directory.encode(xr)},e}();E.API.PDFObject=function(){var e;function _e(){}return e=function(er,tr){return(Array(tr+1).join("0")+er).slice(-tr)},_e.convert=function(er){var tr,rr,nr,ir;if(Array.isArray(er))return"["+function(){var ar,sr,or;for(or=[],ar=0,sr=er.length;ar<sr;ar++)tr=er[ar],or.push(_e.convert(tr));return or}().join(" ")+"]";if(typeof er=="string")return"/"+er;if(er!=null&&er.isString)return"("+er+")";if(er instanceof Date)return"(D:"+e(er.getUTCFullYear(),4)+e(er.getUTCMonth(),2)+e(er.getUTCDate(),2)+e(er.getUTCHours(),2)+e(er.getUTCMinutes(),2)+e(er.getUTCSeconds(),2)+"Z)";if({}.toString.call(er)==="[object Object]"){for(rr in nr=["<<"],er)ir=er[rr],nr.push("/"+rr+" "+_e.convert(ir));return nr.push(">>"),nr.join(`
`)}return""+er},_e}();const jspdf_es_min=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:St,AcroFormAppearance:At,AcroFormButton:mt,AcroFormCheckBox:wt,AcroFormChoiceField:ft,AcroFormComboBox:pt,AcroFormEditBox:gt,AcroFormListBox:dt,AcroFormPasswordField:Lt,AcroFormPushButton:vt,AcroFormRadioButton:bt,AcroFormTextField:Nt,GState:j,ShadingPattern:B,TilingPattern:M,default:E,jsPDF:E},Symbol.toStringTag,{value:"Module"}));var jspdf_plugin_autotable={exports:{}};const require$$0=getAugmentedNamespace(jspdf_es_min);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,_e){(function(tr,rr){e.exports=rr(function(){try{return require$$0}catch{}}())})(typeof globalThis<"u"?globalThis:typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:commonjsGlobal,function(er){return function(){var tr={172:function(ar,sr){var or=this&&this.__extends||function(){var fr=function(cr,mr){return fr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(dr,xr){dr.__proto__=xr}||function(dr,xr){for(var pr in xr)Object.prototype.hasOwnProperty.call(xr,pr)&&(dr[pr]=xr[pr])},fr(cr,mr)};return function(cr,mr){if(typeof mr!="function"&&mr!==null)throw new TypeError("Class extends value "+String(mr)+" is not a constructor or null");fr(cr,mr);function dr(){this.constructor=cr}cr.prototype=mr===null?Object.create(mr):(dr.prototype=mr.prototype,new dr)}}();Object.defineProperty(sr,"__esModule",{value:!0}),sr.CellHookData=sr.HookData=void 0;var lr=function(){function fr(cr,mr,dr){this.table=mr,this.pageNumber=mr.pageNumber,this.pageCount=this.pageNumber,this.settings=mr.settings,this.cursor=dr,this.doc=cr.getDocument()}return fr}();sr.HookData=lr;var ur=function(fr){or(cr,fr);function cr(mr,dr,xr,pr,gr,vr){var Cr=fr.call(this,mr,dr,vr)||this;return Cr.cell=xr,Cr.row=pr,Cr.column=gr,Cr.section=pr.section,Cr}return cr}(lr);sr.CellHookData=ur},340:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0});var lr=or(4),ur=or(136),fr=or(744),cr=or(776),mr=or(664),dr=or(972);function xr(pr){pr.API.autoTable=function(){for(var gr=[],vr=0;vr<arguments.length;vr++)gr[vr]=arguments[vr];var Cr;gr.length===1?Cr=gr[0]:(console.error("Use of deprecated autoTable initiation"),Cr=gr[2]||{},Cr.columns=gr[0],Cr.body=gr[1]);var Tr=(0,cr.parseInput)(this,Cr),Fr=(0,dr.createTable)(this,Tr);return(0,mr.drawTable)(this,Fr),this},pr.API.lastAutoTable=!1,pr.API.previousAutoTable=!1,pr.API.autoTable.previous=!1,pr.API.autoTableText=function(gr,vr,Cr,Tr){(0,ur.default)(gr,vr,Cr,Tr,this)},pr.API.autoTableSetDefaults=function(gr){return fr.DocHandler.setDefaults(gr,this),this},pr.autoTableSetDefaults=function(gr,vr){fr.DocHandler.setDefaults(gr,vr)},pr.API.autoTableHtmlToJson=function(gr,vr){var Cr;if(vr===void 0&&(vr=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var Tr=new fr.DocHandler(this),Fr=(0,lr.parseHtml)(Tr,gr,window,vr,!1),_r=Fr.head,Ar=Fr.body,Pr=((Cr=_r[0])===null||Cr===void 0?void 0:Cr.map(function(Ir){return Ir.content}))||[];return{columns:Pr,rows:Ar,data:Ar}},pr.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var gr=this.lastAutoTable;return gr&&gr.finalY?gr.finalY:0},pr.API.autoTableAddPageContent=function(gr){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),pr.API.autoTable.globalDefaults||(pr.API.autoTable.globalDefaults={}),pr.API.autoTable.globalDefaults.addPageContent=gr,this},pr.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}sr.default=xr},136:function(ar,sr){Object.defineProperty(sr,"__esModule",{value:!0});function or(lr,ur,fr,cr,mr){cr=cr||{};var dr=1.15,xr=mr.internal.scaleFactor,pr=mr.internal.getFontSize()/xr,gr=mr.getLineHeightFactor?mr.getLineHeightFactor():dr,vr=pr*gr,Cr=/\r\n|\r|\n/g,Tr="",Fr=1;if((cr.valign==="middle"||cr.valign==="bottom"||cr.halign==="center"||cr.halign==="right")&&(Tr=typeof lr=="string"?lr.split(Cr):lr,Fr=Tr.length||1),fr+=pr*(2-dr),cr.valign==="middle"?fr-=Fr/2*vr:cr.valign==="bottom"&&(fr-=Fr*vr),cr.halign==="center"||cr.halign==="right"){var _r=pr;if(cr.halign==="center"&&(_r*=.5),Tr&&Fr>=1){for(var Ar=0;Ar<Tr.length;Ar++)mr.text(Tr[Ar],ur-mr.getStringUnitWidth(Tr[Ar])*_r,fr),fr+=vr;return mr}ur-=mr.getStringUnitWidth(lr)*_r}return cr.halign==="justify"?mr.text(lr,ur,fr,{maxWidth:cr.maxWidth||100,align:"justify"}):mr.text(lr,ur,fr),mr}sr.default=or},420:function(ar,sr){Object.defineProperty(sr,"__esModule",{value:!0}),sr.getPageAvailableWidth=sr.parseSpacing=sr.getFillStyle=sr.addTableBorder=sr.getStringWidth=void 0;function or(mr,dr,xr){xr.applyStyles(dr,!0);var pr=Array.isArray(mr)?mr:[mr],gr=pr.map(function(vr){return xr.getTextWidth(vr)}).reduce(function(vr,Cr){return Math.max(vr,Cr)},0);return gr}sr.getStringWidth=or;function lr(mr,dr,xr,pr){var gr=dr.settings.tableLineWidth,vr=dr.settings.tableLineColor;mr.applyStyles({lineWidth:gr,lineColor:vr});var Cr=ur(gr,!1);Cr&&mr.rect(xr.x,xr.y,dr.getWidth(mr.pageSize().width),pr.y-xr.y,Cr)}sr.addTableBorder=lr;function ur(mr,dr){var xr=mr>0,pr=dr||dr===0;return xr&&pr?"DF":xr?"S":pr?"F":null}sr.getFillStyle=ur;function fr(mr,dr){var xr,pr,gr,vr;if(mr=mr||dr,Array.isArray(mr)){if(mr.length>=4)return{top:mr[0],right:mr[1],bottom:mr[2],left:mr[3]};if(mr.length===3)return{top:mr[0],right:mr[1],bottom:mr[2],left:mr[1]};if(mr.length===2)return{top:mr[0],right:mr[1],bottom:mr[0],left:mr[1]};mr.length===1?mr=mr[0]:mr=dr}return typeof mr=="object"?(typeof mr.vertical=="number"&&(mr.top=mr.vertical,mr.bottom=mr.vertical),typeof mr.horizontal=="number"&&(mr.right=mr.horizontal,mr.left=mr.horizontal),{left:(xr=mr.left)!==null&&xr!==void 0?xr:dr,top:(pr=mr.top)!==null&&pr!==void 0?pr:dr,right:(gr=mr.right)!==null&&gr!==void 0?gr:dr,bottom:(vr=mr.bottom)!==null&&vr!==void 0?vr:dr}):(typeof mr!="number"&&(mr=dr),{top:mr,right:mr,bottom:mr,left:mr})}sr.parseSpacing=fr;function cr(mr,dr){var xr=fr(dr.settings.margin,0);return mr.pageSize().width-(xr.left+xr.right)}sr.getPageAvailableWidth=cr},796:function(ar,sr){var or=this&&this.__extends||function(){var cr=function(mr,dr){return cr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(xr,pr){xr.__proto__=pr}||function(xr,pr){for(var gr in pr)Object.prototype.hasOwnProperty.call(pr,gr)&&(xr[gr]=pr[gr])},cr(mr,dr)};return function(mr,dr){if(typeof dr!="function"&&dr!==null)throw new TypeError("Class extends value "+String(dr)+" is not a constructor or null");cr(mr,dr);function xr(){this.constructor=mr}mr.prototype=dr===null?Object.create(dr):(xr.prototype=dr.prototype,new xr)}}();Object.defineProperty(sr,"__esModule",{value:!0}),sr.getTheme=sr.defaultStyles=sr.HtmlRowInput=void 0;var lr=function(cr){or(mr,cr);function mr(dr){var xr=cr.call(this)||this;return xr._element=dr,xr}return mr}(Array);sr.HtmlRowInput=lr;function ur(cr){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/cr,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}sr.defaultStyles=ur;function fr(cr){var mr={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return mr[cr]}sr.getTheme=fr},903:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.parseCss=void 0;var lr=or(420);function ur(xr,pr,gr,vr,Cr){var Tr={},Fr=1.3333333333333333,_r=cr(pr,function(Rr){return Cr.getComputedStyle(Rr).backgroundColor});_r!=null&&(Tr.fillColor=_r);var Ar=cr(pr,function(Rr){return Cr.getComputedStyle(Rr).color});Ar!=null&&(Tr.textColor=Ar);var Pr=dr(vr,gr);Pr&&(Tr.cellPadding=Pr);var Ir="borderTopColor",wr=Fr*gr,kr=vr.borderTopWidth;if(vr.borderBottomWidth===kr&&vr.borderRightWidth===kr&&vr.borderLeftWidth===kr){var Mr=(parseFloat(kr)||0)/wr;Mr&&(Tr.lineWidth=Mr)}else Tr.lineWidth={top:(parseFloat(vr.borderTopWidth)||0)/wr,right:(parseFloat(vr.borderRightWidth)||0)/wr,bottom:(parseFloat(vr.borderBottomWidth)||0)/wr,left:(parseFloat(vr.borderLeftWidth)||0)/wr},Tr.lineWidth.top||(Tr.lineWidth.right?Ir="borderRightColor":Tr.lineWidth.bottom?Ir="borderBottomColor":Tr.lineWidth.left&&(Ir="borderLeftColor"));var Hr=cr(pr,function(Rr){return Cr.getComputedStyle(Rr)[Ir]});Hr!=null&&(Tr.lineColor=Hr);var Gr=["left","right","center","justify"];Gr.indexOf(vr.textAlign)!==-1&&(Tr.halign=vr.textAlign),Gr=["middle","bottom","top"],Gr.indexOf(vr.verticalAlign)!==-1&&(Tr.valign=vr.verticalAlign);var zr=parseInt(vr.fontSize||"");isNaN(zr)||(Tr.fontSize=zr/Fr);var Br=fr(vr);Br&&(Tr.fontStyle=Br);var Vr=(vr.fontFamily||"").toLowerCase();return xr.indexOf(Vr)!==-1&&(Tr.font=Vr),Tr}sr.parseCss=ur;function fr(xr){var pr="";return(xr.fontWeight==="bold"||xr.fontWeight==="bolder"||parseInt(xr.fontWeight)>=700)&&(pr="bold"),(xr.fontStyle==="italic"||xr.fontStyle==="oblique")&&(pr+="italic"),pr}function cr(xr,pr){var gr=mr(xr,pr);if(!gr)return null;var vr=gr.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!vr||!Array.isArray(vr))return null;var Cr=[parseInt(vr[1]),parseInt(vr[2]),parseInt(vr[3])],Tr=parseInt(vr[4]);return Tr===0||isNaN(Cr[0])||isNaN(Cr[1])||isNaN(Cr[2])?null:Cr}function mr(xr,pr){var gr=pr(xr);return gr==="rgba(0, 0, 0, 0)"||gr==="transparent"||gr==="initial"||gr==="inherit"?xr.parentElement==null?null:mr(xr.parentElement,pr):gr}function dr(xr,pr){var gr=[xr.paddingTop,xr.paddingRight,xr.paddingBottom,xr.paddingLeft],vr=96/(72/pr),Cr=(parseInt(xr.lineHeight)-parseInt(xr.fontSize))/pr/2,Tr=gr.map(function(_r){return parseInt(_r||"0")/vr}),Fr=(0,lr.parseSpacing)(Tr,0);return Cr>Fr.top&&(Fr.top=Cr),Cr>Fr.bottom&&(Fr.bottom=Cr),Fr}},744:function(ar,sr){Object.defineProperty(sr,"__esModule",{value:!0}),sr.DocHandler=void 0;var or={},lr=function(){function ur(fr){this.jsPDFDocument=fr,this.userStyles={textColor:fr.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:fr.internal.getFontSize(),fontStyle:fr.internal.getFont().fontStyle,font:fr.internal.getFont().fontName,lineWidth:fr.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:fr.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return ur.setDefaults=function(fr,cr){cr===void 0&&(cr=null),cr?cr.__autoTableDocumentDefaults=fr:or=fr},ur.unifyColor=function(fr){return Array.isArray(fr)?fr:typeof fr=="number"?[fr,fr,fr]:typeof fr=="string"?[fr]:null},ur.prototype.applyStyles=function(fr,cr){var mr,dr,xr;cr===void 0&&(cr=!1),fr.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(fr.fontStyle);var pr=this.jsPDFDocument.internal.getFont(),gr=pr.fontStyle,vr=pr.fontName;if(fr.font&&(vr=fr.font),fr.fontStyle){gr=fr.fontStyle;var Cr=this.getFontList()[vr];Cr&&Cr.indexOf(gr)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(Cr[0]),gr=Cr[0])}if(this.jsPDFDocument.setFont(vr,gr),fr.fontSize&&this.jsPDFDocument.setFontSize(fr.fontSize),!cr){var Tr=ur.unifyColor(fr.fillColor);Tr&&(mr=this.jsPDFDocument).setFillColor.apply(mr,Tr),Tr=ur.unifyColor(fr.textColor),Tr&&(dr=this.jsPDFDocument).setTextColor.apply(dr,Tr),Tr=ur.unifyColor(fr.lineColor),Tr&&(xr=this.jsPDFDocument).setDrawColor.apply(xr,Tr),typeof fr.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(fr.lineWidth)}},ur.prototype.splitTextToSize=function(fr,cr,mr){return this.jsPDFDocument.splitTextToSize(fr,cr,mr)},ur.prototype.rect=function(fr,cr,mr,dr,xr){return this.jsPDFDocument.rect(fr,cr,mr,dr,xr)},ur.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},ur.prototype.getTextWidth=function(fr){return this.jsPDFDocument.getTextWidth(fr)},ur.prototype.getDocument=function(){return this.jsPDFDocument},ur.prototype.setPage=function(fr){this.jsPDFDocument.setPage(fr)},ur.prototype.addPage=function(){return this.jsPDFDocument.addPage()},ur.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},ur.prototype.getGlobalOptions=function(){return or||{}},ur.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},ur.prototype.pageSize=function(){var fr=this.jsPDFDocument.internal.pageSize;return fr.width==null&&(fr={width:fr.getWidth(),height:fr.getHeight()}),fr},ur.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},ur.prototype.getLineHeightFactor=function(){var fr=this.jsPDFDocument;return fr.getLineHeightFactor?fr.getLineHeightFactor():1.15},ur.prototype.getLineHeight=function(fr){return fr/this.scaleFactor()*this.getLineHeightFactor()},ur.prototype.pageNumber=function(){var fr=this.jsPDFDocument.internal.getCurrentPageInfo();return fr?fr.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},ur}();sr.DocHandler=lr},4:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.parseHtml=void 0;var lr=or(903),ur=or(796);function fr(dr,xr,pr,gr,vr){var Cr,Tr;gr===void 0&&(gr=!1),vr===void 0&&(vr=!1);var Fr;typeof xr=="string"?Fr=pr.document.querySelector(xr):Fr=xr;var _r=Object.keys(dr.getFontList()),Ar=dr.scaleFactor(),Pr=[],Ir=[],wr=[];if(!Fr)return console.error("Html table could not be found with input: ",xr),{head:Pr,body:Ir,foot:wr};for(var kr=0;kr<Fr.rows.length;kr++){var Mr=Fr.rows[kr],Hr=(Tr=(Cr=Mr==null?void 0:Mr.parentElement)===null||Cr===void 0?void 0:Cr.tagName)===null||Tr===void 0?void 0:Tr.toLowerCase(),Gr=cr(_r,Ar,pr,Mr,gr,vr);Gr&&(Hr==="thead"?Pr.push(Gr):Hr==="tfoot"?wr.push(Gr):Ir.push(Gr))}return{head:Pr,body:Ir,foot:wr}}sr.parseHtml=fr;function cr(dr,xr,pr,gr,vr,Cr){for(var Tr=new ur.HtmlRowInput(gr),Fr=0;Fr<gr.cells.length;Fr++){var _r=gr.cells[Fr],Ar=pr.getComputedStyle(_r);if(vr||Ar.display!=="none"){var Pr=void 0;Cr&&(Pr=(0,lr.parseCss)(dr,_r,xr,Ar,pr)),Tr.push({rowSpan:_r.rowSpan,colSpan:_r.colSpan,styles:Pr,_element:_r,content:mr(_r)})}}var Ir=pr.getComputedStyle(gr);if(Tr.length>0&&(vr||Ir.display!=="none"))return Tr}function mr(dr){var xr=dr.cloneNode(!0);return xr.innerHTML=xr.innerHTML.replace(/\n/g,"").replace(/ +/g," "),xr.innerHTML=xr.innerHTML.split(/<br.*?>/).map(function(pr){return pr.trim()}).join(`
`),xr.innerText||xr.textContent||""}},776:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.parseInput=void 0;var lr=or(4),ur=or(356),fr=or(420),cr=or(744),mr=or(792);function dr(Fr,_r){var Ar=new cr.DocHandler(Fr),Pr=Ar.getDocumentOptions(),Ir=Ar.getGlobalOptions();(0,mr.default)(Ar,Ir,Pr,_r);var wr=(0,ur.assign)({},Ir,Pr,_r),kr;typeof window<"u"&&(kr=window);var Mr=xr(Ir,Pr,_r),Hr=pr(Ir,Pr,_r),Gr=gr(Ar,wr),zr=Cr(Ar,wr,kr);return{id:_r.tableId,content:zr,hooks:Hr,styles:Mr,settings:Gr}}sr.parseInput=dr;function xr(Fr,_r,Ar){for(var Pr={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},Ir=function(Hr){if(Hr==="columnStyles"){var Gr=Fr[Hr],zr=_r[Hr],Br=Ar[Hr];Pr.columnStyles=(0,ur.assign)({},Gr,zr,Br)}else{var Vr=[Fr,_r,Ar],Rr=Vr.map(function(Xr){return Xr[Hr]||{}});Pr[Hr]=(0,ur.assign)({},Rr[0],Rr[1],Rr[2])}},wr=0,kr=Object.keys(Pr);wr<kr.length;wr++){var Mr=kr[wr];Ir(Mr)}return Pr}function pr(Fr,_r,Ar){for(var Pr=[Fr,_r,Ar],Ir={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},wr=0,kr=Pr;wr<kr.length;wr++){var Mr=kr[wr];Mr.didParseCell&&Ir.didParseCell.push(Mr.didParseCell),Mr.willDrawCell&&Ir.willDrawCell.push(Mr.willDrawCell),Mr.didDrawCell&&Ir.didDrawCell.push(Mr.didDrawCell),Mr.willDrawPage&&Ir.willDrawPage.push(Mr.willDrawPage),Mr.didDrawPage&&Ir.didDrawPage.push(Mr.didDrawPage)}return Ir}function gr(Fr,_r){var Ar,Pr,Ir,wr,kr,Mr,Hr,Gr,zr,Br,Vr,Rr,Xr=(0,fr.parseSpacing)(_r.margin,40/Fr.scaleFactor()),an=(Ar=vr(Fr,_r.startY))!==null&&Ar!==void 0?Ar:Xr.top,yr;_r.showFoot===!0?yr="everyPage":_r.showFoot===!1?yr="never":yr=(Pr=_r.showFoot)!==null&&Pr!==void 0?Pr:"everyPage";var br;_r.showHead===!0?br="everyPage":_r.showHead===!1?br="never":br=(Ir=_r.showHead)!==null&&Ir!==void 0?Ir:"everyPage";var Er=(wr=_r.useCss)!==null&&wr!==void 0?wr:!1,Lr=_r.theme||(Er?"plain":"striped"),Or=!!_r.horizontalPageBreak,Ur=(kr=_r.horizontalPageBreakRepeat)!==null&&kr!==void 0?kr:null;return{includeHiddenHtml:(Mr=_r.includeHiddenHtml)!==null&&Mr!==void 0?Mr:!1,useCss:Er,theme:Lr,startY:an,margin:Xr,pageBreak:(Hr=_r.pageBreak)!==null&&Hr!==void 0?Hr:"auto",rowPageBreak:(Gr=_r.rowPageBreak)!==null&&Gr!==void 0?Gr:"auto",tableWidth:(zr=_r.tableWidth)!==null&&zr!==void 0?zr:"auto",showHead:br,showFoot:yr,tableLineWidth:(Br=_r.tableLineWidth)!==null&&Br!==void 0?Br:0,tableLineColor:(Vr=_r.tableLineColor)!==null&&Vr!==void 0?Vr:200,horizontalPageBreak:Or,horizontalPageBreakRepeat:Ur,horizontalPageBreakBehaviour:(Rr=_r.horizontalPageBreakBehaviour)!==null&&Rr!==void 0?Rr:"afterAllRows"}}function vr(Fr,_r){var Ar=Fr.getLastAutoTable(),Pr=Fr.scaleFactor(),Ir=Fr.pageNumber(),wr=!1;if(Ar&&Ar.startPageNumber){var kr=Ar.startPageNumber+Ar.pageNumber-1;wr=kr===Ir}return typeof _r=="number"?_r:(_r==null||_r===!1)&&wr&&(Ar==null?void 0:Ar.finalY)!=null?Ar.finalY+20/Pr:null}function Cr(Fr,_r,Ar){var Pr=_r.head||[],Ir=_r.body||[],wr=_r.foot||[];if(_r.html){var kr=_r.includeHiddenHtml;if(Ar){var Mr=(0,lr.parseHtml)(Fr,_r.html,Ar,kr,_r.useCss)||{};Pr=Mr.head||Pr,Ir=Mr.body||Pr,wr=Mr.foot||Pr}else console.error("Cannot parse html in non browser environment")}var Hr=_r.columns||Tr(Pr,Ir,wr);return{columns:Hr,head:Pr,body:Ir,foot:wr}}function Tr(Fr,_r,Ar){var Pr=Fr[0]||_r[0]||Ar[0]||[],Ir=[];return Object.keys(Pr).filter(function(wr){return wr!=="_element"}).forEach(function(wr){var kr=1,Mr;Array.isArray(Pr)?Mr=Pr[parseInt(wr)]:Mr=Pr[wr],typeof Mr=="object"&&!Array.isArray(Mr)&&(kr=(Mr==null?void 0:Mr.colSpan)||1);for(var Hr=0;Hr<kr;Hr++){var Gr=void 0;Array.isArray(Pr)?Gr=Ir.length:Gr=wr+(Hr>0?"_".concat(Hr):"");var zr={dataKey:Gr};Ir.push(zr)}}),Ir}},792:function(ar,sr){Object.defineProperty(sr,"__esModule",{value:!0});function or(ur,fr,cr,mr){for(var dr=function(vr){vr&&typeof vr!="object"&&console.error("The options parameter should be of type object, is: "+typeof vr),typeof vr.extendWidth<"u"&&(vr.tableWidth=vr.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof vr.margins<"u"&&(typeof vr.margin>"u"&&(vr.margin=vr.margins),console.error("Use of deprecated option: margins, use margin instead.")),vr.startY&&typeof vr.startY!="number"&&(console.error("Invalid value for startY option",vr.startY),delete vr.startY),!vr.didDrawPage&&(vr.afterPageContent||vr.beforePageContent||vr.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),vr.didDrawPage=function(wr){ur.applyStyles(ur.userStyles),vr.beforePageContent&&vr.beforePageContent(wr),ur.applyStyles(ur.userStyles),vr.afterPageContent&&vr.afterPageContent(wr),ur.applyStyles(ur.userStyles),vr.afterPageAdd&&wr.pageNumber>1&&wr.afterPageAdd(wr),ur.applyStyles(ur.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(wr){vr[wr]&&console.error('The "'.concat(wr,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(wr){var kr=wr[0],Mr=wr[1];vr[Mr]&&(console.error("Use of deprecated option ".concat(Mr,". Use ").concat(kr," instead")),vr[kr]=vr[Mr])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(wr){var kr=typeof wr=="string"?wr:wr[0],Mr=typeof wr=="string"?wr:wr[1];typeof vr[kr]<"u"&&(typeof vr.styles[Mr]>"u"&&(vr.styles[Mr]=vr[kr]),console.error("Use of deprecated option: "+kr+", use the style "+Mr+" instead."))});for(var Cr=0,Tr=["styles","bodyStyles","headStyles","footStyles"];Cr<Tr.length;Cr++){var Fr=Tr[Cr];lr(vr[Fr]||{})}for(var _r=vr.columnStyles||{},Ar=0,Pr=Object.keys(_r);Ar<Pr.length;Ar++){var Ir=Pr[Ar];lr(_r[Ir]||{})}},xr=0,pr=[fr,cr,mr];xr<pr.length;xr++){var gr=pr[xr];dr(gr)}}sr.default=or;function lr(ur){ur.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),ur.minCellHeight||(ur.minCellHeight=ur.rowHeight)):ur.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),ur.cellWidth||(ur.cellWidth=ur.columnWidth))}},260:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.Column=sr.Cell=sr.Row=sr.Table=void 0;var lr=or(796),ur=or(172),fr=or(420),cr=function(){function pr(gr,vr){this.pageNumber=1,this.pageCount=1,this.id=gr.id,this.settings=gr.settings,this.styles=gr.styles,this.hooks=gr.hooks,this.columns=vr.columns,this.head=vr.head,this.body=vr.body,this.foot=vr.foot}return pr.prototype.getHeadHeight=function(gr){return this.head.reduce(function(vr,Cr){return vr+Cr.getMaxCellHeight(gr)},0)},pr.prototype.getFootHeight=function(gr){return this.foot.reduce(function(vr,Cr){return vr+Cr.getMaxCellHeight(gr)},0)},pr.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},pr.prototype.callCellHooks=function(gr,vr,Cr,Tr,Fr,_r){for(var Ar=0,Pr=vr;Ar<Pr.length;Ar++){var Ir=Pr[Ar],wr=new ur.CellHookData(gr,this,Cr,Tr,Fr,_r),kr=Ir(wr)===!1;if(Cr.text=Array.isArray(Cr.text)?Cr.text:[Cr.text],kr)return!1}return!0},pr.prototype.callEndPageHooks=function(gr,vr){gr.applyStyles(gr.userStyles);for(var Cr=0,Tr=this.hooks.didDrawPage;Cr<Tr.length;Cr++){var Fr=Tr[Cr];Fr(new ur.HookData(gr,this,vr))}},pr.prototype.callWillDrawPageHooks=function(gr,vr){for(var Cr=0,Tr=this.hooks.willDrawPage;Cr<Tr.length;Cr++){var Fr=Tr[Cr];Fr(new ur.HookData(gr,this,vr))}},pr.prototype.getWidth=function(gr){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var vr=this.columns.reduce(function(Tr,Fr){return Tr+Fr.wrappedWidth},0);return vr}else{var Cr=this.settings.margin;return gr-Cr.left-Cr.right}},pr}();sr.Table=cr;var mr=function(){function pr(gr,vr,Cr,Tr,Fr){Fr===void 0&&(Fr=!1),this.height=0,this.raw=gr,gr instanceof lr.HtmlRowInput&&(this.raw=gr._element,this.element=gr._element),this.index=vr,this.section=Cr,this.cells=Tr,this.spansMultiplePages=Fr}return pr.prototype.getMaxCellHeight=function(gr){var vr=this;return gr.reduce(function(Cr,Tr){var Fr;return Math.max(Cr,((Fr=vr.cells[Tr.index])===null||Fr===void 0?void 0:Fr.height)||0)},0)},pr.prototype.hasRowSpan=function(gr){var vr=this;return gr.filter(function(Cr){var Tr=vr.cells[Cr.index];return Tr?Tr.rowSpan>1:!1}).length>0},pr.prototype.canEntireRowFit=function(gr,vr){return this.getMaxCellHeight(vr)<=gr},pr.prototype.getMinimumRowHeight=function(gr,vr){var Cr=this;return gr.reduce(function(Tr,Fr){var _r=Cr.cells[Fr.index];if(!_r)return 0;var Ar=vr.getLineHeight(_r.styles.fontSize),Pr=_r.padding("vertical"),Ir=Pr+Ar;return Ir>Tr?Ir:Tr},0)},pr}();sr.Row=mr;var dr=function(){function pr(gr,vr,Cr){var Tr,Fr;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=vr,this.section=Cr,this.raw=gr;var _r=gr;gr!=null&&typeof gr=="object"&&!Array.isArray(gr)?(this.rowSpan=gr.rowSpan||1,this.colSpan=gr.colSpan||1,_r=(Fr=(Tr=gr.content)!==null&&Tr!==void 0?Tr:gr.title)!==null&&Fr!==void 0?Fr:gr,gr._element&&(this.raw=gr._element)):(this.rowSpan=1,this.colSpan=1);var Ar=_r!=null?""+_r:"",Pr=/\r\n|\r|\n/g;this.text=Ar.split(Pr)}return pr.prototype.getTextPos=function(){var gr;if(this.styles.valign==="top")gr=this.y+this.padding("top");else if(this.styles.valign==="bottom")gr=this.y+this.height-this.padding("bottom");else{var vr=this.height-this.padding("vertical");gr=this.y+vr/2+this.padding("top")}var Cr;if(this.styles.halign==="right")Cr=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var Tr=this.width-this.padding("horizontal");Cr=this.x+Tr/2+this.padding("left")}else Cr=this.x+this.padding("left");return{x:Cr,y:gr}},pr.prototype.getContentHeight=function(gr,vr){vr===void 0&&(vr=1.15);var Cr=Array.isArray(this.text)?this.text.length:1,Tr=this.styles.fontSize/gr*vr,Fr=Cr*Tr+this.padding("vertical");return Math.max(Fr,this.styles.minCellHeight)},pr.prototype.padding=function(gr){var vr=(0,fr.parseSpacing)(this.styles.cellPadding,0);return gr==="vertical"?vr.top+vr.bottom:gr==="horizontal"?vr.left+vr.right:vr[gr]},pr}();sr.Cell=dr;var xr=function(){function pr(gr,vr,Cr){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=gr,this.raw=vr,this.index=Cr}return pr.prototype.getMaxCustomCellWidth=function(gr){for(var vr=0,Cr=0,Tr=gr.allRows();Cr<Tr.length;Cr++){var Fr=Tr[Cr],_r=Fr.cells[this.index];_r&&typeof _r.styles.cellWidth=="number"&&(vr=Math.max(vr,_r.styles.cellWidth))}return vr},pr}();sr.Column=xr},356:function(ar,sr){Object.defineProperty(sr,"__esModule",{value:!0}),sr.assign=void 0;function or(lr,ur,fr,cr,mr){if(lr==null)throw new TypeError("Cannot convert undefined or null to object");for(var dr=Object(lr),xr=1;xr<arguments.length;xr++){var pr=arguments[xr];if(pr!=null)for(var gr in pr)Object.prototype.hasOwnProperty.call(pr,gr)&&(dr[gr]=pr[gr])}return dr}sr.assign=or},972:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.createTable=void 0;var lr=or(744),ur=or(260),fr=or(324),cr=or(796),mr=or(356);function dr(Fr,_r){var Ar=new lr.DocHandler(Fr),Pr=xr(_r,Ar.scaleFactor()),Ir=new ur.Table(_r,Pr);return(0,fr.calculateWidths)(Ar,Ir),Ar.applyStyles(Ar.userStyles),Ir}sr.createTable=dr;function xr(Fr,_r){var Ar=Fr.content,Pr=Cr(Ar.columns);if(Ar.head.length===0){var Ir=gr(Pr,"head");Ir&&Ar.head.push(Ir)}if(Ar.foot.length===0){var Ir=gr(Pr,"foot");Ir&&Ar.foot.push(Ir)}var wr=Fr.settings.theme,kr=Fr.styles;return{columns:Pr,head:pr("head",Ar.head,Pr,kr,wr,_r),body:pr("body",Ar.body,Pr,kr,wr,_r),foot:pr("foot",Ar.foot,Pr,kr,wr,_r)}}function pr(Fr,_r,Ar,Pr,Ir,wr){var kr={},Mr=_r.map(function(Hr,Gr){for(var zr=0,Br={},Vr=0,Rr=0,Xr=0,an=Ar;Xr<an.length;Xr++){var yr=an[Xr];if(kr[yr.index]==null||kr[yr.index].left===0)if(Rr===0){var br=void 0;Array.isArray(Hr)?br=Hr[yr.index-Vr-zr]:br=Hr[yr.dataKey];var Er={};typeof br=="object"&&!Array.isArray(br)&&(Er=(br==null?void 0:br.styles)||{});var Lr=Tr(Fr,yr,Gr,Ir,Pr,wr,Er),Or=new ur.Cell(br,Lr,Fr);Br[yr.dataKey]=Or,Br[yr.index]=Or,Rr=Or.colSpan-1,kr[yr.index]={left:Or.rowSpan-1,times:Rr}}else Rr--,Vr++;else kr[yr.index].left--,Rr=kr[yr.index].times,zr++}return new ur.Row(Hr,Gr,Fr,Br)});return Mr}function gr(Fr,_r){var Ar={};return Fr.forEach(function(Pr){if(Pr.raw!=null){var Ir=vr(_r,Pr.raw);Ir!=null&&(Ar[Pr.dataKey]=Ir)}}),Object.keys(Ar).length>0?Ar:null}function vr(Fr,_r){if(Fr==="head"){if(typeof _r=="object")return _r.header||_r.title||null;if(typeof _r=="string"||typeof _r=="number")return _r}else if(Fr==="foot"&&typeof _r=="object")return _r.footer;return null}function Cr(Fr){return Fr.map(function(_r,Ar){var Pr,Ir,wr;return typeof _r=="object"?wr=(Ir=(Pr=_r.dataKey)!==null&&Pr!==void 0?Pr:_r.key)!==null&&Ir!==void 0?Ir:Ar:wr=Ar,new ur.Column(wr,_r,Ar)})}function Tr(Fr,_r,Ar,Pr,Ir,wr,kr){var Mr=(0,cr.getTheme)(Pr),Hr;Fr==="head"?Hr=Ir.headStyles:Fr==="body"?Hr=Ir.bodyStyles:Fr==="foot"&&(Hr=Ir.footStyles);var Gr=(0,mr.assign)({},Mr.table,Mr[Fr],Ir.styles,Hr),zr=Ir.columnStyles[_r.dataKey]||Ir.columnStyles[_r.index]||{},Br=Fr==="body"?zr:{},Vr=Fr==="body"&&Ar%2===0?(0,mr.assign)({},Mr.alternateRow,Ir.alternateRowStyles):{},Rr=(0,cr.defaultStyles)(wr),Xr=(0,mr.assign)({},Rr,Gr,Vr,Br);return(0,mr.assign)(Xr,kr)}},664:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.addPage=sr.drawTable=void 0;var lr=or(420),ur=or(260),fr=or(744),cr=or(356),mr=or(136),dr=or(224);function xr(zr,Br){var Vr=Br.settings,Rr=Vr.startY,Xr=Vr.margin,an={x:Xr.left,y:Rr},yr=Br.getHeadHeight(Br.columns)+Br.getFootHeight(Br.columns),br=Rr+Xr.bottom+yr;if(Vr.pageBreak==="avoid"){var Er=Br.body,Lr=Er.reduce(function($r,Zr){return $r+Zr.height},0);br+=Lr}var Or=new fr.DocHandler(zr);(Vr.pageBreak==="always"||Vr.startY!=null&&br>Or.pageSize().height)&&(Gr(Or),an.y=Xr.top),Br.callWillDrawPageHooks(Or,an);var Ur=(0,cr.assign)({},an);Br.startPageNumber=Or.pageNumber(),Vr.horizontalPageBreak?pr(Or,Br,Ur,an):(Or.applyStyles(Or.userStyles),(Vr.showHead==="firstPage"||Vr.showHead==="everyPage")&&Br.head.forEach(function($r){return Ir(Or,Br,$r,an,Br.columns)}),Or.applyStyles(Or.userStyles),Br.body.forEach(function($r,Zr){var fn=Zr===Br.body.length-1;Pr(Or,Br,$r,fn,Ur,an,Br.columns)}),Or.applyStyles(Or.userStyles),(Vr.showFoot==="lastPage"||Vr.showFoot==="everyPage")&&Br.foot.forEach(function($r){return Ir(Or,Br,$r,an,Br.columns)})),(0,lr.addTableBorder)(Or,Br,Ur,an),Br.callEndPageHooks(Or,an),Br.finalY=an.y,zr.lastAutoTable=Br,zr.previousAutoTable=Br,zr.autoTable&&(zr.autoTable.previous=Br),Or.applyStyles(Or.userStyles)}sr.drawTable=xr;function pr(zr,Br,Vr,Rr){var Xr=(0,dr.calculateAllColumnsCanFitInPage)(zr,Br),an=Br.settings;if(an.horizontalPageBreakBehaviour==="afterAllRows")Xr.forEach(function(Lr,Or){zr.applyStyles(zr.userStyles),Or>0?Hr(zr,Br,Vr,Rr,Lr.columns,!0):gr(zr,Br,Rr,Lr.columns),vr(zr,Br,Vr,Rr,Lr.columns),Tr(zr,Br,Rr,Lr.columns)});else for(var yr=-1,br=Xr[0],Er=function(){var Lr=yr;if(br){zr.applyStyles(zr.userStyles);var Or=br.columns;yr>=0?Hr(zr,Br,Vr,Rr,Or,!0):gr(zr,Br,Rr,Or),Lr=Cr(zr,Br,yr+1,Rr,Or),Tr(zr,Br,Rr,Or)}var Ur=Lr-yr;Xr.slice(1).forEach(function($r){zr.applyStyles(zr.userStyles),Hr(zr,Br,Vr,Rr,$r.columns,!0),Cr(zr,Br,yr+1,Rr,$r.columns,Ur),Tr(zr,Br,Rr,$r.columns)}),yr=Lr};yr<Br.body.length-1;)Er()}function gr(zr,Br,Vr,Rr){var Xr=Br.settings;zr.applyStyles(zr.userStyles),(Xr.showHead==="firstPage"||Xr.showHead==="everyPage")&&Br.head.forEach(function(an){return Ir(zr,Br,an,Vr,Rr)})}function vr(zr,Br,Vr,Rr,Xr){zr.applyStyles(zr.userStyles),Br.body.forEach(function(an,yr){var br=yr===Br.body.length-1;Pr(zr,Br,an,br,Vr,Rr,Xr)})}function Cr(zr,Br,Vr,Rr,Xr,an){zr.applyStyles(zr.userStyles),an=an??Br.body.length;var yr=Math.min(Vr+an,Br.body.length),br=-1;return Br.body.slice(Vr,yr).forEach(function(Er,Lr){var Or=Vr+Lr===Br.body.length-1,Ur=Mr(zr,Br,Or,Rr);Er.canEntireRowFit(Ur,Xr)&&(Ir(zr,Br,Er,Rr,Xr),br=Vr+Lr)}),br}function Tr(zr,Br,Vr,Rr){var Xr=Br.settings;zr.applyStyles(zr.userStyles),(Xr.showFoot==="lastPage"||Xr.showFoot==="everyPage")&&Br.foot.forEach(function(an){return Ir(zr,Br,an,Vr,Rr)})}function Fr(zr,Br,Vr){var Rr=Vr.getLineHeight(zr.styles.fontSize),Xr=zr.padding("vertical"),an=Math.floor((Br-Xr)/Rr);return Math.max(0,an)}function _r(zr,Br,Vr,Rr){var Xr={};zr.spansMultiplePages=!0,zr.height=0;for(var an=0,yr=0,br=Vr.columns;yr<br.length;yr++){var Er=br[yr],Lr=zr.cells[Er.index];if(Lr){Array.isArray(Lr.text)||(Lr.text=[Lr.text]);var Or=new ur.Cell(Lr.raw,Lr.styles,Lr.section);Or=(0,cr.assign)(Or,Lr),Or.text=[];var Ur=Fr(Lr,Br,Rr);Lr.text.length>Ur&&(Or.text=Lr.text.splice(Ur,Lr.text.length));var $r=Rr.scaleFactor(),Zr=Rr.getLineHeightFactor();Lr.contentHeight=Lr.getContentHeight($r,Zr),Lr.contentHeight>=Br&&(Lr.contentHeight=Br,Or.styles.minCellHeight-=Br),Lr.contentHeight>zr.height&&(zr.height=Lr.contentHeight),Or.contentHeight=Or.getContentHeight($r,Zr),Or.contentHeight>an&&(an=Or.contentHeight),Xr[Er.index]=Or}}var fn=new ur.Row(zr.raw,-1,zr.section,Xr,!0);fn.height=an;for(var _n=0,Kr=Vr.columns;_n<Kr.length;_n++){var Er=Kr[_n],Or=fn.cells[Er.index];Or&&(Or.height=fn.height);var Lr=zr.cells[Er.index];Lr&&(Lr.height=zr.height)}return fn}function Ar(zr,Br,Vr,Rr){var Xr=zr.pageSize().height,an=Rr.settings.margin,yr=an.top+an.bottom,br=Xr-yr;Br.section==="body"&&(br-=Rr.getHeadHeight(Rr.columns)+Rr.getFootHeight(Rr.columns));var Er=Br.getMinimumRowHeight(Rr.columns,zr),Lr=Er<Vr;if(Er>br)return console.error("Will not be able to print row ".concat(Br.index," correctly since it's minimum height is larger than page height")),!0;if(!Lr)return!1;var Or=Br.hasRowSpan(Rr.columns),Ur=Br.getMaxCellHeight(Rr.columns)>br;return Ur?(Or&&console.error("The content of row ".concat(Br.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(Or||Rr.settings.rowPageBreak==="avoid")}function Pr(zr,Br,Vr,Rr,Xr,an,yr){var br=Mr(zr,Br,Rr,an);if(Vr.canEntireRowFit(br,yr))Ir(zr,Br,Vr,an,yr);else if(Ar(zr,Vr,br,Br)){var Er=_r(Vr,br,Br,zr);Ir(zr,Br,Vr,an,yr),Hr(zr,Br,Xr,an,yr),Pr(zr,Br,Er,Rr,Xr,an,yr)}else Hr(zr,Br,Xr,an,yr),Pr(zr,Br,Vr,Rr,Xr,an,yr)}function Ir(zr,Br,Vr,Rr,Xr){Rr.x=Br.settings.margin.left;for(var an=0,yr=Xr;an<yr.length;an++){var br=yr[an],Er=Vr.cells[br.index];if(!Er){Rr.x+=br.width;continue}zr.applyStyles(Er.styles),Er.x=Rr.x,Er.y=Rr.y;var Lr=Br.callCellHooks(zr,Br.hooks.willDrawCell,Er,Vr,br,Rr);if(Lr===!1){Rr.x+=br.width;continue}wr(zr,Er,Rr);var Or=Er.getTextPos();(0,mr.default)(Er.text,Or.x,Or.y,{halign:Er.styles.halign,valign:Er.styles.valign,maxWidth:Math.ceil(Er.width-Er.padding("left")-Er.padding("right"))},zr.getDocument()),Br.callCellHooks(zr,Br.hooks.didDrawCell,Er,Vr,br,Rr),Rr.x+=br.width}Rr.y+=Vr.height}function wr(zr,Br,Vr){var Rr=Br.styles;if(zr.getDocument().setFillColor(zr.getDocument().getFillColor()),typeof Rr.lineWidth=="number"){var Xr=(0,lr.getFillStyle)(Rr.lineWidth,Rr.fillColor);Xr&&zr.rect(Br.x,Vr.y,Br.width,Br.height,Xr)}else typeof Rr.lineWidth=="object"&&(Rr.fillColor&&zr.rect(Br.x,Vr.y,Br.width,Br.height,"F"),kr(zr,Br,Vr,Rr.lineWidth))}function kr(zr,Br,Vr,Rr){var Xr,an,yr,br;Rr.top&&(Xr=Vr.x,an=Vr.y,yr=Vr.x+Br.width,br=Vr.y,Rr.right&&(yr+=.5*Rr.right),Rr.left&&(Xr-=.5*Rr.left),Er(Rr.top,Xr,an,yr,br)),Rr.bottom&&(Xr=Vr.x,an=Vr.y+Br.height,yr=Vr.x+Br.width,br=Vr.y+Br.height,Rr.right&&(yr+=.5*Rr.right),Rr.left&&(Xr-=.5*Rr.left),Er(Rr.bottom,Xr,an,yr,br)),Rr.left&&(Xr=Vr.x,an=Vr.y,yr=Vr.x,br=Vr.y+Br.height,Rr.top&&(an-=.5*Rr.top),Rr.bottom&&(br+=.5*Rr.bottom),Er(Rr.left,Xr,an,yr,br)),Rr.right&&(Xr=Vr.x+Br.width,an=Vr.y,yr=Vr.x+Br.width,br=Vr.y+Br.height,Rr.top&&(an-=.5*Rr.top),Rr.bottom&&(br+=.5*Rr.bottom),Er(Rr.right,Xr,an,yr,br));function Er(Lr,Or,Ur,$r,Zr){zr.getDocument().setLineWidth(Lr),zr.getDocument().line(Or,Ur,$r,Zr,"S")}}function Mr(zr,Br,Vr,Rr){var Xr=Br.settings.margin.bottom,an=Br.settings.showFoot;return(an==="everyPage"||an==="lastPage"&&Vr)&&(Xr+=Br.getFootHeight(Br.columns)),zr.pageSize().height-Rr.y-Xr}function Hr(zr,Br,Vr,Rr,Xr,an){Xr===void 0&&(Xr=[]),an===void 0&&(an=!1),zr.applyStyles(zr.userStyles),Br.settings.showFoot==="everyPage"&&!an&&Br.foot.forEach(function(br){return Ir(zr,Br,br,Rr,Xr)}),Br.callEndPageHooks(zr,Rr);var yr=Br.settings.margin;(0,lr.addTableBorder)(zr,Br,Vr,Rr),Gr(zr),Br.pageNumber++,Br.pageCount++,Rr.x=yr.left,Rr.y=yr.top,Vr.y=yr.top,Br.callWillDrawPageHooks(zr,Rr),Br.settings.showHead==="everyPage"&&(Br.head.forEach(function(br){return Ir(zr,Br,br,Rr,Xr)}),zr.applyStyles(zr.userStyles))}sr.addPage=Hr;function Gr(zr){var Br=zr.pageNumber();zr.setPage(Br+1);var Vr=zr.pageNumber();return Vr===Br?(zr.addPage(),!0):!1}},224:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.calculateAllColumnsCanFitInPage=void 0;var lr=or(420);function ur(cr,mr,dr){var xr;dr===void 0&&(dr={});var pr=(0,lr.getPageAvailableWidth)(cr,mr),gr=new Map,vr=[],Cr=[],Tr=[];mr.settings.horizontalPageBreakRepeat,Array.isArray(mr.settings.horizontalPageBreakRepeat)?Tr=mr.settings.horizontalPageBreakRepeat:(typeof mr.settings.horizontalPageBreakRepeat=="string"||typeof mr.settings.horizontalPageBreakRepeat=="number")&&(Tr=[mr.settings.horizontalPageBreakRepeat]),Tr.forEach(function(Pr){var Ir=mr.columns.find(function(wr){return wr.dataKey===Pr||wr.index===Pr});Ir&&!gr.has(Ir.index)&&(gr.set(Ir.index,!0),vr.push(Ir.index),Cr.push(mr.columns[Ir.index]),pr-=Ir.wrappedWidth)});for(var Fr=!0,_r=(xr=dr==null?void 0:dr.start)!==null&&xr!==void 0?xr:0;_r<mr.columns.length;){if(gr.has(_r)){_r++;continue}var Ar=mr.columns[_r].wrappedWidth;if(Fr||pr>=Ar)Fr=!1,vr.push(_r),Cr.push(mr.columns[_r]),pr-=Ar;else break;_r++}return{colIndexes:vr,columns:Cr,lastIndex:_r-1}}function fr(cr,mr){for(var dr=[],xr=0;xr<mr.columns.length;xr++){var pr=ur(cr,mr,{start:xr});pr.columns.length&&(dr.push(pr),xr=pr.lastIndex)}return dr}sr.calculateAllColumnsCanFitInPage=fr},324:function(ar,sr,or){Object.defineProperty(sr,"__esModule",{value:!0}),sr.ellipsize=sr.resizeColumns=sr.calculateWidths=void 0;var lr=or(420);function ur(vr,Cr){fr(vr,Cr);var Tr=[],Fr=0;Cr.columns.forEach(function(Ar){var Pr=Ar.getMaxCustomCellWidth(Cr);Pr?Ar.width=Pr:(Ar.width=Ar.wrappedWidth,Tr.push(Ar)),Fr+=Ar.width});var _r=Cr.getWidth(vr.pageSize().width)-Fr;_r&&(_r=cr(Tr,_r,function(Ar){return Math.max(Ar.minReadableWidth,Ar.minWidth)})),_r&&(_r=cr(Tr,_r,function(Ar){return Ar.minWidth})),_r=Math.abs(_r),!Cr.settings.horizontalPageBreak&&_r>.1/vr.scaleFactor()&&(_r=_r<1?_r:Math.round(_r),console.warn("Of the table content, ".concat(_r," units width could not fit page"))),dr(Cr),xr(Cr,vr),mr(Cr)}sr.calculateWidths=ur;function fr(vr,Cr){var Tr=vr.scaleFactor(),Fr=Cr.settings.horizontalPageBreak,_r=(0,lr.getPageAvailableWidth)(vr,Cr);Cr.allRows().forEach(function(Ar){for(var Pr=0,Ir=Cr.columns;Pr<Ir.length;Pr++){var wr=Ir[Pr],kr=Ar.cells[wr.index];if(kr){var Mr=Cr.hooks.didParseCell;Cr.callCellHooks(vr,Mr,kr,Ar,wr,null);var Hr=kr.padding("horizontal");kr.contentWidth=(0,lr.getStringWidth)(kr.text,kr.styles,vr)+Hr;var Gr=(0,lr.getStringWidth)(kr.text.join(" ").split(/[^\S\u00A0]+/),kr.styles,vr);if(kr.minReadableWidth=Gr+kr.padding("horizontal"),typeof kr.styles.cellWidth=="number")kr.minWidth=kr.styles.cellWidth,kr.wrappedWidth=kr.styles.cellWidth;else if(kr.styles.cellWidth==="wrap"||Fr===!0)kr.contentWidth>_r?(kr.minWidth=_r,kr.wrappedWidth=_r):(kr.minWidth=kr.contentWidth,kr.wrappedWidth=kr.contentWidth);else{var zr=10/Tr;kr.minWidth=kr.styles.minCellWidth||zr,kr.wrappedWidth=kr.contentWidth,kr.minWidth>kr.wrappedWidth&&(kr.wrappedWidth=kr.minWidth)}}}}),Cr.allRows().forEach(function(Ar){for(var Pr=0,Ir=Cr.columns;Pr<Ir.length;Pr++){var wr=Ir[Pr],kr=Ar.cells[wr.index];if(kr&&kr.colSpan===1)wr.wrappedWidth=Math.max(wr.wrappedWidth,kr.wrappedWidth),wr.minWidth=Math.max(wr.minWidth,kr.minWidth),wr.minReadableWidth=Math.max(wr.minReadableWidth,kr.minReadableWidth);else{var Mr=Cr.styles.columnStyles[wr.dataKey]||Cr.styles.columnStyles[wr.index]||{},Hr=Mr.cellWidth||Mr.minCellWidth;Hr&&typeof Hr=="number"&&(wr.minWidth=Hr,wr.wrappedWidth=Hr)}kr&&(kr.colSpan>1&&!wr.minWidth&&(wr.minWidth=kr.minWidth),kr.colSpan>1&&!wr.wrappedWidth&&(wr.wrappedWidth=kr.minWidth))}})}function cr(vr,Cr,Tr){for(var Fr=Cr,_r=vr.reduce(function(zr,Br){return zr+Br.wrappedWidth},0),Ar=0;Ar<vr.length;Ar++){var Pr=vr[Ar],Ir=Pr.wrappedWidth/_r,wr=Fr*Ir,kr=Pr.width+wr,Mr=Tr(Pr),Hr=kr<Mr?Mr:kr;Cr-=Hr-Pr.width,Pr.width=Hr}if(Cr=Math.round(Cr*1e10)/1e10,Cr){var Gr=vr.filter(function(zr){return Cr<0?zr.width>Tr(zr):!0});Gr.length&&(Cr=cr(Gr,Cr,Tr))}return Cr}sr.resizeColumns=cr;function mr(vr){for(var Cr={},Tr=1,Fr=vr.allRows(),_r=0;_r<Fr.length;_r++)for(var Ar=Fr[_r],Pr=0,Ir=vr.columns;Pr<Ir.length;Pr++){var wr=Ir[Pr],kr=Cr[wr.index];if(Tr>1)Tr--,delete Ar.cells[wr.index];else if(kr)kr.cell.height+=Ar.height,Tr=kr.cell.colSpan,delete Ar.cells[wr.index],kr.left--,kr.left<=1&&delete Cr[wr.index];else{var Mr=Ar.cells[wr.index];if(!Mr)continue;if(Mr.height=Ar.height,Mr.rowSpan>1){var Hr=Fr.length-_r,Gr=Mr.rowSpan>Hr?Hr:Mr.rowSpan;Cr[wr.index]={cell:Mr,left:Gr,row:Ar}}}}}function dr(vr){for(var Cr=vr.allRows(),Tr=0;Tr<Cr.length;Tr++)for(var Fr=Cr[Tr],_r=null,Ar=0,Pr=0,Ir=0;Ir<vr.columns.length;Ir++){var wr=vr.columns[Ir];if(Pr-=1,Pr>1&&vr.columns[Ir+1])Ar+=wr.width,delete Fr.cells[wr.index];else if(_r){var kr=_r;delete Fr.cells[wr.index],_r=null,kr.width=wr.width+Ar}else{var kr=Fr.cells[wr.index];if(!kr)continue;if(Pr=kr.colSpan,Ar=0,kr.colSpan>1){_r=kr,Ar+=wr.width;continue}kr.width=wr.width+Ar}}}function xr(vr,Cr){for(var Tr={count:0,height:0},Fr=0,_r=vr.allRows();Fr<_r.length;Fr++){for(var Ar=_r[Fr],Pr=0,Ir=vr.columns;Pr<Ir.length;Pr++){var wr=Ir[Pr],kr=Ar.cells[wr.index];if(kr){Cr.applyStyles(kr.styles,!0);var Mr=kr.width-kr.padding("horizontal");if(kr.styles.overflow==="linebreak")kr.text=Cr.splitTextToSize(kr.text,Mr+1/Cr.scaleFactor(),{fontSize:kr.styles.fontSize});else if(kr.styles.overflow==="ellipsize")kr.text=pr(kr.text,Mr,kr.styles,Cr,"...");else if(kr.styles.overflow==="hidden")kr.text=pr(kr.text,Mr,kr.styles,Cr,"");else if(typeof kr.styles.overflow=="function"){var Hr=kr.styles.overflow(kr.text,Mr);typeof Hr=="string"?kr.text=[Hr]:kr.text=Hr}kr.contentHeight=kr.getContentHeight(Cr.scaleFactor(),Cr.getLineHeightFactor());var Gr=kr.contentHeight/kr.rowSpan;kr.rowSpan>1&&Tr.count*Tr.height<Gr*kr.rowSpan?Tr={height:Gr,count:kr.rowSpan}:Tr&&Tr.count>0&&Tr.height>Gr&&(Gr=Tr.height),Gr>Ar.height&&(Ar.height=Gr)}}Tr.count--}}function pr(vr,Cr,Tr,Fr,_r){return vr.map(function(Ar){return gr(Ar,Cr,Tr,Fr,_r)})}sr.ellipsize=pr;function gr(vr,Cr,Tr,Fr,_r){var Ar=1e4*Fr.scaleFactor();if(Cr=Math.ceil(Cr*Ar)/Ar,Cr>=(0,lr.getStringWidth)(vr,Tr,Fr))return vr;for(;Cr<(0,lr.getStringWidth)(vr+_r,Tr,Fr)&&!(vr.length<=1);)vr=vr.substring(0,vr.length-1);return vr.trim()+_r}},964:function(ar){if(typeof er>"u"){var sr=new Error("Cannot find module 'undefined'");throw sr.code="MODULE_NOT_FOUND",sr}ar.exports=er}},rr={};function nr(ar){var sr=rr[ar];if(sr!==void 0)return sr.exports;var or=rr[ar]={exports:{}};return tr[ar].call(or.exports,or,or.exports,nr),or.exports}var ir={};return function(){var ar=ir;Object.defineProperty(ar,"__esModule",{value:!0}),ar.Cell=ar.Column=ar.Row=ar.Table=ar.CellHookData=ar.__drawTable=ar.__createTable=ar.applyPlugin=void 0;var sr=nr(340),or=nr(776),lr=nr(664),ur=nr(972),fr=nr(260);Object.defineProperty(ar,"Table",{enumerable:!0,get:function(){return fr.Table}});var cr=nr(172);Object.defineProperty(ar,"CellHookData",{enumerable:!0,get:function(){return cr.CellHookData}});var mr=nr(260);Object.defineProperty(ar,"Cell",{enumerable:!0,get:function(){return mr.Cell}}),Object.defineProperty(ar,"Column",{enumerable:!0,get:function(){return mr.Column}}),Object.defineProperty(ar,"Row",{enumerable:!0,get:function(){return mr.Row}});function dr(Cr){(0,sr.default)(Cr)}ar.applyPlugin=dr;function xr(Cr,Tr){var Fr=(0,or.parseInput)(Cr,Tr),_r=(0,ur.createTable)(Cr,Fr);(0,lr.drawTable)(Cr,_r)}function pr(Cr,Tr){var Fr=(0,or.parseInput)(Cr,Tr);return(0,ur.createTable)(Cr,Fr)}ar.__createTable=pr;function gr(Cr,Tr){(0,lr.drawTable)(Cr,Tr)}ar.__drawTable=gr;try{var vr=nr(964);vr.jsPDF&&(vr=vr.jsPDF),dr(vr)}catch{}ar.default=xr}(),ir}()})})(jspdf_plugin_autotable);var jspdf_plugin_autotableExports=jspdf_plugin_autotable.exports;const autoTable=getDefaultExportFromCjs(jspdf_plugin_autotableExports);function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(_e,er){module.exports=_e.pdfjsLib=er()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,_e)=>{var Ps;Object.defineProperty(_e,"__esModule",{value:!0}),_e.VerbosityLevel=_e.Util=_e.UnknownErrorException=_e.UnexpectedResponseException=_e.TextRenderingMode=_e.RenderingIntentFlag=_e.PromiseCapability=_e.PermissionFlag=_e.PasswordResponses=_e.PasswordException=_e.PageActionEventType=_e.OPS=_e.MissingPDFException=_e.MAX_IMAGE_SIZE_TO_CACHE=_e.LINE_FACTOR=_e.LINE_DESCENT_FACTOR=_e.InvalidPDFException=_e.ImageKind=_e.IDENTITY_MATRIX=_e.FormatError=_e.FeatureTest=_e.FONT_IDENTITY_MATRIX=_e.DocumentActionEventType=_e.CMapCompressionType=_e.BaseException=_e.BASELINE_FACTOR=_e.AnnotationType=_e.AnnotationReplyType=_e.AnnotationPrefix=_e.AnnotationMode=_e.AnnotationFlag=_e.AnnotationFieldFlag=_e.AnnotationEditorType=_e.AnnotationEditorPrefix=_e.AnnotationEditorParamsType=_e.AnnotationBorderStyleType=_e.AnnotationActionEventType=_e.AbortException=void 0,_e.assert=Rr,_e.bytesToString=_n,_e.createValidAbsoluteUrl=an,_e.getModificationDate=Qn,_e.getUuid=ws,_e.getVerbosityLevel=Gr,_e.info=zr,_e.isArrayBuffer=En,_e.isArrayEqual=ba,_e.isNodeJS=void 0,_e.normalizeUnicode=Xn,_e.objectFromMap=wn,_e.objectSize=Dn,_e.setVerbosityLevel=Hr,_e.shadow=yr,_e.string32=Cn,_e.stringToBytes=Kr,_e.stringToPDFString=Ln,_e.stringToUTF8String=Wn,_e.unreachable=Vr,_e.utf8StringToString=$n,_e.warn=Br;const er=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");_e.isNodeJS=er;const tr=[1,0,0,1,0,0];_e.IDENTITY_MATRIX=tr;const rr=[.001,0,0,.001,0,0];_e.FONT_IDENTITY_MATRIX=rr;const nr=1e7;_e.MAX_IMAGE_SIZE_TO_CACHE=nr;const ir=1.35;_e.LINE_FACTOR=ir;const ar=.35;_e.LINE_DESCENT_FACTOR=ar;const sr=ar/ir;_e.BASELINE_FACTOR=sr;const or={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};_e.RenderingIntentFlag=or;const lr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};_e.AnnotationMode=lr;const ur="pdfjs_internal_editor_";_e.AnnotationEditorPrefix=ur;const fr={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};_e.AnnotationEditorType=fr;const cr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};_e.AnnotationEditorParamsType=cr;const mr={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};_e.PermissionFlag=mr;const dr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};_e.TextRenderingMode=dr;const xr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};_e.ImageKind=xr;const pr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};_e.AnnotationType=pr;const gr={GROUP:"Group",REPLY:"R"};_e.AnnotationReplyType=gr;const vr={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};_e.AnnotationFlag=vr;const Cr={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};_e.AnnotationFieldFlag=Cr;const Tr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};_e.AnnotationBorderStyleType=Tr;const Fr={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};_e.AnnotationActionEventType=Fr;const _r={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};_e.DocumentActionEventType=_r;const Ar={O:"PageOpen",C:"PageClose"};_e.PageActionEventType=Ar;const Pr={ERRORS:0,WARNINGS:1,INFOS:5};_e.VerbosityLevel=Pr;const Ir={NONE:0,BINARY:1};_e.CMapCompressionType=Ir;const wr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};_e.OPS=wr;const kr={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};_e.PasswordResponses=kr;let Mr=Pr.WARNINGS;function Hr(Zn){Number.isInteger(Zn)&&(Mr=Zn)}function Gr(){return Mr}function zr(Zn){Mr>=Pr.INFOS&&console.log(`Info: ${Zn}`)}function Br(Zn){Mr>=Pr.WARNINGS&&console.log(`Warning: ${Zn}`)}function Vr(Zn){throw new Error(Zn)}function Rr(Zn,Mn){Zn||Vr(Mn)}function Xr(Zn){switch(Zn==null?void 0:Zn.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function an(Zn,Mn=null,zn=null){if(!Zn)return null;try{if(zn&&typeof Zn=="string"){if(zn.addDefaultProtocol&&Zn.startsWith("www.")){const Ls=Zn.match(/\./g);(Ls==null?void 0:Ls.length)>=2&&(Zn=`http://${Zn}`)}if(zn.tryConvertEncoding)try{Zn=Wn(Zn)}catch{}}const cs=Mn?new URL(Zn,Mn):new URL(Zn);if(Xr(cs))return cs}catch{}return null}function yr(Zn,Mn,zn,cs=!1){return Object.defineProperty(Zn,Mn,{value:zn,enumerable:!cs,configurable:!0,writable:!1}),zn}const br=function(){function Mn(zn,cs){this.constructor===Mn&&Vr("Cannot initialize BaseException."),this.message=zn,this.name=cs}return Mn.prototype=new Error,Mn.constructor=Mn,Mn}();_e.BaseException=br;class Er extends br{constructor(Mn,zn){super(Mn,"PasswordException"),this.code=zn}}_e.PasswordException=Er;class Lr extends br{constructor(Mn,zn){super(Mn,"UnknownErrorException"),this.details=zn}}_e.UnknownErrorException=Lr;class Or extends br{constructor(Mn){super(Mn,"InvalidPDFException")}}_e.InvalidPDFException=Or;class Ur extends br{constructor(Mn){super(Mn,"MissingPDFException")}}_e.MissingPDFException=Ur;class $r extends br{constructor(Mn,zn){super(Mn,"UnexpectedResponseException"),this.status=zn}}_e.UnexpectedResponseException=$r;class Zr extends br{constructor(Mn){super(Mn,"FormatError")}}_e.FormatError=Zr;class fn extends br{constructor(Mn){super(Mn,"AbortException")}}_e.AbortException=fn;function _n(Zn){(typeof Zn!="object"||(Zn==null?void 0:Zn.length)===void 0)&&Vr("Invalid argument for bytesToString");const Mn=Zn.length,zn=8192;if(Mn<zn)return String.fromCharCode.apply(null,Zn);const cs=[];for(let Ls=0;Ls<Mn;Ls+=zn){const As=Math.min(Ls+zn,Mn),yn=Zn.subarray(Ls,As);cs.push(String.fromCharCode.apply(null,yn))}return cs.join("")}function Kr(Zn){typeof Zn!="string"&&Vr("Invalid argument for stringToBytes");const Mn=Zn.length,zn=new Uint8Array(Mn);for(let cs=0;cs<Mn;++cs)zn[cs]=Zn.charCodeAt(cs)&255;return zn}function Cn(Zn){return String.fromCharCode(Zn>>24&255,Zn>>16&255,Zn>>8&255,Zn&255)}function Dn(Zn){return Object.keys(Zn).length}function wn(Zn){const Mn=Object.create(null);for(const[zn,cs]of Zn)Mn[zn]=cs;return Mn}function Qr(){const Zn=new Uint8Array(4);return Zn[0]=1,new Uint32Array(Zn.buffer,0,1)[0]===1}function xn(){try{return new Function(""),!0}catch{return!1}}class tn{static get isLittleEndian(){return yr(this,"isLittleEndian",Qr())}static get isEvalSupported(){return yr(this,"isEvalSupported",xn())}static get isOffscreenCanvasSupported(){return yr(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?yr(this,"platform",{isWin:!1,isMac:!1}):yr(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Mn,zn;return yr(this,"isCSSRoundSupported",(zn=(Mn=globalThis.CSS)==null?void 0:Mn.supports)==null?void 0:zn.call(Mn,"width: round(1.5px, 1px)"))}}_e.FeatureTest=tn;const on=[...Array(256).keys()].map(Zn=>Zn.toString(16).padStart(2,"0"));class vn{static makeHexColor(Mn,zn,cs){return`#${on[Mn]}${on[zn]}${on[cs]}`}static scaleMinMax(Mn,zn){let cs;Mn[0]?(Mn[0]<0&&(cs=zn[0],zn[0]=zn[1],zn[1]=cs),zn[0]*=Mn[0],zn[1]*=Mn[0],Mn[3]<0&&(cs=zn[2],zn[2]=zn[3],zn[3]=cs),zn[2]*=Mn[3],zn[3]*=Mn[3]):(cs=zn[0],zn[0]=zn[2],zn[2]=cs,cs=zn[1],zn[1]=zn[3],zn[3]=cs,Mn[1]<0&&(cs=zn[2],zn[2]=zn[3],zn[3]=cs),zn[2]*=Mn[1],zn[3]*=Mn[1],Mn[2]<0&&(cs=zn[0],zn[0]=zn[1],zn[1]=cs),zn[0]*=Mn[2],zn[1]*=Mn[2]),zn[0]+=Mn[4],zn[1]+=Mn[4],zn[2]+=Mn[5],zn[3]+=Mn[5]}static transform(Mn,zn){return[Mn[0]*zn[0]+Mn[2]*zn[1],Mn[1]*zn[0]+Mn[3]*zn[1],Mn[0]*zn[2]+Mn[2]*zn[3],Mn[1]*zn[2]+Mn[3]*zn[3],Mn[0]*zn[4]+Mn[2]*zn[5]+Mn[4],Mn[1]*zn[4]+Mn[3]*zn[5]+Mn[5]]}static applyTransform(Mn,zn){const cs=Mn[0]*zn[0]+Mn[1]*zn[2]+zn[4],Ls=Mn[0]*zn[1]+Mn[1]*zn[3]+zn[5];return[cs,Ls]}static applyInverseTransform(Mn,zn){const cs=zn[0]*zn[3]-zn[1]*zn[2],Ls=(Mn[0]*zn[3]-Mn[1]*zn[2]+zn[2]*zn[5]-zn[4]*zn[3])/cs,As=(-Mn[0]*zn[1]+Mn[1]*zn[0]+zn[4]*zn[1]-zn[5]*zn[0])/cs;return[Ls,As]}static getAxialAlignedBoundingBox(Mn,zn){const cs=this.applyTransform(Mn,zn),Ls=this.applyTransform(Mn.slice(2,4),zn),As=this.applyTransform([Mn[0],Mn[3]],zn),yn=this.applyTransform([Mn[2],Mn[1]],zn);return[Math.min(cs[0],Ls[0],As[0],yn[0]),Math.min(cs[1],Ls[1],As[1],yn[1]),Math.max(cs[0],Ls[0],As[0],yn[0]),Math.max(cs[1],Ls[1],As[1],yn[1])]}static inverseTransform(Mn){const zn=Mn[0]*Mn[3]-Mn[1]*Mn[2];return[Mn[3]/zn,-Mn[1]/zn,-Mn[2]/zn,Mn[0]/zn,(Mn[2]*Mn[5]-Mn[4]*Mn[3])/zn,(Mn[4]*Mn[1]-Mn[5]*Mn[0])/zn]}static singularValueDecompose2dScale(Mn){const zn=[Mn[0],Mn[2],Mn[1],Mn[3]],cs=Mn[0]*zn[0]+Mn[1]*zn[2],Ls=Mn[0]*zn[1]+Mn[1]*zn[3],As=Mn[2]*zn[0]+Mn[3]*zn[2],yn=Mn[2]*zn[1]+Mn[3]*zn[3],_i=(cs+yn)/2,rs=Math.sqrt((cs+yn)**2-4*(cs*yn-As*Ls))/2,os=_i+rs||1,ms=_i-rs||1;return[Math.sqrt(os),Math.sqrt(ms)]}static normalizeRect(Mn){const zn=Mn.slice(0);return Mn[0]>Mn[2]&&(zn[0]=Mn[2],zn[2]=Mn[0]),Mn[1]>Mn[3]&&(zn[1]=Mn[3],zn[3]=Mn[1]),zn}static intersect(Mn,zn){const cs=Math.max(Math.min(Mn[0],Mn[2]),Math.min(zn[0],zn[2])),Ls=Math.min(Math.max(Mn[0],Mn[2]),Math.max(zn[0],zn[2]));if(cs>Ls)return null;const As=Math.max(Math.min(Mn[1],Mn[3]),Math.min(zn[1],zn[3])),yn=Math.min(Math.max(Mn[1],Mn[3]),Math.max(zn[1],zn[3]));return As>yn?null:[cs,As,Ls,yn]}static bezierBoundingBox(Mn,zn,cs,Ls,As,yn,_i,rs){const os=[],ms=[[],[]];let bs,gn,pn,Pn,Rn,Yn,xa,$a;for(let Yr=0;Yr<2;++Yr){if(Yr===0?(gn=6*Mn-12*cs+6*As,bs=-3*Mn+9*cs-9*As+3*_i,pn=3*cs-3*Mn):(gn=6*zn-12*Ls+6*yn,bs=-3*zn+9*Ls-9*yn+3*rs,pn=3*Ls-3*zn),Math.abs(bs)<1e-12){if(Math.abs(gn)<1e-12)continue;Pn=-pn/gn,0<Pn&&Pn<1&&os.push(Pn);continue}xa=gn*gn-4*pn*bs,$a=Math.sqrt(xa),!(xa<0)&&(Rn=(-gn+$a)/(2*bs),0<Rn&&Rn<1&&os.push(Rn),Yn=(-gn-$a)/(2*bs),0<Yn&&Yn<1&&os.push(Yn))}let ys=os.length,xs;const Jr=ys;for(;ys--;)Pn=os[ys],xs=1-Pn,ms[0][ys]=xs*xs*xs*Mn+3*xs*xs*Pn*cs+3*xs*Pn*Pn*As+Pn*Pn*Pn*_i,ms[1][ys]=xs*xs*xs*zn+3*xs*xs*Pn*Ls+3*xs*Pn*Pn*yn+Pn*Pn*Pn*rs;return ms[0][Jr]=Mn,ms[1][Jr]=zn,ms[0][Jr+1]=_i,ms[1][Jr+1]=rs,ms[0].length=ms[1].length=Jr+2,[Math.min(...ms[0]),Math.min(...ms[1]),Math.max(...ms[0]),Math.max(...ms[1])]}}_e.Util=vn;const Sn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ln(Zn){if(Zn[0]>=""){let zn;if(Zn[0]===""&&Zn[1]===""?zn="utf-16be":Zn[0]===""&&Zn[1]===""?zn="utf-16le":Zn[0]===""&&Zn[1]===""&&Zn[2]===""&&(zn="utf-8"),zn)try{const cs=new TextDecoder(zn,{fatal:!0}),Ls=Kr(Zn);return cs.decode(Ls)}catch(cs){Br(`stringToPDFString: "${cs}".`)}}const Mn=[];for(let zn=0,cs=Zn.length;zn<cs;zn++){const Ls=Sn[Zn.charCodeAt(zn)];Mn.push(Ls?String.fromCharCode(Ls):Zn.charAt(zn))}return Mn.join("")}function Wn(Zn){return decodeURIComponent(escape(Zn))}function $n(Zn){return unescape(encodeURIComponent(Zn))}function En(Zn){return typeof Zn=="object"&&(Zn==null?void 0:Zn.byteLength)!==void 0}function ba(Zn,Mn){if(Zn.length!==Mn.length)return!1;for(let zn=0,cs=Zn.length;zn<cs;zn++)if(Zn[zn]!==Mn[zn])return!1;return!0}function Qn(Zn=new Date){return[Zn.getUTCFullYear().toString(),(Zn.getUTCMonth()+1).toString().padStart(2,"0"),Zn.getUTCDate().toString().padStart(2,"0"),Zn.getUTCHours().toString().padStart(2,"0"),Zn.getUTCMinutes().toString().padStart(2,"0"),Zn.getUTCSeconds().toString().padStart(2,"0")].join("")}class vs{constructor(){Vn(this,Ps,!1);this.promise=new Promise((Mn,zn)=>{this.resolve=cs=>{Gn(this,Ps,!0),Mn(cs)},this.reject=cs=>{Gn(this,Ps,!0),zn(cs)}})}get settled(){return jr(this,Ps)}}Ps=new WeakMap,_e.PromiseCapability=vs;let es=null,ls=null;function Xn(Zn){return es||(es=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ls=new Map([["","t"]])),Zn.replaceAll(es,(Mn,zn,cs)=>zn?zn.normalize("NFKC"):ls.get(cs))}function ws(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Zn=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Zn);else for(let Mn=0;Mn<32;Mn++)Zn[Mn]=Math.floor(Math.random()*255);return _n(Zn)}const ds="pdfjs_internal_id_";_e.AnnotationPrefix=ds},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var e,er,tr,rr,wu,q0,ar,sr,or,lr,ur,fr,cr,mr,dr,G0,pr,gr,$p,Cr,Tr;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_r){if(typeof _r=="string"||_r instanceof URL?_r={url:_r}:(0,_util.isArrayBuffer)(_r)&&(_r={data:_r}),typeof _r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_r.url&&!_r.data&&!_r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const Ar=new PDFDocumentLoadingTask,{docId:Pr}=Ar,Ir=_r.url?getUrlProp(_r.url):null,wr=_r.data?getDataProp(_r.data):null,kr=_r.httpHeaders||null,Mr=_r.withCredentials===!0,Hr=_r.password??null,Gr=_r.range instanceof PDFDataRangeTransport?_r.range:null,zr=Number.isInteger(_r.rangeChunkSize)&&_r.rangeChunkSize>0?_r.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Br=_r.worker instanceof PDFWorker?_r.worker:null;const Vr=_r.verbosity,Rr=typeof _r.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_r.docBaseUrl)?_r.docBaseUrl:null,Xr=typeof _r.cMapUrl=="string"?_r.cMapUrl:null,an=_r.cMapPacked!==!1,yr=_r.CMapReaderFactory||DefaultCMapReaderFactory,br=typeof _r.standardFontDataUrl=="string"?_r.standardFontDataUrl:null,Er=_r.StandardFontDataFactory||DefaultStandardFontDataFactory,Lr=_r.stopAtErrors!==!0,Or=Number.isInteger(_r.maxImageSize)&&_r.maxImageSize>-1?_r.maxImageSize:-1,Ur=_r.isEvalSupported!==!1,$r=typeof _r.isOffscreenCanvasSupported=="boolean"?_r.isOffscreenCanvasSupported:!_util.isNodeJS,Zr=Number.isInteger(_r.canvasMaxAreaInBytes)?_r.canvasMaxAreaInBytes:-1,fn=typeof _r.disableFontFace=="boolean"?_r.disableFontFace:_util.isNodeJS,_n=_r.fontExtraProperties===!0,Kr=_r.enableXfa===!0,Cn=_r.ownerDocument||globalThis.document,Dn=_r.disableRange===!0,wn=_r.disableStream===!0,Qr=_r.disableAutoFetch===!0,xn=_r.pdfBug===!0,tn=Gr?Gr.length:_r.length??NaN,on=typeof _r.useSystemFonts=="boolean"?_r.useSystemFonts:!_util.isNodeJS&&!fn,vn=typeof _r.useWorkerFetch=="boolean"?_r.useWorkerFetch:yr===_display_utils.DOMCMapReaderFactory&&Er===_display_utils.DOMStandardFontDataFactory&&Xr&&br&&(0,_display_utils.isValidFetchUrl)(Xr,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(br,document.baseURI),Sn=_r.canvasFactory||new DefaultCanvasFactory({ownerDocument:Cn}),Ln=_r.filterFactory||new DefaultFilterFactory({docId:Pr,ownerDocument:Cn}),Wn=null;(0,_util.setVerbosityLevel)(Vr);const $n={canvasFactory:Sn,filterFactory:Ln};if(vn||($n.cMapReaderFactory=new yr({baseUrl:Xr,isCompressed:an}),$n.standardFontDataFactory=new Er({baseUrl:br})),!Br){const Qn={verbosity:Vr,port:_worker_options.GlobalWorkerOptions.workerPort};Br=Qn.port?PDFWorker.fromPort(Qn):new PDFWorker(Qn),Ar._worker=Br}const En={docId:Pr,apiVersion:"3.11.174",data:wr,password:Hr,disableAutoFetch:Qr,rangeChunkSize:zr,length:tn,docBaseUrl:Rr,enableXfa:Kr,evaluatorOptions:{maxImageSize:Or,disableFontFace:fn,ignoreErrors:Lr,isEvalSupported:Ur,isOffscreenCanvasSupported:$r,canvasMaxAreaInBytes:Zr,fontExtraProperties:_n,useSystemFonts:on,cMapUrl:vn?Xr:null,standardFontDataUrl:vn?br:null}},ba={ignoreErrors:Lr,isEvalSupported:Ur,disableFontFace:fn,fontExtraProperties:_n,enableXfa:Kr,ownerDocument:Cn,disableAutoFetch:Qr,pdfBug:xn,styleElement:Wn};return Br.promise.then(function(){if(Ar.destroyed)throw new Error("Loading aborted");const Qn=_fetchDocument(Br,En),vs=new Promise(function(es){let ls;Gr?ls=new _transport_stream.PDFDataTransportStream({length:tn,initialData:Gr.initialData,progressiveDone:Gr.progressiveDone,contentDispositionFilename:Gr.contentDispositionFilename,disableRange:Dn,disableStream:wn},Gr):wr||(ls=(ws=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ws):(0,_display_utils.isValidFetchUrl)(ws.url)?new _displayFetch_stream.PDFFetchStream(ws):new _displayNetwork.PDFNetworkStream(ws))({url:Ir,length:tn,httpHeaders:kr,withCredentials:Mr,rangeChunkSize:zr,disableRange:Dn,disableStream:wn})),es(ls)});return Promise.all([Qn,vs]).then(function([es,ls]){if(Ar.destroyed)throw new Error("Loading aborted");const Xn=new _message_handler.MessageHandler(Pr,es,Br.port),ws=new WorkerTransport(Xn,Ar,ls,ba,$n);Ar._transport=ws,Xn.send("Ready",null)})}).catch(Ar._capability.reject),Ar}async function _fetchDocument(_r,Ar){if(_r.destroyed)throw new Error("Worker was destroyed");const Pr=await _r.messageHandler.sendWithPromise("GetDocRequest",Ar,Ar.data?[Ar.data.buffer]:null);if(_r.destroyed)throw new Error("Worker was destroyed");return Pr}function getUrlProp(_r){if(_r instanceof URL)return _r.href;try{return new URL(_r,window.location).href}catch{if(_util.isNodeJS&&typeof _r=="string")return _r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_r){if(_util.isNodeJS&&typeof Buffer<"u"&&_r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_r instanceof Uint8Array&&_r.byteLength===_r.buffer.byteLength)return _r;if(typeof _r=="string")return(0,_util.stringToBytes)(_r);if(typeof _r=="object"&&!isNaN(_r==null?void 0:_r.length)||(0,_util.isArrayBuffer)(_r))return new Uint8Array(_r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const _e=class _e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${_f(_e,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var Ar,Pr,Ir;this.destroyed=!0;try{(Ar=this._worker)!=null&&Ar.port&&(this._worker._pendingDestroy=!0),await((Pr=this._transport)==null?void 0:Pr.destroy())}catch(wr){throw(Ir=this._worker)!=null&&Ir.port&&delete this._worker._pendingDestroy,wr}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,Vn(_e,e,0);let PDFDocumentLoadingTask=_e;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Ar,Pr,Ir=!1,wr=null){this.length=Ar,this.initialData=Pr,this.progressiveDone=Ir,this.contentDispositionFilename=wr,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(Ar){this._rangeListeners.push(Ar)}addProgressListener(Ar){this._progressListeners.push(Ar)}addProgressiveReadListener(Ar){this._progressiveReadListeners.push(Ar)}addProgressiveDoneListener(Ar){this._progressiveDoneListeners.push(Ar)}onDataRange(Ar,Pr){for(const Ir of this._rangeListeners)Ir(Ar,Pr)}onDataProgress(Ar,Pr){this._readyCapability.promise.then(()=>{for(const Ir of this._progressListeners)Ir(Ar,Pr)})}onDataProgressiveRead(Ar){this._readyCapability.promise.then(()=>{for(const Pr of this._progressiveReadListeners)Pr(Ar)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Ar of this._progressiveDoneListeners)Ar()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Ar,Pr){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Ar,Pr){this._pdfInfo=Ar,this._transport=Pr,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Ir=>{if(!Ir)return Ir;const wr=[];for(const kr in Ir)wr.push(...Ir[kr]);return wr}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Ar){return this._transport.getPage(Ar)}getPageIndex(Ar){return this._transport.getPageIndex(Ar)}getDestinations(){return this._transport.getDestinations()}getDestination(Ar){return this._transport.getDestination(Ar)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Ar=!1){return this._transport.startCleanup(Ar||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Ar,Pr,Ir,wr=!1){Vn(this,rr);Vn(this,er,null);Vn(this,tr,!1);this._pageIndex=Ar,this._pageInfo=Pr,this._transport=Ir,this._stats=wr?new _display_utils.StatTimer:null,this._pdfBug=wr,this.commonObjs=Ir.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Ar,rotation:Pr=this.rotate,offsetX:Ir=0,offsetY:wr=0,dontFlip:kr=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Ar,rotation:Pr,offsetX:Ir,offsetY:wr,dontFlip:kr})}getAnnotations({intent:Ar="display"}={}){const Pr=this._transport.getRenderingIntent(Ar);return this._transport.getAnnotations(this._pageIndex,Pr.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var Ar;return((Ar=this._transport._htmlForXfa)==null?void 0:Ar.children[this._pageIndex])||null}render({canvasContext:Ar,viewport:Pr,intent:Ir="display",annotationMode:wr=_util.AnnotationMode.ENABLE,transform:kr=null,background:Mr=null,optionalContentConfigPromise:Hr=null,annotationCanvasMap:Gr=null,pageColors:zr=null,printAnnotationStorage:Br=null}){var Er,Lr;(Er=this._stats)==null||Er.time("Overall");const Vr=this._transport.getRenderingIntent(Ir,wr,Br);Gn(this,tr,!1),On(this,rr,q0).call(this),Hr||(Hr=this._transport.getOptionalContentConfig());let Rr=this._intentStates.get(Vr.cacheKey);Rr||(Rr=Object.create(null),this._intentStates.set(Vr.cacheKey,Rr)),Rr.streamReaderCancelTimeout&&(clearTimeout(Rr.streamReaderCancelTimeout),Rr.streamReaderCancelTimeout=null);const Xr=!!(Vr.renderingIntent&_util.RenderingIntentFlag.PRINT);Rr.displayReadyCapability||(Rr.displayReadyCapability=new _util.PromiseCapability,Rr.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Lr=this._stats)==null||Lr.time("Page Request"),this._pumpOperatorList(Vr));const an=Or=>{var Ur,$r;Rr.renderTasks.delete(yr),(this._maybeCleanupAfterRender||Xr)&&Gn(this,tr,!0),On(this,rr,wu).call(this,!Xr),Or?(yr.capability.reject(Or),this._abortOperatorList({intentState:Rr,reason:Or instanceof Error?Or:new Error(Or)})):yr.capability.resolve(),(Ur=this._stats)==null||Ur.timeEnd("Rendering"),($r=this._stats)==null||$r.timeEnd("Overall")},yr=new InternalRenderTask({callback:an,params:{canvasContext:Ar,viewport:Pr,transform:kr,background:Mr},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Gr,operatorList:Rr.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Xr,pdfBug:this._pdfBug,pageColors:zr});(Rr.renderTasks||(Rr.renderTasks=new Set)).add(yr);const br=yr.task;return Promise.all([Rr.displayReadyCapability.promise,Hr]).then(([Or,Ur])=>{var $r;if(this.destroyed){an();return}($r=this._stats)==null||$r.time("Rendering"),yr.initializeGraphics({transparency:Or,optionalContentConfig:Ur}),yr.operatorListChanged()}).catch(an),br}getOperatorList({intent:Ar="display",annotationMode:Pr=_util.AnnotationMode.ENABLE,printAnnotationStorage:Ir=null}={}){var Gr;function wr(){Mr.operatorList.lastChunk&&(Mr.opListReadCapability.resolve(Mr.operatorList),Mr.renderTasks.delete(Hr))}const kr=this._transport.getRenderingIntent(Ar,Pr,Ir,!0);let Mr=this._intentStates.get(kr.cacheKey);Mr||(Mr=Object.create(null),this._intentStates.set(kr.cacheKey,Mr));let Hr;return Mr.opListReadCapability||(Hr=Object.create(null),Hr.operatorListChanged=wr,Mr.opListReadCapability=new _util.PromiseCapability,(Mr.renderTasks||(Mr.renderTasks=new Set)).add(Hr),Mr.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Gr=this._stats)==null||Gr.time("Page Request"),this._pumpOperatorList(kr)),Mr.opListReadCapability.promise}streamTextContent({includeMarkedContent:Ar=!1,disableNormalization:Pr=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:Ar===!0,disableNormalization:Pr===!0},{highWaterMark:100,size(wr){return wr.items.length}})}getTextContent(Ar={}){if(this._transport._htmlForXfa)return this.getXfa().then(Ir=>_xfa_text.XfaText.textContent(Ir));const Pr=this.streamTextContent(Ar);return new Promise(function(Ir,wr){function kr(){Mr.read().then(function({value:Gr,done:zr}){if(zr){Ir(Hr);return}Object.assign(Hr.styles,Gr.styles),Hr.items.push(...Gr.items),kr()},wr)}const Mr=Pr.getReader(),Hr={items:[],styles:Object.create(null)};kr()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const Ar=[];for(const Pr of this._intentStates.values())if(this._abortOperatorList({intentState:Pr,reason:new Error("Page was destroyed."),force:!0}),!Pr.opListReadCapability)for(const Ir of Pr.renderTasks)Ar.push(Ir.completed),Ir.cancel();return this.objs.clear(),Gn(this,tr,!1),On(this,rr,q0).call(this),Promise.all(Ar)}cleanup(Ar=!1){Gn(this,tr,!0);const Pr=On(this,rr,wu).call(this,!1);return Ar&&Pr&&this._stats&&(this._stats=new _display_utils.StatTimer),Pr}_startRenderPage(Ar,Pr){var wr,kr;const Ir=this._intentStates.get(Pr);Ir&&((wr=this._stats)==null||wr.timeEnd("Page Request"),(kr=Ir.displayReadyCapability)==null||kr.resolve(Ar))}_renderPageChunk(Ar,Pr){for(let Ir=0,wr=Ar.length;Ir<wr;Ir++)Pr.operatorList.fnArray.push(Ar.fnArray[Ir]),Pr.operatorList.argsArray.push(Ar.argsArray[Ir]);Pr.operatorList.lastChunk=Ar.lastChunk,Pr.operatorList.separateAnnots=Ar.separateAnnots;for(const Ir of Pr.renderTasks)Ir.operatorListChanged();Ar.lastChunk&&On(this,rr,wu).call(this,!0)}_pumpOperatorList({renderingIntent:Ar,cacheKey:Pr,annotationStorageSerializable:Ir}){const{map:wr,transfers:kr}=Ir,Hr=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Ar,cacheKey:Pr,annotationStorage:wr},kr).getReader(),Gr=this._intentStates.get(Pr);Gr.streamReader=Hr;const zr=()=>{Hr.read().then(({value:Br,done:Vr})=>{if(Vr){Gr.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Br,Gr),zr())},Br=>{if(Gr.streamReader=null,!this._transport.destroyed){if(Gr.operatorList){Gr.operatorList.lastChunk=!0;for(const Vr of Gr.renderTasks)Vr.operatorListChanged();On(this,rr,wu).call(this,!0)}if(Gr.displayReadyCapability)Gr.displayReadyCapability.reject(Br);else if(Gr.opListReadCapability)Gr.opListReadCapability.reject(Br);else throw Br}})};zr()}_abortOperatorList({intentState:Ar,reason:Pr,force:Ir=!1}){if(Ar.streamReader){if(Ar.streamReaderCancelTimeout&&(clearTimeout(Ar.streamReaderCancelTimeout),Ar.streamReaderCancelTimeout=null),!Ir){if(Ar.renderTasks.size>0)return;if(Pr instanceof _display_utils.RenderingCancelledException){let wr=RENDERING_CANCELLED_TIMEOUT;Pr.extraDelay>0&&Pr.extraDelay<1e3&&(wr+=Pr.extraDelay),Ar.streamReaderCancelTimeout=setTimeout(()=>{Ar.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:Ar,reason:Pr,force:!0})},wr);return}}if(Ar.streamReader.cancel(new _util.AbortException(Pr.message)).catch(()=>{}),Ar.streamReader=null,!this._transport.destroyed){for(const[wr,kr]of this._intentStates)if(kr===Ar){this._intentStates.delete(wr);break}this.cleanup()}}}get stats(){return this._stats}}er=new WeakMap,tr=new WeakMap,rr=new WeakSet,wu=function(Ar=!1){if(On(this,rr,q0).call(this),!jr(this,tr)||this.destroyed)return!1;if(Ar)return Gn(this,er,setTimeout(()=>{Gn(this,er,null),On(this,rr,wu).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:Pr,operatorList:Ir}of this._intentStates.values())if(Pr.size>0||!Ir.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Gn(this,tr,!1),!0},q0=function(){jr(this,er)&&(clearTimeout(jr(this,er)),Gn(this,er,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Vn(this,ar,new Set);Vn(this,sr,Promise.resolve())}postMessage(Ar,Pr){const Ir={data:structuredClone(Ar,Pr?{transfer:Pr}:null)};jr(this,sr).then(()=>{for(const wr of jr(this,ar))wr.call(this,Ir)})}addEventListener(Ar,Pr){jr(this,ar).add(Pr)}removeEventListener(Ar,Pr){jr(this,ar).delete(Pr)}terminate(){jr(this,ar).clear()}}ar=new WeakMap,sr=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _r=(or=document==null?void 0:document.currentScript)==null?void 0:or.src;_r&&(PDFWorkerUtil.fallbackWorkerSrc=_r.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_r,Ar){let Pr;try{if(Pr=new URL(_r),!Pr.origin||Pr.origin==="null")return!1}catch{return!1}const Ir=new URL(Ar,Pr);return Pr.origin===Ir.origin},PDFWorkerUtil.createCDNWrapper=function(_r){const Ar=`importScripts("${_r}");`;return URL.createObjectURL(new Blob([Ar]))}}const _PDFWorker=class _PDFWorker{constructor({name:_r=null,port:Ar=null,verbosity:Pr=(0,_util.getVerbosityLevel)()}={}){var Ir;if(this.name=_r,this.destroyed=!1,this.verbosity=Pr,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,Ar){if((Ir=jr(_PDFWorker,lr))!=null&&Ir.has(Ar))throw new Error("Cannot use more than one PDFWorker per port.");(jr(_PDFWorker,lr)||Gn(_PDFWorker,lr,new WeakMap)).set(Ar,this),this._initializeFromPort(Ar);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_r){this._port=_r,this._messageHandler=new _message_handler.MessageHandler("main","worker",_r),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_r}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_r)||(_r=PDFWorkerUtil.createCDNWrapper(new URL(_r,window.location).href));const Ar=new Worker(_r),Pr=new _message_handler.MessageHandler("main","worker",Ar),Ir=()=>{Ar.removeEventListener("error",wr),Pr.destroy(),Ar.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},wr=()=>{this._webWorker||Ir()};Ar.addEventListener("error",wr),Pr.on("test",Mr=>{if(Ar.removeEventListener("error",wr),this.destroyed){Ir();return}Mr?(this._messageHandler=Pr,this._port=Ar,this._webWorker=Ar,this._readyCapability.resolve(),Pr.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),Pr.destroy(),Ar.terminate())}),Pr.on("ready",Mr=>{if(Ar.removeEventListener("error",wr),this.destroyed){Ir();return}try{kr()}catch{this._setupFakeWorker()}});const kr=()=>{const Mr=new Uint8Array;Pr.send("test",Mr,[Mr.buffer])};kr();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_r=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Ar=new LoopbackPort;this._port=Ar;const Pr=`fake${PDFWorkerUtil.fakeWorkerId++}`,Ir=new _message_handler.MessageHandler(Pr+"_worker",Pr,Ar);_r.setup(Ir,Ar);const wr=new _message_handler.MessageHandler(Pr,Pr+"_worker",Ar);this._messageHandler=wr,this._readyCapability.resolve(),wr.send("configure",{verbosity:this.verbosity})}).catch(_r=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_r.message}".`))})}destroy(){var _r;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(_r=jr(_PDFWorker,lr))==null||_r.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_r){var Pr;if(!(_r!=null&&_r.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const Ar=(Pr=jr(this,lr))==null?void 0:Pr.get(_r.port);if(Ar){if(Ar._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return Ar}return new _PDFWorker(_r)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _r;try{return((_r=globalThis.pdfjsWorker)==null?void 0:_r.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};lr=new WeakMap,Vn(_PDFWorker,lr);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(Ar,Pr,Ir,wr,kr){Vn(this,dr);Vn(this,ur,new Map);Vn(this,fr,new Map);Vn(this,cr,new Map);Vn(this,mr,null);this.messageHandler=Ar,this.loadingTask=Pr,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:wr.ownerDocument,styleElement:wr.styleElement}),this._params=wr,this.canvasFactory=kr.canvasFactory,this.filterFactory=kr.filterFactory,this.cMapReaderFactory=kr.cMapReaderFactory,this.standardFontDataFactory=kr.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Ir,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(Ar,Pr=_util.AnnotationMode.ENABLE,Ir=null,wr=!1){let kr=_util.RenderingIntentFlag.DISPLAY,Mr=_annotation_storage.SerializableEmpty;switch(Ar){case"any":kr=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":kr=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Ar}`)}switch(Pr){case _util.AnnotationMode.DISABLE:kr+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:kr+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:kr+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Mr=(kr&_util.RenderingIntentFlag.PRINT&&Ir instanceof _annotation_storage.PrintAnnotationStorage?Ir:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${Pr}`)}return wr&&(kr+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:kr,cacheKey:`${kr}_${Mr.hash}`,annotationStorageSerializable:Mr}}destroy(){var Ir;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Ir=jr(this,mr))==null||Ir.reject(new Error("Worker was destroyed during onPassword callback"));const Ar=[];for(const wr of jr(this,fr).values())Ar.push(wr._destroy());jr(this,fr).clear(),jr(this,cr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const Pr=this.messageHandler.sendWithPromise("Terminate",null);return Ar.push(Pr),Promise.all(Ar).then(()=>{var wr;this.commonObjs.clear(),this.fontLoader.clear(),jr(this,ur).clear(),this.filterFactory.destroy(),(wr=this._networkStream)==null||wr.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Ar,loadingTask:Pr}=this;Ar.on("GetReader",(Ir,wr)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=kr=>{this._lastProgress={loaded:kr.loaded,total:kr.total}},wr.onPull=()=>{this._fullReader.read().then(function({value:kr,done:Mr}){if(Mr){wr.close();return}(0,_util.assert)(kr instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),wr.enqueue(new Uint8Array(kr),1,[kr])}).catch(kr=>{wr.error(kr)})},wr.onCancel=kr=>{this._fullReader.cancel(kr),wr.ready.catch(Mr=>{if(!this.destroyed)throw Mr})}}),Ar.on("ReaderHeadersReady",Ir=>{const wr=new _util.PromiseCapability,kr=this._fullReader;return kr.headersReady.then(()=>{var Mr;(!kr.isStreamingSupported||!kr.isRangeSupported)&&(this._lastProgress&&((Mr=Pr.onProgress)==null||Mr.call(Pr,this._lastProgress)),kr.onProgress=Hr=>{var Gr;(Gr=Pr.onProgress)==null||Gr.call(Pr,{loaded:Hr.loaded,total:Hr.total})}),wr.resolve({isStreamingSupported:kr.isStreamingSupported,isRangeSupported:kr.isRangeSupported,contentLength:kr.contentLength})},wr.reject),wr.promise}),Ar.on("GetRangeReader",(Ir,wr)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const kr=this._networkStream.getRangeReader(Ir.begin,Ir.end);if(!kr){wr.close();return}wr.onPull=()=>{kr.read().then(function({value:Mr,done:Hr}){if(Hr){wr.close();return}(0,_util.assert)(Mr instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),wr.enqueue(new Uint8Array(Mr),1,[Mr])}).catch(Mr=>{wr.error(Mr)})},wr.onCancel=Mr=>{kr.cancel(Mr),wr.ready.catch(Hr=>{if(!this.destroyed)throw Hr})}}),Ar.on("GetDoc",({pdfInfo:Ir})=>{this._numPages=Ir.numPages,this._htmlForXfa=Ir.htmlForXfa,delete Ir.htmlForXfa,Pr._capability.resolve(new PDFDocumentProxy(Ir,this))}),Ar.on("DocException",function(Ir){let wr;switch(Ir.name){case"PasswordException":wr=new _util.PasswordException(Ir.message,Ir.code);break;case"InvalidPDFException":wr=new _util.InvalidPDFException(Ir.message);break;case"MissingPDFException":wr=new _util.MissingPDFException(Ir.message);break;case"UnexpectedResponseException":wr=new _util.UnexpectedResponseException(Ir.message,Ir.status);break;case"UnknownErrorException":wr=new _util.UnknownErrorException(Ir.message,Ir.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}Pr._capability.reject(wr)}),Ar.on("PasswordRequest",Ir=>{if(Gn(this,mr,new _util.PromiseCapability),Pr.onPassword){const wr=kr=>{kr instanceof Error?jr(this,mr).reject(kr):jr(this,mr).resolve({password:kr})};try{Pr.onPassword(wr,Ir.code)}catch(kr){jr(this,mr).reject(kr)}}else jr(this,mr).reject(new _util.PasswordException(Ir.message,Ir.code));return jr(this,mr).promise}),Ar.on("DataLoaded",Ir=>{var wr;(wr=Pr.onProgress)==null||wr.call(Pr,{loaded:Ir.length,total:Ir.length}),this.downloadInfoCapability.resolve(Ir)}),Ar.on("StartRenderPage",Ir=>{if(this.destroyed)return;jr(this,fr).get(Ir.pageIndex)._startRenderPage(Ir.transparency,Ir.cacheKey)}),Ar.on("commonobj",([Ir,wr,kr])=>{var Mr;if(!this.destroyed&&!this.commonObjs.has(Ir))switch(wr){case"Font":const Hr=this._params;if("error"in kr){const Br=kr.error;(0,_util.warn)(`Error during font loading: ${Br}`),this.commonObjs.resolve(Ir,Br);break}const Gr=Hr.pdfBug&&((Mr=globalThis.FontInspector)!=null&&Mr.enabled)?(Br,Vr)=>globalThis.FontInspector.fontAdded(Br,Vr):null,zr=new _font_loader.FontFaceObject(kr,{isEvalSupported:Hr.isEvalSupported,disableFontFace:Hr.disableFontFace,ignoreErrors:Hr.ignoreErrors,inspectFont:Gr});this.fontLoader.bind(zr).catch(Br=>Ar.sendWithPromise("FontFallback",{id:Ir})).finally(()=>{!Hr.fontExtraProperties&&zr.data&&(zr.data=null),this.commonObjs.resolve(Ir,zr)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Ir,kr);break;default:throw new Error(`Got unknown common object type ${wr}`)}}),Ar.on("obj",([Ir,wr,kr,Mr])=>{var Gr;if(this.destroyed)return;const Hr=jr(this,fr).get(wr);if(!Hr.objs.has(Ir))switch(kr){case"Image":if(Hr.objs.resolve(Ir,Mr),Mr){let zr;if(Mr.bitmap){const{width:Br,height:Vr}=Mr;zr=Br*Vr*4}else zr=((Gr=Mr.data)==null?void 0:Gr.length)||0;zr>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Hr._maybeCleanupAfterRender=!0)}break;case"Pattern":Hr.objs.resolve(Ir,Mr);break;default:throw new Error(`Got unknown object type ${kr}`)}}),Ar.on("DocProgress",Ir=>{var wr;this.destroyed||(wr=Pr.onProgress)==null||wr.call(Pr,{loaded:Ir.loaded,total:Ir.total})}),Ar.on("FetchBuiltInCMap",Ir=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Ir):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Ar.on("FetchStandardFontData",Ir=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Ir):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Ir;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:Ar,transfers:Pr}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:Ar,filename:((Ir=this._fullReader)==null?void 0:Ir.filename)??null},Pr).finally(()=>{this.annotationStorage.resetModified()})}getPage(Ar){if(!Number.isInteger(Ar)||Ar<=0||Ar>this._numPages)return Promise.reject(new Error("Invalid page request."));const Pr=Ar-1,Ir=jr(this,cr).get(Pr);if(Ir)return Ir;const wr=this.messageHandler.sendWithPromise("GetPage",{pageIndex:Pr}).then(kr=>{if(this.destroyed)throw new Error("Transport destroyed");const Mr=new PDFPageProxy(Pr,kr,this,this._params.pdfBug);return jr(this,fr).set(Pr,Mr),Mr});return jr(this,cr).set(Pr,wr),wr}getPageIndex(Ar){return typeof Ar!="object"||Ar===null||!Number.isInteger(Ar.num)||Ar.num<0||!Number.isInteger(Ar.gen)||Ar.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Ar.num,gen:Ar.gen})}getAnnotations(Ar,Pr){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Ar,intent:Pr})}getFieldObjects(){return On(this,dr,G0).call(this,"GetFieldObjects")}hasJSActions(){return On(this,dr,G0).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Ar){return typeof Ar!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Ar})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return On(this,dr,G0).call(this,"GetDocJSActions")}getPageJSActions(Ar){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Ar})}getStructTree(Ar){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Ar})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Ar=>new _optional_content_config.OptionalContentConfig(Ar))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const Ar="GetMetadata",Pr=jr(this,ur).get(Ar);if(Pr)return Pr;const Ir=this.messageHandler.sendWithPromise(Ar,null).then(wr=>{var kr,Mr;return{info:wr[0],metadata:wr[1]?new _metadata.Metadata(wr[1]):null,contentDispositionFilename:((kr=this._fullReader)==null?void 0:kr.filename)??null,contentLength:((Mr=this._fullReader)==null?void 0:Mr.contentLength)??null}});return jr(this,ur).set(Ar,Ir),Ir}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Ar=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const Pr of jr(this,fr).values())if(!Pr.cleanup())throw new Error(`startCleanup: Page ${Pr.pageNumber} is currently rendering.`);this.commonObjs.clear(),Ar||this.fontLoader.clear(),jr(this,ur).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:Ar,enableXfa:Pr}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Ar,enableXfa:Pr})}}ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakSet,G0=function(Ar,Pr=null){const Ir=jr(this,ur).get(Ar);if(Ir)return Ir;const wr=this.messageHandler.sendWithPromise(Ar,Pr);return jr(this,ur).set(Ar,wr),wr};class PDFObjects{constructor(){Vn(this,gr);Vn(this,pr,Object.create(null))}get(Ar,Pr=null){if(Pr){const wr=On(this,gr,$p).call(this,Ar);return wr.capability.promise.then(()=>Pr(wr.data)),null}const Ir=jr(this,pr)[Ar];if(!(Ir!=null&&Ir.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Ar}.`);return Ir.data}has(Ar){const Pr=jr(this,pr)[Ar];return(Pr==null?void 0:Pr.capability.settled)||!1}resolve(Ar,Pr=null){const Ir=On(this,gr,$p).call(this,Ar);Ir.data=Pr,Ir.capability.resolve()}clear(){var Ar;for(const Pr in jr(this,pr)){const{data:Ir}=jr(this,pr)[Pr];(Ar=Ir==null?void 0:Ir.bitmap)==null||Ar.close()}Gn(this,pr,Object.create(null))}}pr=new WeakMap,gr=new WeakSet,$p=function(Ar){var Pr;return(Pr=jr(this,pr))[Ar]||(Pr[Ar]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(Ar){Vn(this,Cr,null);Gn(this,Cr,Ar),this.onContinue=null}get promise(){return jr(this,Cr).capability.promise}cancel(Ar=0){jr(this,Cr).cancel(null,Ar)}get separateAnnots(){const{separateAnnots:Ar}=jr(this,Cr).operatorList;if(!Ar)return!1;const{annotationCanvasMap:Pr}=jr(this,Cr);return Ar.form||Ar.canvas&&(Pr==null?void 0:Pr.size)>0}}Cr=new WeakMap,exports$1.RenderTask=RenderTask;const Fr=class Fr{constructor({callback:Ar,params:Pr,objs:Ir,commonObjs:wr,annotationCanvasMap:kr,operatorList:Mr,pageIndex:Hr,canvasFactory:Gr,filterFactory:zr,useRequestAnimationFrame:Br=!1,pdfBug:Vr=!1,pageColors:Rr=null}){this.callback=Ar,this.params=Pr,this.objs=Ir,this.commonObjs=wr,this.annotationCanvasMap=kr,this.operatorListIdx=null,this.operatorList=Mr,this._pageIndex=Hr,this.canvasFactory=Gr,this.filterFactory=zr,this._pdfBug=Vr,this.pageColors=Rr,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Br===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=Pr.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Ar=!1,optionalContentConfig:Pr}){var Hr,Gr;if(this.cancelled)return;if(this._canvas){if(jr(Fr,Tr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");jr(Fr,Tr).add(this._canvas)}this._pdfBug&&((Hr=globalThis.StepperManager)!=null&&Hr.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Ir,viewport:wr,transform:kr,background:Mr}=this.params;this.gfx=new _canvas.CanvasGraphics(Ir,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:Pr},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:kr,viewport:wr,transparency:Ar,background:Mr}),this.operatorListIdx=0,this.graphicsReady=!0,(Gr=this.graphicsReadyCallback)==null||Gr.call(this)}cancel(Ar=null,Pr=0){var Ir;this.running=!1,this.cancelled=!0,(Ir=this.gfx)==null||Ir.endDrawing(),jr(Fr,Tr).delete(this._canvas),this.callback(Ar||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,Pr))}operatorListChanged(){var Ar;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Ar=this.stepper)==null||Ar.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),jr(Fr,Tr).delete(this._canvas),this.callback())))}};Tr=new WeakMap,Vn(Fr,Tr,new WeakSet);let InternalRenderTask=Fr;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(e,_e,er)=>{var or,lr,ur,J1,cr;Object.defineProperty(_e,"__esModule",{value:!0}),_e.SerializableEmpty=_e.PrintAnnotationStorage=_e.AnnotationStorage=void 0;var tr=er(1),rr=er(4),nr=er(8);const ir=Object.freeze({map:null,hash:"",transfers:void 0});_e.SerializableEmpty=ir;class ar{constructor(){Vn(this,ur);Vn(this,or,!1);Vn(this,lr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(dr,xr){const pr=jr(this,lr).get(dr);return pr===void 0?xr:Object.assign(xr,pr)}getRawValue(dr){return jr(this,lr).get(dr)}remove(dr){if(jr(this,lr).delete(dr),jr(this,lr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const xr of jr(this,lr).values())if(xr instanceof rr.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(dr,xr){const pr=jr(this,lr).get(dr);let gr=!1;if(pr!==void 0)for(const[vr,Cr]of Object.entries(xr))pr[vr]!==Cr&&(gr=!0,pr[vr]=Cr);else gr=!0,jr(this,lr).set(dr,xr);gr&&On(this,ur,J1).call(this),xr instanceof rr.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(xr.constructor._type)}has(dr){return jr(this,lr).has(dr)}getAll(){return jr(this,lr).size>0?(0,tr.objectFromMap)(jr(this,lr)):null}setAll(dr){for(const[xr,pr]of Object.entries(dr))this.setValue(xr,pr)}get size(){return jr(this,lr).size}resetModified(){jr(this,or)&&(Gn(this,or,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new sr(this)}get serializable(){if(jr(this,lr).size===0)return ir;const dr=new Map,xr=new nr.MurmurHash3_64,pr=[],gr=Object.create(null);let vr=!1;for(const[Cr,Tr]of jr(this,lr)){const Fr=Tr instanceof rr.AnnotationEditor?Tr.serialize(!1,gr):Tr;Fr&&(dr.set(Cr,Fr),xr.update(`${Cr}:${JSON.stringify(Fr)}`),vr||(vr=!!Fr.bitmap))}if(vr)for(const Cr of dr.values())Cr.bitmap&&pr.push(Cr.bitmap);return dr.size>0?{map:dr,hash:xr.hexdigest(),transfers:pr}:ir}}or=new WeakMap,lr=new WeakMap,ur=new WeakSet,J1=function(){jr(this,or)||(Gn(this,or,!0),typeof this.onSetModified=="function"&&this.onSetModified())},_e.AnnotationStorage=ar;class sr extends ar{constructor(xr){super();Vn(this,cr);const{map:pr,hash:gr,transfers:vr}=xr.serializable,Cr=structuredClone(pr,vr?{transfer:vr}:null);Gn(this,cr,{map:Cr,hash:gr,transfers:vr})}get print(){(0,tr.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return jr(this,cr)}}cr=new WeakMap,_e.PrintAnnotationStorage=sr},(e,_e,er)=>{var sr,or,lr,ur,fr,cr,mr,dr,xr,pr,gr,vr,Cr,Tr,Fr,Hp,Vp,Pr,Xp,qp,Z1,Q1,em,Gp,tm;Object.defineProperty(_e,"__esModule",{value:!0}),_e.AnnotationEditor=void 0;var tr=er(5),rr=er(1),nr=er(6);const Br=class Br{constructor(Rr){Vn(this,Fr);Vn(this,sr,"");Vn(this,or,!1);Vn(this,lr,null);Vn(this,ur,null);Vn(this,fr,null);Vn(this,cr,!1);Vn(this,mr,null);Vn(this,dr,this.focusin.bind(this));Vn(this,xr,this.focusout.bind(this));Vn(this,pr,!1);Vn(this,gr,!1);Vn(this,vr,!1);Xs(this,"_initialOptions",Object.create(null));Xs(this,"_uiManager",null);Xs(this,"_focusEventsAllowed",!0);Xs(this,"_l10nPromise",null);Vn(this,Cr,!1);Vn(this,Tr,Br._zIndex++);this.constructor===Br&&(0,rr.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Rr.parent,this.id=Rr.id,this.width=this.height=null,this.pageIndex=Rr.parent.pageIndex,this.name=Rr.name,this.div=null,this._uiManager=Rr.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Rr.isCentered,this._structTreeParentId=null;const{rotation:Xr,rawDims:{pageWidth:an,pageHeight:yr,pageX:br,pageY:Er}}=this.parent.viewport;this.rotation=Xr,this.pageRotation=(360+Xr-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[an,yr],this.pageTranslation=[br,Er];const[Lr,Or]=this.parentDimensions;this.x=Rr.x/Lr,this.y=Rr.y/Or,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,rr.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Rr){const Xr=new ar({id:Rr.parent.getNextId(),parent:Rr.parent,uiManager:Rr._uiManager});Xr.annotationElementId=Rr.annotationElementId,Xr.deleted=!0,Xr._uiManager.addToAnnotationStorage(Xr)}static initialize(Rr,Xr=null){if(Br._l10nPromise||(Br._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(yr=>[yr,Rr.get(yr)]))),Xr!=null&&Xr.strings)for(const yr of Xr.strings)Br._l10nPromise.set(yr,Rr.get(yr));if(Br._borderLineWidth!==-1)return;const an=getComputedStyle(document.documentElement);Br._borderLineWidth=parseFloat(an.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Rr,Xr){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Rr){return!1}static paste(Rr,Xr){(0,rr.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return jr(this,Cr)}set _isDraggable(Rr){var Xr;Gn(this,Cr,Rr),(Xr=this.div)==null||Xr.classList.toggle("draggable",Rr)}center(){const[Rr,Xr]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Xr/(Rr*2),this.y+=this.width*Rr/(Xr*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Xr/(Rr*2),this.y-=this.width*Rr/(Xr*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Rr){this._uiManager.addCommands(Rr)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=jr(this,Tr)}setParent(Rr){Rr!==null&&(this.pageIndex=Rr.pageIndex,this.pageDimensions=Rr.pageDimensions),this.parent=Rr}focusin(Rr){this._focusEventsAllowed&&(jr(this,pr)?Gn(this,pr,!1):this.parent.setSelected(this))}focusout(Rr){var an;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Xr=Rr.relatedTarget;Xr!=null&&Xr.closest(`#${this.id}`)||(Rr.preventDefault(),(an=this.parent)!=null&&an.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Rr,Xr,an,yr){const[br,Er]=this.parentDimensions;[an,yr]=this.screenToPageTranslation(an,yr),this.x=(Rr+an)/br,this.y=(Xr+yr)/Er,this.fixAndSetPosition()}translate(Rr,Xr){On(this,Fr,Hp).call(this,this.parentDimensions,Rr,Xr)}translateInPage(Rr,Xr){On(this,Fr,Hp).call(this,this.pageDimensions,Rr,Xr),this.div.scrollIntoView({block:"nearest"})}drag(Rr,Xr){const[an,yr]=this.parentDimensions;if(this.x+=Rr/an,this.y+=Xr/yr,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Ur,y:$r}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Ur,$r)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:br,y:Er}=this;const[Lr,Or]=On(this,Fr,Vp).call(this);br+=Lr,Er+=Or,this.div.style.left=`${(100*br).toFixed(2)}%`,this.div.style.top=`${(100*Er).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Rr,Xr]=this.pageDimensions;let{x:an,y:yr,width:br,height:Er}=this;switch(br*=Rr,Er*=Xr,an*=Rr,yr*=Xr,this.rotation){case 0:an=Math.max(0,Math.min(Rr-br,an)),yr=Math.max(0,Math.min(Xr-Er,yr));break;case 90:an=Math.max(0,Math.min(Rr-Er,an)),yr=Math.min(Xr,Math.max(br,yr));break;case 180:an=Math.min(Rr,Math.max(br,an)),yr=Math.min(Xr,Math.max(Er,yr));break;case 270:an=Math.min(Rr,Math.max(Er,an)),yr=Math.max(0,Math.min(Xr-br,yr));break}this.x=an/=Rr,this.y=yr/=Xr;const[Lr,Or]=On(this,Fr,Vp).call(this);an+=Lr,yr+=Or;const{style:Ur}=this.div;Ur.left=`${(100*an).toFixed(2)}%`,Ur.top=`${(100*yr).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Rr,Xr){var an;return On(an=Br,Pr,Xp).call(an,Rr,Xr,this.parentRotation)}pageTranslationToScreen(Rr,Xr){var an;return On(an=Br,Pr,Xp).call(an,Rr,Xr,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Rr,pageDimensions:[Xr,an]}=this,yr=Xr*Rr,br=an*Rr;return rr.FeatureTest.isCSSRoundSupported?[Math.round(yr),Math.round(br)]:[yr,br]}setDims(Rr,Xr){var br;const[an,yr]=this.parentDimensions;this.div.style.width=`${(100*Rr/an).toFixed(2)}%`,jr(this,cr)||(this.div.style.height=`${(100*Xr/yr).toFixed(2)}%`),(br=jr(this,lr))==null||br.classList.toggle("small",Rr<Br.SMALL_EDITOR_SIZE||Xr<Br.SMALL_EDITOR_SIZE)}fixDims(){const{style:Rr}=this.div,{height:Xr,width:an}=Rr,yr=an.endsWith("%"),br=!jr(this,cr)&&Xr.endsWith("%");if(yr&&br)return;const[Er,Lr]=this.parentDimensions;yr||(Rr.width=`${(100*parseFloat(an)/Er).toFixed(2)}%`),!jr(this,cr)&&!br&&(Rr.height=`${(100*parseFloat(Xr)/Lr).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(jr(this,lr))return;const Rr=Gn(this,lr,document.createElement("button"));Rr.className="altText";const Xr=await Br._l10nPromise.get("editor_alt_text_button_label");Rr.textContent=Xr,Rr.setAttribute("aria-label",Xr),Rr.tabIndex="0",Rr.addEventListener("contextmenu",nr.noContextMenu),Rr.addEventListener("pointerdown",an=>an.stopPropagation()),Rr.addEventListener("click",an=>{an.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Rr.addEventListener("keydown",an=>{an.target===Rr&&an.key==="Enter"&&(an.preventDefault(),this._uiManager.editAltText(this))}),On(this,Fr,Gp).call(this),this.div.append(Rr),Br.SMALL_EDITOR_SIZE||(Br.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Rr.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:jr(this,sr),decorative:jr(this,or)}}set altTextData({altText:Rr,decorative:Xr}){jr(this,sr)===Rr&&jr(this,or)===Xr||(Gn(this,sr,Rr),Gn(this,or,Xr),On(this,Fr,Gp).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",jr(this,dr)),this.div.addEventListener("focusout",jr(this,xr));const[Rr,Xr]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Xr/Rr).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Rr/Xr).toFixed(2)}%`);const[an,yr]=this.getInitialTranslation();return this.translate(an,yr),(0,tr.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Rr){const{isMac:Xr}=rr.FeatureTest.platform;if(Rr.button!==0||Rr.ctrlKey&&Xr){Rr.preventDefault();return}Gn(this,pr,!0),On(this,Fr,tm).call(this,Rr)}moveInDOM(){var Rr;(Rr=this.parent)==null||Rr.moveEditorInDOM(this)}_setParentAndPosition(Rr,Xr,an){Rr.changeParent(this),this.x=Xr,this.y=an,this.fixAndSetPosition()}getRect(Rr,Xr){const an=this.parentScale,[yr,br]=this.pageDimensions,[Er,Lr]=this.pageTranslation,Or=Rr/an,Ur=Xr/an,$r=this.x*yr,Zr=this.y*br,fn=this.width*yr,_n=this.height*br;switch(this.rotation){case 0:return[$r+Or+Er,br-Zr-Ur-_n+Lr,$r+Or+fn+Er,br-Zr-Ur+Lr];case 90:return[$r+Ur+Er,br-Zr+Or+Lr,$r+Ur+_n+Er,br-Zr+Or+fn+Lr];case 180:return[$r-Or-fn+Er,br-Zr+Ur+Lr,$r-Or+Er,br-Zr+Ur+_n+Lr];case 270:return[$r-Ur-_n+Er,br-Zr-Or-fn+Lr,$r-Ur+Er,br-Zr-Or+Lr];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Rr,Xr){const[an,yr,br,Er]=Rr,Lr=br-an,Or=Er-yr;switch(this.rotation){case 0:return[an,Xr-Er,Lr,Or];case 90:return[an,Xr-yr,Or,Lr];case 180:return[br,Xr-yr,Lr,Or];case 270:return[br,Xr-Er,Or,Lr];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Gn(this,vr,!0)}disableEditMode(){Gn(this,vr,!1)}isInEditMode(){return jr(this,vr)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Rr,Xr;(Rr=this.div)==null||Rr.addEventListener("focusin",jr(this,dr)),(Xr=this.div)==null||Xr.addEventListener("focusout",jr(this,xr))}serialize(Rr=!1,Xr=null){(0,rr.unreachable)("An editor must be serializable")}static deserialize(Rr,Xr,an){const yr=new this.prototype.constructor({parent:Xr,id:Xr.getNextId(),uiManager:an});yr.rotation=Rr.rotation;const[br,Er]=yr.pageDimensions,[Lr,Or,Ur,$r]=yr.getRectInCurrentCoords(Rr.rect,Er);return yr.x=Lr/br,yr.y=Or/Er,yr.width=Ur/br,yr.height=$r/Er,yr}remove(){var Rr;this.div.removeEventListener("focusin",jr(this,dr)),this.div.removeEventListener("focusout",jr(this,xr)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(Rr=jr(this,lr))==null||Rr.remove(),Gn(this,lr,null),Gn(this,ur,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(On(this,Fr,Z1).call(this),jr(this,mr).classList.remove("hidden"))}select(){var Rr;this.makeResizable(),(Rr=this.div)==null||Rr.classList.add("selectedEditor")}unselect(){var Rr,Xr,an;(Rr=jr(this,mr))==null||Rr.classList.add("hidden"),(Xr=this.div)==null||Xr.classList.remove("selectedEditor"),(an=this.div)!=null&&an.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Rr,Xr){}disableEditing(){jr(this,lr)&&(jr(this,lr).hidden=!0)}enableEditing(){jr(this,lr)&&(jr(this,lr).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return jr(this,gr)}set isEditing(Rr){Gn(this,gr,Rr),this.parent&&(Rr?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Rr,Xr){Gn(this,cr,!0);const an=Rr/Xr,{style:yr}=this.div;yr.aspectRatio=an,yr.height="auto"}static get MIN_SIZE(){return 16}};sr=new WeakMap,or=new WeakMap,lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakMap,gr=new WeakMap,vr=new WeakMap,Cr=new WeakMap,Tr=new WeakMap,Fr=new WeakSet,Hp=function([Rr,Xr],an,yr){[an,yr]=this.screenToPageTranslation(an,yr),this.x+=an/Rr,this.y+=yr/Xr,this.fixAndSetPosition()},Vp=function(){const[Rr,Xr]=this.parentDimensions,{_borderLineWidth:an}=Br,yr=an/Rr,br=an/Xr;switch(this.rotation){case 90:return[-yr,br];case 180:return[yr,br];case 270:return[yr,-br];default:return[-yr,-br]}},Pr=new WeakSet,Xp=function(Rr,Xr,an){switch(an){case 90:return[Xr,-Rr];case 180:return[-Rr,-Xr];case 270:return[-Xr,Rr];default:return[Rr,Xr]}},qp=function(Rr){switch(Rr){case 90:{const[Xr,an]=this.pageDimensions;return[0,-Xr/an,an/Xr,0]}case 180:return[-1,0,0,-1];case 270:{const[Xr,an]=this.pageDimensions;return[0,Xr/an,-an/Xr,0]}default:return[1,0,0,1]}},Z1=function(){if(jr(this,mr))return;Gn(this,mr,document.createElement("div")),jr(this,mr).classList.add("resizers");const Rr=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Rr.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Xr of Rr){const an=document.createElement("div");jr(this,mr).append(an),an.classList.add("resizer",Xr),an.addEventListener("pointerdown",On(this,Fr,Q1).bind(this,Xr)),an.addEventListener("contextmenu",nr.noContextMenu)}this.div.prepend(jr(this,mr))},Q1=function(Rr,Xr){Xr.preventDefault();const{isMac:an}=rr.FeatureTest.platform;if(Xr.button!==0||Xr.ctrlKey&&an)return;const yr=On(this,Fr,em).bind(this,Rr),br=this._isDraggable;this._isDraggable=!1;const Er={passive:!0,capture:!0};window.addEventListener("pointermove",yr,Er);const Lr=this.x,Or=this.y,Ur=this.width,$r=this.height,Zr=this.parent.div.style.cursor,fn=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Xr.target).cursor;const _n=()=>{this._isDraggable=br,window.removeEventListener("pointerup",_n),window.removeEventListener("blur",_n),window.removeEventListener("pointermove",yr,Er),this.parent.div.style.cursor=Zr,this.div.style.cursor=fn;const Kr=this.x,Cn=this.y,Dn=this.width,wn=this.height;Kr===Lr&&Cn===Or&&Dn===Ur&&wn===$r||this.addCommands({cmd:()=>{this.width=Dn,this.height=wn,this.x=Kr,this.y=Cn;const[Qr,xn]=this.parentDimensions;this.setDims(Qr*Dn,xn*wn),this.fixAndSetPosition()},undo:()=>{this.width=Ur,this.height=$r,this.x=Lr,this.y=Or;const[Qr,xn]=this.parentDimensions;this.setDims(Qr*Ur,xn*$r),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",_n),window.addEventListener("blur",_n)},em=function(Rr,Xr){const[an,yr]=this.parentDimensions,br=this.x,Er=this.y,Lr=this.width,Or=this.height,Ur=Br.MIN_SIZE/an,$r=Br.MIN_SIZE/yr,Zr=Xn=>Math.round(Xn*1e4)/1e4,fn=On(this,Fr,qp).call(this,this.rotation),_n=(Xn,ws)=>[fn[0]*Xn+fn[2]*ws,fn[1]*Xn+fn[3]*ws],Kr=On(this,Fr,qp).call(this,360-this.rotation),Cn=(Xn,ws)=>[Kr[0]*Xn+Kr[2]*ws,Kr[1]*Xn+Kr[3]*ws];let Dn,wn,Qr=!1,xn=!1;switch(Rr){case"topLeft":Qr=!0,Dn=(Xn,ws)=>[0,0],wn=(Xn,ws)=>[Xn,ws];break;case"topMiddle":Dn=(Xn,ws)=>[Xn/2,0],wn=(Xn,ws)=>[Xn/2,ws];break;case"topRight":Qr=!0,Dn=(Xn,ws)=>[Xn,0],wn=(Xn,ws)=>[0,ws];break;case"middleRight":xn=!0,Dn=(Xn,ws)=>[Xn,ws/2],wn=(Xn,ws)=>[0,ws/2];break;case"bottomRight":Qr=!0,Dn=(Xn,ws)=>[Xn,ws],wn=(Xn,ws)=>[0,0];break;case"bottomMiddle":Dn=(Xn,ws)=>[Xn/2,ws],wn=(Xn,ws)=>[Xn/2,0];break;case"bottomLeft":Qr=!0,Dn=(Xn,ws)=>[0,ws],wn=(Xn,ws)=>[Xn,0];break;case"middleLeft":xn=!0,Dn=(Xn,ws)=>[0,ws/2],wn=(Xn,ws)=>[Xn,ws/2];break}const tn=Dn(Lr,Or),on=wn(Lr,Or);let vn=_n(...on);const Sn=Zr(br+vn[0]),Ln=Zr(Er+vn[1]);let Wn=1,$n=1,[En,ba]=this.screenToPageTranslation(Xr.movementX,Xr.movementY);if([En,ba]=Cn(En/an,ba/yr),Qr){const Xn=Math.hypot(Lr,Or);Wn=$n=Math.max(Math.min(Math.hypot(on[0]-tn[0]-En,on[1]-tn[1]-ba)/Xn,1/Lr,1/Or),Ur/Lr,$r/Or)}else xn?Wn=Math.max(Ur,Math.min(1,Math.abs(on[0]-tn[0]-En)))/Lr:$n=Math.max($r,Math.min(1,Math.abs(on[1]-tn[1]-ba)))/Or;const Qn=Zr(Lr*Wn),vs=Zr(Or*$n);vn=_n(...wn(Qn,vs));const es=Sn-vn[0],ls=Ln-vn[1];this.width=Qn,this.height=vs,this.x=es,this.y=ls,this.setDims(an*Qn,yr*vs),this.fixAndSetPosition()},Gp=async function(){var an;const Rr=jr(this,lr);if(!Rr)return;if(!jr(this,sr)&&!jr(this,or)){Rr.classList.remove("done"),(an=jr(this,ur))==null||an.remove();return}Br._l10nPromise.get("editor_alt_text_edit_button_label").then(yr=>{Rr.setAttribute("aria-label",yr)});let Xr=jr(this,ur);if(!Xr){Gn(this,ur,Xr=document.createElement("span")),Xr.className="tooltip",Xr.setAttribute("role","tooltip");const yr=Xr.id=`alt-text-tooltip-${this.id}`;Rr.setAttribute("aria-describedby",yr);const br=100;Rr.addEventListener("mouseenter",()=>{Gn(this,fr,setTimeout(()=>{Gn(this,fr,null),jr(this,ur).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},br))}),Rr.addEventListener("mouseleave",()=>{var Er;clearTimeout(jr(this,fr)),Gn(this,fr,null),(Er=jr(this,ur))==null||Er.classList.remove("show")})}Rr.classList.add("done"),Xr.innerText=jr(this,or)?await Br._l10nPromise.get("editor_alt_text_decorative_tooltip"):jr(this,sr),Xr.parentNode||Rr.append(Xr)},tm=function(Rr){if(!this._isDraggable)return;const Xr=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let an,yr;Xr&&(an={passive:!0,capture:!0},yr=Er=>{const[Lr,Or]=this.screenToPageTranslation(Er.movementX,Er.movementY);this._uiManager.dragSelectedEditors(Lr,Or)},window.addEventListener("pointermove",yr,an));const br=()=>{if(window.removeEventListener("pointerup",br),window.removeEventListener("blur",br),Xr&&window.removeEventListener("pointermove",yr,an),Gn(this,pr,!1),!this._uiManager.endDragSession()){const{isMac:Er}=rr.FeatureTest.platform;Rr.ctrlKey&&!Er||Rr.shiftKey||Rr.metaKey&&Er?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",br),window.addEventListener("blur",br)},Vn(Br,Pr),Xs(Br,"_borderLineWidth",-1),Xs(Br,"_colorManager",new tr.ColorManager),Xs(Br,"_zIndex",1),Xs(Br,"SMALL_EDITOR_SIZE",0);let ir=Br;_e.AnnotationEditor=ir;class ar extends ir{constructor(Rr){super(Rr),this.annotationElementId=Rr.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,_e,er)=>{var cr,mr,dr,xr,pr,Yp,Cr,Tr,Fr,_r,Ar,rm,wr,kr,Mr,Hr,Gr,zr,Br,Vr,Rr,Xr,an,yr,br,Er,Lr,Or,Ur,$r,Zr,fn,_n,Kr,Cn,Dn,wn,Qr,xn,tn,on,vn,Sn,Ln,Wn,$n,En,nm,Kp,Jp,Y0,Zp,Qp,Uo,_h,im,am,e1,e0,t1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.KeyboardManager=_e.CommandManager=_e.ColorManager=_e.AnnotationEditorUIManager=void 0,_e.bindEvents=nr,_e.opacityToHex=ir;var tr=er(1),rr=er(6);function nr(As,yn,_i){for(const rs of _i)yn.addEventListener(rs,As[rs].bind(As))}function ir(As){return Math.round(Math.min(255,Math.max(1,255*As))).toString(16).padStart(2,"0")}class ar{constructor(){Vn(this,cr,0)}getId(){return`${tr.AnnotationEditorPrefix}${_f(this,cr)._++}`}}cr=new WeakMap;const vr=class vr{constructor(){Vn(this,pr);Vn(this,mr,(0,tr.getUuid)());Vn(this,dr,0);Vn(this,xr,null)}static get _isSVGFittingCanvas(){const yn='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',rs=new OffscreenCanvas(1,3).getContext("2d"),os=new Image;os.src=yn;const ms=os.decode().then(()=>(rs.drawImage(os,0,0,1,1,0,0,1,3),new Uint32Array(rs.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,tr.shadow)(this,"_isSVGFittingCanvas",ms)}async getFromFile(yn){const{lastModified:_i,name:rs,size:os,type:ms}=yn;return On(this,pr,Yp).call(this,`${_i}_${rs}_${os}_${ms}`,yn)}async getFromUrl(yn){return On(this,pr,Yp).call(this,yn,yn)}async getFromId(yn){jr(this,xr)||Gn(this,xr,new Map);const _i=jr(this,xr).get(yn);return _i?_i.bitmap?(_i.refCounter+=1,_i):_i.file?this.getFromFile(_i.file):this.getFromUrl(_i.url):null}getSvgUrl(yn){const _i=jr(this,xr).get(yn);return _i!=null&&_i.isSvg?_i.svgUrl:null}deleteId(yn){jr(this,xr)||Gn(this,xr,new Map);const _i=jr(this,xr).get(yn);_i&&(_i.refCounter-=1,_i.refCounter===0&&(_i.bitmap=null))}isValidId(yn){return yn.startsWith(`image_${jr(this,mr)}_`)}};mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakSet,Yp=async function(yn,_i){jr(this,xr)||Gn(this,xr,new Map);let rs=jr(this,xr).get(yn);if(rs===null)return null;if(rs!=null&&rs.bitmap)return rs.refCounter+=1,rs;try{rs||(rs={bitmap:null,id:`image_${jr(this,mr)}_${_f(this,dr)._++}`,refCounter:0,isSvg:!1});let os;if(typeof _i=="string"){rs.url=_i;const ms=await fetch(_i);if(!ms.ok)throw new Error(ms.statusText);os=await ms.blob()}else os=rs.file=_i;if(os.type==="image/svg+xml"){const ms=vr._isSVGFittingCanvas,bs=new FileReader,gn=new Image,pn=new Promise((Pn,Rn)=>{gn.onload=()=>{rs.bitmap=gn,rs.isSvg=!0,Pn()},bs.onload=async()=>{const Yn=rs.svgUrl=bs.result;gn.src=await ms?`${Yn}#svgView(preserveAspectRatio(none))`:Yn},gn.onerror=bs.onerror=Rn});bs.readAsDataURL(os),await pn}else rs.bitmap=await createImageBitmap(os);rs.refCounter=1}catch(os){console.error(os),rs=null}return jr(this,xr).set(yn,rs),rs&&jr(this,xr).set(rs.id,rs),rs};let sr=vr;class or{constructor(yn=128){Vn(this,Cr,[]);Vn(this,Tr,!1);Vn(this,Fr);Vn(this,_r,-1);Gn(this,Fr,yn)}add({cmd:yn,undo:_i,mustExec:rs,type:os=NaN,overwriteIfSameType:ms=!1,keepUndo:bs=!1}){if(rs&&yn(),jr(this,Tr))return;const gn={cmd:yn,undo:_i,type:os};if(jr(this,_r)===-1){jr(this,Cr).length>0&&(jr(this,Cr).length=0),Gn(this,_r,0),jr(this,Cr).push(gn);return}if(ms&&jr(this,Cr)[jr(this,_r)].type===os){bs&&(gn.undo=jr(this,Cr)[jr(this,_r)].undo),jr(this,Cr)[jr(this,_r)]=gn;return}const pn=jr(this,_r)+1;pn===jr(this,Fr)?jr(this,Cr).splice(0,1):(Gn(this,_r,pn),pn<jr(this,Cr).length&&jr(this,Cr).splice(pn)),jr(this,Cr).push(gn)}undo(){jr(this,_r)!==-1&&(Gn(this,Tr,!0),jr(this,Cr)[jr(this,_r)].undo(),Gn(this,Tr,!1),Gn(this,_r,jr(this,_r)-1))}redo(){jr(this,_r)<jr(this,Cr).length-1&&(Gn(this,_r,jr(this,_r)+1),Gn(this,Tr,!0),jr(this,Cr)[jr(this,_r)].cmd(),Gn(this,Tr,!1))}hasSomethingToUndo(){return jr(this,_r)!==-1}hasSomethingToRedo(){return jr(this,_r)<jr(this,Cr).length-1}destroy(){Gn(this,Cr,null)}}Cr=new WeakMap,Tr=new WeakMap,Fr=new WeakMap,_r=new WeakMap,_e.CommandManager=or;class lr{constructor(yn){Vn(this,Ar);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:_i}=tr.FeatureTest.platform;for(const[rs,os,ms={}]of yn)for(const bs of rs){const gn=bs.startsWith("mac+");_i&&gn?(this.callbacks.set(bs.slice(4),{callback:os,options:ms}),this.allKeys.add(bs.split("+").at(-1))):!_i&&!gn&&(this.callbacks.set(bs,{callback:os,options:ms}),this.allKeys.add(bs.split("+").at(-1)))}}exec(yn,_i){if(!this.allKeys.has(_i.key))return;const rs=this.callbacks.get(On(this,Ar,rm).call(this,_i));if(!rs)return;const{callback:os,options:{bubbles:ms=!1,args:bs=[],checker:gn=null}}=rs;gn&&!gn(yn,_i)||(os.bind(yn,...bs)(),ms||(_i.stopPropagation(),_i.preventDefault()))}}Ar=new WeakSet,rm=function(yn){yn.altKey&&this.buffer.push("alt"),yn.ctrlKey&&this.buffer.push("ctrl"),yn.metaKey&&this.buffer.push("meta"),yn.shiftKey&&this.buffer.push("shift"),this.buffer.push(yn.key);const _i=this.buffer.join("+");return this.buffer.length=0,_i},_e.KeyboardManager=lr;const Ir=class Ir{get _colors(){const yn=new Map([["CanvasText",null],["Canvas",null]]);return(0,rr.getColorValues)(yn),(0,tr.shadow)(this,"_colors",yn)}convert(yn){const _i=(0,rr.getRGB)(yn);if(!window.matchMedia("(forced-colors: active)").matches)return _i;for(const[rs,os]of this._colors)if(os.every((ms,bs)=>ms===_i[bs]))return Ir._colorsMapping.get(rs);return _i}getHexCode(yn){const _i=this._colors.get(yn);return _i?tr.Util.makeHexColor(..._i):yn}};Xs(Ir,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let ur=Ir;_e.ColorManager=ur;const Ls=class Ls{constructor(yn,_i,rs,os,ms,bs){Vn(this,En);Vn(this,wr,null);Vn(this,kr,new Map);Vn(this,Mr,new Map);Vn(this,Hr,null);Vn(this,Gr,null);Vn(this,zr,new or);Vn(this,Br,0);Vn(this,Vr,new Set);Vn(this,Rr,null);Vn(this,Xr,null);Vn(this,an,new Set);Vn(this,yr,null);Vn(this,br,new ar);Vn(this,Er,!1);Vn(this,Lr,!1);Vn(this,Or,null);Vn(this,Ur,tr.AnnotationEditorType.NONE);Vn(this,$r,new Set);Vn(this,Zr,null);Vn(this,fn,this.blur.bind(this));Vn(this,_n,this.focus.bind(this));Vn(this,Kr,this.copy.bind(this));Vn(this,Cn,this.cut.bind(this));Vn(this,Dn,this.paste.bind(this));Vn(this,wn,this.keydown.bind(this));Vn(this,Qr,this.onEditingAction.bind(this));Vn(this,xn,this.onPageChanging.bind(this));Vn(this,tn,this.onScaleChanging.bind(this));Vn(this,on,this.onRotationChanging.bind(this));Vn(this,vn,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Vn(this,Sn,[0,0]);Vn(this,Ln,null);Vn(this,Wn,null);Vn(this,$n,null);Gn(this,Wn,yn),Gn(this,$n,_i),Gn(this,Hr,rs),this._eventBus=os,this._eventBus._on("editingaction",jr(this,Qr)),this._eventBus._on("pagechanging",jr(this,xn)),this._eventBus._on("scalechanging",jr(this,tn)),this._eventBus._on("rotationchanging",jr(this,on)),Gn(this,Gr,ms.annotationStorage),Gn(this,yr,ms.filterFactory),Gn(this,Zr,bs),this.viewParameters={realScale:rr.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const yn=Ls.prototype,_i=ms=>{const{activeElement:bs}=document;return bs&&jr(ms,Wn).contains(bs)&&ms.hasSomethingToControl()},rs=this.TRANSLATE_SMALL,os=this.TRANSLATE_BIG;return(0,tr.shadow)(this,"_keyboardManager",new lr([[["ctrl+a","mac+meta+a"],yn.selectAll],[["ctrl+z","mac+meta+z"],yn.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],yn.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],yn.delete],[["Escape","mac+Escape"],yn.unselectAll],[["ArrowLeft","mac+ArrowLeft"],yn.translateSelectedEditors,{args:[-rs,0],checker:_i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],yn.translateSelectedEditors,{args:[-os,0],checker:_i}],[["ArrowRight","mac+ArrowRight"],yn.translateSelectedEditors,{args:[rs,0],checker:_i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],yn.translateSelectedEditors,{args:[os,0],checker:_i}],[["ArrowUp","mac+ArrowUp"],yn.translateSelectedEditors,{args:[0,-rs],checker:_i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],yn.translateSelectedEditors,{args:[0,-os],checker:_i}],[["ArrowDown","mac+ArrowDown"],yn.translateSelectedEditors,{args:[0,rs],checker:_i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],yn.translateSelectedEditors,{args:[0,os],checker:_i}]]))}destroy(){On(this,En,Y0).call(this),On(this,En,Kp).call(this),this._eventBus._off("editingaction",jr(this,Qr)),this._eventBus._off("pagechanging",jr(this,xn)),this._eventBus._off("scalechanging",jr(this,tn)),this._eventBus._off("rotationchanging",jr(this,on));for(const yn of jr(this,Mr).values())yn.destroy();jr(this,Mr).clear(),jr(this,kr).clear(),jr(this,an).clear(),Gn(this,wr,null),jr(this,$r).clear(),jr(this,zr).destroy(),jr(this,Hr).destroy()}get hcmFilter(){return(0,tr.shadow)(this,"hcmFilter",jr(this,Zr)?jr(this,yr).addHCMFilter(jr(this,Zr).foreground,jr(this,Zr).background):"none")}get direction(){return(0,tr.shadow)(this,"direction",getComputedStyle(jr(this,Wn)).direction)}editAltText(yn){var _i;(_i=jr(this,Hr))==null||_i.editAltText(this,yn)}onPageChanging({pageNumber:yn}){Gn(this,Br,yn-1)}focusMainContainer(){jr(this,Wn).focus()}findParent(yn,_i){for(const rs of jr(this,Mr).values()){const{x:os,y:ms,width:bs,height:gn}=rs.div.getBoundingClientRect();if(yn>=os&&yn<=os+bs&&_i>=ms&&_i<=ms+gn)return rs}return null}disableUserSelect(yn=!1){jr(this,$n).classList.toggle("noUserSelect",yn)}addShouldRescale(yn){jr(this,an).add(yn)}removeShouldRescale(yn){jr(this,an).delete(yn)}onScaleChanging({scale:yn}){this.commitOrRemove(),this.viewParameters.realScale=yn*rr.PixelsPerInch.PDF_TO_CSS_UNITS;for(const _i of jr(this,an))_i.onScaleChanging()}onRotationChanging({pagesRotation:yn}){this.commitOrRemove(),this.viewParameters.rotation=yn}addToAnnotationStorage(yn){!yn.isEmpty()&&jr(this,Gr)&&!jr(this,Gr).has(yn.id)&&jr(this,Gr).setValue(yn.id,yn)}blur(){if(!this.hasSelection)return;const{activeElement:yn}=document;for(const _i of jr(this,$r))if(_i.div.contains(yn)){Gn(this,Or,[_i,yn]),_i._focusEventsAllowed=!1;break}}focus(){if(!jr(this,Or))return;const[yn,_i]=jr(this,Or);Gn(this,Or,null),_i.addEventListener("focusin",()=>{yn._focusEventsAllowed=!0},{once:!0}),_i.focus()}addEditListeners(){On(this,En,Jp).call(this),On(this,En,Zp).call(this)}removeEditListeners(){On(this,En,Y0).call(this),On(this,En,Qp).call(this)}copy(yn){var rs;if(yn.preventDefault(),(rs=jr(this,wr))==null||rs.commitOrRemove(),!this.hasSelection)return;const _i=[];for(const os of jr(this,$r)){const ms=os.serialize(!0);ms&&_i.push(ms)}_i.length!==0&&yn.clipboardData.setData("application/pdfjs",JSON.stringify(_i))}cut(yn){this.copy(yn),this.delete()}paste(yn){yn.preventDefault();const{clipboardData:_i}=yn;for(const ms of _i.items)for(const bs of jr(this,Xr))if(bs.isHandlingMimeForPasting(ms.type)){bs.paste(ms,this.currentLayer);return}let rs=_i.getData("application/pdfjs");if(!rs)return;try{rs=JSON.parse(rs)}catch(ms){(0,tr.warn)(`paste: "${ms.message}".`);return}if(!Array.isArray(rs))return;this.unselectAll();const os=this.currentLayer;try{const ms=[];for(const pn of rs){const Pn=os.deserialize(pn);if(!Pn)return;ms.push(Pn)}const bs=()=>{for(const pn of ms)On(this,En,e1).call(this,pn);On(this,En,t1).call(this,ms)},gn=()=>{for(const pn of ms)pn.remove()};this.addCommands({cmd:bs,undo:gn,mustExec:!0})}catch(ms){(0,tr.warn)(`paste: "${ms.message}".`)}}keydown(yn){var _i;(_i=this.getActive())!=null&&_i.shouldGetKeyboardEvents()||Ls._keyboardManager.exec(this,yn)}onEditingAction(yn){["undo","redo","delete","selectAll"].includes(yn.name)&&this[yn.name]()}setEditingState(yn){yn?(On(this,En,nm).call(this),On(this,En,Jp).call(this),On(this,En,Zp).call(this),On(this,En,Uo).call(this,{isEditing:jr(this,Ur)!==tr.AnnotationEditorType.NONE,isEmpty:On(this,En,e0).call(this),hasSomethingToUndo:jr(this,zr).hasSomethingToUndo(),hasSomethingToRedo:jr(this,zr).hasSomethingToRedo(),hasSelectedEditor:!1})):(On(this,En,Kp).call(this),On(this,En,Y0).call(this),On(this,En,Qp).call(this),On(this,En,Uo).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(yn){if(!jr(this,Xr)){Gn(this,Xr,yn);for(const _i of jr(this,Xr))On(this,En,_h).call(this,_i.defaultPropertiesToUpdate)}}getId(){return jr(this,br).getId()}get currentLayer(){return jr(this,Mr).get(jr(this,Br))}getLayer(yn){return jr(this,Mr).get(yn)}get currentPageIndex(){return jr(this,Br)}addLayer(yn){jr(this,Mr).set(yn.pageIndex,yn),jr(this,Er)?yn.enable():yn.disable()}removeLayer(yn){jr(this,Mr).delete(yn.pageIndex)}updateMode(yn,_i=null){if(jr(this,Ur)!==yn){if(Gn(this,Ur,yn),yn===tr.AnnotationEditorType.NONE){this.setEditingState(!1),On(this,En,am).call(this);return}this.setEditingState(!0),On(this,En,im).call(this),this.unselectAll();for(const rs of jr(this,Mr).values())rs.updateMode(yn);if(_i){for(const rs of jr(this,kr).values())if(rs.annotationElementId===_i){this.setSelected(rs),rs.enterInEditMode();break}}}}updateToolbar(yn){yn!==jr(this,Ur)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:yn})}updateParams(yn,_i){if(jr(this,Xr)){if(yn===tr.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(yn);return}for(const rs of jr(this,$r))rs.updateParams(yn,_i);for(const rs of jr(this,Xr))rs.updateDefaultParams(yn,_i)}}enableWaiting(yn=!1){if(jr(this,Lr)!==yn){Gn(this,Lr,yn);for(const _i of jr(this,Mr).values())yn?_i.disableClick():_i.enableClick(),_i.div.classList.toggle("waiting",yn)}}getEditors(yn){const _i=[];for(const rs of jr(this,kr).values())rs.pageIndex===yn&&_i.push(rs);return _i}getEditor(yn){return jr(this,kr).get(yn)}addEditor(yn){jr(this,kr).set(yn.id,yn)}removeEditor(yn){var _i;jr(this,kr).delete(yn.id),this.unselect(yn),(!yn.annotationElementId||!jr(this,Vr).has(yn.annotationElementId))&&((_i=jr(this,Gr))==null||_i.remove(yn.id))}addDeletedAnnotationElement(yn){jr(this,Vr).add(yn.annotationElementId),yn.deleted=!0}isDeletedAnnotationElement(yn){return jr(this,Vr).has(yn)}removeDeletedAnnotationElement(yn){jr(this,Vr).delete(yn.annotationElementId),yn.deleted=!1}setActiveEditor(yn){jr(this,wr)!==yn&&(Gn(this,wr,yn),yn&&On(this,En,_h).call(this,yn.propertiesToUpdate))}toggleSelected(yn){if(jr(this,$r).has(yn)){jr(this,$r).delete(yn),yn.unselect(),On(this,En,Uo).call(this,{hasSelectedEditor:this.hasSelection});return}jr(this,$r).add(yn),yn.select(),On(this,En,_h).call(this,yn.propertiesToUpdate),On(this,En,Uo).call(this,{hasSelectedEditor:!0})}setSelected(yn){for(const _i of jr(this,$r))_i!==yn&&_i.unselect();jr(this,$r).clear(),jr(this,$r).add(yn),yn.select(),On(this,En,_h).call(this,yn.propertiesToUpdate),On(this,En,Uo).call(this,{hasSelectedEditor:!0})}isSelected(yn){return jr(this,$r).has(yn)}unselect(yn){yn.unselect(),jr(this,$r).delete(yn),On(this,En,Uo).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return jr(this,$r).size!==0}undo(){jr(this,zr).undo(),On(this,En,Uo).call(this,{hasSomethingToUndo:jr(this,zr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:On(this,En,e0).call(this)})}redo(){jr(this,zr).redo(),On(this,En,Uo).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:jr(this,zr).hasSomethingToRedo(),isEmpty:On(this,En,e0).call(this)})}addCommands(yn){jr(this,zr).add(yn),On(this,En,Uo).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:On(this,En,e0).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const yn=[...jr(this,$r)],_i=()=>{for(const os of yn)os.remove()},rs=()=>{for(const os of yn)On(this,En,e1).call(this,os)};this.addCommands({cmd:_i,undo:rs,mustExec:!0})}commitOrRemove(){var yn;(yn=jr(this,wr))==null||yn.commitOrRemove()}hasSomethingToControl(){return jr(this,wr)||this.hasSelection}selectAll(){for(const yn of jr(this,$r))yn.commit();On(this,En,t1).call(this,jr(this,kr).values())}unselectAll(){if(jr(this,wr)){jr(this,wr).commitOrRemove();return}if(this.hasSelection){for(const yn of jr(this,$r))yn.unselect();jr(this,$r).clear(),On(this,En,Uo).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(yn,_i,rs=!1){if(rs||this.commitOrRemove(),!this.hasSelection)return;jr(this,Sn)[0]+=yn,jr(this,Sn)[1]+=_i;const[os,ms]=jr(this,Sn),bs=[...jr(this,$r)],gn=1e3;jr(this,Ln)&&clearTimeout(jr(this,Ln)),Gn(this,Ln,setTimeout(()=>{Gn(this,Ln,null),jr(this,Sn)[0]=jr(this,Sn)[1]=0,this.addCommands({cmd:()=>{for(const pn of bs)jr(this,kr).has(pn.id)&&pn.translateInPage(os,ms)},undo:()=>{for(const pn of bs)jr(this,kr).has(pn.id)&&pn.translateInPage(-os,-ms)},mustExec:!1})},gn));for(const pn of bs)pn.translateInPage(yn,_i)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Gn(this,Rr,new Map);for(const yn of jr(this,$r))jr(this,Rr).set(yn,{savedX:yn.x,savedY:yn.y,savedPageIndex:yn.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!jr(this,Rr))return!1;this.disableUserSelect(!1);const yn=jr(this,Rr);Gn(this,Rr,null);let _i=!1;for(const[{x:os,y:ms,pageIndex:bs},gn]of yn)gn.newX=os,gn.newY=ms,gn.newPageIndex=bs,_i||(_i=os!==gn.savedX||ms!==gn.savedY||bs!==gn.savedPageIndex);if(!_i)return!1;const rs=(os,ms,bs,gn)=>{if(jr(this,kr).has(os.id)){const pn=jr(this,Mr).get(gn);pn?os._setParentAndPosition(pn,ms,bs):(os.pageIndex=gn,os.x=ms,os.y=bs)}};return this.addCommands({cmd:()=>{for(const[os,{newX:ms,newY:bs,newPageIndex:gn}]of yn)rs(os,ms,bs,gn)},undo:()=>{for(const[os,{savedX:ms,savedY:bs,savedPageIndex:gn}]of yn)rs(os,ms,bs,gn)},mustExec:!0}),!0}dragSelectedEditors(yn,_i){if(jr(this,Rr))for(const rs of jr(this,Rr).keys())rs.drag(yn,_i)}rebuild(yn){if(yn.parent===null){const _i=this.getLayer(yn.pageIndex);_i?(_i.changeParent(yn),_i.addOrRebuild(yn)):(this.addEditor(yn),this.addToAnnotationStorage(yn),yn.rebuild())}else yn.parent.addOrRebuild(yn)}isActive(yn){return jr(this,wr)===yn}getActive(){return jr(this,wr)}getMode(){return jr(this,Ur)}get imageManager(){return(0,tr.shadow)(this,"imageManager",new sr)}};wr=new WeakMap,kr=new WeakMap,Mr=new WeakMap,Hr=new WeakMap,Gr=new WeakMap,zr=new WeakMap,Br=new WeakMap,Vr=new WeakMap,Rr=new WeakMap,Xr=new WeakMap,an=new WeakMap,yr=new WeakMap,br=new WeakMap,Er=new WeakMap,Lr=new WeakMap,Or=new WeakMap,Ur=new WeakMap,$r=new WeakMap,Zr=new WeakMap,fn=new WeakMap,_n=new WeakMap,Kr=new WeakMap,Cn=new WeakMap,Dn=new WeakMap,wn=new WeakMap,Qr=new WeakMap,xn=new WeakMap,tn=new WeakMap,on=new WeakMap,vn=new WeakMap,Sn=new WeakMap,Ln=new WeakMap,Wn=new WeakMap,$n=new WeakMap,En=new WeakSet,nm=function(){window.addEventListener("focus",jr(this,_n)),window.addEventListener("blur",jr(this,fn))},Kp=function(){window.removeEventListener("focus",jr(this,_n)),window.removeEventListener("blur",jr(this,fn))},Jp=function(){window.addEventListener("keydown",jr(this,wn),{capture:!0})},Y0=function(){window.removeEventListener("keydown",jr(this,wn),{capture:!0})},Zp=function(){document.addEventListener("copy",jr(this,Kr)),document.addEventListener("cut",jr(this,Cn)),document.addEventListener("paste",jr(this,Dn))},Qp=function(){document.removeEventListener("copy",jr(this,Kr)),document.removeEventListener("cut",jr(this,Cn)),document.removeEventListener("paste",jr(this,Dn))},Uo=function(yn){Object.entries(yn).some(([rs,os])=>jr(this,vn)[rs]!==os)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(jr(this,vn),yn)})},_h=function(yn){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:yn})},im=function(){if(!jr(this,Er)){Gn(this,Er,!0);for(const yn of jr(this,Mr).values())yn.enable()}},am=function(){if(this.unselectAll(),jr(this,Er)){Gn(this,Er,!1);for(const yn of jr(this,Mr).values())yn.disable()}},e1=function(yn){const _i=jr(this,Mr).get(yn.pageIndex);_i?_i.addOrRebuild(yn):this.addEditor(yn)},e0=function(){if(jr(this,kr).size===0)return!0;if(jr(this,kr).size===1)for(const yn of jr(this,kr).values())return yn.isEmpty();return!1},t1=function(yn){jr(this,$r).clear();for(const _i of yn)_i.isEmpty()||(jr(this,$r).add(_i),_i.select());On(this,En,Uo).call(this,{hasSelectedEditor:!0})},Xs(Ls,"TRANSLATE_SMALL",1),Xs(Ls,"TRANSLATE_BIG",10);let fr=Ls;_e.AnnotationEditorUIManager=fr},(e,_e,er)=>{var Br,Vr,Rr,Xr,an,yr,br,Er,Lr,Or,Ur,$r,yu,bu,r1,K0,J0,t0,r0;Object.defineProperty(_e,"__esModule",{value:!0}),_e.StatTimer=_e.RenderingCancelledException=_e.PixelsPerInch=_e.PageViewport=_e.PDFDateString=_e.DOMStandardFontDataFactory=_e.DOMSVGFactory=_e.DOMFilterFactory=_e.DOMCanvasFactory=_e.DOMCMapReaderFactory=void 0,_e.deprecated=_r,_e.getColorValues=kr,_e.getCurrentTransform=Mr,_e.getCurrentTransformInverse=Hr,_e.getFilenameFromUrl=pr,_e.getPdfFilenameFromUrl=gr,_e.getRGB=wr,_e.getXfaPageViewport=Ir,_e.isDataScheme=dr,_e.isPdfFile=xr,_e.isValidFetchUrl=Cr,_e.loadScript=Fr,_e.noContextMenu=Tr,_e.setLayerDimensions=Gr;var tr=er(7),rr=er(1);const nr="http://www.w3.org/2000/svg",zr=class zr{};Xs(zr,"CSS",96),Xs(zr,"PDF",72),Xs(zr,"PDF_TO_CSS_UNITS",zr.CSS/zr.PDF);let ir=zr;_e.PixelsPerInch=ir;class ar extends tr.BaseFilterFactory{constructor({docId:tn,ownerDocument:on=globalThis.document}={}){super();Vn(this,$r);Vn(this,Br);Vn(this,Vr);Vn(this,Rr);Vn(this,Xr);Vn(this,an);Vn(this,yr);Vn(this,br);Vn(this,Er);Vn(this,Lr);Vn(this,Or);Vn(this,Ur,0);Gn(this,Rr,tn),Gn(this,Xr,on)}addFilter(tn){if(!tn)return"none";let on=jr(this,$r,yu).get(tn);if(on)return on;let vn,Sn,Ln,Wn;if(tn.length===1){const Qn=tn[0],vs=new Array(256);for(let es=0;es<256;es++)vs[es]=Qn[es]/255;Wn=vn=Sn=Ln=vs.join(",")}else{const[Qn,vs,es]=tn,ls=new Array(256),Xn=new Array(256),ws=new Array(256);for(let ds=0;ds<256;ds++)ls[ds]=Qn[ds]/255,Xn[ds]=vs[ds]/255,ws[ds]=es[ds]/255;vn=ls.join(","),Sn=Xn.join(","),Ln=ws.join(","),Wn=`${vn}${Sn}${Ln}`}if(on=jr(this,$r,yu).get(Wn),on)return jr(this,$r,yu).set(tn,on),on;const $n=`g_${jr(this,Rr)}_transfer_map_${_f(this,Ur)._++}`,En=`url(#${$n})`;jr(this,$r,yu).set(tn,En),jr(this,$r,yu).set(Wn,En);const ba=On(this,$r,K0).call(this,$n);return On(this,$r,t0).call(this,vn,Sn,Ln,ba),En}addHCMFilter(tn,on){var vs;const vn=`${tn}-${on}`;if(jr(this,yr)===vn)return jr(this,br);if(Gn(this,yr,vn),Gn(this,br,"none"),(vs=jr(this,an))==null||vs.remove(),!tn||!on)return jr(this,br);const Sn=On(this,$r,r0).call(this,tn);tn=rr.Util.makeHexColor(...Sn);const Ln=On(this,$r,r0).call(this,on);if(on=rr.Util.makeHexColor(...Ln),jr(this,$r,bu).style.color="",tn==="#000000"&&on==="#ffffff"||tn===on)return jr(this,br);const Wn=new Array(256);for(let es=0;es<=255;es++){const ls=es/255;Wn[es]=ls<=.03928?ls/12.92:((ls+.055)/1.055)**2.4}const $n=Wn.join(","),En=`g_${jr(this,Rr)}_hcm_filter`,ba=Gn(this,Er,On(this,$r,K0).call(this,En));On(this,$r,t0).call(this,$n,$n,$n,ba),On(this,$r,r1).call(this,ba);const Qn=(es,ls)=>{const Xn=Sn[es]/255,ws=Ln[es]/255,ds=new Array(ls+1);for(let Ps=0;Ps<=ls;Ps++)ds[Ps]=Xn+Ps/ls*(ws-Xn);return ds.join(",")};return On(this,$r,t0).call(this,Qn(0,5),Qn(1,5),Qn(2,5),ba),Gn(this,br,`url(#${En})`),jr(this,br)}addHighlightHCMFilter(tn,on,vn,Sn){var ws;const Ln=`${tn}-${on}-${vn}-${Sn}`;if(jr(this,Lr)===Ln)return jr(this,Or);if(Gn(this,Lr,Ln),Gn(this,Or,"none"),(ws=jr(this,Er))==null||ws.remove(),!tn||!on)return jr(this,Or);const[Wn,$n]=[tn,on].map(On(this,$r,r0).bind(this));let En=Math.round(.2126*Wn[0]+.7152*Wn[1]+.0722*Wn[2]),ba=Math.round(.2126*$n[0]+.7152*$n[1]+.0722*$n[2]),[Qn,vs]=[vn,Sn].map(On(this,$r,r0).bind(this));ba<En&&([En,ba,Qn,vs]=[ba,En,vs,Qn]),jr(this,$r,bu).style.color="";const es=(ds,Ps,Zn)=>{const Mn=new Array(256),zn=(ba-En)/Zn,cs=ds/255,Ls=(Ps-ds)/(255*Zn);let As=0;for(let yn=0;yn<=Zn;yn++){const _i=Math.round(En+yn*zn),rs=cs+yn*Ls;for(let os=As;os<=_i;os++)Mn[os]=rs;As=_i+1}for(let yn=As;yn<256;yn++)Mn[yn]=Mn[As-1];return Mn.join(",")},ls=`g_${jr(this,Rr)}_hcm_highlight_filter`,Xn=Gn(this,Er,On(this,$r,K0).call(this,ls));return On(this,$r,r1).call(this,Xn),On(this,$r,t0).call(this,es(Qn[0],vs[0],5),es(Qn[1],vs[1],5),es(Qn[2],vs[2],5),Xn),Gn(this,Or,`url(#${ls})`),jr(this,Or)}destroy(tn=!1){tn&&(jr(this,br)||jr(this,Or))||(jr(this,Vr)&&(jr(this,Vr).parentNode.parentNode.remove(),Gn(this,Vr,null)),jr(this,Br)&&(jr(this,Br).clear(),Gn(this,Br,null)),Gn(this,Ur,0))}}Br=new WeakMap,Vr=new WeakMap,Rr=new WeakMap,Xr=new WeakMap,an=new WeakMap,yr=new WeakMap,br=new WeakMap,Er=new WeakMap,Lr=new WeakMap,Or=new WeakMap,Ur=new WeakMap,$r=new WeakSet,yu=function(){return jr(this,Br)||Gn(this,Br,new Map)},bu=function(){if(!jr(this,Vr)){const tn=jr(this,Xr).createElement("div"),{style:on}=tn;on.visibility="hidden",on.contain="strict",on.width=on.height=0,on.position="absolute",on.top=on.left=0,on.zIndex=-1;const vn=jr(this,Xr).createElementNS(nr,"svg");vn.setAttribute("width",0),vn.setAttribute("height",0),Gn(this,Vr,jr(this,Xr).createElementNS(nr,"defs")),tn.append(vn),vn.append(jr(this,Vr)),jr(this,Xr).body.append(tn)}return jr(this,Vr)},r1=function(tn){const on=jr(this,Xr).createElementNS(nr,"feColorMatrix");on.setAttribute("type","matrix"),on.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),tn.append(on)},K0=function(tn){const on=jr(this,Xr).createElementNS(nr,"filter");return on.setAttribute("color-interpolation-filters","sRGB"),on.setAttribute("id",tn),jr(this,$r,bu).append(on),on},J0=function(tn,on,vn){const Sn=jr(this,Xr).createElementNS(nr,on);Sn.setAttribute("type","discrete"),Sn.setAttribute("tableValues",vn),tn.append(Sn)},t0=function(tn,on,vn,Sn){const Ln=jr(this,Xr).createElementNS(nr,"feComponentTransfer");Sn.append(Ln),On(this,$r,J0).call(this,Ln,"feFuncR",tn),On(this,$r,J0).call(this,Ln,"feFuncG",on),On(this,$r,J0).call(this,Ln,"feFuncB",vn)},r0=function(tn){return jr(this,$r,bu).style.color=tn,wr(getComputedStyle(jr(this,$r,bu)).getPropertyValue("color"))},_e.DOMFilterFactory=ar;class sr extends tr.BaseCanvasFactory{constructor({ownerDocument:xn=globalThis.document}={}){super(),this._document=xn}_createCanvas(xn,tn){const on=this._document.createElement("canvas");return on.width=xn,on.height=tn,on}}_e.DOMCanvasFactory=sr;async function or(Qr,xn=!1){if(Cr(Qr,document.baseURI)){const tn=await fetch(Qr);if(!tn.ok)throw new Error(tn.statusText);return xn?new Uint8Array(await tn.arrayBuffer()):(0,rr.stringToBytes)(await tn.text())}return new Promise((tn,on)=>{const vn=new XMLHttpRequest;vn.open("GET",Qr,!0),xn&&(vn.responseType="arraybuffer"),vn.onreadystatechange=()=>{if(vn.readyState===XMLHttpRequest.DONE){if(vn.status===200||vn.status===0){let Sn;if(xn&&vn.response?Sn=new Uint8Array(vn.response):!xn&&vn.responseText&&(Sn=(0,rr.stringToBytes)(vn.responseText)),Sn){tn(Sn);return}}on(new Error(vn.statusText))}},vn.send(null)})}class lr extends tr.BaseCMapReaderFactory{_fetchData(xn,tn){return or(xn,this.isCompressed).then(on=>({cMapData:on,compressionType:tn}))}}_e.DOMCMapReaderFactory=lr;class ur extends tr.BaseStandardFontDataFactory{_fetchData(xn){return or(xn,!0)}}_e.DOMStandardFontDataFactory=ur;class fr extends tr.BaseSVGFactory{_createSVG(xn){return document.createElementNS(nr,xn)}}_e.DOMSVGFactory=fr;class cr{constructor({viewBox:xn,scale:tn,rotation:on,offsetX:vn=0,offsetY:Sn=0,dontFlip:Ln=!1}){this.viewBox=xn,this.scale=tn,this.rotation=on,this.offsetX=vn,this.offsetY=Sn;const Wn=(xn[2]+xn[0])/2,$n=(xn[3]+xn[1])/2;let En,ba,Qn,vs;switch(on%=360,on<0&&(on+=360),on){case 180:En=-1,ba=0,Qn=0,vs=1;break;case 90:En=0,ba=1,Qn=1,vs=0;break;case 270:En=0,ba=-1,Qn=-1,vs=0;break;case 0:En=1,ba=0,Qn=0,vs=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ln&&(Qn=-Qn,vs=-vs);let es,ls,Xn,ws;En===0?(es=Math.abs($n-xn[1])*tn+vn,ls=Math.abs(Wn-xn[0])*tn+Sn,Xn=(xn[3]-xn[1])*tn,ws=(xn[2]-xn[0])*tn):(es=Math.abs(Wn-xn[0])*tn+vn,ls=Math.abs($n-xn[1])*tn+Sn,Xn=(xn[2]-xn[0])*tn,ws=(xn[3]-xn[1])*tn),this.transform=[En*tn,ba*tn,Qn*tn,vs*tn,es-En*tn*Wn-Qn*tn*$n,ls-ba*tn*Wn-vs*tn*$n],this.width=Xn,this.height=ws}get rawDims(){const{viewBox:xn}=this;return(0,rr.shadow)(this,"rawDims",{pageWidth:xn[2]-xn[0],pageHeight:xn[3]-xn[1],pageX:xn[0],pageY:xn[1]})}clone({scale:xn=this.scale,rotation:tn=this.rotation,offsetX:on=this.offsetX,offsetY:vn=this.offsetY,dontFlip:Sn=!1}={}){return new cr({viewBox:this.viewBox.slice(),scale:xn,rotation:tn,offsetX:on,offsetY:vn,dontFlip:Sn})}convertToViewportPoint(xn,tn){return rr.Util.applyTransform([xn,tn],this.transform)}convertToViewportRectangle(xn){const tn=rr.Util.applyTransform([xn[0],xn[1]],this.transform),on=rr.Util.applyTransform([xn[2],xn[3]],this.transform);return[tn[0],tn[1],on[0],on[1]]}convertToPdfPoint(xn,tn){return rr.Util.applyInverseTransform([xn,tn],this.transform)}}_e.PageViewport=cr;class mr extends rr.BaseException{constructor(xn,tn=0){super(xn,"RenderingCancelledException"),this.extraDelay=tn}}_e.RenderingCancelledException=mr;function dr(Qr){const xn=Qr.length;let tn=0;for(;tn<xn&&Qr[tn].trim()==="";)tn++;return Qr.substring(tn,tn+5).toLowerCase()==="data:"}function xr(Qr){return typeof Qr=="string"&&/\.pdf$/i.test(Qr)}function pr(Qr,xn=!1){return xn||([Qr]=Qr.split(/[#?]/,1)),Qr.substring(Qr.lastIndexOf("/")+1)}function gr(Qr,xn="document.pdf"){if(typeof Qr!="string")return xn;if(dr(Qr))return(0,rr.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),xn;const tn=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,on=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,vn=tn.exec(Qr);let Sn=on.exec(vn[1])||on.exec(vn[2])||on.exec(vn[3]);if(Sn&&(Sn=Sn[0],Sn.includes("%")))try{Sn=on.exec(decodeURIComponent(Sn))[0]}catch{}return Sn||xn}class vr{constructor(){Xs(this,"started",Object.create(null));Xs(this,"times",[])}time(xn){xn in this.started&&(0,rr.warn)(`Timer is already running for ${xn}`),this.started[xn]=Date.now()}timeEnd(xn){xn in this.started||(0,rr.warn)(`Timer has not been started for ${xn}`),this.times.push({name:xn,start:this.started[xn],end:Date.now()}),delete this.started[xn]}toString(){const xn=[];let tn=0;for(const{name:on}of this.times)tn=Math.max(on.length,tn);for(const{name:on,start:vn,end:Sn}of this.times)xn.push(`${on.padEnd(tn)} ${Sn-vn}ms
`);return xn.join("")}}_e.StatTimer=vr;function Cr(Qr,xn){try{const{protocol:tn}=xn?new URL(Qr,xn):new URL(Qr);return tn==="http:"||tn==="https:"}catch{return!1}}function Tr(Qr){Qr.preventDefault()}function Fr(Qr,xn=!1){return new Promise((tn,on)=>{const vn=document.createElement("script");vn.src=Qr,vn.onload=function(Sn){xn&&vn.remove(),tn(Sn)},vn.onerror=function(){on(new Error(`Cannot load script at: ${vn.src}`))},(document.head||document.documentElement).append(vn)})}function _r(Qr){console.log("Deprecated API usage: "+Qr)}let Ar;class Pr{static toDateObject(xn){if(!xn||typeof xn!="string")return null;Ar||(Ar=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const tn=Ar.exec(xn);if(!tn)return null;const on=parseInt(tn[1],10);let vn=parseInt(tn[2],10);vn=vn>=1&&vn<=12?vn-1:0;let Sn=parseInt(tn[3],10);Sn=Sn>=1&&Sn<=31?Sn:1;let Ln=parseInt(tn[4],10);Ln=Ln>=0&&Ln<=23?Ln:0;let Wn=parseInt(tn[5],10);Wn=Wn>=0&&Wn<=59?Wn:0;let $n=parseInt(tn[6],10);$n=$n>=0&&$n<=59?$n:0;const En=tn[7]||"Z";let ba=parseInt(tn[8],10);ba=ba>=0&&ba<=23?ba:0;let Qn=parseInt(tn[9],10)||0;return Qn=Qn>=0&&Qn<=59?Qn:0,En==="-"?(Ln+=ba,Wn+=Qn):En==="+"&&(Ln-=ba,Wn-=Qn),new Date(Date.UTC(on,vn,Sn,Ln,Wn,$n))}}_e.PDFDateString=Pr;function Ir(Qr,{scale:xn=1,rotation:tn=0}){const{width:on,height:vn}=Qr.attributes.style,Sn=[0,0,parseInt(on),parseInt(vn)];return new cr({viewBox:Sn,scale:xn,rotation:tn})}function wr(Qr){if(Qr.startsWith("#")){const xn=parseInt(Qr.slice(1),16);return[(xn&16711680)>>16,(xn&65280)>>8,xn&255]}return Qr.startsWith("rgb(")?Qr.slice(4,-1).split(",").map(xn=>parseInt(xn)):Qr.startsWith("rgba(")?Qr.slice(5,-1).split(",").map(xn=>parseInt(xn)).slice(0,3):((0,rr.warn)(`Not a valid color format: "${Qr}"`),[0,0,0])}function kr(Qr){const xn=document.createElement("span");xn.style.visibility="hidden",document.body.append(xn);for(const tn of Qr.keys()){xn.style.color=tn;const on=window.getComputedStyle(xn).color;Qr.set(tn,wr(on))}xn.remove()}function Mr(Qr){const{a:xn,b:tn,c:on,d:vn,e:Sn,f:Ln}=Qr.getTransform();return[xn,tn,on,vn,Sn,Ln]}function Hr(Qr){const{a:xn,b:tn,c:on,d:vn,e:Sn,f:Ln}=Qr.getTransform().invertSelf();return[xn,tn,on,vn,Sn,Ln]}function Gr(Qr,xn,tn=!1,on=!0){if(xn instanceof cr){const{pageWidth:vn,pageHeight:Sn}=xn.rawDims,{style:Ln}=Qr,Wn=rr.FeatureTest.isCSSRoundSupported,$n=`var(--scale-factor) * ${vn}px`,En=`var(--scale-factor) * ${Sn}px`,ba=Wn?`round(${$n}, 1px)`:`calc(${$n})`,Qn=Wn?`round(${En}, 1px)`:`calc(${En})`;!tn||xn.rotation%180===0?(Ln.width=ba,Ln.height=Qn):(Ln.width=Qn,Ln.height=ba)}on&&Qr.setAttribute("data-main-rotation",xn.rotation)}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.BaseStandardFontDataFactory=_e.BaseSVGFactory=_e.BaseFilterFactory=_e.BaseCanvasFactory=_e.BaseCMapReaderFactory=void 0;var tr=er(1);class rr{constructor(){this.constructor===rr&&(0,tr.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(lr){return"none"}addHCMFilter(lr,ur){return"none"}addHighlightHCMFilter(lr,ur,fr,cr){return"none"}destroy(lr=!1){}}_e.BaseFilterFactory=rr;class nr{constructor(){this.constructor===nr&&(0,tr.unreachable)("Cannot initialize BaseCanvasFactory.")}create(lr,ur){if(lr<=0||ur<=0)throw new Error("Invalid canvas size");const fr=this._createCanvas(lr,ur);return{canvas:fr,context:fr.getContext("2d")}}reset(lr,ur,fr){if(!lr.canvas)throw new Error("Canvas is not specified");if(ur<=0||fr<=0)throw new Error("Invalid canvas size");lr.canvas.width=ur,lr.canvas.height=fr}destroy(lr){if(!lr.canvas)throw new Error("Canvas is not specified");lr.canvas.width=0,lr.canvas.height=0,lr.canvas=null,lr.context=null}_createCanvas(lr,ur){(0,tr.unreachable)("Abstract method `_createCanvas` called.")}}_e.BaseCanvasFactory=nr;class ir{constructor({baseUrl:lr=null,isCompressed:ur=!0}){this.constructor===ir&&(0,tr.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=lr,this.isCompressed=ur}async fetch({name:lr}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!lr)throw new Error("CMap name must be specified.");const ur=this.baseUrl+lr+(this.isCompressed?".bcmap":""),fr=this.isCompressed?tr.CMapCompressionType.BINARY:tr.CMapCompressionType.NONE;return this._fetchData(ur,fr).catch(cr=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${ur}`)})}_fetchData(lr,ur){(0,tr.unreachable)("Abstract method `_fetchData` called.")}}_e.BaseCMapReaderFactory=ir;class ar{constructor({baseUrl:lr=null}){this.constructor===ar&&(0,tr.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=lr}async fetch({filename:lr}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!lr)throw new Error("Font filename must be specified.");const ur=`${this.baseUrl}${lr}`;return this._fetchData(ur).catch(fr=>{throw new Error(`Unable to load font data at: ${ur}`)})}_fetchData(lr){(0,tr.unreachable)("Abstract method `_fetchData` called.")}}_e.BaseStandardFontDataFactory=ar;class sr{constructor(){this.constructor===sr&&(0,tr.unreachable)("Cannot initialize BaseSVGFactory.")}create(lr,ur,fr=!1){if(lr<=0||ur<=0)throw new Error("Invalid SVG dimensions");const cr=this._createSVG("svg:svg");return cr.setAttribute("version","1.1"),fr||(cr.setAttribute("width",`${lr}px`),cr.setAttribute("height",`${ur}px`)),cr.setAttribute("preserveAspectRatio","none"),cr.setAttribute("viewBox",`0 0 ${lr} ${ur}`),cr}createElement(lr){if(typeof lr!="string")throw new Error("Invalid SVG element type");return this._createSVG(lr)}_createSVG(lr){(0,tr.unreachable)("Abstract method `_createSVG` called.")}}_e.BaseSVGFactory=sr},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.MurmurHash3_64=void 0;var tr=er(1);const rr=3285377520,nr=4294901760,ir=65535;class ar{constructor(or){this.h1=or?or&4294967295:rr,this.h2=or?or&4294967295:rr}update(or){let lr,ur;if(typeof or=="string"){lr=new Uint8Array(or.length*2),ur=0;for(let _r=0,Ar=or.length;_r<Ar;_r++){const Pr=or.charCodeAt(_r);Pr<=255?lr[ur++]=Pr:(lr[ur++]=Pr>>>8,lr[ur++]=Pr&255)}}else if((0,tr.isArrayBuffer)(or))lr=or.slice(),ur=lr.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const fr=ur>>2,cr=ur-fr*4,mr=new Uint32Array(lr.buffer,0,fr);let dr=0,xr=0,pr=this.h1,gr=this.h2;const vr=3432918353,Cr=461845907,Tr=vr&ir,Fr=Cr&ir;for(let _r=0;_r<fr;_r++)_r&1?(dr=mr[_r],dr=dr*vr&nr|dr*Tr&ir,dr=dr<<15|dr>>>17,dr=dr*Cr&nr|dr*Fr&ir,pr^=dr,pr=pr<<13|pr>>>19,pr=pr*5+3864292196):(xr=mr[_r],xr=xr*vr&nr|xr*Tr&ir,xr=xr<<15|xr>>>17,xr=xr*Cr&nr|xr*Fr&ir,gr^=xr,gr=gr<<13|gr>>>19,gr=gr*5+3864292196);switch(dr=0,cr){case 3:dr^=lr[fr*4+2]<<16;case 2:dr^=lr[fr*4+1]<<8;case 1:dr^=lr[fr*4],dr=dr*vr&nr|dr*Tr&ir,dr=dr<<15|dr>>>17,dr=dr*Cr&nr|dr*Fr&ir,fr&1?pr^=dr:gr^=dr}this.h1=pr,this.h2=gr}hexdigest(){let or=this.h1,lr=this.h2;return or^=lr>>>1,or=or*3981806797&nr|or*36045&ir,lr=lr*4283543511&nr|((lr<<16|or>>>16)*2950163797&nr)>>>16,or^=lr>>>1,or=or*444984403&nr|or*60499&ir,lr=lr*3301882366&nr|((lr<<16|or>>>16)*3120437893&nr)>>>16,or^=lr>>>1,(or>>>0).toString(16).padStart(8,"0")+(lr>>>0).toString(16).padStart(8,"0")}}_e.MurmurHash3_64=ar},(e,_e,er)=>{var ir;Object.defineProperty(_e,"__esModule",{value:!0}),_e.FontLoader=_e.FontFaceObject=void 0;var tr=er(1);class rr{constructor({ownerDocument:sr=globalThis.document,styleElement:or=null}){Vn(this,ir,new Set);this._document=sr,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(sr){this.nativeFontFaces.add(sr),this._document.fonts.add(sr)}removeNativeFontFace(sr){this.nativeFontFaces.delete(sr),this._document.fonts.delete(sr)}insertRule(sr){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const or=this.styleElement.sheet;or.insertRule(sr,or.cssRules.length)}clear(){for(const sr of this.nativeFontFaces)this._document.fonts.delete(sr);this.nativeFontFaces.clear(),jr(this,ir).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(sr){if(!(!sr||jr(this,ir).has(sr.loadedName))){if((0,tr.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:or,src:lr,style:ur}=sr,fr=new FontFace(or,lr,ur);this.addNativeFontFace(fr);try{await fr.load(),jr(this,ir).add(or)}catch{(0,tr.warn)(`Cannot load system font: ${sr.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(fr)}return}(0,tr.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(sr){if(sr.attached||sr.missingFile&&!sr.systemFontInfo)return;if(sr.attached=!0,sr.systemFontInfo){await this.loadSystemFont(sr.systemFontInfo);return}if(this.isFontLoadingAPISupported){const lr=sr.createNativeFontFace();if(lr){this.addNativeFontFace(lr);try{await lr.loaded}catch(ur){throw(0,tr.warn)(`Failed to load font '${lr.family}': '${ur}'.`),sr.disableFontFace=!0,ur}}return}const or=sr.createFontFaceRule();if(or){if(this.insertRule(or),this.isSyncFontLoadingSupported)return;await new Promise(lr=>{const ur=this._queueLoadingCallback(lr);this._prepareFontLoadEvent(sr,ur)})}}get isFontLoadingAPISupported(){var or;const sr=!!((or=this._document)!=null&&or.fonts);return(0,tr.shadow)(this,"isFontLoadingAPISupported",sr)}get isSyncFontLoadingSupported(){let sr=!1;return(tr.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(sr=!0),(0,tr.shadow)(this,"isSyncFontLoadingSupported",sr)}_queueLoadingCallback(sr){function or(){for((0,tr.assert)(!ur.done,"completeRequest() cannot be called twice."),ur.done=!0;lr.length>0&&lr[0].done;){const fr=lr.shift();setTimeout(fr.callback,0)}}const{loadingRequests:lr}=this,ur={done:!1,complete:or,callback:sr};return lr.push(ur),ur}get _loadTestFont(){const sr=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,tr.shadow)(this,"_loadTestFont",sr)}_prepareFontLoadEvent(sr,or){function lr(wr,kr){return wr.charCodeAt(kr)<<24|wr.charCodeAt(kr+1)<<16|wr.charCodeAt(kr+2)<<8|wr.charCodeAt(kr+3)&255}function ur(wr,kr,Mr,Hr){const Gr=wr.substring(0,kr),zr=wr.substring(kr+Mr);return Gr+Hr+zr}let fr,cr;const mr=this._document.createElement("canvas");mr.width=1,mr.height=1;const dr=mr.getContext("2d");let xr=0;function pr(wr,kr){if(++xr>30){(0,tr.warn)("Load test font never loaded."),kr();return}if(dr.font="30px "+wr,dr.fillText(".",0,20),dr.getImageData(0,0,1,1).data[3]>0){kr();return}setTimeout(pr.bind(null,wr,kr))}const gr=`lt${Date.now()}${this.loadTestFontId++}`;let vr=this._loadTestFont;vr=ur(vr,976,gr.length,gr);const Tr=16,Fr=1482184792;let _r=lr(vr,Tr);for(fr=0,cr=gr.length-3;fr<cr;fr+=4)_r=_r-Fr+lr(gr,fr)|0;fr<gr.length&&(_r=_r-Fr+lr(gr+"XXX",fr)|0),vr=ur(vr,Tr,4,(0,tr.string32)(_r));const Ar=`url(data:font/opentype;base64,${btoa(vr)});`,Pr=`@font-face {font-family:"${gr}";src:${Ar}}`;this.insertRule(Pr);const Ir=this._document.createElement("div");Ir.style.visibility="hidden",Ir.style.width=Ir.style.height="10px",Ir.style.position="absolute",Ir.style.top=Ir.style.left="0px";for(const wr of[sr.loadedName,gr]){const kr=this._document.createElement("span");kr.textContent="Hi",kr.style.fontFamily=wr,Ir.append(kr)}this._document.body.append(Ir),pr(gr,()=>{Ir.remove(),or.complete()})}}ir=new WeakMap,_e.FontLoader=rr;class nr{constructor(sr,{isEvalSupported:or=!0,disableFontFace:lr=!1,ignoreErrors:ur=!1,inspectFont:fr=null}){this.compiledGlyphs=Object.create(null);for(const cr in sr)this[cr]=sr[cr];this.isEvalSupported=or!==!1,this.disableFontFace=lr===!0,this.ignoreErrors=ur===!0,this._inspectFont=fr}createNativeFontFace(){var or;if(!this.data||this.disableFontFace)return null;let sr;if(!this.cssFontInfo)sr=new FontFace(this.loadedName,this.data,{});else{const lr={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(lr.style=`oblique ${this.cssFontInfo.italicAngle}deg`),sr=new FontFace(this.cssFontInfo.fontFamily,this.data,lr)}return(or=this._inspectFont)==null||or.call(this,this),sr}createFontFaceRule(){var ur;if(!this.data||this.disableFontFace)return null;const sr=(0,tr.bytesToString)(this.data),or=`url(data:${this.mimetype};base64,${btoa(sr)});`;let lr;if(!this.cssFontInfo)lr=`@font-face {font-family:"${this.loadedName}";src:${or}}`;else{let fr=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(fr+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),lr=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${fr}src:${or}}`}return(ur=this._inspectFont)==null||ur.call(this,this,or),lr}getPathGenerator(sr,or){if(this.compiledGlyphs[or]!==void 0)return this.compiledGlyphs[or];let lr;try{lr=sr.get(this.loadedName+"_path_"+or)}catch(ur){if(!this.ignoreErrors)throw ur;return(0,tr.warn)(`getPathGenerator - ignoring character: "${ur}".`),this.compiledGlyphs[or]=function(fr,cr){}}if(this.isEvalSupported&&tr.FeatureTest.isEvalSupported){const ur=[];for(const fr of lr){const cr=fr.args!==void 0?fr.args.join(","):"";ur.push("c.",fr.cmd,"(",cr,`);
`)}return this.compiledGlyphs[or]=new Function("c","size",ur.join(""))}return this.compiledGlyphs[or]=function(ur,fr){for(const cr of lr)cr.cmd==="scale"&&(cr.args=[fr,-fr]),ur[cr.cmd].apply(ur,cr.args)}}}_e.FontFaceObject=nr},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.NodeStandardFontDataFactory=_e.NodeFilterFactory=_e.NodeCanvasFactory=_e.NodeCMapReaderFactory=void 0;var tr=er(7);er(1);const rr=function(or){return new Promise((lr,ur)=>{require$$5.readFile(or,(cr,mr)=>{if(cr||!mr){ur(new Error(cr));return}lr(new Uint8Array(mr))})})};class nr extends tr.BaseFilterFactory{}_e.NodeFilterFactory=nr;class ir extends tr.BaseCanvasFactory{_createCanvas(lr,ur){return require$$5.createCanvas(lr,ur)}}_e.NodeCanvasFactory=ir;class ar extends tr.BaseCMapReaderFactory{_fetchData(lr,ur){return rr(lr).then(fr=>({cMapData:fr,compressionType:ur}))}}_e.NodeCMapReaderFactory=ar;class sr extends tr.BaseStandardFontDataFactory{_fetchData(lr){return rr(lr)}}_e.NodeStandardFontDataFactory=sr},(e,_e,er)=>{var Vr,n1,i1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.CanvasGraphics=void 0;var tr=er(1),rr=er(6),nr=er(12),ir=er(13);const ar=16,sr=100,or=4096,lr=15,ur=10,fr=1e3,cr=16;function mr(yr,br){if(yr._removeMirroring)throw new Error("Context is already forwarding operations.");yr.__originalSave=yr.save,yr.__originalRestore=yr.restore,yr.__originalRotate=yr.rotate,yr.__originalScale=yr.scale,yr.__originalTranslate=yr.translate,yr.__originalTransform=yr.transform,yr.__originalSetTransform=yr.setTransform,yr.__originalResetTransform=yr.resetTransform,yr.__originalClip=yr.clip,yr.__originalMoveTo=yr.moveTo,yr.__originalLineTo=yr.lineTo,yr.__originalBezierCurveTo=yr.bezierCurveTo,yr.__originalRect=yr.rect,yr.__originalClosePath=yr.closePath,yr.__originalBeginPath=yr.beginPath,yr._removeMirroring=()=>{yr.save=yr.__originalSave,yr.restore=yr.__originalRestore,yr.rotate=yr.__originalRotate,yr.scale=yr.__originalScale,yr.translate=yr.__originalTranslate,yr.transform=yr.__originalTransform,yr.setTransform=yr.__originalSetTransform,yr.resetTransform=yr.__originalResetTransform,yr.clip=yr.__originalClip,yr.moveTo=yr.__originalMoveTo,yr.lineTo=yr.__originalLineTo,yr.bezierCurveTo=yr.__originalBezierCurveTo,yr.rect=yr.__originalRect,yr.closePath=yr.__originalClosePath,yr.beginPath=yr.__originalBeginPath,delete yr._removeMirroring},yr.save=function(){br.save(),this.__originalSave()},yr.restore=function(){br.restore(),this.__originalRestore()},yr.translate=function(Lr,Or){br.translate(Lr,Or),this.__originalTranslate(Lr,Or)},yr.scale=function(Lr,Or){br.scale(Lr,Or),this.__originalScale(Lr,Or)},yr.transform=function(Lr,Or,Ur,$r,Zr,fn){br.transform(Lr,Or,Ur,$r,Zr,fn),this.__originalTransform(Lr,Or,Ur,$r,Zr,fn)},yr.setTransform=function(Lr,Or,Ur,$r,Zr,fn){br.setTransform(Lr,Or,Ur,$r,Zr,fn),this.__originalSetTransform(Lr,Or,Ur,$r,Zr,fn)},yr.resetTransform=function(){br.resetTransform(),this.__originalResetTransform()},yr.rotate=function(Lr){br.rotate(Lr),this.__originalRotate(Lr)},yr.clip=function(Lr){br.clip(Lr),this.__originalClip(Lr)},yr.moveTo=function(Er,Lr){br.moveTo(Er,Lr),this.__originalMoveTo(Er,Lr)},yr.lineTo=function(Er,Lr){br.lineTo(Er,Lr),this.__originalLineTo(Er,Lr)},yr.bezierCurveTo=function(Er,Lr,Or,Ur,$r,Zr){br.bezierCurveTo(Er,Lr,Or,Ur,$r,Zr),this.__originalBezierCurveTo(Er,Lr,Or,Ur,$r,Zr)},yr.rect=function(Er,Lr,Or,Ur){br.rect(Er,Lr,Or,Ur),this.__originalRect(Er,Lr,Or,Ur)},yr.closePath=function(){br.closePath(),this.__originalClosePath()},yr.beginPath=function(){br.beginPath(),this.__originalBeginPath()}}class dr{constructor(br){this.canvasFactory=br,this.cache=Object.create(null)}getCanvas(br,Er,Lr){let Or;return this.cache[br]!==void 0?(Or=this.cache[br],this.canvasFactory.reset(Or,Er,Lr)):(Or=this.canvasFactory.create(Er,Lr),this.cache[br]=Or),Or}delete(br){delete this.cache[br]}clear(){for(const br in this.cache){const Er=this.cache[br];this.canvasFactory.destroy(Er),delete this.cache[br]}}}function xr(yr,br,Er,Lr,Or,Ur,$r,Zr,fn,_n){const[Kr,Cn,Dn,wn,Qr,xn]=(0,rr.getCurrentTransform)(yr);if(Cn===0&&Dn===0){const vn=$r*Kr+Qr,Sn=Math.round(vn),Ln=Zr*wn+xn,Wn=Math.round(Ln),$n=($r+fn)*Kr+Qr,En=Math.abs(Math.round($n)-Sn)||1,ba=(Zr+_n)*wn+xn,Qn=Math.abs(Math.round(ba)-Wn)||1;return yr.setTransform(Math.sign(Kr),0,0,Math.sign(wn),Sn,Wn),yr.drawImage(br,Er,Lr,Or,Ur,0,0,En,Qn),yr.setTransform(Kr,Cn,Dn,wn,Qr,xn),[En,Qn]}if(Kr===0&&wn===0){const vn=Zr*Dn+Qr,Sn=Math.round(vn),Ln=$r*Cn+xn,Wn=Math.round(Ln),$n=(Zr+_n)*Dn+Qr,En=Math.abs(Math.round($n)-Sn)||1,ba=($r+fn)*Cn+xn,Qn=Math.abs(Math.round(ba)-Wn)||1;return yr.setTransform(0,Math.sign(Cn),Math.sign(Dn),0,Sn,Wn),yr.drawImage(br,Er,Lr,Or,Ur,0,0,Qn,En),yr.setTransform(Kr,Cn,Dn,wn,Qr,xn),[Qn,En]}yr.drawImage(br,Er,Lr,Or,Ur,$r,Zr,fn,_n);const tn=Math.hypot(Kr,Cn),on=Math.hypot(Dn,wn);return[tn*fn,on*_n]}function pr(yr){const{width:br,height:Er}=yr;if(br>fr||Er>fr)return null;const Lr=1e3,Or=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Ur=br+1;let $r=new Uint8Array(Ur*(Er+1)),Zr,fn,_n;const Kr=br+7&-8;let Cn=new Uint8Array(Kr*Er),Dn=0;for(const on of yr.data){let vn=128;for(;vn>0;)Cn[Dn++]=on&vn?0:255,vn>>=1}let wn=0;for(Dn=0,Cn[Dn]!==0&&($r[0]=1,++wn),fn=1;fn<br;fn++)Cn[Dn]!==Cn[Dn+1]&&($r[fn]=Cn[Dn]?2:1,++wn),Dn++;for(Cn[Dn]!==0&&($r[fn]=2,++wn),Zr=1;Zr<Er;Zr++){Dn=Zr*Kr,_n=Zr*Ur,Cn[Dn-Kr]!==Cn[Dn]&&($r[_n]=Cn[Dn]?1:8,++wn);let on=(Cn[Dn]?4:0)+(Cn[Dn-Kr]?8:0);for(fn=1;fn<br;fn++)on=(on>>2)+(Cn[Dn+1]?4:0)+(Cn[Dn-Kr+1]?8:0),Or[on]&&($r[_n+fn]=Or[on],++wn),Dn++;if(Cn[Dn-Kr]!==Cn[Dn]&&($r[_n+fn]=Cn[Dn]?2:4,++wn),wn>Lr)return null}for(Dn=Kr*(Er-1),_n=Zr*Ur,Cn[Dn]!==0&&($r[_n]=8,++wn),fn=1;fn<br;fn++)Cn[Dn]!==Cn[Dn+1]&&($r[_n+fn]=Cn[Dn]?4:8,++wn),Dn++;if(Cn[Dn]!==0&&($r[_n+fn]=4,++wn),wn>Lr)return null;const Qr=new Int32Array([0,Ur,-1,0,-Ur,0,0,0,1]),xn=new Path2D;for(Zr=0;wn&&Zr<=Er;Zr++){let on=Zr*Ur;const vn=on+br;for(;on<vn&&!$r[on];)on++;if(on===vn)continue;xn.moveTo(on%Ur,Zr);const Sn=on;let Ln=$r[on];do{const Wn=Qr[Ln];do on+=Wn;while(!$r[on]);const $n=$r[on];$n!==5&&$n!==10?(Ln=$n,$r[on]=0):(Ln=$n&51*Ln>>4,$r[on]&=Ln>>2|Ln<<2),xn.lineTo(on%Ur,on/Ur|0),$r[on]||--wn}while(Sn!==on);--Zr}return Cn=null,$r=null,function(on){on.save(),on.scale(1/br,-1/Er),on.translate(0,-Er),on.fill(xn),on.beginPath(),on.restore()}}class gr{constructor(br,Er){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=tr.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=tr.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=tr.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,br,Er])}clone(){const br=Object.create(this);return br.clipBox=this.clipBox.slice(),br}setCurrentPoint(br,Er){this.x=br,this.y=Er}updatePathMinMax(br,Er,Lr){[Er,Lr]=tr.Util.applyTransform([Er,Lr],br),this.minX=Math.min(this.minX,Er),this.minY=Math.min(this.minY,Lr),this.maxX=Math.max(this.maxX,Er),this.maxY=Math.max(this.maxY,Lr)}updateRectMinMax(br,Er){const Lr=tr.Util.applyTransform(Er,br),Or=tr.Util.applyTransform(Er.slice(2),br);this.minX=Math.min(this.minX,Lr[0],Or[0]),this.minY=Math.min(this.minY,Lr[1],Or[1]),this.maxX=Math.max(this.maxX,Lr[0],Or[0]),this.maxY=Math.max(this.maxY,Lr[1],Or[1])}updateScalingPathMinMax(br,Er){tr.Util.scaleMinMax(br,Er),this.minX=Math.min(this.minX,Er[0]),this.maxX=Math.max(this.maxX,Er[1]),this.minY=Math.min(this.minY,Er[2]),this.maxY=Math.max(this.maxY,Er[3])}updateCurvePathMinMax(br,Er,Lr,Or,Ur,$r,Zr,fn,_n,Kr){const Cn=tr.Util.bezierBoundingBox(Er,Lr,Or,Ur,$r,Zr,fn,_n);if(Kr){Kr[0]=Math.min(Kr[0],Cn[0],Cn[2]),Kr[1]=Math.max(Kr[1],Cn[0],Cn[2]),Kr[2]=Math.min(Kr[2],Cn[1],Cn[3]),Kr[3]=Math.max(Kr[3],Cn[1],Cn[3]);return}this.updateRectMinMax(br,Cn)}getPathBoundingBox(br=nr.PathType.FILL,Er=null){const Lr=[this.minX,this.minY,this.maxX,this.maxY];if(br===nr.PathType.STROKE){Er||(0,tr.unreachable)("Stroke bounding box must include transform.");const Or=tr.Util.singularValueDecompose2dScale(Er),Ur=Or[0]*this.lineWidth/2,$r=Or[1]*this.lineWidth/2;Lr[0]-=Ur,Lr[1]-=$r,Lr[2]+=Ur,Lr[3]+=$r}return Lr}updateClipFromPath(){const br=tr.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(br||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(br){this.clipBox=br,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(br=nr.PathType.FILL,Er=null){return tr.Util.intersect(this.clipBox,this.getPathBoundingBox(br,Er))}}function vr(yr,br){if(typeof ImageData<"u"&&br instanceof ImageData){yr.putImageData(br,0,0);return}const Er=br.height,Lr=br.width,Or=Er%cr,Ur=(Er-Or)/cr,$r=Or===0?Ur:Ur+1,Zr=yr.createImageData(Lr,cr);let fn=0,_n;const Kr=br.data,Cn=Zr.data;let Dn,wn,Qr,xn;if(br.kind===tr.ImageKind.GRAYSCALE_1BPP){const tn=Kr.byteLength,on=new Uint32Array(Cn.buffer,0,Cn.byteLength>>2),vn=on.length,Sn=Lr+7>>3,Ln=4294967295,Wn=tr.FeatureTest.isLittleEndian?4278190080:255;for(Dn=0;Dn<$r;Dn++){for(Qr=Dn<Ur?cr:Or,_n=0,wn=0;wn<Qr;wn++){const $n=tn-fn;let En=0;const ba=$n>Sn?Lr:$n*8-7,Qn=ba&-8;let vs=0,es=0;for(;En<Qn;En+=8)es=Kr[fn++],on[_n++]=es&128?Ln:Wn,on[_n++]=es&64?Ln:Wn,on[_n++]=es&32?Ln:Wn,on[_n++]=es&16?Ln:Wn,on[_n++]=es&8?Ln:Wn,on[_n++]=es&4?Ln:Wn,on[_n++]=es&2?Ln:Wn,on[_n++]=es&1?Ln:Wn;for(;En<ba;En++)vs===0&&(es=Kr[fn++],vs=128),on[_n++]=es&vs?Ln:Wn,vs>>=1}for(;_n<vn;)on[_n++]=0;yr.putImageData(Zr,0,Dn*cr)}}else if(br.kind===tr.ImageKind.RGBA_32BPP){for(wn=0,xn=Lr*cr*4,Dn=0;Dn<Ur;Dn++)Cn.set(Kr.subarray(fn,fn+xn)),fn+=xn,yr.putImageData(Zr,0,wn),wn+=cr;Dn<$r&&(xn=Lr*Or*4,Cn.set(Kr.subarray(fn,fn+xn)),yr.putImageData(Zr,0,wn))}else if(br.kind===tr.ImageKind.RGB_24BPP)for(Qr=cr,xn=Lr*Qr,Dn=0;Dn<$r;Dn++){for(Dn>=Ur&&(Qr=Or,xn=Lr*Qr),_n=0,wn=xn;wn--;)Cn[_n++]=Kr[fn++],Cn[_n++]=Kr[fn++],Cn[_n++]=Kr[fn++],Cn[_n++]=255;yr.putImageData(Zr,0,Dn*cr)}else throw new Error(`bad image kind: ${br.kind}`)}function Cr(yr,br){if(br.bitmap){yr.drawImage(br.bitmap,0,0);return}const Er=br.height,Lr=br.width,Or=Er%cr,Ur=(Er-Or)/cr,$r=Or===0?Ur:Ur+1,Zr=yr.createImageData(Lr,cr);let fn=0;const _n=br.data,Kr=Zr.data;for(let Cn=0;Cn<$r;Cn++){const Dn=Cn<Ur?cr:Or;({srcPos:fn}=(0,ir.convertBlackAndWhiteToRGBA)({src:_n,srcPos:fn,dest:Kr,width:Lr,height:Dn,nonBlackColor:0})),yr.putImageData(Zr,0,Cn*cr)}}function Tr(yr,br){const Er=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const Lr of Er)yr[Lr]!==void 0&&(br[Lr]=yr[Lr]);yr.setLineDash!==void 0&&(br.setLineDash(yr.getLineDash()),br.lineDashOffset=yr.lineDashOffset)}function Fr(yr){if(yr.strokeStyle=yr.fillStyle="#000000",yr.fillRule="nonzero",yr.globalAlpha=1,yr.lineWidth=1,yr.lineCap="butt",yr.lineJoin="miter",yr.miterLimit=10,yr.globalCompositeOperation="source-over",yr.font="10px sans-serif",yr.setLineDash!==void 0&&(yr.setLineDash([]),yr.lineDashOffset=0),!tr.isNodeJS){const{filter:br}=yr;br!=="none"&&br!==""&&(yr.filter="none")}}function _r(yr,br,Er,Lr){const Or=yr.length;for(let Ur=3;Ur<Or;Ur+=4){const $r=yr[Ur];if($r===0)yr[Ur-3]=br,yr[Ur-2]=Er,yr[Ur-1]=Lr;else if($r<255){const Zr=255-$r;yr[Ur-3]=yr[Ur-3]*$r+br*Zr>>8,yr[Ur-2]=yr[Ur-2]*$r+Er*Zr>>8,yr[Ur-1]=yr[Ur-1]*$r+Lr*Zr>>8}}}function Ar(yr,br,Er){const Lr=yr.length,Or=1/255;for(let Ur=3;Ur<Lr;Ur+=4){const $r=Er?Er[yr[Ur]]:yr[Ur];br[Ur]=br[Ur]*$r*Or|0}}function Pr(yr,br,Er){const Lr=yr.length;for(let Or=3;Or<Lr;Or+=4){const Ur=yr[Or-3]*77+yr[Or-2]*152+yr[Or-1]*28;br[Or]=Er?br[Or]*Er[Ur>>8]>>8:br[Or]*Ur>>16}}function Ir(yr,br,Er,Lr,Or,Ur,$r,Zr,fn,_n,Kr){const Cn=!!Ur,Dn=Cn?Ur[0]:0,wn=Cn?Ur[1]:0,Qr=Cn?Ur[2]:0,xn=Or==="Luminosity"?Pr:Ar,on=Math.min(Lr,Math.ceil(1048576/Er));for(let vn=0;vn<Lr;vn+=on){const Sn=Math.min(on,Lr-vn),Ln=yr.getImageData(Zr-_n,vn+(fn-Kr),Er,Sn),Wn=br.getImageData(Zr,vn+fn,Er,Sn);Cn&&_r(Ln.data,Dn,wn,Qr),xn(Ln.data,Wn.data,$r),br.putImageData(Wn,Zr,vn+fn)}}function wr(yr,br,Er,Lr){const Or=Lr[0],Ur=Lr[1],$r=Lr[2]-Or,Zr=Lr[3]-Ur;$r===0||Zr===0||(Ir(br.context,Er,$r,Zr,br.subtype,br.backdrop,br.transferMap,Or,Ur,br.offsetX,br.offsetY),yr.save(),yr.globalAlpha=1,yr.globalCompositeOperation="source-over",yr.setTransform(1,0,0,1,0,0),yr.drawImage(Er.canvas,0,0),yr.restore())}function kr(yr,br){const Er=tr.Util.singularValueDecompose2dScale(yr);Er[0]=Math.fround(Er[0]),Er[1]=Math.fround(Er[1]);const Lr=Math.fround((globalThis.devicePixelRatio||1)*rr.PixelsPerInch.PDF_TO_CSS_UNITS);return br!==void 0?br:Er[0]<=Lr||Er[1]<=Lr}const Mr=["butt","round","square"],Hr=["miter","round","bevel"],Gr={},zr={},an=class an{constructor(br,Er,Lr,Or,Ur,{optionalContentConfig:$r,markedContentStack:Zr=null},fn,_n){Vn(this,Vr);this.ctx=br,this.current=new gr(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=Er,this.objs=Lr,this.canvasFactory=Or,this.filterFactory=Ur,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Zr||[],this.optionalContentConfig=$r,this.cachedCanvases=new dr(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=fn,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=_n,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(br,Er=null){return typeof br=="string"?br.startsWith("g_")?this.commonObjs.get(br):this.objs.get(br):Er}beginDrawing({transform:br,viewport:Er,transparency:Lr=!1,background:Or=null}){const Ur=this.ctx.canvas.width,$r=this.ctx.canvas.height,Zr=this.ctx.fillStyle;if(this.ctx.fillStyle=Or||"#ffffff",this.ctx.fillRect(0,0,Ur,$r),this.ctx.fillStyle=Zr,Lr){const fn=this.cachedCanvases.getCanvas("transparent",Ur,$r);this.compositeCtx=this.ctx,this.transparentCanvas=fn.canvas,this.ctx=fn.context,this.ctx.save(),this.ctx.transform(...(0,rr.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Fr(this.ctx),br&&(this.ctx.transform(...br),this.outputScaleX=br[0],this.outputScaleY=br[0]),this.ctx.transform(...Er.transform),this.viewportScale=Er.scale,this.baseTransform=(0,rr.getCurrentTransform)(this.ctx)}executeOperatorList(br,Er,Lr,Or){const Ur=br.argsArray,$r=br.fnArray;let Zr=Er||0;const fn=Ur.length;if(fn===Zr)return Zr;const _n=fn-Zr>ur&&typeof Lr=="function",Kr=_n?Date.now()+lr:0;let Cn=0;const Dn=this.commonObjs,wn=this.objs;let Qr;for(;;){if(Or!==void 0&&Zr===Or.nextBreakPoint)return Or.breakIt(Zr,Lr),Zr;if(Qr=$r[Zr],Qr!==tr.OPS.dependency)this[Qr].apply(this,Ur[Zr]);else for(const xn of Ur[Zr]){const tn=xn.startsWith("g_")?Dn:wn;if(!tn.has(xn))return tn.get(xn,Lr),Zr}if(Zr++,Zr===fn)return Zr;if(_n&&++Cn>ur){if(Date.now()>Kr)return Lr(),Zr;Cn=0}}}endDrawing(){On(this,Vr,n1).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const br of this._cachedBitmapsMap.values()){for(const Er of br.values())typeof HTMLCanvasElement<"u"&&Er instanceof HTMLCanvasElement&&(Er.width=Er.height=0);br.clear()}this._cachedBitmapsMap.clear(),On(this,Vr,i1).call(this)}_scaleImage(br,Er){const Lr=br.width,Or=br.height;let Ur=Math.max(Math.hypot(Er[0],Er[1]),1),$r=Math.max(Math.hypot(Er[2],Er[3]),1),Zr=Lr,fn=Or,_n="prescale1",Kr,Cn;for(;Ur>2&&Zr>1||$r>2&&fn>1;){let Dn=Zr,wn=fn;Ur>2&&Zr>1&&(Dn=Zr>=16384?Math.floor(Zr/2)-1||1:Math.ceil(Zr/2),Ur/=Zr/Dn),$r>2&&fn>1&&(wn=fn>=16384?Math.floor(fn/2)-1||1:Math.ceil(fn)/2,$r/=fn/wn),Kr=this.cachedCanvases.getCanvas(_n,Dn,wn),Cn=Kr.context,Cn.clearRect(0,0,Dn,wn),Cn.drawImage(br,0,0,Zr,fn,0,0,Dn,wn),br=Kr.canvas,Zr=Dn,fn=wn,_n=_n==="prescale1"?"prescale2":"prescale1"}return{img:br,paintWidth:Zr,paintHeight:fn}}_createMaskCanvas(br){const Er=this.ctx,{width:Lr,height:Or}=br,Ur=this.current.fillColor,$r=this.current.patternFill,Zr=(0,rr.getCurrentTransform)(Er);let fn,_n,Kr,Cn;if((br.bitmap||br.data)&&br.count>1){const En=br.bitmap||br.data.buffer;_n=JSON.stringify($r?Zr:[Zr.slice(0,4),Ur]),fn=this._cachedBitmapsMap.get(En),fn||(fn=new Map,this._cachedBitmapsMap.set(En,fn));const ba=fn.get(_n);if(ba&&!$r){const Qn=Math.round(Math.min(Zr[0],Zr[2])+Zr[4]),vs=Math.round(Math.min(Zr[1],Zr[3])+Zr[5]);return{canvas:ba,offsetX:Qn,offsetY:vs}}Kr=ba}Kr||(Cn=this.cachedCanvases.getCanvas("maskCanvas",Lr,Or),Cr(Cn.context,br));let Dn=tr.Util.transform(Zr,[1/Lr,0,0,-1/Or,0,0]);Dn=tr.Util.transform(Dn,[1,0,0,1,0,-Or]);const wn=tr.Util.applyTransform([0,0],Dn),Qr=tr.Util.applyTransform([Lr,Or],Dn),xn=tr.Util.normalizeRect([wn[0],wn[1],Qr[0],Qr[1]]),tn=Math.round(xn[2]-xn[0])||1,on=Math.round(xn[3]-xn[1])||1,vn=this.cachedCanvases.getCanvas("fillCanvas",tn,on),Sn=vn.context,Ln=Math.min(wn[0],Qr[0]),Wn=Math.min(wn[1],Qr[1]);Sn.translate(-Ln,-Wn),Sn.transform(...Dn),Kr||(Kr=this._scaleImage(Cn.canvas,(0,rr.getCurrentTransformInverse)(Sn)),Kr=Kr.img,fn&&$r&&fn.set(_n,Kr)),Sn.imageSmoothingEnabled=kr((0,rr.getCurrentTransform)(Sn),br.interpolate),xr(Sn,Kr,0,0,Kr.width,Kr.height,0,0,Lr,Or),Sn.globalCompositeOperation="source-in";const $n=tr.Util.transform((0,rr.getCurrentTransformInverse)(Sn),[1,0,0,1,-Ln,-Wn]);return Sn.fillStyle=$r?Ur.getPattern(Er,this,$n,nr.PathType.FILL):Ur,Sn.fillRect(0,0,Lr,Or),fn&&!$r&&(this.cachedCanvases.delete("fillCanvas"),fn.set(_n,vn.canvas)),{canvas:vn.canvas,offsetX:Math.round(Ln),offsetY:Math.round(Wn)}}setLineWidth(br){br!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=br,this.ctx.lineWidth=br}setLineCap(br){this.ctx.lineCap=Mr[br]}setLineJoin(br){this.ctx.lineJoin=Hr[br]}setMiterLimit(br){this.ctx.miterLimit=br}setDash(br,Er){const Lr=this.ctx;Lr.setLineDash!==void 0&&(Lr.setLineDash(br),Lr.lineDashOffset=Er)}setRenderingIntent(br){}setFlatness(br){}setGState(br){for(const[Er,Lr]of br)switch(Er){case"LW":this.setLineWidth(Lr);break;case"LC":this.setLineCap(Lr);break;case"LJ":this.setLineJoin(Lr);break;case"ML":this.setMiterLimit(Lr);break;case"D":this.setDash(Lr[0],Lr[1]);break;case"RI":this.setRenderingIntent(Lr);break;case"FL":this.setFlatness(Lr);break;case"Font":this.setFont(Lr[0],Lr[1]);break;case"CA":this.current.strokeAlpha=Lr;break;case"ca":this.current.fillAlpha=Lr,this.ctx.globalAlpha=Lr;break;case"BM":this.ctx.globalCompositeOperation=Lr;break;case"SMask":this.current.activeSMask=Lr?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Lr);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const br=this.inSMaskMode;this.current.activeSMask&&!br?this.beginSMaskMode():!this.current.activeSMask&&br&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const br=this.ctx.canvas.width,Er=this.ctx.canvas.height,Lr="smaskGroupAt"+this.groupLevel,Or=this.cachedCanvases.getCanvas(Lr,br,Er);this.suspendedCtx=this.ctx,this.ctx=Or.context;const Ur=this.ctx;Ur.setTransform(...(0,rr.getCurrentTransform)(this.suspendedCtx)),Tr(this.suspendedCtx,Ur),mr(Ur,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Tr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(br){if(!this.current.activeSMask)return;br?(br[0]=Math.floor(br[0]),br[1]=Math.floor(br[1]),br[2]=Math.ceil(br[2]),br[3]=Math.ceil(br[3])):br=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const Er=this.current.activeSMask,Lr=this.suspendedCtx;wr(Lr,Er,this.ctx,br),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Tr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const br=this.current;this.stateStack.push(br),this.current=br.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Tr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(br,Er,Lr,Or,Ur,$r){this.ctx.transform(br,Er,Lr,Or,Ur,$r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(br,Er,Lr){const Or=this.ctx,Ur=this.current;let $r=Ur.x,Zr=Ur.y,fn,_n;const Kr=(0,rr.getCurrentTransform)(Or),Cn=Kr[0]===0&&Kr[3]===0||Kr[1]===0&&Kr[2]===0,Dn=Cn?Lr.slice(0):null;for(let wn=0,Qr=0,xn=br.length;wn<xn;wn++)switch(br[wn]|0){case tr.OPS.rectangle:$r=Er[Qr++],Zr=Er[Qr++];const tn=Er[Qr++],on=Er[Qr++],vn=$r+tn,Sn=Zr+on;Or.moveTo($r,Zr),tn===0||on===0?Or.lineTo(vn,Sn):(Or.lineTo(vn,Zr),Or.lineTo(vn,Sn),Or.lineTo($r,Sn)),Cn||Ur.updateRectMinMax(Kr,[$r,Zr,vn,Sn]),Or.closePath();break;case tr.OPS.moveTo:$r=Er[Qr++],Zr=Er[Qr++],Or.moveTo($r,Zr),Cn||Ur.updatePathMinMax(Kr,$r,Zr);break;case tr.OPS.lineTo:$r=Er[Qr++],Zr=Er[Qr++],Or.lineTo($r,Zr),Cn||Ur.updatePathMinMax(Kr,$r,Zr);break;case tr.OPS.curveTo:fn=$r,_n=Zr,$r=Er[Qr+4],Zr=Er[Qr+5],Or.bezierCurveTo(Er[Qr],Er[Qr+1],Er[Qr+2],Er[Qr+3],$r,Zr),Ur.updateCurvePathMinMax(Kr,fn,_n,Er[Qr],Er[Qr+1],Er[Qr+2],Er[Qr+3],$r,Zr,Dn),Qr+=6;break;case tr.OPS.curveTo2:fn=$r,_n=Zr,Or.bezierCurveTo($r,Zr,Er[Qr],Er[Qr+1],Er[Qr+2],Er[Qr+3]),Ur.updateCurvePathMinMax(Kr,fn,_n,$r,Zr,Er[Qr],Er[Qr+1],Er[Qr+2],Er[Qr+3],Dn),$r=Er[Qr+2],Zr=Er[Qr+3],Qr+=4;break;case tr.OPS.curveTo3:fn=$r,_n=Zr,$r=Er[Qr+2],Zr=Er[Qr+3],Or.bezierCurveTo(Er[Qr],Er[Qr+1],$r,Zr,$r,Zr),Ur.updateCurvePathMinMax(Kr,fn,_n,Er[Qr],Er[Qr+1],$r,Zr,$r,Zr,Dn),Qr+=4;break;case tr.OPS.closePath:Or.closePath();break}Cn&&Ur.updateScalingPathMinMax(Kr,Dn),Ur.setCurrentPoint($r,Zr)}closePath(){this.ctx.closePath()}stroke(br=!0){const Er=this.ctx,Lr=this.current.strokeColor;Er.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Lr=="object"&&(Lr!=null&&Lr.getPattern)?(Er.save(),Er.strokeStyle=Lr.getPattern(Er,this,(0,rr.getCurrentTransformInverse)(Er),nr.PathType.STROKE),this.rescaleAndStroke(!1),Er.restore()):this.rescaleAndStroke(!0)),br&&this.consumePath(this.current.getClippedPathBoundingBox()),Er.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(br=!0){const Er=this.ctx,Lr=this.current.fillColor,Or=this.current.patternFill;let Ur=!1;Or&&(Er.save(),Er.fillStyle=Lr.getPattern(Er,this,(0,rr.getCurrentTransformInverse)(Er),nr.PathType.FILL),Ur=!0);const $r=this.current.getClippedPathBoundingBox();this.contentVisible&&$r!==null&&(this.pendingEOFill?(Er.fill("evenodd"),this.pendingEOFill=!1):Er.fill()),Ur&&Er.restore(),br&&this.consumePath($r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Gr}eoClip(){this.pendingClip=zr}beginText(){this.current.textMatrix=tr.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const br=this.pendingTextPaths,Er=this.ctx;if(br===void 0){Er.beginPath();return}Er.save(),Er.beginPath();for(const Lr of br)Er.setTransform(...Lr.transform),Er.translate(Lr.x,Lr.y),Lr.addToPath(Er,Lr.fontSize);Er.restore(),Er.clip(),Er.beginPath(),delete this.pendingTextPaths}setCharSpacing(br){this.current.charSpacing=br}setWordSpacing(br){this.current.wordSpacing=br}setHScale(br){this.current.textHScale=br/100}setLeading(br){this.current.leading=-br}setFont(br,Er){var Kr;const Lr=this.commonObjs.get(br),Or=this.current;if(!Lr)throw new Error(`Can't find font for ${br}`);if(Or.fontMatrix=Lr.fontMatrix||tr.FONT_IDENTITY_MATRIX,(Or.fontMatrix[0]===0||Or.fontMatrix[3]===0)&&(0,tr.warn)("Invalid font matrix for font "+br),Er<0?(Er=-Er,Or.fontDirection=-1):Or.fontDirection=1,this.current.font=Lr,this.current.fontSize=Er,Lr.isType3Font)return;const Ur=Lr.loadedName||"sans-serif",$r=((Kr=Lr.systemFontInfo)==null?void 0:Kr.css)||`"${Ur}", ${Lr.fallbackName}`;let Zr="normal";Lr.black?Zr="900":Lr.bold&&(Zr="bold");const fn=Lr.italic?"italic":"normal";let _n=Er;Er<ar?_n=ar:Er>sr&&(_n=sr),this.current.fontSizeScale=Er/_n,this.ctx.font=`${fn} ${Zr} ${_n}px ${$r}`}setTextRenderingMode(br){this.current.textRenderingMode=br}setTextRise(br){this.current.textRise=br}moveText(br,Er){this.current.x=this.current.lineX+=br,this.current.y=this.current.lineY+=Er}setLeadingMoveText(br,Er){this.setLeading(-Er),this.moveText(br,Er)}setTextMatrix(br,Er,Lr,Or,Ur,$r){this.current.textMatrix=[br,Er,Lr,Or,Ur,$r],this.current.textMatrixScale=Math.hypot(br,Er),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(br,Er,Lr,Or){const Ur=this.ctx,$r=this.current,Zr=$r.font,fn=$r.textRenderingMode,_n=$r.fontSize/$r.fontSizeScale,Kr=fn&tr.TextRenderingMode.FILL_STROKE_MASK,Cn=!!(fn&tr.TextRenderingMode.ADD_TO_PATH_FLAG),Dn=$r.patternFill&&!Zr.missingFile;let wn;(Zr.disableFontFace||Cn||Dn)&&(wn=Zr.getPathGenerator(this.commonObjs,br)),Zr.disableFontFace||Dn?(Ur.save(),Ur.translate(Er,Lr),Ur.beginPath(),wn(Ur,_n),Or&&Ur.setTransform(...Or),(Kr===tr.TextRenderingMode.FILL||Kr===tr.TextRenderingMode.FILL_STROKE)&&Ur.fill(),(Kr===tr.TextRenderingMode.STROKE||Kr===tr.TextRenderingMode.FILL_STROKE)&&Ur.stroke(),Ur.restore()):((Kr===tr.TextRenderingMode.FILL||Kr===tr.TextRenderingMode.FILL_STROKE)&&Ur.fillText(br,Er,Lr),(Kr===tr.TextRenderingMode.STROKE||Kr===tr.TextRenderingMode.FILL_STROKE)&&Ur.strokeText(br,Er,Lr)),Cn&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,rr.getCurrentTransform)(Ur),x:Er,y:Lr,fontSize:_n,addToPath:wn})}get isFontSubpixelAAEnabled(){const{context:br}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);br.scale(1.5,1),br.fillText("I",0,10);const Er=br.getImageData(0,0,10,10).data;let Lr=!1;for(let Or=3;Or<Er.length;Or+=4)if(Er[Or]>0&&Er[Or]<255){Lr=!0;break}return(0,tr.shadow)(this,"isFontSubpixelAAEnabled",Lr)}showText(br){const Er=this.current,Lr=Er.font;if(Lr.isType3Font)return this.showType3Text(br);const Or=Er.fontSize;if(Or===0)return;const Ur=this.ctx,$r=Er.fontSizeScale,Zr=Er.charSpacing,fn=Er.wordSpacing,_n=Er.fontDirection,Kr=Er.textHScale*_n,Cn=br.length,Dn=Lr.vertical,wn=Dn?1:-1,Qr=Lr.defaultVMetrics,xn=Or*Er.fontMatrix[0],tn=Er.textRenderingMode===tr.TextRenderingMode.FILL&&!Lr.disableFontFace&&!Er.patternFill;Ur.save(),Ur.transform(...Er.textMatrix),Ur.translate(Er.x,Er.y+Er.textRise),_n>0?Ur.scale(Kr,-1):Ur.scale(Kr,1);let on;if(Er.patternFill){Ur.save();const $n=Er.fillColor.getPattern(Ur,this,(0,rr.getCurrentTransformInverse)(Ur),nr.PathType.FILL);on=(0,rr.getCurrentTransform)(Ur),Ur.restore(),Ur.fillStyle=$n}let vn=Er.lineWidth;const Sn=Er.textMatrixScale;if(Sn===0||vn===0){const $n=Er.textRenderingMode&tr.TextRenderingMode.FILL_STROKE_MASK;($n===tr.TextRenderingMode.STROKE||$n===tr.TextRenderingMode.FILL_STROKE)&&(vn=this.getSinglePixelWidth())}else vn/=Sn;if($r!==1&&(Ur.scale($r,$r),vn/=$r),Ur.lineWidth=vn,Lr.isInvalidPDFjsFont){const $n=[];let En=0;for(const ba of br)$n.push(ba.unicode),En+=ba.width;Ur.fillText($n.join(""),0,0),Er.x+=En*xn*Kr,Ur.restore(),this.compose();return}let Ln=0,Wn;for(Wn=0;Wn<Cn;++Wn){const $n=br[Wn];if(typeof $n=="number"){Ln+=wn*$n*Or/1e3;continue}let En=!1;const ba=($n.isSpace?fn:0)+Zr,Qn=$n.fontChar,vs=$n.accent;let es,ls,Xn=$n.width;if(Dn){const ds=$n.vmetric||Qr,Ps=-($n.vmetric?ds[1]:Xn*.5)*xn,Zn=ds[2]*xn;Xn=ds?-ds[0]:Xn,es=Ps/$r,ls=(Ln+Zn)/$r}else es=Ln/$r,ls=0;if(Lr.remeasure&&Xn>0){const ds=Ur.measureText(Qn).width*1e3/Or*$r;if(Xn<ds&&this.isFontSubpixelAAEnabled){const Ps=Xn/ds;En=!0,Ur.save(),Ur.scale(Ps,1),es/=Ps}else Xn!==ds&&(es+=(Xn-ds)/2e3*Or/$r)}if(this.contentVisible&&($n.isInFont||Lr.missingFile)){if(tn&&!vs)Ur.fillText(Qn,es,ls);else if(this.paintChar(Qn,es,ls,on),vs){const ds=es+Or*vs.offset.x/$r,Ps=ls-Or*vs.offset.y/$r;this.paintChar(vs.fontChar,ds,Ps,on)}}const ws=Dn?Xn*xn-ba*_n:Xn*xn+ba*_n;Ln+=ws,En&&Ur.restore()}Dn?Er.y-=Ln:Er.x+=Ln*Kr,Ur.restore(),this.compose()}showType3Text(br){const Er=this.ctx,Lr=this.current,Or=Lr.font,Ur=Lr.fontSize,$r=Lr.fontDirection,Zr=Or.vertical?1:-1,fn=Lr.charSpacing,_n=Lr.wordSpacing,Kr=Lr.textHScale*$r,Cn=Lr.fontMatrix||tr.FONT_IDENTITY_MATRIX,Dn=br.length,wn=Lr.textRenderingMode===tr.TextRenderingMode.INVISIBLE;let Qr,xn,tn,on;if(!(wn||Ur===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,Er.save(),Er.transform(...Lr.textMatrix),Er.translate(Lr.x,Lr.y),Er.scale(Kr,$r),Qr=0;Qr<Dn;++Qr){if(xn=br[Qr],typeof xn=="number"){on=Zr*xn*Ur/1e3,this.ctx.translate(on,0),Lr.x+=on*Kr;continue}const vn=(xn.isSpace?_n:0)+fn,Sn=Or.charProcOperatorList[xn.operatorListId];if(!Sn){(0,tr.warn)(`Type3 character "${xn.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=xn,this.save(),Er.scale(Ur,Ur),Er.transform(...Cn),this.executeOperatorList(Sn),this.restore()),tn=tr.Util.applyTransform([xn.width,0],Cn)[0]*Ur+vn,Er.translate(tn,0),Lr.x+=tn*Kr}Er.restore(),this.processingType3=null}}setCharWidth(br,Er){}setCharWidthAndBounds(br,Er,Lr,Or,Ur,$r){this.ctx.rect(Lr,Or,Ur-Lr,$r-Or),this.ctx.clip(),this.endPath()}getColorN_Pattern(br){let Er;if(br[0]==="TilingPattern"){const Lr=br[1],Or=this.baseTransform||(0,rr.getCurrentTransform)(this.ctx),Ur={createCanvasGraphics:$r=>new an($r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};Er=new nr.TilingPattern(br,Lr,this.ctx,Ur,Or)}else Er=this._getPattern(br[1],br[2]);return Er}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(br,Er,Lr){const Or=tr.Util.makeHexColor(br,Er,Lr);this.ctx.strokeStyle=Or,this.current.strokeColor=Or}setFillRGBColor(br,Er,Lr){const Or=tr.Util.makeHexColor(br,Er,Lr);this.ctx.fillStyle=Or,this.current.fillColor=Or,this.current.patternFill=!1}_getPattern(br,Er=null){let Lr;return this.cachedPatterns.has(br)?Lr=this.cachedPatterns.get(br):(Lr=(0,nr.getShadingPattern)(this.getObject(br)),this.cachedPatterns.set(br,Lr)),Er&&(Lr.matrix=Er),Lr}shadingFill(br){if(!this.contentVisible)return;const Er=this.ctx;this.save();const Lr=this._getPattern(br);Er.fillStyle=Lr.getPattern(Er,this,(0,rr.getCurrentTransformInverse)(Er),nr.PathType.SHADING);const Or=(0,rr.getCurrentTransformInverse)(Er);if(Or){const{width:Ur,height:$r}=Er.canvas,[Zr,fn,_n,Kr]=tr.Util.getAxialAlignedBoundingBox([0,0,Ur,$r],Or);this.ctx.fillRect(Zr,fn,_n-Zr,Kr-fn)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,tr.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,tr.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(br,Er){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(br)&&br.length===6&&this.transform(...br),this.baseTransform=(0,rr.getCurrentTransform)(this.ctx),Er)){const Lr=Er[2]-Er[0],Or=Er[3]-Er[1];this.ctx.rect(Er[0],Er[1],Lr,Or),this.current.updateRectMinMax((0,rr.getCurrentTransform)(this.ctx),Er),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(br){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const Er=this.ctx;br.isolated||(0,tr.info)("TODO: Support non-isolated groups."),br.knockout&&(0,tr.warn)("Knockout groups not supported.");const Lr=(0,rr.getCurrentTransform)(Er);if(br.matrix&&Er.transform(...br.matrix),!br.bbox)throw new Error("Bounding box is required.");let Or=tr.Util.getAxialAlignedBoundingBox(br.bbox,(0,rr.getCurrentTransform)(Er));const Ur=[0,0,Er.canvas.width,Er.canvas.height];Or=tr.Util.intersect(Or,Ur)||[0,0,0,0];const $r=Math.floor(Or[0]),Zr=Math.floor(Or[1]);let fn=Math.max(Math.ceil(Or[2])-$r,1),_n=Math.max(Math.ceil(Or[3])-Zr,1),Kr=1,Cn=1;fn>or&&(Kr=fn/or,fn=or),_n>or&&(Cn=_n/or,_n=or),this.current.startNewPathAndClipBox([0,0,fn,_n]);let Dn="groupAt"+this.groupLevel;br.smask&&(Dn+="_smask_"+this.smaskCounter++%2);const wn=this.cachedCanvases.getCanvas(Dn,fn,_n),Qr=wn.context;Qr.scale(1/Kr,1/Cn),Qr.translate(-$r,-Zr),Qr.transform(...Lr),br.smask?this.smaskStack.push({canvas:wn.canvas,context:Qr,offsetX:$r,offsetY:Zr,scaleX:Kr,scaleY:Cn,subtype:br.smask.subtype,backdrop:br.smask.backdrop,transferMap:br.smask.transferMap||null,startTransformInverse:null}):(Er.setTransform(1,0,0,1,0,0),Er.translate($r,Zr),Er.scale(Kr,Cn),Er.save()),Tr(Er,Qr),this.ctx=Qr,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(Er),this.groupLevel++}endGroup(br){if(!this.contentVisible)return;this.groupLevel--;const Er=this.ctx,Lr=this.groupStack.pop();if(this.ctx=Lr,this.ctx.imageSmoothingEnabled=!1,br.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Or=(0,rr.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Or);const Ur=tr.Util.getAxialAlignedBoundingBox([0,0,Er.canvas.width,Er.canvas.height],Or);this.ctx.drawImage(Er.canvas,0,0),this.ctx.restore(),this.compose(Ur)}}beginAnnotation(br,Er,Lr,Or,Ur){if(On(this,Vr,n1).call(this),Fr(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(Er)&&Er.length===4){const $r=Er[2]-Er[0],Zr=Er[3]-Er[1];if(Ur&&this.annotationCanvasMap){Lr=Lr.slice(),Lr[4]-=Er[0],Lr[5]-=Er[1],Er=Er.slice(),Er[0]=Er[1]=0,Er[2]=$r,Er[3]=Zr;const[fn,_n]=tr.Util.singularValueDecompose2dScale((0,rr.getCurrentTransform)(this.ctx)),{viewportScale:Kr}=this,Cn=Math.ceil($r*this.outputScaleX*Kr),Dn=Math.ceil(Zr*this.outputScaleY*Kr);this.annotationCanvas=this.canvasFactory.create(Cn,Dn);const{canvas:wn,context:Qr}=this.annotationCanvas;this.annotationCanvasMap.set(br,wn),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Qr,this.ctx.save(),this.ctx.setTransform(fn,0,0,-_n,0,Zr*_n),Fr(this.ctx)}else Fr(this.ctx),this.ctx.rect(Er[0],Er[1],$r,Zr),this.ctx.clip(),this.endPath()}this.current=new gr(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Lr),this.transform(...Or)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),On(this,Vr,i1).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(br){if(!this.contentVisible)return;const Er=br.count;br=this.getObject(br.data,br),br.count=Er;const Lr=this.ctx,Or=this.processingType3;if(Or&&(Or.compiled===void 0&&(Or.compiled=pr(br)),Or.compiled)){Or.compiled(Lr);return}const Ur=this._createMaskCanvas(br),$r=Ur.canvas;Lr.save(),Lr.setTransform(1,0,0,1,0,0),Lr.drawImage($r,Ur.offsetX,Ur.offsetY),Lr.restore(),this.compose()}paintImageMaskXObjectRepeat(br,Er,Lr=0,Or=0,Ur,$r){if(!this.contentVisible)return;br=this.getObject(br.data,br);const Zr=this.ctx;Zr.save();const fn=(0,rr.getCurrentTransform)(Zr);Zr.transform(Er,Lr,Or,Ur,0,0);const _n=this._createMaskCanvas(br);Zr.setTransform(1,0,0,1,_n.offsetX-fn[4],_n.offsetY-fn[5]);for(let Kr=0,Cn=$r.length;Kr<Cn;Kr+=2){const Dn=tr.Util.transform(fn,[Er,Lr,Or,Ur,$r[Kr],$r[Kr+1]]),[wn,Qr]=tr.Util.applyTransform([0,0],Dn);Zr.drawImage(_n.canvas,wn,Qr)}Zr.restore(),this.compose()}paintImageMaskXObjectGroup(br){if(!this.contentVisible)return;const Er=this.ctx,Lr=this.current.fillColor,Or=this.current.patternFill;for(const Ur of br){const{data:$r,width:Zr,height:fn,transform:_n}=Ur,Kr=this.cachedCanvases.getCanvas("maskCanvas",Zr,fn),Cn=Kr.context;Cn.save();const Dn=this.getObject($r,Ur);Cr(Cn,Dn),Cn.globalCompositeOperation="source-in",Cn.fillStyle=Or?Lr.getPattern(Cn,this,(0,rr.getCurrentTransformInverse)(Er),nr.PathType.FILL):Lr,Cn.fillRect(0,0,Zr,fn),Cn.restore(),Er.save(),Er.transform(..._n),Er.scale(1,-1),xr(Er,Kr.canvas,0,0,Zr,fn,0,-1,1,1),Er.restore()}this.compose()}paintImageXObject(br){if(!this.contentVisible)return;const Er=this.getObject(br);if(!Er){(0,tr.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(Er)}paintImageXObjectRepeat(br,Er,Lr,Or){if(!this.contentVisible)return;const Ur=this.getObject(br);if(!Ur){(0,tr.warn)("Dependent image isn't ready yet");return}const $r=Ur.width,Zr=Ur.height,fn=[];for(let _n=0,Kr=Or.length;_n<Kr;_n+=2)fn.push({transform:[Er,0,0,Lr,Or[_n],Or[_n+1]],x:0,y:0,w:$r,h:Zr});this.paintInlineImageXObjectGroup(Ur,fn)}applyTransferMapsToCanvas(br){return this.current.transferMaps!=="none"&&(br.filter=this.current.transferMaps,br.drawImage(br.canvas,0,0),br.filter="none"),br.canvas}applyTransferMapsToBitmap(br){if(this.current.transferMaps==="none")return br.bitmap;const{bitmap:Er,width:Lr,height:Or}=br,Ur=this.cachedCanvases.getCanvas("inlineImage",Lr,Or),$r=Ur.context;return $r.filter=this.current.transferMaps,$r.drawImage(Er,0,0),$r.filter="none",Ur.canvas}paintInlineImageXObject(br){if(!this.contentVisible)return;const Er=br.width,Lr=br.height,Or=this.ctx;if(this.save(),!tr.isNodeJS){const{filter:Zr}=Or;Zr!=="none"&&Zr!==""&&(Or.filter="none")}Or.scale(1/Er,-1/Lr);let Ur;if(br.bitmap)Ur=this.applyTransferMapsToBitmap(br);else if(typeof HTMLElement=="function"&&br instanceof HTMLElement||!br.data)Ur=br;else{const fn=this.cachedCanvases.getCanvas("inlineImage",Er,Lr).context;vr(fn,br),Ur=this.applyTransferMapsToCanvas(fn)}const $r=this._scaleImage(Ur,(0,rr.getCurrentTransformInverse)(Or));Or.imageSmoothingEnabled=kr((0,rr.getCurrentTransform)(Or),br.interpolate),xr(Or,$r.img,0,0,$r.paintWidth,$r.paintHeight,0,-Lr,Er,Lr),this.compose(),this.restore()}paintInlineImageXObjectGroup(br,Er){if(!this.contentVisible)return;const Lr=this.ctx;let Or;if(br.bitmap)Or=br.bitmap;else{const Ur=br.width,$r=br.height,fn=this.cachedCanvases.getCanvas("inlineImage",Ur,$r).context;vr(fn,br),Or=this.applyTransferMapsToCanvas(fn)}for(const Ur of Er)Lr.save(),Lr.transform(...Ur.transform),Lr.scale(1,-1),xr(Lr,Or,Ur.x,Ur.y,Ur.w,Ur.h,0,-1,1,1),Lr.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(br){}markPointProps(br,Er){}beginMarkedContent(br){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(br,Er){br==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(Er)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(br){const Er=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(br);const Lr=this.ctx;this.pendingClip&&(Er||(this.pendingClip===zr?Lr.clip("evenodd"):Lr.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Lr.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const br=(0,rr.getCurrentTransform)(this.ctx);if(br[1]===0&&br[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(br[0]),Math.abs(br[3]));else{const Er=Math.abs(br[0]*br[3]-br[2]*br[1]),Lr=Math.hypot(br[0],br[2]),Or=Math.hypot(br[1],br[3]);this._cachedGetSinglePixelWidth=Math.max(Lr,Or)/Er}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:br}=this.current,{a:Er,b:Lr,c:Or,d:Ur}=this.ctx.getTransform();let $r,Zr;if(Lr===0&&Or===0){const fn=Math.abs(Er),_n=Math.abs(Ur);if(fn===_n)if(br===0)$r=Zr=1/fn;else{const Kr=fn*br;$r=Zr=Kr<1?1/Kr:1}else if(br===0)$r=1/fn,Zr=1/_n;else{const Kr=fn*br,Cn=_n*br;$r=Kr<1?1/Kr:1,Zr=Cn<1?1/Cn:1}}else{const fn=Math.abs(Er*Ur-Lr*Or),_n=Math.hypot(Er,Lr),Kr=Math.hypot(Or,Ur);if(br===0)$r=Kr/fn,Zr=_n/fn;else{const Cn=br*fn;$r=Kr>Cn?Kr/Cn:1,Zr=_n>Cn?_n/Cn:1}}this._cachedScaleForStroking[0]=$r,this._cachedScaleForStroking[1]=Zr}return this._cachedScaleForStroking}rescaleAndStroke(br){const{ctx:Er}=this,{lineWidth:Lr}=this.current,[Or,Ur]=this.getScaleForStroking();if(Er.lineWidth=Lr||1,Or===1&&Ur===1){Er.stroke();return}const $r=Er.getLineDash();if(br&&Er.save(),Er.scale(Or,Ur),$r.length>0){const Zr=Math.max(Or,Ur);Er.setLineDash($r.map(fn=>fn/Zr)),Er.lineDashOffset/=Zr}Er.stroke(),br&&Er.restore()}isContentVisible(){for(let br=this.markedContentStack.length-1;br>=0;br--)if(!this.markedContentStack[br].visible)return!1;return!0}};Vr=new WeakSet,n1=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},i1=function(){if(this.pageColors){const br=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(br!=="none"){const Er=this.ctx.filter;this.ctx.filter=br,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=Er}}};let Br=an;_e.CanvasGraphics=Br;for(const yr in tr.OPS)Br.prototype[yr]!==void 0&&(Br.prototype[tr.OPS[yr]]=Br.prototype[yr])},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.TilingPattern=_e.PathType=void 0,_e.getShadingPattern=cr;var tr=er(1),rr=er(6);const nr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};_e.PathType=nr;function ir(pr,gr){if(!gr)return;const vr=gr[2]-gr[0],Cr=gr[3]-gr[1],Tr=new Path2D;Tr.rect(gr[0],gr[1],vr,Cr),pr.clip(Tr)}class ar{constructor(){this.constructor===ar&&(0,tr.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,tr.unreachable)("Abstract method `getPattern` called.")}}class sr extends ar{constructor(gr){super(),this._type=gr[1],this._bbox=gr[2],this._colorStops=gr[3],this._p0=gr[4],this._p1=gr[5],this._r0=gr[6],this._r1=gr[7],this.matrix=null}_createGradient(gr){let vr;this._type==="axial"?vr=gr.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(vr=gr.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Cr of this._colorStops)vr.addColorStop(Cr[0],Cr[1]);return vr}getPattern(gr,vr,Cr,Tr){let Fr;if(Tr===nr.STROKE||Tr===nr.FILL){const _r=vr.current.getClippedPathBoundingBox(Tr,(0,rr.getCurrentTransform)(gr))||[0,0,0,0],Ar=Math.ceil(_r[2]-_r[0])||1,Pr=Math.ceil(_r[3]-_r[1])||1,Ir=vr.cachedCanvases.getCanvas("pattern",Ar,Pr,!0),wr=Ir.context;wr.clearRect(0,0,wr.canvas.width,wr.canvas.height),wr.beginPath(),wr.rect(0,0,wr.canvas.width,wr.canvas.height),wr.translate(-_r[0],-_r[1]),Cr=tr.Util.transform(Cr,[1,0,0,1,_r[0],_r[1]]),wr.transform(...vr.baseTransform),this.matrix&&wr.transform(...this.matrix),ir(wr,this._bbox),wr.fillStyle=this._createGradient(wr),wr.fill(),Fr=gr.createPattern(Ir.canvas,"no-repeat");const kr=new DOMMatrix(Cr);Fr.setTransform(kr)}else ir(gr,this._bbox),Fr=this._createGradient(gr);return Fr}}function or(pr,gr,vr,Cr,Tr,Fr,_r,Ar){const Pr=gr.coords,Ir=gr.colors,wr=pr.data,kr=pr.width*4;let Mr;Pr[vr+1]>Pr[Cr+1]&&(Mr=vr,vr=Cr,Cr=Mr,Mr=Fr,Fr=_r,_r=Mr),Pr[Cr+1]>Pr[Tr+1]&&(Mr=Cr,Cr=Tr,Tr=Mr,Mr=_r,_r=Ar,Ar=Mr),Pr[vr+1]>Pr[Cr+1]&&(Mr=vr,vr=Cr,Cr=Mr,Mr=Fr,Fr=_r,_r=Mr);const Hr=(Pr[vr]+gr.offsetX)*gr.scaleX,Gr=(Pr[vr+1]+gr.offsetY)*gr.scaleY,zr=(Pr[Cr]+gr.offsetX)*gr.scaleX,Br=(Pr[Cr+1]+gr.offsetY)*gr.scaleY,Vr=(Pr[Tr]+gr.offsetX)*gr.scaleX,Rr=(Pr[Tr+1]+gr.offsetY)*gr.scaleY;if(Gr>=Rr)return;const Xr=Ir[Fr],an=Ir[Fr+1],yr=Ir[Fr+2],br=Ir[_r],Er=Ir[_r+1],Lr=Ir[_r+2],Or=Ir[Ar],Ur=Ir[Ar+1],$r=Ir[Ar+2],Zr=Math.round(Gr),fn=Math.round(Rr);let _n,Kr,Cn,Dn,wn,Qr,xn,tn;for(let on=Zr;on<=fn;on++){if(on<Br){const $n=on<Gr?0:(Gr-on)/(Gr-Br);_n=Hr-(Hr-zr)*$n,Kr=Xr-(Xr-br)*$n,Cn=an-(an-Er)*$n,Dn=yr-(yr-Lr)*$n}else{let $n;on>Rr?$n=1:Br===Rr?$n=0:$n=(Br-on)/(Br-Rr),_n=zr-(zr-Vr)*$n,Kr=br-(br-Or)*$n,Cn=Er-(Er-Ur)*$n,Dn=Lr-(Lr-$r)*$n}let vn;on<Gr?vn=0:on>Rr?vn=1:vn=(Gr-on)/(Gr-Rr),wn=Hr-(Hr-Vr)*vn,Qr=Xr-(Xr-Or)*vn,xn=an-(an-Ur)*vn,tn=yr-(yr-$r)*vn;const Sn=Math.round(Math.min(_n,wn)),Ln=Math.round(Math.max(_n,wn));let Wn=kr*on+Sn*4;for(let $n=Sn;$n<=Ln;$n++)vn=(_n-$n)/(_n-wn),vn<0?vn=0:vn>1&&(vn=1),wr[Wn++]=Kr-(Kr-Qr)*vn|0,wr[Wn++]=Cn-(Cn-xn)*vn|0,wr[Wn++]=Dn-(Dn-tn)*vn|0,wr[Wn++]=255}}function lr(pr,gr,vr){const Cr=gr.coords,Tr=gr.colors;let Fr,_r;switch(gr.type){case"lattice":const Ar=gr.verticesPerRow,Pr=Math.floor(Cr.length/Ar)-1,Ir=Ar-1;for(Fr=0;Fr<Pr;Fr++){let wr=Fr*Ar;for(let kr=0;kr<Ir;kr++,wr++)or(pr,vr,Cr[wr],Cr[wr+1],Cr[wr+Ar],Tr[wr],Tr[wr+1],Tr[wr+Ar]),or(pr,vr,Cr[wr+Ar+1],Cr[wr+1],Cr[wr+Ar],Tr[wr+Ar+1],Tr[wr+1],Tr[wr+Ar])}break;case"triangles":for(Fr=0,_r=Cr.length;Fr<_r;Fr+=3)or(pr,vr,Cr[Fr],Cr[Fr+1],Cr[Fr+2],Tr[Fr],Tr[Fr+1],Tr[Fr+2]);break;default:throw new Error("illegal figure")}}class ur extends ar{constructor(gr){super(),this._coords=gr[2],this._colors=gr[3],this._figures=gr[4],this._bounds=gr[5],this._bbox=gr[7],this._background=gr[8],this.matrix=null}_createMeshCanvas(gr,vr,Cr){const Ar=Math.floor(this._bounds[0]),Pr=Math.floor(this._bounds[1]),Ir=Math.ceil(this._bounds[2])-Ar,wr=Math.ceil(this._bounds[3])-Pr,kr=Math.min(Math.ceil(Math.abs(Ir*gr[0]*1.1)),3e3),Mr=Math.min(Math.ceil(Math.abs(wr*gr[1]*1.1)),3e3),Hr=Ir/kr,Gr=wr/Mr,zr={coords:this._coords,colors:this._colors,offsetX:-Ar,offsetY:-Pr,scaleX:1/Hr,scaleY:1/Gr},Br=kr+2*2,Vr=Mr+2*2,Rr=Cr.getCanvas("mesh",Br,Vr,!1),Xr=Rr.context,an=Xr.createImageData(kr,Mr);if(vr){const br=an.data;for(let Er=0,Lr=br.length;Er<Lr;Er+=4)br[Er]=vr[0],br[Er+1]=vr[1],br[Er+2]=vr[2],br[Er+3]=255}for(const br of this._figures)lr(an,br,zr);return Xr.putImageData(an,2,2),{canvas:Rr.canvas,offsetX:Ar-2*Hr,offsetY:Pr-2*Gr,scaleX:Hr,scaleY:Gr}}getPattern(gr,vr,Cr,Tr){ir(gr,this._bbox);let Fr;if(Tr===nr.SHADING)Fr=tr.Util.singularValueDecompose2dScale((0,rr.getCurrentTransform)(gr));else if(Fr=tr.Util.singularValueDecompose2dScale(vr.baseTransform),this.matrix){const Ar=tr.Util.singularValueDecompose2dScale(this.matrix);Fr=[Fr[0]*Ar[0],Fr[1]*Ar[1]]}const _r=this._createMeshCanvas(Fr,Tr===nr.SHADING?null:this._background,vr.cachedCanvases);return Tr!==nr.SHADING&&(gr.setTransform(...vr.baseTransform),this.matrix&&gr.transform(...this.matrix)),gr.translate(_r.offsetX,_r.offsetY),gr.scale(_r.scaleX,_r.scaleY),gr.createPattern(_r.canvas,"no-repeat")}}class fr extends ar{getPattern(){return"hotpink"}}function cr(pr){switch(pr[0]){case"RadialAxial":return new sr(pr);case"Mesh":return new ur(pr);case"Dummy":return new fr}throw new Error(`Unknown IR type: ${pr[0]}`)}const mr={COLORED:1,UNCOLORED:2},xr=class xr{constructor(gr,vr,Cr,Tr,Fr){this.operatorList=gr[2],this.matrix=gr[3]||[1,0,0,1,0,0],this.bbox=gr[4],this.xstep=gr[5],this.ystep=gr[6],this.paintType=gr[7],this.tilingType=gr[8],this.color=vr,this.ctx=Cr,this.canvasGraphicsFactory=Tr,this.baseTransform=Fr}createPatternCanvas(gr){const vr=this.operatorList,Cr=this.bbox,Tr=this.xstep,Fr=this.ystep,_r=this.paintType,Ar=this.tilingType,Pr=this.color,Ir=this.canvasGraphicsFactory;(0,tr.info)("TilingType: "+Ar);const wr=Cr[0],kr=Cr[1],Mr=Cr[2],Hr=Cr[3],Gr=tr.Util.singularValueDecompose2dScale(this.matrix),zr=tr.Util.singularValueDecompose2dScale(this.baseTransform),Br=[Gr[0]*zr[0],Gr[1]*zr[1]],Vr=this.getSizeAndScale(Tr,this.ctx.canvas.width,Br[0]),Rr=this.getSizeAndScale(Fr,this.ctx.canvas.height,Br[1]),Xr=gr.cachedCanvases.getCanvas("pattern",Vr.size,Rr.size,!0),an=Xr.context,yr=Ir.createCanvasGraphics(an);yr.groupLevel=gr.groupLevel,this.setFillAndStrokeStyleToContext(yr,_r,Pr);let br=wr,Er=kr,Lr=Mr,Or=Hr;return wr<0&&(br=0,Lr+=Math.abs(wr)),kr<0&&(Er=0,Or+=Math.abs(kr)),an.translate(-(Vr.scale*br),-(Rr.scale*Er)),yr.transform(Vr.scale,0,0,Rr.scale,0,0),an.save(),this.clipBbox(yr,br,Er,Lr,Or),yr.baseTransform=(0,rr.getCurrentTransform)(yr.ctx),yr.executeOperatorList(vr),yr.endDrawing(),{canvas:Xr.canvas,scaleX:Vr.scale,scaleY:Rr.scale,offsetX:br,offsetY:Er}}getSizeAndScale(gr,vr,Cr){gr=Math.abs(gr);const Tr=Math.max(xr.MAX_PATTERN_SIZE,vr);let Fr=Math.ceil(gr*Cr);return Fr>=Tr?Fr=Tr:Cr=Fr/gr,{scale:Cr,size:Fr}}clipBbox(gr,vr,Cr,Tr,Fr){const _r=Tr-vr,Ar=Fr-Cr;gr.ctx.rect(vr,Cr,_r,Ar),gr.current.updateRectMinMax((0,rr.getCurrentTransform)(gr.ctx),[vr,Cr,Tr,Fr]),gr.clip(),gr.endPath()}setFillAndStrokeStyleToContext(gr,vr,Cr){const Tr=gr.ctx,Fr=gr.current;switch(vr){case mr.COLORED:const _r=this.ctx;Tr.fillStyle=_r.fillStyle,Tr.strokeStyle=_r.strokeStyle,Fr.fillColor=_r.fillStyle,Fr.strokeColor=_r.strokeStyle;break;case mr.UNCOLORED:const Ar=tr.Util.makeHexColor(Cr[0],Cr[1],Cr[2]);Tr.fillStyle=Ar,Tr.strokeStyle=Ar,Fr.fillColor=Ar,Fr.strokeColor=Ar;break;default:throw new tr.FormatError(`Unsupported paint type: ${vr}`)}}getPattern(gr,vr,Cr,Tr){let Fr=Cr;Tr!==nr.SHADING&&(Fr=tr.Util.transform(Fr,vr.baseTransform),this.matrix&&(Fr=tr.Util.transform(Fr,this.matrix)));const _r=this.createPatternCanvas(vr);let Ar=new DOMMatrix(Fr);Ar=Ar.translate(_r.offsetX,_r.offsetY),Ar=Ar.scale(1/_r.scaleX,1/_r.scaleY);const Pr=gr.createPattern(_r.canvas,"repeat");return Pr.setTransform(Ar),Pr}};Xs(xr,"MAX_PATTERN_SIZE",3e3);let dr=xr;_e.TilingPattern=dr},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.convertBlackAndWhiteToRGBA=nr,_e.convertToRGBA=rr,_e.grayToRGBA=ar;var tr=er(1);function rr(sr){switch(sr.kind){case tr.ImageKind.GRAYSCALE_1BPP:return nr(sr);case tr.ImageKind.RGB_24BPP:return ir(sr)}return null}function nr({src:sr,srcPos:or=0,dest:lr,width:ur,height:fr,nonBlackColor:cr=4294967295,inverseDecode:mr=!1}){const dr=tr.FeatureTest.isLittleEndian?4278190080:255,[xr,pr]=mr?[cr,dr]:[dr,cr],gr=ur>>3,vr=ur&7,Cr=sr.length;lr=new Uint32Array(lr.buffer);let Tr=0;for(let Fr=0;Fr<fr;Fr++){for(const Ar=or+gr;or<Ar;or++){const Pr=or<Cr?sr[or]:255;lr[Tr++]=Pr&128?pr:xr,lr[Tr++]=Pr&64?pr:xr,lr[Tr++]=Pr&32?pr:xr,lr[Tr++]=Pr&16?pr:xr,lr[Tr++]=Pr&8?pr:xr,lr[Tr++]=Pr&4?pr:xr,lr[Tr++]=Pr&2?pr:xr,lr[Tr++]=Pr&1?pr:xr}if(vr===0)continue;const _r=or<Cr?sr[or++]:255;for(let Ar=0;Ar<vr;Ar++)lr[Tr++]=_r&1<<7-Ar?pr:xr}return{srcPos:or,destPos:Tr}}function ir({src:sr,srcPos:or=0,dest:lr,destPos:ur=0,width:fr,height:cr}){let mr=0;const dr=sr.length>>2,xr=new Uint32Array(sr.buffer,or,dr);if(tr.FeatureTest.isLittleEndian){for(;mr<dr-2;mr+=3,ur+=4){const pr=xr[mr],gr=xr[mr+1],vr=xr[mr+2];lr[ur]=pr|4278190080,lr[ur+1]=pr>>>24|gr<<8|4278190080,lr[ur+2]=gr>>>16|vr<<16|4278190080,lr[ur+3]=vr>>>8|4278190080}for(let pr=mr*4,gr=sr.length;pr<gr;pr+=3)lr[ur++]=sr[pr]|sr[pr+1]<<8|sr[pr+2]<<16|4278190080}else{for(;mr<dr-2;mr+=3,ur+=4){const pr=xr[mr],gr=xr[mr+1],vr=xr[mr+2];lr[ur]=pr|255,lr[ur+1]=pr<<24|gr>>>8|255,lr[ur+2]=gr<<16|vr>>>16|255,lr[ur+3]=vr<<8|255}for(let pr=mr*4,gr=sr.length;pr<gr;pr+=3)lr[ur++]=sr[pr]<<24|sr[pr+1]<<16|sr[pr+2]<<8|255}return{srcPos:or,destPos:ur}}function ar(sr,or){if(tr.FeatureTest.isLittleEndian)for(let lr=0,ur=sr.length;lr<ur;lr++)or[lr]=sr[lr]*65793|4278190080;else for(let lr=0,ur=sr.length;lr<ur;lr++)or[lr]=sr[lr]*16843008|255}},(e,_e)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.GlobalWorkerOptions=void 0;const er=Object.create(null);_e.GlobalWorkerOptions=er,er.workerPort=null,er.workerSrc=""},(e,_e,er)=>{var sr,sm,om,Z0;Object.defineProperty(_e,"__esModule",{value:!0}),_e.MessageHandler=void 0;var tr=er(1);const rr={DATA:1,ERROR:2},nr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ir(fr){switch(fr instanceof Error||typeof fr=="object"&&fr!==null||(0,tr.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),fr.name){case"AbortException":return new tr.AbortException(fr.message);case"MissingPDFException":return new tr.MissingPDFException(fr.message);case"PasswordException":return new tr.PasswordException(fr.message,fr.code);case"UnexpectedResponseException":return new tr.UnexpectedResponseException(fr.message,fr.status);case"UnknownErrorException":return new tr.UnknownErrorException(fr.message,fr.details);default:return new tr.UnknownErrorException(fr.message,fr.toString())}}class ar{constructor(cr,mr,dr){Vn(this,sr);this.sourceName=cr,this.targetName=mr,this.comObj=dr,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=xr=>{const pr=xr.data;if(pr.targetName!==this.sourceName)return;if(pr.stream){On(this,sr,om).call(this,pr);return}if(pr.callback){const vr=pr.callbackId,Cr=this.callbackCapabilities[vr];if(!Cr)throw new Error(`Cannot resolve callback ${vr}`);if(delete this.callbackCapabilities[vr],pr.callback===rr.DATA)Cr.resolve(pr.data);else if(pr.callback===rr.ERROR)Cr.reject(ir(pr.reason));else throw new Error("Unexpected callback case");return}const gr=this.actionHandler[pr.action];if(!gr)throw new Error(`Unknown action from worker: ${pr.action}`);if(pr.callbackId){const vr=this.sourceName,Cr=pr.sourceName;new Promise(function(Tr){Tr(gr(pr.data))}).then(function(Tr){dr.postMessage({sourceName:vr,targetName:Cr,callback:rr.DATA,callbackId:pr.callbackId,data:Tr})},function(Tr){dr.postMessage({sourceName:vr,targetName:Cr,callback:rr.ERROR,callbackId:pr.callbackId,reason:ir(Tr)})});return}if(pr.streamId){On(this,sr,sm).call(this,pr);return}gr(pr.data)},dr.addEventListener("message",this._onComObjOnMessage)}on(cr,mr){const dr=this.actionHandler;if(dr[cr])throw new Error(`There is already an actionName called "${cr}"`);dr[cr]=mr}send(cr,mr,dr){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:cr,data:mr},dr)}sendWithPromise(cr,mr,dr){const xr=this.callbackId++,pr=new tr.PromiseCapability;this.callbackCapabilities[xr]=pr;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:cr,callbackId:xr,data:mr},dr)}catch(gr){pr.reject(gr)}return pr.promise}sendWithStream(cr,mr,dr,xr){const pr=this.streamId++,gr=this.sourceName,vr=this.targetName,Cr=this.comObj;return new ReadableStream({start:Tr=>{const Fr=new tr.PromiseCapability;return this.streamControllers[pr]={controller:Tr,startCall:Fr,pullCall:null,cancelCall:null,isClosed:!1},Cr.postMessage({sourceName:gr,targetName:vr,action:cr,streamId:pr,data:mr,desiredSize:Tr.desiredSize},xr),Fr.promise},pull:Tr=>{const Fr=new tr.PromiseCapability;return this.streamControllers[pr].pullCall=Fr,Cr.postMessage({sourceName:gr,targetName:vr,stream:nr.PULL,streamId:pr,desiredSize:Tr.desiredSize}),Fr.promise},cancel:Tr=>{(0,tr.assert)(Tr instanceof Error,"cancel must have a valid reason");const Fr=new tr.PromiseCapability;return this.streamControllers[pr].cancelCall=Fr,this.streamControllers[pr].isClosed=!0,Cr.postMessage({sourceName:gr,targetName:vr,stream:nr.CANCEL,streamId:pr,reason:ir(Tr)}),Fr.promise}},dr)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}sr=new WeakSet,sm=function(cr){const mr=cr.streamId,dr=this.sourceName,xr=cr.sourceName,pr=this.comObj,gr=this,vr=this.actionHandler[cr.action],Cr={enqueue(Tr,Fr=1,_r){if(this.isCancelled)return;const Ar=this.desiredSize;this.desiredSize-=Fr,Ar>0&&this.desiredSize<=0&&(this.sinkCapability=new tr.PromiseCapability,this.ready=this.sinkCapability.promise),pr.postMessage({sourceName:dr,targetName:xr,stream:nr.ENQUEUE,streamId:mr,chunk:Tr},_r)},close(){this.isCancelled||(this.isCancelled=!0,pr.postMessage({sourceName:dr,targetName:xr,stream:nr.CLOSE,streamId:mr}),delete gr.streamSinks[mr])},error(Tr){(0,tr.assert)(Tr instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,pr.postMessage({sourceName:dr,targetName:xr,stream:nr.ERROR,streamId:mr,reason:ir(Tr)}))},sinkCapability:new tr.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:cr.desiredSize,ready:null};Cr.sinkCapability.resolve(),Cr.ready=Cr.sinkCapability.promise,this.streamSinks[mr]=Cr,new Promise(function(Tr){Tr(vr(cr.data,Cr))}).then(function(){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.START_COMPLETE,streamId:mr,success:!0})},function(Tr){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.START_COMPLETE,streamId:mr,reason:ir(Tr)})})},om=function(cr){const mr=cr.streamId,dr=this.sourceName,xr=cr.sourceName,pr=this.comObj,gr=this.streamControllers[mr],vr=this.streamSinks[mr];switch(cr.stream){case nr.START_COMPLETE:cr.success?gr.startCall.resolve():gr.startCall.reject(ir(cr.reason));break;case nr.PULL_COMPLETE:cr.success?gr.pullCall.resolve():gr.pullCall.reject(ir(cr.reason));break;case nr.PULL:if(!vr){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.PULL_COMPLETE,streamId:mr,success:!0});break}vr.desiredSize<=0&&cr.desiredSize>0&&vr.sinkCapability.resolve(),vr.desiredSize=cr.desiredSize,new Promise(function(Cr){var Tr;Cr((Tr=vr.onPull)==null?void 0:Tr.call(vr))}).then(function(){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.PULL_COMPLETE,streamId:mr,success:!0})},function(Cr){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.PULL_COMPLETE,streamId:mr,reason:ir(Cr)})});break;case nr.ENQUEUE:if((0,tr.assert)(gr,"enqueue should have stream controller"),gr.isClosed)break;gr.controller.enqueue(cr.chunk);break;case nr.CLOSE:if((0,tr.assert)(gr,"close should have stream controller"),gr.isClosed)break;gr.isClosed=!0,gr.controller.close(),On(this,sr,Z0).call(this,gr,mr);break;case nr.ERROR:(0,tr.assert)(gr,"error should have stream controller"),gr.controller.error(ir(cr.reason)),On(this,sr,Z0).call(this,gr,mr);break;case nr.CANCEL_COMPLETE:cr.success?gr.cancelCall.resolve():gr.cancelCall.reject(ir(cr.reason)),On(this,sr,Z0).call(this,gr,mr);break;case nr.CANCEL:if(!vr)break;new Promise(function(Cr){var Tr;Cr((Tr=vr.onCancel)==null?void 0:Tr.call(vr,ir(cr.reason)))}).then(function(){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.CANCEL_COMPLETE,streamId:mr,success:!0})},function(Cr){pr.postMessage({sourceName:dr,targetName:xr,stream:nr.CANCEL_COMPLETE,streamId:mr,reason:ir(Cr)})}),vr.sinkCapability.reject(ir(cr.reason)),vr.isCancelled=!0,delete this.streamSinks[mr];break;default:throw new Error("Unexpected stream case")}},Z0=async function(cr,mr){var dr,xr,pr;await Promise.allSettled([(dr=cr.startCall)==null?void 0:dr.promise,(xr=cr.pullCall)==null?void 0:xr.promise,(pr=cr.cancelCall)==null?void 0:pr.promise]),delete this.streamControllers[mr]},_e.MessageHandler=ar},(e,_e,er)=>{var nr,ir;Object.defineProperty(_e,"__esModule",{value:!0}),_e.Metadata=void 0;var tr=er(1);class rr{constructor({parsedData:sr,rawData:or}){Vn(this,nr);Vn(this,ir);Gn(this,nr,sr),Gn(this,ir,or)}getRaw(){return jr(this,ir)}get(sr){return jr(this,nr).get(sr)??null}getAll(){return(0,tr.objectFromMap)(jr(this,nr))}has(sr){return jr(this,nr).has(sr)}}nr=new WeakMap,ir=new WeakMap,_e.Metadata=rr},(e,_e,er)=>{var sr,or,lr,ur,fr,cr,a1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.OptionalContentConfig=void 0;var tr=er(1),rr=er(8);const nr=Symbol("INTERNAL");class ir{constructor(xr,pr){Vn(this,sr,!0);this.name=xr,this.intent=pr}get visible(){return jr(this,sr)}_setVisible(xr,pr){xr!==nr&&(0,tr.unreachable)("Internal method `_setVisible` called."),Gn(this,sr,pr)}}sr=new WeakMap;class ar{constructor(xr){Vn(this,cr);Vn(this,or,null);Vn(this,lr,new Map);Vn(this,ur,null);Vn(this,fr,null);if(this.name=null,this.creator=null,xr!==null){this.name=xr.name,this.creator=xr.creator,Gn(this,fr,xr.order);for(const pr of xr.groups)jr(this,lr).set(pr.id,new ir(pr.name,pr.intent));if(xr.baseState==="OFF")for(const pr of jr(this,lr).values())pr._setVisible(nr,!1);for(const pr of xr.on)jr(this,lr).get(pr)._setVisible(nr,!0);for(const pr of xr.off)jr(this,lr).get(pr)._setVisible(nr,!1);Gn(this,ur,this.getHash())}}isVisible(xr){if(jr(this,lr).size===0)return!0;if(!xr)return(0,tr.warn)("Optional content group not defined."),!0;if(xr.type==="OCG")return jr(this,lr).has(xr.id)?jr(this,lr).get(xr.id).visible:((0,tr.warn)(`Optional content group not found: ${xr.id}`),!0);if(xr.type==="OCMD"){if(xr.expression)return On(this,cr,a1).call(this,xr.expression);if(!xr.policy||xr.policy==="AnyOn"){for(const pr of xr.ids){if(!jr(this,lr).has(pr))return(0,tr.warn)(`Optional content group not found: ${pr}`),!0;if(jr(this,lr).get(pr).visible)return!0}return!1}else if(xr.policy==="AllOn"){for(const pr of xr.ids){if(!jr(this,lr).has(pr))return(0,tr.warn)(`Optional content group not found: ${pr}`),!0;if(!jr(this,lr).get(pr).visible)return!1}return!0}else if(xr.policy==="AnyOff"){for(const pr of xr.ids){if(!jr(this,lr).has(pr))return(0,tr.warn)(`Optional content group not found: ${pr}`),!0;if(!jr(this,lr).get(pr).visible)return!0}return!1}else if(xr.policy==="AllOff"){for(const pr of xr.ids){if(!jr(this,lr).has(pr))return(0,tr.warn)(`Optional content group not found: ${pr}`),!0;if(jr(this,lr).get(pr).visible)return!1}return!0}return(0,tr.warn)(`Unknown optional content policy ${xr.policy}.`),!0}return(0,tr.warn)(`Unknown group type ${xr.type}.`),!0}setVisibility(xr,pr=!0){if(!jr(this,lr).has(xr)){(0,tr.warn)(`Optional content group not found: ${xr}`);return}jr(this,lr).get(xr)._setVisible(nr,!!pr),Gn(this,or,null)}get hasInitialVisibility(){return jr(this,ur)===null||this.getHash()===jr(this,ur)}getOrder(){return jr(this,lr).size?jr(this,fr)?jr(this,fr).slice():[...jr(this,lr).keys()]:null}getGroups(){return jr(this,lr).size>0?(0,tr.objectFromMap)(jr(this,lr)):null}getGroup(xr){return jr(this,lr).get(xr)||null}getHash(){if(jr(this,or)!==null)return jr(this,or);const xr=new rr.MurmurHash3_64;for(const[pr,gr]of jr(this,lr))xr.update(`${pr}:${gr.visible}`);return Gn(this,or,xr.hexdigest())}}or=new WeakMap,lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakSet,a1=function(xr){const pr=xr.length;if(pr<2)return!0;const gr=xr[0];for(let vr=1;vr<pr;vr++){const Cr=xr[vr];let Tr;if(Array.isArray(Cr))Tr=On(this,cr,a1).call(this,Cr);else if(jr(this,lr).has(Cr))Tr=jr(this,lr).get(Cr).visible;else return(0,tr.warn)(`Optional content group not found: ${Cr}`),!0;switch(gr){case"And":if(!Tr)return!1;break;case"Or":if(Tr)return!0;break;case"Not":return!Tr;default:return!0}}return gr==="And"},_e.OptionalContentConfig=ar},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.PDFDataTransportStream=void 0;var tr=er(1),rr=er(6);class nr{constructor({length:or,initialData:lr,progressiveDone:ur=!1,contentDispositionFilename:fr=null,disableRange:cr=!1,disableStream:mr=!1},dr){if((0,tr.assert)(dr,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=ur,this._contentDispositionFilename=fr,(lr==null?void 0:lr.length)>0){const xr=lr instanceof Uint8Array&&lr.byteLength===lr.buffer.byteLength?lr.buffer:new Uint8Array(lr).buffer;this._queuedChunks.push(xr)}this._pdfDataRangeTransport=dr,this._isStreamingSupported=!mr,this._isRangeSupported=!cr,this._contentLength=or,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((xr,pr)=>{this._onReceiveData({begin:xr,chunk:pr})}),this._pdfDataRangeTransport.addProgressListener((xr,pr)=>{this._onProgress({loaded:xr,total:pr})}),this._pdfDataRangeTransport.addProgressiveReadListener(xr=>{this._onReceiveData({chunk:xr})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:or,chunk:lr}){const ur=lr instanceof Uint8Array&&lr.byteLength===lr.buffer.byteLength?lr.buffer:new Uint8Array(lr).buffer;if(or===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(ur):this._queuedChunks.push(ur);else{const fr=this._rangeReaders.some(function(cr){return cr._begin!==or?!1:(cr._enqueue(ur),!0)});(0,tr.assert)(fr,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var or;return((or=this._fullRequestReader)==null?void 0:or._loaded)??0}_onProgress(or){var lr,ur,fr,cr;or.total===void 0?(ur=(lr=this._rangeReaders[0])==null?void 0:lr.onProgress)==null||ur.call(lr,{loaded:or.loaded}):(cr=(fr=this._fullRequestReader)==null?void 0:fr.onProgress)==null||cr.call(fr,{loaded:or.loaded,total:or.total})}_onProgressiveDone(){var or;(or=this._fullRequestReader)==null||or.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(or){const lr=this._rangeReaders.indexOf(or);lr>=0&&this._rangeReaders.splice(lr,1)}getFullReader(){(0,tr.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const or=this._queuedChunks;return this._queuedChunks=null,new ir(this,or,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(or,lr){if(lr<=this._progressiveDataLength)return null;const ur=new ar(this,or,lr);return this._pdfDataRangeTransport.requestDataRange(or,lr),this._rangeReaders.push(ur),ur}cancelAllRequests(or){var lr;(lr=this._fullRequestReader)==null||lr.cancel(or);for(const ur of this._rangeReaders.slice(0))ur.cancel(or);this._pdfDataRangeTransport.abort()}}_e.PDFDataTransportStream=nr;class ir{constructor(or,lr,ur=!1,fr=null){this._stream=or,this._done=ur||!1,this._filename=(0,rr.isPdfFile)(fr)?fr:null,this._queuedChunks=lr||[],this._loaded=0;for(const cr of this._queuedChunks)this._loaded+=cr.byteLength;this._requests=[],this._headersReady=Promise.resolve(),or._fullRequestReader=this,this.onProgress=null}_enqueue(or){this._done||(this._requests.length>0?this._requests.shift().resolve({value:or,done:!1}):this._queuedChunks.push(or),this._loaded+=or.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const or=new tr.PromiseCapability;return this._requests.push(or),or.promise}cancel(or){this._done=!0;for(const lr of this._requests)lr.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ar{constructor(or,lr,ur){this._stream=or,this._begin=lr,this._end=ur,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(or){if(!this._done){if(this._requests.length===0)this._queuedChunk=or;else{this._requests.shift().resolve({value:or,done:!1});for(const ur of this._requests)ur.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const lr=this._queuedChunk;return this._queuedChunk=null,{value:lr,done:!1}}if(this._done)return{value:void 0,done:!0};const or=new tr.PromiseCapability;return this._requests.push(or),or.promise}cancel(or){this._done=!0;for(const lr of this._requests)lr.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.PDFFetchStream=void 0;var tr=er(1),rr=er(20);function nr(ur,fr,cr){return{method:"GET",headers:ur,signal:cr.signal,mode:"cors",credentials:fr?"include":"same-origin",redirect:"follow"}}function ir(ur){const fr=new Headers;for(const cr in ur){const mr=ur[cr];mr!==void 0&&fr.append(cr,mr)}return fr}function ar(ur){return ur instanceof Uint8Array?ur.buffer:ur instanceof ArrayBuffer?ur:((0,tr.warn)(`getArrayBuffer - unexpected data format: ${ur}`),new Uint8Array(ur).buffer)}class sr{constructor(fr){this.source=fr,this.isHttp=/^https?:/i.test(fr.url),this.httpHeaders=this.isHttp&&fr.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var fr;return((fr=this._fullRequestReader)==null?void 0:fr._loaded)??0}getFullReader(){return(0,tr.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new or(this),this._fullRequestReader}getRangeReader(fr,cr){if(cr<=this._progressiveDataLength)return null;const mr=new lr(this,fr,cr);return this._rangeRequestReaders.push(mr),mr}cancelAllRequests(fr){var cr;(cr=this._fullRequestReader)==null||cr.cancel(fr);for(const mr of this._rangeRequestReaders.slice(0))mr.cancel(fr)}}_e.PDFFetchStream=sr;class or{constructor(fr){this._stream=fr,this._reader=null,this._loaded=0,this._filename=null;const cr=fr.source;this._withCredentials=cr.withCredentials||!1,this._contentLength=cr.length,this._headersCapability=new tr.PromiseCapability,this._disableRange=cr.disableRange||!1,this._rangeChunkSize=cr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!cr.disableStream,this._isRangeSupported=!cr.disableRange,this._headers=ir(this._stream.httpHeaders);const mr=cr.url;fetch(mr,nr(this._headers,this._withCredentials,this._abortController)).then(dr=>{if(!(0,rr.validateResponseStatus)(dr.status))throw(0,rr.createResponseStatusError)(dr.status,mr);this._reader=dr.body.getReader(),this._headersCapability.resolve();const xr=vr=>dr.headers.get(vr),{allowRangeRequests:pr,suggestedLength:gr}=(0,rr.validateRangeRequestCapabilities)({getResponseHeader:xr,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=pr,this._contentLength=gr||this._contentLength,this._filename=(0,rr.extractFilenameFromHeader)(xr),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new tr.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var mr;await this._headersCapability.promise;const{value:fr,done:cr}=await this._reader.read();return cr?{value:fr,done:cr}:(this._loaded+=fr.byteLength,(mr=this.onProgress)==null||mr.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ar(fr),done:!1})}cancel(fr){var cr;(cr=this._reader)==null||cr.cancel(fr),this._abortController.abort()}}class lr{constructor(fr,cr,mr){this._stream=fr,this._reader=null,this._loaded=0;const dr=fr.source;this._withCredentials=dr.withCredentials||!1,this._readCapability=new tr.PromiseCapability,this._isStreamingSupported=!dr.disableStream,this._abortController=new AbortController,this._headers=ir(this._stream.httpHeaders),this._headers.append("Range",`bytes=${cr}-${mr-1}`);const xr=dr.url;fetch(xr,nr(this._headers,this._withCredentials,this._abortController)).then(pr=>{if(!(0,rr.validateResponseStatus)(pr.status))throw(0,rr.createResponseStatusError)(pr.status,xr);this._readCapability.resolve(),this._reader=pr.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var mr;await this._readCapability.promise;const{value:fr,done:cr}=await this._reader.read();return cr?{value:fr,done:cr}:(this._loaded+=fr.byteLength,(mr=this.onProgress)==null||mr.call(this,{loaded:this._loaded}),{value:ar(fr),done:!1})}cancel(fr){var cr;(cr=this._reader)==null||cr.cancel(fr),this._abortController.abort()}}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.createResponseStatusError=sr,_e.extractFilenameFromHeader=ar,_e.validateRangeRequestCapabilities=ir,_e.validateResponseStatus=or;var tr=er(1),rr=er(21),nr=er(6);function ir({getResponseHeader:lr,isHttp:ur,rangeChunkSize:fr,disableRange:cr}){const mr={allowRangeRequests:!1,suggestedLength:void 0},dr=parseInt(lr("Content-Length"),10);return!Number.isInteger(dr)||(mr.suggestedLength=dr,dr<=2*fr)||cr||!ur||lr("Accept-Ranges")!=="bytes"||(lr("Content-Encoding")||"identity")!=="identity"||(mr.allowRangeRequests=!0),mr}function ar(lr){const ur=lr("Content-Disposition");if(ur){let fr=(0,rr.getFilenameFromContentDispositionHeader)(ur);if(fr.includes("%"))try{fr=decodeURIComponent(fr)}catch{}if((0,nr.isPdfFile)(fr))return fr}return null}function sr(lr,ur){return lr===404||lr===0&&ur.startsWith("file:")?new tr.MissingPDFException('Missing PDF "'+ur+'".'):new tr.UnexpectedResponseException(`Unexpected server response (${lr}) while retrieving PDF "${ur}".`,lr)}function or(lr){return lr===200||lr===206}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.getFilenameFromContentDispositionHeader=rr;var tr=er(1);function rr(nr){let ir=!0,ar=sr("filename\\*","i").exec(nr);if(ar){ar=ar[1];let dr=fr(ar);return dr=unescape(dr),dr=cr(dr),dr=mr(dr),lr(dr)}if(ar=ur(nr),ar){const dr=mr(ar);return lr(dr)}if(ar=sr("filename","i").exec(nr),ar){ar=ar[1];let dr=fr(ar);return dr=mr(dr),lr(dr)}function sr(dr,xr){return new RegExp("(?:^|;)\\s*"+dr+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',xr)}function or(dr,xr){if(dr){if(!/^[\x00-\xFF]+$/.test(xr))return xr;try{const pr=new TextDecoder(dr,{fatal:!0}),gr=(0,tr.stringToBytes)(xr);xr=pr.decode(gr),ir=!1}catch{}}return xr}function lr(dr){return ir&&/[\x80-\xff]/.test(dr)&&(dr=or("utf-8",dr),ir&&(dr=or("iso-8859-1",dr))),dr}function ur(dr){const xr=[];let pr;const gr=sr("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(pr=gr.exec(dr))!==null;){let[,Cr,Tr,Fr]=pr;if(Cr=parseInt(Cr,10),Cr in xr){if(Cr===0)break;continue}xr[Cr]=[Tr,Fr]}const vr=[];for(let Cr=0;Cr<xr.length&&Cr in xr;++Cr){let[Tr,Fr]=xr[Cr];Fr=fr(Fr),Tr&&(Fr=unescape(Fr),Cr===0&&(Fr=cr(Fr))),vr.push(Fr)}return vr.join("")}function fr(dr){if(dr.startsWith('"')){const xr=dr.slice(1).split('\\"');for(let pr=0;pr<xr.length;++pr){const gr=xr[pr].indexOf('"');gr!==-1&&(xr[pr]=xr[pr].slice(0,gr),xr.length=pr+1),xr[pr]=xr[pr].replaceAll(/\\(.)/g,"$1")}dr=xr.join('"')}return dr}function cr(dr){const xr=dr.indexOf("'");if(xr===-1)return dr;const pr=dr.slice(0,xr),vr=dr.slice(xr+1).replace(/^[^']*'/,"");return or(pr,vr)}function mr(dr){return!dr.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(dr)?dr:dr.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(xr,pr,gr,vr){if(gr==="q"||gr==="Q")return vr=vr.replaceAll("_"," "),vr=vr.replaceAll(/=([0-9a-fA-F]{2})/g,function(Cr,Tr){return String.fromCharCode(parseInt(Tr,16))}),or(pr,vr);try{vr=atob(vr)}catch{}return or(pr,vr)})}return""}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.PDFNetworkStream=void 0;var tr=er(1),rr=er(20);const nr=200,ir=206;function ar(fr){const cr=fr.response;return typeof cr!="string"?cr:(0,tr.stringToBytes)(cr).buffer}class sr{constructor(cr,mr={}){this.url=cr,this.isHttp=/^https?:/i.test(cr),this.httpHeaders=this.isHttp&&mr.httpHeaders||Object.create(null),this.withCredentials=mr.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(cr,mr,dr){const xr={begin:cr,end:mr};for(const pr in dr)xr[pr]=dr[pr];return this.request(xr)}requestFull(cr){return this.request(cr)}request(cr){const mr=new XMLHttpRequest,dr=this.currXhrId++,xr=this.pendingRequests[dr]={xhr:mr};mr.open("GET",this.url),mr.withCredentials=this.withCredentials;for(const pr in this.httpHeaders){const gr=this.httpHeaders[pr];gr!==void 0&&mr.setRequestHeader(pr,gr)}return this.isHttp&&"begin"in cr&&"end"in cr?(mr.setRequestHeader("Range",`bytes=${cr.begin}-${cr.end-1}`),xr.expectedStatus=ir):xr.expectedStatus=nr,mr.responseType="arraybuffer",cr.onError&&(mr.onerror=function(pr){cr.onError(mr.status)}),mr.onreadystatechange=this.onStateChange.bind(this,dr),mr.onprogress=this.onProgress.bind(this,dr),xr.onHeadersReceived=cr.onHeadersReceived,xr.onDone=cr.onDone,xr.onError=cr.onError,xr.onProgress=cr.onProgress,mr.send(null),dr}onProgress(cr,mr){var xr;const dr=this.pendingRequests[cr];dr&&((xr=dr.onProgress)==null||xr.call(dr,mr))}onStateChange(cr,mr){var Cr,Tr,Fr;const dr=this.pendingRequests[cr];if(!dr)return;const xr=dr.xhr;if(xr.readyState>=2&&dr.onHeadersReceived&&(dr.onHeadersReceived(),delete dr.onHeadersReceived),xr.readyState!==4||!(cr in this.pendingRequests))return;if(delete this.pendingRequests[cr],xr.status===0&&this.isHttp){(Cr=dr.onError)==null||Cr.call(dr,xr.status);return}const pr=xr.status||nr;if(!(pr===nr&&dr.expectedStatus===ir)&&pr!==dr.expectedStatus){(Tr=dr.onError)==null||Tr.call(dr,xr.status);return}const vr=ar(xr);if(pr===ir){const _r=xr.getResponseHeader("Content-Range"),Ar=/bytes (\d+)-(\d+)\/(\d+)/.exec(_r);dr.onDone({begin:parseInt(Ar[1],10),chunk:vr})}else vr?dr.onDone({begin:0,chunk:vr}):(Fr=dr.onError)==null||Fr.call(dr,xr.status)}getRequestXhr(cr){return this.pendingRequests[cr].xhr}isPendingRequest(cr){return cr in this.pendingRequests}abortRequest(cr){const mr=this.pendingRequests[cr].xhr;delete this.pendingRequests[cr],mr.abort()}}class or{constructor(cr){this._source=cr,this._manager=new sr(cr.url,{httpHeaders:cr.httpHeaders,withCredentials:cr.withCredentials}),this._rangeChunkSize=cr.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(cr){const mr=this._rangeRequestReaders.indexOf(cr);mr>=0&&this._rangeRequestReaders.splice(mr,1)}getFullReader(){return(0,tr.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new lr(this._manager,this._source),this._fullRequestReader}getRangeReader(cr,mr){const dr=new ur(this._manager,cr,mr);return dr.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(dr),dr}cancelAllRequests(cr){var mr;(mr=this._fullRequestReader)==null||mr.cancel(cr);for(const dr of this._rangeRequestReaders.slice(0))dr.cancel(cr)}}_e.PDFNetworkStream=or;class lr{constructor(cr,mr){this._manager=cr;const dr={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=mr.url,this._fullRequestId=cr.requestFull(dr),this._headersReceivedCapability=new tr.PromiseCapability,this._disableRange=mr.disableRange||!1,this._contentLength=mr.length,this._rangeChunkSize=mr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const cr=this._fullRequestId,mr=this._manager.getRequestXhr(cr),dr=gr=>mr.getResponseHeader(gr),{allowRangeRequests:xr,suggestedLength:pr}=(0,rr.validateRangeRequestCapabilities)({getResponseHeader:dr,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});xr&&(this._isRangeSupported=!0),this._contentLength=pr||this._contentLength,this._filename=(0,rr.extractFilenameFromHeader)(dr),this._isRangeSupported&&this._manager.abortRequest(cr),this._headersReceivedCapability.resolve()}_onDone(cr){if(cr&&(this._requests.length>0?this._requests.shift().resolve({value:cr.chunk,done:!1}):this._cachedChunks.push(cr.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const mr of this._requests)mr.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(cr){this._storedError=(0,rr.createResponseStatusError)(cr,this._url),this._headersReceivedCapability.reject(this._storedError);for(const mr of this._requests)mr.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(cr){var mr;(mr=this.onProgress)==null||mr.call(this,{loaded:cr.loaded,total:cr.lengthComputable?cr.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const cr=new tr.PromiseCapability;return this._requests.push(cr),cr.promise}cancel(cr){this._done=!0,this._headersReceivedCapability.reject(cr);for(const mr of this._requests)mr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ur{constructor(cr,mr,dr){this._manager=cr;const xr={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=cr.url,this._requestId=cr.requestRange(mr,dr,xr),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var cr;(cr=this.onClosed)==null||cr.call(this,this)}_onDone(cr){const mr=cr.chunk;this._requests.length>0?this._requests.shift().resolve({value:mr,done:!1}):this._queuedChunk=mr,this._done=!0;for(const dr of this._requests)dr.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(cr){this._storedError=(0,rr.createResponseStatusError)(cr,this._url);for(const mr of this._requests)mr.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(cr){var mr;this.isStreamingSupported||(mr=this.onProgress)==null||mr.call(this,{loaded:cr.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const mr=this._queuedChunk;return this._queuedChunk=null,{value:mr,done:!1}}if(this._done)return{value:void 0,done:!0};const cr=new tr.PromiseCapability;return this._requests.push(cr),cr.promise}cancel(cr){this._done=!0;for(const mr of this._requests)mr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.PDFNodeStream=void 0;var tr=er(1),rr=er(20);const nr=/^file:\/\/\/[a-zA-Z]:\//;function ir(dr){const xr=require$$5,pr=xr.parse(dr);return pr.protocol==="file:"||pr.host?pr:/^[a-z]:[/\\]/i.test(dr)?xr.parse(`file:///${dr}`):(pr.host||(pr.protocol="file:"),pr)}class ar{constructor(xr){this.source=xr,this.url=ir(xr.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&xr.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var xr;return((xr=this._fullRequestReader)==null?void 0:xr._loaded)??0}getFullReader(){return(0,tr.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new cr(this):new ur(this),this._fullRequestReader}getRangeReader(xr,pr){if(pr<=this._progressiveDataLength)return null;const gr=this.isFsUrl?new mr(this,xr,pr):new fr(this,xr,pr);return this._rangeRequestReaders.push(gr),gr}cancelAllRequests(xr){var pr;(pr=this._fullRequestReader)==null||pr.cancel(xr);for(const gr of this._rangeRequestReaders.slice(0))gr.cancel(xr)}}_e.PDFNodeStream=ar;class sr{constructor(xr){this._url=xr.url,this._done=!1,this._storedError=null,this.onProgress=null;const pr=xr.source;this._contentLength=pr.length,this._loaded=0,this._filename=null,this._disableRange=pr.disableRange||!1,this._rangeChunkSize=pr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!pr.disableStream,this._isRangeSupported=!pr.disableRange,this._readableStream=null,this._readCapability=new tr.PromiseCapability,this._headersCapability=new tr.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var gr;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const xr=this._readableStream.read();return xr===null?(this._readCapability=new tr.PromiseCapability,this.read()):(this._loaded+=xr.length,(gr=this.onProgress)==null||gr.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(xr).buffer,done:!1})}cancel(xr){if(!this._readableStream){this._error(xr);return}this._readableStream.destroy(xr)}_error(xr){this._storedError=xr,this._readCapability.resolve()}_setReadableStream(xr){this._readableStream=xr,xr.on("readable",()=>{this._readCapability.resolve()}),xr.on("end",()=>{xr.destroy(),this._done=!0,this._readCapability.resolve()}),xr.on("error",pr=>{this._error(pr)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new tr.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class or{constructor(xr){this._url=xr.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new tr.PromiseCapability;const pr=xr.source;this._isStreamingSupported=!pr.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var gr;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const xr=this._readableStream.read();return xr===null?(this._readCapability=new tr.PromiseCapability,this.read()):(this._loaded+=xr.length,(gr=this.onProgress)==null||gr.call(this,{loaded:this._loaded}),{value:new Uint8Array(xr).buffer,done:!1})}cancel(xr){if(!this._readableStream){this._error(xr);return}this._readableStream.destroy(xr)}_error(xr){this._storedError=xr,this._readCapability.resolve()}_setReadableStream(xr){this._readableStream=xr,xr.on("readable",()=>{this._readCapability.resolve()}),xr.on("end",()=>{xr.destroy(),this._done=!0,this._readCapability.resolve()}),xr.on("error",pr=>{this._error(pr)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function lr(dr,xr){return{protocol:dr.protocol,auth:dr.auth,host:dr.hostname,port:dr.port,path:dr.path,method:"GET",headers:xr}}class ur extends sr{constructor(xr){super(xr);const pr=gr=>{if(gr.statusCode===404){const Fr=new tr.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Fr,this._headersCapability.reject(Fr);return}this._headersCapability.resolve(),this._setReadableStream(gr);const vr=Fr=>this._readableStream.headers[Fr.toLowerCase()],{allowRangeRequests:Cr,suggestedLength:Tr}=(0,rr.validateRangeRequestCapabilities)({getResponseHeader:vr,isHttp:xr.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Cr,this._contentLength=Tr||this._contentLength,this._filename=(0,rr.extractFilenameFromHeader)(vr)};if(this._request=null,this._url.protocol==="http:"){const gr=require$$5;this._request=gr.request(lr(this._url,xr.httpHeaders),pr)}else{const gr=require$$5;this._request=gr.request(lr(this._url,xr.httpHeaders),pr)}this._request.on("error",gr=>{this._storedError=gr,this._headersCapability.reject(gr)}),this._request.end()}}class fr extends or{constructor(xr,pr,gr){super(xr),this._httpHeaders={};for(const Cr in xr.httpHeaders){const Tr=xr.httpHeaders[Cr];Tr!==void 0&&(this._httpHeaders[Cr]=Tr)}this._httpHeaders.Range=`bytes=${pr}-${gr-1}`;const vr=Cr=>{if(Cr.statusCode===404){const Tr=new tr.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Tr;return}this._setReadableStream(Cr)};if(this._request=null,this._url.protocol==="http:"){const Cr=require$$5;this._request=Cr.request(lr(this._url,this._httpHeaders),vr)}else{const Cr=require$$5;this._request=Cr.request(lr(this._url,this._httpHeaders),vr)}this._request.on("error",Cr=>{this._storedError=Cr}),this._request.end()}}class cr extends sr{constructor(xr){super(xr);let pr=decodeURIComponent(this._url.path);nr.test(this._url.href)&&(pr=pr.replace(/^\//,""));const gr=require$$5;gr.lstat(pr,(vr,Cr)=>{if(vr){vr.code==="ENOENT"&&(vr=new tr.MissingPDFException(`Missing PDF "${pr}".`)),this._storedError=vr,this._headersCapability.reject(vr);return}this._contentLength=Cr.size,this._setReadableStream(gr.createReadStream(pr)),this._headersCapability.resolve()})}}class mr extends or{constructor(xr,pr,gr){super(xr);let vr=decodeURIComponent(this._url.path);nr.test(this._url.href)&&(vr=vr.replace(/^\//,""));const Cr=require$$5;this._setReadableStream(Cr.createReadStream(vr,{start:pr,end:gr-1}))}}},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.SVGGraphics=void 0;var tr=er(6),rr=er(1);const nr={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},ir="http://www.w3.org/XML/1998/namespace",ar="http://www.w3.org/1999/xlink",sr=["butt","round","square"],or=["miter","round","bevel"],lr=function(Cr,Tr="",Fr=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Fr)return URL.createObjectURL(new Blob([Cr],{type:Tr}));const _r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ar=`data:${Tr};base64,`;for(let Pr=0,Ir=Cr.length;Pr<Ir;Pr+=3){const wr=Cr[Pr]&255,kr=Cr[Pr+1]&255,Mr=Cr[Pr+2]&255,Hr=wr>>2,Gr=(wr&3)<<4|kr>>4,zr=Pr+1<Ir?(kr&15)<<2|Mr>>6:64,Br=Pr+2<Ir?Mr&63:64;Ar+=_r[Hr]+_r[Gr]+_r[zr]+_r[Br]}return Ar},ur=function(){const Cr=new Uint8Array([137,80,78,71,13,10,26,10]),Tr=12,Fr=new Int32Array(256);for(let Mr=0;Mr<256;Mr++){let Hr=Mr;for(let Gr=0;Gr<8;Gr++)Hr=Hr&1?3988292384^Hr>>1&2147483647:Hr>>1&2147483647;Fr[Mr]=Hr}function _r(Mr,Hr,Gr){let zr=-1;for(let Br=Hr;Br<Gr;Br++){const Vr=(zr^Mr[Br])&255,Rr=Fr[Vr];zr=zr>>>8^Rr}return zr^-1}function Ar(Mr,Hr,Gr,zr){let Br=zr;const Vr=Hr.length;Gr[Br]=Vr>>24&255,Gr[Br+1]=Vr>>16&255,Gr[Br+2]=Vr>>8&255,Gr[Br+3]=Vr&255,Br+=4,Gr[Br]=Mr.charCodeAt(0)&255,Gr[Br+1]=Mr.charCodeAt(1)&255,Gr[Br+2]=Mr.charCodeAt(2)&255,Gr[Br+3]=Mr.charCodeAt(3)&255,Br+=4,Gr.set(Hr,Br),Br+=Hr.length;const Rr=_r(Gr,zr+4,Br);Gr[Br]=Rr>>24&255,Gr[Br+1]=Rr>>16&255,Gr[Br+2]=Rr>>8&255,Gr[Br+3]=Rr&255}function Pr(Mr,Hr,Gr){let zr=1,Br=0;for(let Vr=Hr;Vr<Gr;++Vr)zr=(zr+(Mr[Vr]&255))%65521,Br=(Br+zr)%65521;return Br<<16|zr}function Ir(Mr){if(!rr.isNodeJS)return wr(Mr);try{const Hr=parseInt(process.versions.node)>=8?Mr:Buffer.from(Mr),Gr=require$$5.deflateSync(Hr,{level:9});return Gr instanceof Uint8Array?Gr:new Uint8Array(Gr)}catch(Hr){(0,rr.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Hr)}return wr(Mr)}function wr(Mr){let Hr=Mr.length;const Gr=65535,zr=Math.ceil(Hr/Gr),Br=new Uint8Array(2+Hr+zr*5+4);let Vr=0;Br[Vr++]=120,Br[Vr++]=156;let Rr=0;for(;Hr>Gr;)Br[Vr++]=0,Br[Vr++]=255,Br[Vr++]=255,Br[Vr++]=0,Br[Vr++]=0,Br.set(Mr.subarray(Rr,Rr+Gr),Vr),Vr+=Gr,Rr+=Gr,Hr-=Gr;Br[Vr++]=1,Br[Vr++]=Hr&255,Br[Vr++]=Hr>>8&255,Br[Vr++]=~Hr&65535&255,Br[Vr++]=(~Hr&65535)>>8&255,Br.set(Mr.subarray(Rr),Vr),Vr+=Mr.length-Rr;const Xr=Pr(Mr,0,Mr.length);return Br[Vr++]=Xr>>24&255,Br[Vr++]=Xr>>16&255,Br[Vr++]=Xr>>8&255,Br[Vr++]=Xr&255,Br}function kr(Mr,Hr,Gr,zr){const Br=Mr.width,Vr=Mr.height;let Rr,Xr,an;const yr=Mr.data;switch(Hr){case rr.ImageKind.GRAYSCALE_1BPP:Xr=0,Rr=1,an=Br+7>>3;break;case rr.ImageKind.RGB_24BPP:Xr=2,Rr=8,an=Br*3;break;case rr.ImageKind.RGBA_32BPP:Xr=6,Rr=8,an=Br*4;break;default:throw new Error("invalid format")}const br=new Uint8Array((1+an)*Vr);let Er=0,Lr=0;for(let _n=0;_n<Vr;++_n)br[Er++]=0,br.set(yr.subarray(Lr,Lr+an),Er),Lr+=an,Er+=an;if(Hr===rr.ImageKind.GRAYSCALE_1BPP&&zr){Er=0;for(let _n=0;_n<Vr;_n++){Er++;for(let Kr=0;Kr<an;Kr++)br[Er++]^=255}}const Or=new Uint8Array([Br>>24&255,Br>>16&255,Br>>8&255,Br&255,Vr>>24&255,Vr>>16&255,Vr>>8&255,Vr&255,Rr,Xr,0,0,0]),Ur=Ir(br),$r=Cr.length+Tr*3+Or.length+Ur.length,Zr=new Uint8Array($r);let fn=0;return Zr.set(Cr,fn),fn+=Cr.length,Ar("IHDR",Or,Zr,fn),fn+=Tr+Or.length,Ar("IDATA",Ur,Zr,fn),fn+=Tr+Ur.length,Ar("IEND",new Uint8Array(0),Zr,fn),lr(Zr,"image/png",Gr)}return function(Hr,Gr,zr){const Br=Hr.kind===void 0?rr.ImageKind.GRAYSCALE_1BPP:Hr.kind;return kr(Hr,Br,Gr,zr)}}();class fr{constructor(){this.fontSizeScale=1,this.fontWeight=nr.fontWeight,this.fontSize=0,this.textMatrix=rr.IDENTITY_MATRIX,this.fontMatrix=rr.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=rr.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=nr.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(Tr,Fr){this.x=Tr,this.y=Fr}}function cr(Cr){let Tr=[];const Fr=[];for(const _r of Cr){if(_r.fn==="save"){Tr.push({fnId:92,fn:"group",items:[]}),Fr.push(Tr),Tr=Tr.at(-1).items;continue}_r.fn==="restore"?Tr=Fr.pop():Tr.push(_r)}return Tr}function mr(Cr){if(Number.isInteger(Cr))return Cr.toString();const Tr=Cr.toFixed(10);let Fr=Tr.length-1;if(Tr[Fr]!=="0")return Tr;do Fr--;while(Tr[Fr]==="0");return Tr.substring(0,Tr[Fr]==="."?Fr:Fr+1)}function dr(Cr){if(Cr[4]===0&&Cr[5]===0){if(Cr[1]===0&&Cr[2]===0)return Cr[0]===1&&Cr[3]===1?"":`scale(${mr(Cr[0])} ${mr(Cr[3])})`;if(Cr[0]===Cr[3]&&Cr[1]===-Cr[2]){const Tr=Math.acos(Cr[0])*180/Math.PI;return`rotate(${mr(Tr)})`}}else if(Cr[0]===1&&Cr[1]===0&&Cr[2]===0&&Cr[3]===1)return`translate(${mr(Cr[4])} ${mr(Cr[5])})`;return`matrix(${mr(Cr[0])} ${mr(Cr[1])} ${mr(Cr[2])} ${mr(Cr[3])} ${mr(Cr[4])} ${mr(Cr[5])})`}let xr=0,pr=0,gr=0;class vr{constructor(Tr,Fr,_r=!1){(0,tr.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new tr.DOMSVGFactory,this.current=new fr,this.transformMatrix=rr.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=Tr,this.objs=Fr,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!_r,this._operatorIdMapping=[];for(const Ar in rr.OPS)this._operatorIdMapping[rr.OPS[Ar]]=Ar}getObject(Tr,Fr=null){return typeof Tr=="string"?Tr.startsWith("g_")?this.commonObjs.get(Tr):this.objs.get(Tr):Fr}save(){this.transformStack.push(this.transformMatrix);const Tr=this.current;this.extraStack.push(Tr),this.current=Tr.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(Tr){this.save(),this.executeOpTree(Tr),this.restore()}loadDependencies(Tr){const Fr=Tr.fnArray,_r=Tr.argsArray;for(let Ar=0,Pr=Fr.length;Ar<Pr;Ar++)if(Fr[Ar]===rr.OPS.dependency)for(const Ir of _r[Ar]){const wr=Ir.startsWith("g_")?this.commonObjs:this.objs,kr=new Promise(Mr=>{wr.get(Ir,Mr)});this.current.dependencies.push(kr)}return Promise.all(this.current.dependencies)}transform(Tr,Fr,_r,Ar,Pr,Ir){const wr=[Tr,Fr,_r,Ar,Pr,Ir];this.transformMatrix=rr.Util.transform(this.transformMatrix,wr),this.tgrp=null}getSVG(Tr,Fr){this.viewport=Fr;const _r=this._initialize(Fr);return this.loadDependencies(Tr).then(()=>(this.transformMatrix=rr.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(Tr)),_r))}convertOpList(Tr){const Fr=this._operatorIdMapping,_r=Tr.argsArray,Ar=Tr.fnArray,Pr=[];for(let Ir=0,wr=Ar.length;Ir<wr;Ir++){const kr=Ar[Ir];Pr.push({fnId:kr,fn:Fr[kr],args:_r[Ir]})}return cr(Pr)}executeOpTree(Tr){for(const Fr of Tr){const _r=Fr.fn,Ar=Fr.fnId,Pr=Fr.args;switch(Ar|0){case rr.OPS.beginText:this.beginText();break;case rr.OPS.dependency:break;case rr.OPS.setLeading:this.setLeading(Pr);break;case rr.OPS.setLeadingMoveText:this.setLeadingMoveText(Pr[0],Pr[1]);break;case rr.OPS.setFont:this.setFont(Pr);break;case rr.OPS.showText:this.showText(Pr[0]);break;case rr.OPS.showSpacedText:this.showText(Pr[0]);break;case rr.OPS.endText:this.endText();break;case rr.OPS.moveText:this.moveText(Pr[0],Pr[1]);break;case rr.OPS.setCharSpacing:this.setCharSpacing(Pr[0]);break;case rr.OPS.setWordSpacing:this.setWordSpacing(Pr[0]);break;case rr.OPS.setHScale:this.setHScale(Pr[0]);break;case rr.OPS.setTextMatrix:this.setTextMatrix(Pr[0],Pr[1],Pr[2],Pr[3],Pr[4],Pr[5]);break;case rr.OPS.setTextRise:this.setTextRise(Pr[0]);break;case rr.OPS.setTextRenderingMode:this.setTextRenderingMode(Pr[0]);break;case rr.OPS.setLineWidth:this.setLineWidth(Pr[0]);break;case rr.OPS.setLineJoin:this.setLineJoin(Pr[0]);break;case rr.OPS.setLineCap:this.setLineCap(Pr[0]);break;case rr.OPS.setMiterLimit:this.setMiterLimit(Pr[0]);break;case rr.OPS.setFillRGBColor:this.setFillRGBColor(Pr[0],Pr[1],Pr[2]);break;case rr.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Pr[0],Pr[1],Pr[2]);break;case rr.OPS.setStrokeColorN:this.setStrokeColorN(Pr);break;case rr.OPS.setFillColorN:this.setFillColorN(Pr);break;case rr.OPS.shadingFill:this.shadingFill(Pr[0]);break;case rr.OPS.setDash:this.setDash(Pr[0],Pr[1]);break;case rr.OPS.setRenderingIntent:this.setRenderingIntent(Pr[0]);break;case rr.OPS.setFlatness:this.setFlatness(Pr[0]);break;case rr.OPS.setGState:this.setGState(Pr[0]);break;case rr.OPS.fill:this.fill();break;case rr.OPS.eoFill:this.eoFill();break;case rr.OPS.stroke:this.stroke();break;case rr.OPS.fillStroke:this.fillStroke();break;case rr.OPS.eoFillStroke:this.eoFillStroke();break;case rr.OPS.clip:this.clip("nonzero");break;case rr.OPS.eoClip:this.clip("evenodd");break;case rr.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case rr.OPS.paintImageXObject:this.paintImageXObject(Pr[0]);break;case rr.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Pr[0]);break;case rr.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Pr[0]);break;case rr.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Pr[0],Pr[1]);break;case rr.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case rr.OPS.closePath:this.closePath();break;case rr.OPS.closeStroke:this.closeStroke();break;case rr.OPS.closeFillStroke:this.closeFillStroke();break;case rr.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case rr.OPS.nextLine:this.nextLine();break;case rr.OPS.transform:this.transform(Pr[0],Pr[1],Pr[2],Pr[3],Pr[4],Pr[5]);break;case rr.OPS.constructPath:this.constructPath(Pr[0],Pr[1]);break;case rr.OPS.endPath:this.endPath();break;case 92:this.group(Fr.items);break;default:(0,rr.warn)(`Unimplemented operator ${_r}`);break}}}setWordSpacing(Tr){this.current.wordSpacing=Tr}setCharSpacing(Tr){this.current.charSpacing=Tr}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(Tr,Fr,_r,Ar,Pr,Ir){const wr=this.current;wr.textMatrix=wr.lineMatrix=[Tr,Fr,_r,Ar,Pr,Ir],wr.textMatrixScale=Math.hypot(Tr,Fr),wr.x=wr.lineX=0,wr.y=wr.lineY=0,wr.xcoords=[],wr.ycoords=[],wr.tspan=this.svgFactory.createElement("svg:tspan"),wr.tspan.setAttributeNS(null,"font-family",wr.fontFamily),wr.tspan.setAttributeNS(null,"font-size",`${mr(wr.fontSize)}px`),wr.tspan.setAttributeNS(null,"y",mr(-wr.y)),wr.txtElement=this.svgFactory.createElement("svg:text"),wr.txtElement.append(wr.tspan)}beginText(){const Tr=this.current;Tr.x=Tr.lineX=0,Tr.y=Tr.lineY=0,Tr.textMatrix=rr.IDENTITY_MATRIX,Tr.lineMatrix=rr.IDENTITY_MATRIX,Tr.textMatrixScale=1,Tr.tspan=this.svgFactory.createElement("svg:tspan"),Tr.txtElement=this.svgFactory.createElement("svg:text"),Tr.txtgrp=this.svgFactory.createElement("svg:g"),Tr.xcoords=[],Tr.ycoords=[]}moveText(Tr,Fr){const _r=this.current;_r.x=_r.lineX+=Tr,_r.y=_r.lineY+=Fr,_r.xcoords=[],_r.ycoords=[],_r.tspan=this.svgFactory.createElement("svg:tspan"),_r.tspan.setAttributeNS(null,"font-family",_r.fontFamily),_r.tspan.setAttributeNS(null,"font-size",`${mr(_r.fontSize)}px`),_r.tspan.setAttributeNS(null,"y",mr(-_r.y))}showText(Tr){const Fr=this.current,_r=Fr.font,Ar=Fr.fontSize;if(Ar===0)return;const Pr=Fr.fontSizeScale,Ir=Fr.charSpacing,wr=Fr.wordSpacing,kr=Fr.fontDirection,Mr=Fr.textHScale*kr,Hr=_r.vertical,Gr=Hr?1:-1,zr=_r.defaultVMetrics,Br=Ar*Fr.fontMatrix[0];let Vr=0;for(const an of Tr){if(an===null){Vr+=kr*wr;continue}else if(typeof an=="number"){Vr+=Gr*an*Ar/1e3;continue}const yr=(an.isSpace?wr:0)+Ir,br=an.fontChar;let Er,Lr,Or=an.width;if(Hr){let $r;const Zr=an.vmetric||zr;$r=an.vmetric?Zr[1]:Or*.5,$r=-$r*Br;const fn=Zr[2]*Br;Or=Zr?-Zr[0]:Or,Er=$r/Pr,Lr=(Vr+fn)/Pr}else Er=Vr/Pr,Lr=0;(an.isInFont||_r.missingFile)&&(Fr.xcoords.push(Fr.x+Er),Hr&&Fr.ycoords.push(-Fr.y+Lr),Fr.tspan.textContent+=br);const Ur=Hr?Or*Br-yr*kr:Or*Br+yr*kr;Vr+=Ur}Fr.tspan.setAttributeNS(null,"x",Fr.xcoords.map(mr).join(" ")),Hr?Fr.tspan.setAttributeNS(null,"y",Fr.ycoords.map(mr).join(" ")):Fr.tspan.setAttributeNS(null,"y",mr(-Fr.y)),Hr?Fr.y-=Vr:Fr.x+=Vr*Mr,Fr.tspan.setAttributeNS(null,"font-family",Fr.fontFamily),Fr.tspan.setAttributeNS(null,"font-size",`${mr(Fr.fontSize)}px`),Fr.fontStyle!==nr.fontStyle&&Fr.tspan.setAttributeNS(null,"font-style",Fr.fontStyle),Fr.fontWeight!==nr.fontWeight&&Fr.tspan.setAttributeNS(null,"font-weight",Fr.fontWeight);const Rr=Fr.textRenderingMode&rr.TextRenderingMode.FILL_STROKE_MASK;if(Rr===rr.TextRenderingMode.FILL||Rr===rr.TextRenderingMode.FILL_STROKE?(Fr.fillColor!==nr.fillColor&&Fr.tspan.setAttributeNS(null,"fill",Fr.fillColor),Fr.fillAlpha<1&&Fr.tspan.setAttributeNS(null,"fill-opacity",Fr.fillAlpha)):Fr.textRenderingMode===rr.TextRenderingMode.ADD_TO_PATH?Fr.tspan.setAttributeNS(null,"fill","transparent"):Fr.tspan.setAttributeNS(null,"fill","none"),Rr===rr.TextRenderingMode.STROKE||Rr===rr.TextRenderingMode.FILL_STROKE){const an=1/(Fr.textMatrixScale||1);this._setStrokeAttributes(Fr.tspan,an)}let Xr=Fr.textMatrix;Fr.textRise!==0&&(Xr=Xr.slice(),Xr[5]+=Fr.textRise),Fr.txtElement.setAttributeNS(null,"transform",`${dr(Xr)} scale(${mr(Mr)}, -1)`),Fr.txtElement.setAttributeNS(ir,"xml:space","preserve"),Fr.txtElement.append(Fr.tspan),Fr.txtgrp.append(Fr.txtElement),this._ensureTransformGroup().append(Fr.txtElement)}setLeadingMoveText(Tr,Fr){this.setLeading(-Fr),this.moveText(Tr,Fr)}addFontStyle(Tr){if(!Tr.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const Fr=lr(Tr.data,Tr.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${Tr.loadedName}"; src: url(${Fr}); }
`}setFont(Tr){const Fr=this.current,_r=this.commonObjs.get(Tr[0]);let Ar=Tr[1];Fr.font=_r,this.embedFonts&&!_r.missingFile&&!this.embeddedFonts[_r.loadedName]&&(this.addFontStyle(_r),this.embeddedFonts[_r.loadedName]=_r),Fr.fontMatrix=_r.fontMatrix||rr.FONT_IDENTITY_MATRIX;let Pr="normal";_r.black?Pr="900":_r.bold&&(Pr="bold");const Ir=_r.italic?"italic":"normal";Ar<0?(Ar=-Ar,Fr.fontDirection=-1):Fr.fontDirection=1,Fr.fontSize=Ar,Fr.fontFamily=_r.loadedName,Fr.fontWeight=Pr,Fr.fontStyle=Ir,Fr.tspan=this.svgFactory.createElement("svg:tspan"),Fr.tspan.setAttributeNS(null,"y",mr(-Fr.y)),Fr.xcoords=[],Fr.ycoords=[]}endText(){var Fr;const Tr=this.current;Tr.textRenderingMode&rr.TextRenderingMode.ADD_TO_PATH_FLAG&&((Fr=Tr.txtElement)!=null&&Fr.hasChildNodes())&&(Tr.element=Tr.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(Tr){Tr>0&&(this.current.lineWidth=Tr)}setLineCap(Tr){this.current.lineCap=sr[Tr]}setLineJoin(Tr){this.current.lineJoin=or[Tr]}setMiterLimit(Tr){this.current.miterLimit=Tr}setStrokeAlpha(Tr){this.current.strokeAlpha=Tr}setStrokeRGBColor(Tr,Fr,_r){this.current.strokeColor=rr.Util.makeHexColor(Tr,Fr,_r)}setFillAlpha(Tr){this.current.fillAlpha=Tr}setFillRGBColor(Tr,Fr,_r){this.current.fillColor=rr.Util.makeHexColor(Tr,Fr,_r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(Tr){this.current.strokeColor=this._makeColorN_Pattern(Tr)}setFillColorN(Tr){this.current.fillColor=this._makeColorN_Pattern(Tr)}shadingFill(Tr){const{width:Fr,height:_r}=this.viewport,Ar=rr.Util.inverseTransform(this.transformMatrix),[Pr,Ir,wr,kr]=rr.Util.getAxialAlignedBoundingBox([0,0,Fr,_r],Ar),Mr=this.svgFactory.createElement("svg:rect");Mr.setAttributeNS(null,"x",Pr),Mr.setAttributeNS(null,"y",Ir),Mr.setAttributeNS(null,"width",wr-Pr),Mr.setAttributeNS(null,"height",kr-Ir),Mr.setAttributeNS(null,"fill",this._makeShadingPattern(Tr)),this.current.fillAlpha<1&&Mr.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Mr)}_makeColorN_Pattern(Tr){return Tr[0]==="TilingPattern"?this._makeTilingPattern(Tr):this._makeShadingPattern(Tr)}_makeTilingPattern(Tr){const Fr=Tr[1],_r=Tr[2],Ar=Tr[3]||rr.IDENTITY_MATRIX,[Pr,Ir,wr,kr]=Tr[4],Mr=Tr[5],Hr=Tr[6],Gr=Tr[7],zr=`shading${gr++}`,[Br,Vr,Rr,Xr]=rr.Util.normalizeRect([...rr.Util.applyTransform([Pr,Ir],Ar),...rr.Util.applyTransform([wr,kr],Ar)]),[an,yr]=rr.Util.singularValueDecompose2dScale(Ar),br=Mr*an,Er=Hr*yr,Lr=this.svgFactory.createElement("svg:pattern");Lr.setAttributeNS(null,"id",zr),Lr.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Lr.setAttributeNS(null,"width",br),Lr.setAttributeNS(null,"height",Er),Lr.setAttributeNS(null,"x",`${Br}`),Lr.setAttributeNS(null,"y",`${Vr}`);const Or=this.svg,Ur=this.transformMatrix,$r=this.current.fillColor,Zr=this.current.strokeColor,fn=this.svgFactory.create(Rr-Br,Xr-Vr);if(this.svg=fn,this.transformMatrix=Ar,Gr===2){const _n=rr.Util.makeHexColor(...Fr);this.current.fillColor=_n,this.current.strokeColor=_n}return this.executeOpTree(this.convertOpList(_r)),this.svg=Or,this.transformMatrix=Ur,this.current.fillColor=$r,this.current.strokeColor=Zr,Lr.append(fn.childNodes[0]),this.defs.append(Lr),`url(#${zr})`}_makeShadingPattern(Tr){switch(typeof Tr=="string"&&(Tr=this.objs.get(Tr)),Tr[0]){case"RadialAxial":const Fr=`shading${gr++}`,_r=Tr[3];let Ar;switch(Tr[1]){case"axial":const Pr=Tr[4],Ir=Tr[5];Ar=this.svgFactory.createElement("svg:linearGradient"),Ar.setAttributeNS(null,"id",Fr),Ar.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ar.setAttributeNS(null,"x1",Pr[0]),Ar.setAttributeNS(null,"y1",Pr[1]),Ar.setAttributeNS(null,"x2",Ir[0]),Ar.setAttributeNS(null,"y2",Ir[1]);break;case"radial":const wr=Tr[4],kr=Tr[5],Mr=Tr[6],Hr=Tr[7];Ar=this.svgFactory.createElement("svg:radialGradient"),Ar.setAttributeNS(null,"id",Fr),Ar.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ar.setAttributeNS(null,"cx",kr[0]),Ar.setAttributeNS(null,"cy",kr[1]),Ar.setAttributeNS(null,"r",Hr),Ar.setAttributeNS(null,"fx",wr[0]),Ar.setAttributeNS(null,"fy",wr[1]),Ar.setAttributeNS(null,"fr",Mr);break;default:throw new Error(`Unknown RadialAxial type: ${Tr[1]}`)}for(const Pr of _r){const Ir=this.svgFactory.createElement("svg:stop");Ir.setAttributeNS(null,"offset",Pr[0]),Ir.setAttributeNS(null,"stop-color",Pr[1]),Ar.append(Ir)}return this.defs.append(Ar),`url(#${Fr})`;case"Mesh":return(0,rr.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${Tr[0]}`)}}setDash(Tr,Fr){this.current.dashArray=Tr,this.current.dashPhase=Fr}constructPath(Tr,Fr){const _r=this.current;let Ar=_r.x,Pr=_r.y,Ir=[],wr=0;for(const kr of Tr)switch(kr|0){case rr.OPS.rectangle:Ar=Fr[wr++],Pr=Fr[wr++];const Mr=Fr[wr++],Hr=Fr[wr++],Gr=Ar+Mr,zr=Pr+Hr;Ir.push("M",mr(Ar),mr(Pr),"L",mr(Gr),mr(Pr),"L",mr(Gr),mr(zr),"L",mr(Ar),mr(zr),"Z");break;case rr.OPS.moveTo:Ar=Fr[wr++],Pr=Fr[wr++],Ir.push("M",mr(Ar),mr(Pr));break;case rr.OPS.lineTo:Ar=Fr[wr++],Pr=Fr[wr++],Ir.push("L",mr(Ar),mr(Pr));break;case rr.OPS.curveTo:Ar=Fr[wr+4],Pr=Fr[wr+5],Ir.push("C",mr(Fr[wr]),mr(Fr[wr+1]),mr(Fr[wr+2]),mr(Fr[wr+3]),mr(Ar),mr(Pr)),wr+=6;break;case rr.OPS.curveTo2:Ir.push("C",mr(Ar),mr(Pr),mr(Fr[wr]),mr(Fr[wr+1]),mr(Fr[wr+2]),mr(Fr[wr+3])),Ar=Fr[wr+2],Pr=Fr[wr+3],wr+=4;break;case rr.OPS.curveTo3:Ar=Fr[wr+2],Pr=Fr[wr+3],Ir.push("C",mr(Fr[wr]),mr(Fr[wr+1]),mr(Ar),mr(Pr),mr(Ar),mr(Pr)),wr+=4;break;case rr.OPS.closePath:Ir.push("Z");break}Ir=Ir.join(" "),_r.path&&Tr.length>0&&Tr[0]!==rr.OPS.rectangle&&Tr[0]!==rr.OPS.moveTo?Ir=_r.path.getAttributeNS(null,"d")+Ir:(_r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(_r.path)),_r.path.setAttributeNS(null,"d",Ir),_r.path.setAttributeNS(null,"fill","none"),_r.element=_r.path,_r.setCurrentPoint(Ar,Pr)}endPath(){const Tr=this.current;if(Tr.path=null,!this.pendingClip)return;if(!Tr.element){this.pendingClip=null;return}const Fr=`clippath${xr++}`,_r=this.svgFactory.createElement("svg:clipPath");_r.setAttributeNS(null,"id",Fr),_r.setAttributeNS(null,"transform",dr(this.transformMatrix));const Ar=Tr.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Ar.setAttributeNS(null,"clip-rule","evenodd"):Ar.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,_r.append(Ar),this.defs.append(_r),Tr.activeClipUrl){Tr.clipGroup=null;for(const Pr of this.extraStack)Pr.clipGroup=null;_r.setAttributeNS(null,"clip-path",Tr.activeClipUrl)}Tr.activeClipUrl=`url(#${Fr})`,this.tgrp=null}clip(Tr){this.pendingClip=Tr}closePath(){const Tr=this.current;if(Tr.path){const Fr=`${Tr.path.getAttributeNS(null,"d")}Z`;Tr.path.setAttributeNS(null,"d",Fr)}}setLeading(Tr){this.current.leading=-Tr}setTextRise(Tr){this.current.textRise=Tr}setTextRenderingMode(Tr){this.current.textRenderingMode=Tr}setHScale(Tr){this.current.textHScale=Tr/100}setRenderingIntent(Tr){}setFlatness(Tr){}setGState(Tr){for(const[Fr,_r]of Tr)switch(Fr){case"LW":this.setLineWidth(_r);break;case"LC":this.setLineCap(_r);break;case"LJ":this.setLineJoin(_r);break;case"ML":this.setMiterLimit(_r);break;case"D":this.setDash(_r[0],_r[1]);break;case"RI":this.setRenderingIntent(_r);break;case"FL":this.setFlatness(_r);break;case"Font":this.setFont(_r);break;case"CA":this.setStrokeAlpha(_r);break;case"ca":this.setFillAlpha(_r);break;default:(0,rr.warn)(`Unimplemented graphic state operator ${Fr}`);break}}fill(){const Tr=this.current;Tr.element&&(Tr.element.setAttributeNS(null,"fill",Tr.fillColor),Tr.element.setAttributeNS(null,"fill-opacity",Tr.fillAlpha),this.endPath())}stroke(){const Tr=this.current;Tr.element&&(this._setStrokeAttributes(Tr.element),Tr.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(Tr,Fr=1){const _r=this.current;let Ar=_r.dashArray;Fr!==1&&Ar.length>0&&(Ar=Ar.map(function(Pr){return Fr*Pr})),Tr.setAttributeNS(null,"stroke",_r.strokeColor),Tr.setAttributeNS(null,"stroke-opacity",_r.strokeAlpha),Tr.setAttributeNS(null,"stroke-miterlimit",mr(_r.miterLimit)),Tr.setAttributeNS(null,"stroke-linecap",_r.lineCap),Tr.setAttributeNS(null,"stroke-linejoin",_r.lineJoin),Tr.setAttributeNS(null,"stroke-width",mr(Fr*_r.lineWidth)+"px"),Tr.setAttributeNS(null,"stroke-dasharray",Ar.map(mr).join(" ")),Tr.setAttributeNS(null,"stroke-dashoffset",mr(Fr*_r.dashPhase)+"px")}eoFill(){var Tr;(Tr=this.current.element)==null||Tr.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var Tr;(Tr=this.current.element)==null||Tr.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const Tr=this.svgFactory.createElement("svg:rect");Tr.setAttributeNS(null,"x","0"),Tr.setAttributeNS(null,"y","0"),Tr.setAttributeNS(null,"width","1px"),Tr.setAttributeNS(null,"height","1px"),Tr.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(Tr)}paintImageXObject(Tr){const Fr=this.getObject(Tr);if(!Fr){(0,rr.warn)(`Dependent image with object ID ${Tr} is not ready yet`);return}this.paintInlineImageXObject(Fr)}paintInlineImageXObject(Tr,Fr){const _r=Tr.width,Ar=Tr.height,Pr=ur(Tr,this.forceDataSchema,!!Fr),Ir=this.svgFactory.createElement("svg:rect");Ir.setAttributeNS(null,"x","0"),Ir.setAttributeNS(null,"y","0"),Ir.setAttributeNS(null,"width",mr(_r)),Ir.setAttributeNS(null,"height",mr(Ar)),this.current.element=Ir,this.clip("nonzero");const wr=this.svgFactory.createElement("svg:image");wr.setAttributeNS(ar,"xlink:href",Pr),wr.setAttributeNS(null,"x","0"),wr.setAttributeNS(null,"y",mr(-Ar)),wr.setAttributeNS(null,"width",mr(_r)+"px"),wr.setAttributeNS(null,"height",mr(Ar)+"px"),wr.setAttributeNS(null,"transform",`scale(${mr(1/_r)} ${mr(-1/Ar)})`),Fr?Fr.append(wr):this._ensureTransformGroup().append(wr)}paintImageMaskXObject(Tr){const Fr=this.getObject(Tr.data,Tr);if(Fr.bitmap){(0,rr.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const _r=this.current,Ar=Fr.width,Pr=Fr.height,Ir=_r.fillColor;_r.maskId=`mask${pr++}`;const wr=this.svgFactory.createElement("svg:mask");wr.setAttributeNS(null,"id",_r.maskId);const kr=this.svgFactory.createElement("svg:rect");kr.setAttributeNS(null,"x","0"),kr.setAttributeNS(null,"y","0"),kr.setAttributeNS(null,"width",mr(Ar)),kr.setAttributeNS(null,"height",mr(Pr)),kr.setAttributeNS(null,"fill",Ir),kr.setAttributeNS(null,"mask",`url(#${_r.maskId})`),this.defs.append(wr),this._ensureTransformGroup().append(kr),this.paintInlineImageXObject(Fr,wr)}paintFormXObjectBegin(Tr,Fr){if(Array.isArray(Tr)&&Tr.length===6&&this.transform(Tr[0],Tr[1],Tr[2],Tr[3],Tr[4],Tr[5]),Fr){const _r=Fr[2]-Fr[0],Ar=Fr[3]-Fr[1],Pr=this.svgFactory.createElement("svg:rect");Pr.setAttributeNS(null,"x",Fr[0]),Pr.setAttributeNS(null,"y",Fr[1]),Pr.setAttributeNS(null,"width",mr(_r)),Pr.setAttributeNS(null,"height",mr(Ar)),this.current.element=Pr,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(Tr){const Fr=this.svgFactory.create(Tr.width,Tr.height),_r=this.svgFactory.createElement("svg:defs");Fr.append(_r),this.defs=_r;const Ar=this.svgFactory.createElement("svg:g");return Ar.setAttributeNS(null,"transform",dr(Tr.transform)),Fr.append(Ar),this.svg=Ar,Fr}_ensureClipGroup(){if(!this.current.clipGroup){const Tr=this.svgFactory.createElement("svg:g");Tr.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(Tr),this.current.clipGroup=Tr}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",dr(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}_e.SVGGraphics=vr},(e,_e)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.XfaText=void 0;class er{static textContent(rr){const nr=[],ir={items:nr,styles:Object.create(null)};function ar(sr){var ur;if(!sr)return;let or=null;const lr=sr.name;if(lr==="#text")or=sr.value;else if(er.shouldBuildText(lr))(ur=sr==null?void 0:sr.attributes)!=null&&ur.textContent?or=sr.attributes.textContent:sr.value&&(or=sr.value);else return;if(or!==null&&nr.push({str:or}),!!sr.children)for(const fr of sr.children)ar(fr)}return ar(rr),ir}static shouldBuildText(rr){return!(rr==="textarea"||rr==="input"||rr==="option"||rr==="select")}}_e.XfaText=er},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.TextLayerRenderTask=void 0,_e.renderTextLayer=dr,_e.updateTextLayer=xr;var tr=er(1),rr=er(6);const nr=1e5,ir=30,ar=.8,sr=new Map;function or(pr,gr){let vr;if(gr&&tr.FeatureTest.isOffscreenCanvasSupported)vr=new OffscreenCanvas(pr,pr).getContext("2d",{alpha:!1});else{const Cr=document.createElement("canvas");Cr.width=Cr.height=pr,vr=Cr.getContext("2d",{alpha:!1})}return vr}function lr(pr,gr){const vr=sr.get(pr);if(vr)return vr;const Cr=or(ir,gr);Cr.font=`${ir}px ${pr}`;const Tr=Cr.measureText("");let Fr=Tr.fontBoundingBoxAscent,_r=Math.abs(Tr.fontBoundingBoxDescent);if(Fr){const Pr=Fr/(Fr+_r);return sr.set(pr,Pr),Cr.canvas.width=Cr.canvas.height=0,Pr}Cr.strokeStyle="red",Cr.clearRect(0,0,ir,ir),Cr.strokeText("g",0,0);let Ar=Cr.getImageData(0,0,ir,ir).data;_r=0;for(let Pr=Ar.length-1-3;Pr>=0;Pr-=4)if(Ar[Pr]>0){_r=Math.ceil(Pr/4/ir);break}Cr.clearRect(0,0,ir,ir),Cr.strokeText("A",0,ir),Ar=Cr.getImageData(0,0,ir,ir).data,Fr=0;for(let Pr=0,Ir=Ar.length;Pr<Ir;Pr+=4)if(Ar[Pr]>0){Fr=ir-Math.floor(Pr/4/ir);break}if(Cr.canvas.width=Cr.canvas.height=0,Fr){const Pr=Fr/(Fr+_r);return sr.set(pr,Pr),Pr}return sr.set(pr,ar),ar}function ur(pr,gr,vr){const Cr=document.createElement("span"),Tr={angle:0,canvasWidth:0,hasText:gr.str!=="",hasEOL:gr.hasEOL,fontSize:0};pr._textDivs.push(Cr);const Fr=tr.Util.transform(pr._transform,gr.transform);let _r=Math.atan2(Fr[1],Fr[0]);const Ar=vr[gr.fontName];Ar.vertical&&(_r+=Math.PI/2);const Pr=Math.hypot(Fr[2],Fr[3]),Ir=Pr*lr(Ar.fontFamily,pr._isOffscreenCanvasSupported);let wr,kr;_r===0?(wr=Fr[4],kr=Fr[5]-Ir):(wr=Fr[4]+Ir*Math.sin(_r),kr=Fr[5]-Ir*Math.cos(_r));const Mr="calc(var(--scale-factor)*",Hr=Cr.style;pr._container===pr._rootContainer?(Hr.left=`${(100*wr/pr._pageWidth).toFixed(2)}%`,Hr.top=`${(100*kr/pr._pageHeight).toFixed(2)}%`):(Hr.left=`${Mr}${wr.toFixed(2)}px)`,Hr.top=`${Mr}${kr.toFixed(2)}px)`),Hr.fontSize=`${Mr}${Pr.toFixed(2)}px)`,Hr.fontFamily=Ar.fontFamily,Tr.fontSize=Pr,Cr.setAttribute("role","presentation"),Cr.textContent=gr.str,Cr.dir=gr.dir,pr._fontInspectorEnabled&&(Cr.dataset.fontName=gr.fontName),_r!==0&&(Tr.angle=_r*(180/Math.PI));let Gr=!1;if(gr.str.length>1)Gr=!0;else if(gr.str!==" "&&gr.transform[0]!==gr.transform[3]){const zr=Math.abs(gr.transform[0]),Br=Math.abs(gr.transform[3]);zr!==Br&&Math.max(zr,Br)/Math.min(zr,Br)>1.5&&(Gr=!0)}Gr&&(Tr.canvasWidth=Ar.vertical?gr.height:gr.width),pr._textDivProperties.set(Cr,Tr),pr._isReadableStream&&pr._layoutText(Cr)}function fr(pr){const{div:gr,scale:vr,properties:Cr,ctx:Tr,prevFontSize:Fr,prevFontFamily:_r}=pr,{style:Ar}=gr;let Pr="";if(Cr.canvasWidth!==0&&Cr.hasText){const{fontFamily:Ir}=Ar,{canvasWidth:wr,fontSize:kr}=Cr;(Fr!==kr||_r!==Ir)&&(Tr.font=`${kr*vr}px ${Ir}`,pr.prevFontSize=kr,pr.prevFontFamily=Ir);const{width:Mr}=Tr.measureText(gr.textContent);Mr>0&&(Pr=`scaleX(${wr*vr/Mr})`)}Cr.angle!==0&&(Pr=`rotate(${Cr.angle}deg) ${Pr}`),Pr.length>0&&(Ar.transform=Pr)}function cr(pr){if(pr._canceled)return;const gr=pr._textDivs,vr=pr._capability;if(gr.length>nr){vr.resolve();return}if(!pr._isReadableStream)for(const Tr of gr)pr._layoutText(Tr);vr.resolve()}class mr{constructor({textContentSource:gr,container:vr,viewport:Cr,textDivs:Tr,textDivProperties:Fr,textContentItemsStr:_r,isOffscreenCanvasSupported:Ar}){var Mr;this._textContentSource=gr,this._isReadableStream=gr instanceof ReadableStream,this._container=this._rootContainer=vr,this._textDivs=Tr||[],this._textContentItemsStr=_r||[],this._isOffscreenCanvasSupported=Ar,this._fontInspectorEnabled=!!((Mr=globalThis.FontInspector)!=null&&Mr.enabled),this._reader=null,this._textDivProperties=Fr||new WeakMap,this._canceled=!1,this._capability=new tr.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:Cr.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:or(0,Ar)};const{pageWidth:Pr,pageHeight:Ir,pageX:wr,pageY:kr}=Cr.rawDims;this._transform=[1,0,0,-1,-wr,kr+Ir],this._pageWidth=Pr,this._pageHeight=Ir,(0,rr.setLayerDimensions)(vr,Cr),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new tr.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new tr.AbortException("TextLayer task cancelled."))}_processItems(gr,vr){for(const Cr of gr){if(Cr.str===void 0){if(Cr.type==="beginMarkedContentProps"||Cr.type==="beginMarkedContent"){const Tr=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),Cr.id!==null&&this._container.setAttribute("id",`${Cr.id}`),Tr.append(this._container)}else Cr.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(Cr.str),ur(this,Cr,vr)}}_layoutText(gr){const vr=this._layoutTextParams.properties=this._textDivProperties.get(gr);if(this._layoutTextParams.div=gr,fr(this._layoutTextParams),vr.hasText&&this._container.append(gr),vr.hasEOL){const Cr=document.createElement("br");Cr.setAttribute("role","presentation"),this._container.append(Cr)}}_render(){const gr=new tr.PromiseCapability;let vr=Object.create(null);if(this._isReadableStream){const Cr=()=>{this._reader.read().then(({value:Tr,done:Fr})=>{if(Fr){gr.resolve();return}Object.assign(vr,Tr.styles),this._processItems(Tr.items,vr),Cr()},gr.reject)};this._reader=this._textContentSource.getReader(),Cr()}else if(this._textContentSource){const{items:Cr,styles:Tr}=this._textContentSource;this._processItems(Cr,Tr),gr.resolve()}else throw new Error('No "textContentSource" parameter specified.');gr.promise.then(()=>{vr=null,cr(this)},this._capability.reject)}}_e.TextLayerRenderTask=mr;function dr(pr){!pr.textContentSource&&(pr.textContent||pr.textContentStream)&&((0,rr.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),pr.textContentSource=pr.textContent||pr.textContentStream);const{container:gr,viewport:vr}=pr,Cr=getComputedStyle(gr),Tr=Cr.getPropertyValue("visibility"),Fr=parseFloat(Cr.getPropertyValue("--scale-factor"));Tr==="visible"&&(!Fr||Math.abs(Fr-vr.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const _r=new mr(pr);return _r._render(),_r}function xr({container:pr,viewport:gr,textDivs:vr,textDivProperties:Cr,isOffscreenCanvasSupported:Tr,mustRotate:Fr=!0,mustRescale:_r=!0}){if(Fr&&(0,rr.setLayerDimensions)(pr,{rotation:gr.rotation}),_r){const Ar=or(0,Tr),Ir={prevFontSize:null,prevFontFamily:null,div:null,scale:gr.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Ar};for(const wr of vr)Ir.properties=Cr.get(wr),Ir.div=wr,fr(Ir)}}},(e,_e,er)=>{var lr,ur,fr,cr,mr,dr,xr,pr,gr,vr,Cr,s1,Q0,o1,l1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.AnnotationEditorLayer=void 0;var tr=er(1),rr=er(4),nr=er(28),ir=er(33),ar=er(6),sr=er(34);const Pr=class Pr{constructor({uiManager:wr,pageIndex:kr,div:Mr,accessibilityManager:Hr,annotationLayer:Gr,viewport:zr,l10n:Br}){Vn(this,Cr);Vn(this,lr);Vn(this,ur,!1);Vn(this,fr,null);Vn(this,cr,this.pointerup.bind(this));Vn(this,mr,this.pointerdown.bind(this));Vn(this,dr,new Map);Vn(this,xr,!1);Vn(this,pr,!1);Vn(this,gr,!1);Vn(this,vr);const Vr=[nr.FreeTextEditor,ir.InkEditor,sr.StampEditor];if(!Pr._initialized){Pr._initialized=!0;for(const Rr of Vr)Rr.initialize(Br)}wr.registerEditorTypes(Vr),Gn(this,vr,wr),this.pageIndex=kr,this.div=Mr,Gn(this,lr,Hr),Gn(this,fr,Gr),this.viewport=zr,jr(this,vr).addLayer(this)}get isEmpty(){return jr(this,dr).size===0}updateToolbar(wr){jr(this,vr).updateToolbar(wr)}updateMode(wr=jr(this,vr).getMode()){On(this,Cr,l1).call(this),wr===tr.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),wr!==tr.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",wr===tr.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",wr===tr.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",wr===tr.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(wr){if(!wr&&jr(this,vr).getMode()!==tr.AnnotationEditorType.INK)return;if(!wr){for(const Mr of jr(this,dr).values())if(Mr.isEmpty()){Mr.setInBackground();return}}On(this,Cr,Q0).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(wr){jr(this,vr).setEditingState(wr)}addCommands(wr){jr(this,vr).addCommands(wr)}enable(){this.div.style.pointerEvents="auto";const wr=new Set;for(const Mr of jr(this,dr).values())Mr.enableEditing(),Mr.annotationElementId&&wr.add(Mr.annotationElementId);if(!jr(this,fr))return;const kr=jr(this,fr).getEditableAnnotations();for(const Mr of kr){if(Mr.hide(),jr(this,vr).isDeletedAnnotationElement(Mr.data.id)||wr.has(Mr.data.id))continue;const Hr=this.deserialize(Mr);Hr&&(this.addOrRebuild(Hr),Hr.enableEditing())}}disable(){var kr;Gn(this,gr,!0),this.div.style.pointerEvents="none";const wr=new Set;for(const Mr of jr(this,dr).values()){if(Mr.disableEditing(),!Mr.annotationElementId||Mr.serialize()!==null){wr.add(Mr.annotationElementId);continue}(kr=this.getEditableAnnotation(Mr.annotationElementId))==null||kr.show(),Mr.remove()}if(jr(this,fr)){const Mr=jr(this,fr).getEditableAnnotations();for(const Hr of Mr){const{id:Gr}=Hr.data;wr.has(Gr)||jr(this,vr).isDeletedAnnotationElement(Gr)||Hr.show()}}On(this,Cr,l1).call(this),this.isEmpty&&(this.div.hidden=!0),Gn(this,gr,!1)}getEditableAnnotation(wr){var kr;return((kr=jr(this,fr))==null?void 0:kr.getEditableAnnotation(wr))||null}setActiveEditor(wr){jr(this,vr).getActive()!==wr&&jr(this,vr).setActiveEditor(wr)}enableClick(){this.div.addEventListener("pointerdown",jr(this,mr)),this.div.addEventListener("pointerup",jr(this,cr))}disableClick(){this.div.removeEventListener("pointerdown",jr(this,mr)),this.div.removeEventListener("pointerup",jr(this,cr))}attach(wr){jr(this,dr).set(wr.id,wr);const{annotationElementId:kr}=wr;kr&&jr(this,vr).isDeletedAnnotationElement(kr)&&jr(this,vr).removeDeletedAnnotationElement(wr)}detach(wr){var kr;jr(this,dr).delete(wr.id),(kr=jr(this,lr))==null||kr.removePointerInTextLayer(wr.contentDiv),!jr(this,gr)&&wr.annotationElementId&&jr(this,vr).addDeletedAnnotationElement(wr)}remove(wr){this.detach(wr),jr(this,vr).removeEditor(wr),wr.div.contains(document.activeElement)&&setTimeout(()=>{jr(this,vr).focusMainContainer()},0),wr.div.remove(),wr.isAttachedToDOM=!1,jr(this,pr)||this.addInkEditorIfNeeded(!1)}changeParent(wr){var kr;wr.parent!==this&&(wr.annotationElementId&&(jr(this,vr).addDeletedAnnotationElement(wr.annotationElementId),rr.AnnotationEditor.deleteAnnotationElement(wr),wr.annotationElementId=null),this.attach(wr),(kr=wr.parent)==null||kr.detach(wr),wr.setParent(this),wr.div&&wr.isAttachedToDOM&&(wr.div.remove(),this.div.append(wr.div)))}add(wr){if(this.changeParent(wr),jr(this,vr).addEditor(wr),this.attach(wr),!wr.isAttachedToDOM){const kr=wr.render();this.div.append(kr),wr.isAttachedToDOM=!0}wr.fixAndSetPosition(),wr.onceAdded(),jr(this,vr).addToAnnotationStorage(wr)}moveEditorInDOM(wr){var Mr;if(!wr.isAttachedToDOM)return;const{activeElement:kr}=document;wr.div.contains(kr)&&(wr._focusEventsAllowed=!1,setTimeout(()=>{wr.div.contains(document.activeElement)?wr._focusEventsAllowed=!0:(wr.div.addEventListener("focusin",()=>{wr._focusEventsAllowed=!0},{once:!0}),kr.focus())},0)),wr._structTreeParentId=(Mr=jr(this,lr))==null?void 0:Mr.moveElementInDOM(this.div,wr.div,wr.contentDiv,!0)}addOrRebuild(wr){wr.needsToBeRebuilt()?wr.rebuild():this.add(wr)}addUndoableEditor(wr){const kr=()=>wr._uiManager.rebuild(wr),Mr=()=>{wr.remove()};this.addCommands({cmd:kr,undo:Mr,mustExec:!1})}getNextId(){return jr(this,vr).getId()}pasteEditor(wr,kr){jr(this,vr).updateToolbar(wr),jr(this,vr).updateMode(wr);const{offsetX:Mr,offsetY:Hr}=On(this,Cr,o1).call(this),Gr=this.getNextId(),zr=On(this,Cr,s1).call(this,{parent:this,id:Gr,x:Mr,y:Hr,uiManager:jr(this,vr),isCentered:!0,...kr});zr&&this.add(zr)}deserialize(wr){switch(wr.annotationType??wr.annotationEditorType){case tr.AnnotationEditorType.FREETEXT:return nr.FreeTextEditor.deserialize(wr,this,jr(this,vr));case tr.AnnotationEditorType.INK:return ir.InkEditor.deserialize(wr,this,jr(this,vr));case tr.AnnotationEditorType.STAMP:return sr.StampEditor.deserialize(wr,this,jr(this,vr))}return null}addNewEditor(){On(this,Cr,Q0).call(this,On(this,Cr,o1).call(this),!0)}setSelected(wr){jr(this,vr).setSelected(wr)}toggleSelected(wr){jr(this,vr).toggleSelected(wr)}isSelected(wr){return jr(this,vr).isSelected(wr)}unselect(wr){jr(this,vr).unselect(wr)}pointerup(wr){const{isMac:kr}=tr.FeatureTest.platform;if(!(wr.button!==0||wr.ctrlKey&&kr)&&wr.target===this.div&&jr(this,xr)){if(Gn(this,xr,!1),!jr(this,ur)){Gn(this,ur,!0);return}if(jr(this,vr).getMode()===tr.AnnotationEditorType.STAMP){jr(this,vr).unselectAll();return}On(this,Cr,Q0).call(this,wr,!1)}}pointerdown(wr){if(jr(this,xr)){Gn(this,xr,!1);return}const{isMac:kr}=tr.FeatureTest.platform;if(wr.button!==0||wr.ctrlKey&&kr||wr.target!==this.div)return;Gn(this,xr,!0);const Mr=jr(this,vr).getActive();Gn(this,ur,!Mr||Mr.isEmpty())}findNewParent(wr,kr,Mr){const Hr=jr(this,vr).findParent(kr,Mr);return Hr===null||Hr===this?!1:(Hr.changeParent(wr),!0)}destroy(){var wr,kr;((wr=jr(this,vr).getActive())==null?void 0:wr.parent)===this&&(jr(this,vr).commitOrRemove(),jr(this,vr).setActiveEditor(null));for(const Mr of jr(this,dr).values())(kr=jr(this,lr))==null||kr.removePointerInTextLayer(Mr.contentDiv),Mr.setParent(null),Mr.isAttachedToDOM=!1,Mr.div.remove();this.div=null,jr(this,dr).clear(),jr(this,vr).removeLayer(this)}render({viewport:wr}){this.viewport=wr,(0,ar.setLayerDimensions)(this.div,wr);for(const kr of jr(this,vr).getEditors(this.pageIndex))this.add(kr);this.updateMode()}update({viewport:wr}){jr(this,vr).commitOrRemove(),this.viewport=wr,(0,ar.setLayerDimensions)(this.div,{rotation:wr.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:wr,pageHeight:kr}=this.viewport.rawDims;return[wr,kr]}};lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakMap,gr=new WeakMap,vr=new WeakMap,Cr=new WeakSet,s1=function(wr){switch(jr(this,vr).getMode()){case tr.AnnotationEditorType.FREETEXT:return new nr.FreeTextEditor(wr);case tr.AnnotationEditorType.INK:return new ir.InkEditor(wr);case tr.AnnotationEditorType.STAMP:return new sr.StampEditor(wr)}return null},Q0=function(wr,kr){const Mr=this.getNextId(),Hr=On(this,Cr,s1).call(this,{parent:this,id:Mr,x:wr.offsetX,y:wr.offsetY,uiManager:jr(this,vr),isCentered:kr});return Hr&&this.add(Hr),Hr},o1=function(){const{x:wr,y:kr,width:Mr,height:Hr}=this.div.getBoundingClientRect(),Gr=Math.max(0,wr),zr=Math.max(0,kr),Br=Math.min(window.innerWidth,wr+Mr),Vr=Math.min(window.innerHeight,kr+Hr),Rr=(Gr+Br)/2-wr,Xr=(zr+Vr)/2-kr,[an,yr]=this.viewport.rotation%180===0?[Rr,Xr]:[Xr,Rr];return{offsetX:an,offsetY:yr}},l1=function(){Gn(this,pr,!0);for(const wr of jr(this,dr).values())wr.isEmpty()&&wr.remove();Gn(this,pr,!1)},Xs(Pr,"_initialized",!1);let or=Pr;_e.AnnotationEditorLayer=or},(e,_e,er)=>{var sr,or,lr,ur,fr,cr,mr,dr,xr,pr,lm,cm,um,n0,c1,fm,u1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.FreeTextEditor=void 0;var tr=er(1),rr=er(5),nr=er(4),ir=er(29);const Pr=class Pr extends nr.AnnotationEditor{constructor(kr){super({...kr,name:"freeTextEditor"});Vn(this,pr);Vn(this,sr,this.editorDivBlur.bind(this));Vn(this,or,this.editorDivFocus.bind(this));Vn(this,lr,this.editorDivInput.bind(this));Vn(this,ur,this.editorDivKeydown.bind(this));Vn(this,fr);Vn(this,cr,"");Vn(this,mr,`${this.id}-editor`);Vn(this,dr);Vn(this,xr,null);Gn(this,fr,kr.color||Pr._defaultColor||nr.AnnotationEditor._defaultLineColor),Gn(this,dr,kr.fontSize||Pr._defaultFontSize)}static get _keyboardManager(){const kr=Pr.prototype,Mr=zr=>zr.isEmpty(),Hr=rr.AnnotationEditorUIManager.TRANSLATE_SMALL,Gr=rr.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,tr.shadow)(this,"_keyboardManager",new rr.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],kr.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],kr.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],kr._translateEmpty,{args:[-Hr,0],checker:Mr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],kr._translateEmpty,{args:[-Gr,0],checker:Mr}],[["ArrowRight","mac+ArrowRight"],kr._translateEmpty,{args:[Hr,0],checker:Mr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],kr._translateEmpty,{args:[Gr,0],checker:Mr}],[["ArrowUp","mac+ArrowUp"],kr._translateEmpty,{args:[0,-Hr],checker:Mr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],kr._translateEmpty,{args:[0,-Gr],checker:Mr}],[["ArrowDown","mac+ArrowDown"],kr._translateEmpty,{args:[0,Hr],checker:Mr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],kr._translateEmpty,{args:[0,Gr],checker:Mr}]]))}static initialize(kr){nr.AnnotationEditor.initialize(kr,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Mr=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Mr.getPropertyValue("--freetext-padding"))}static updateDefaultParams(kr,Mr){switch(kr){case tr.AnnotationEditorParamsType.FREETEXT_SIZE:Pr._defaultFontSize=Mr;break;case tr.AnnotationEditorParamsType.FREETEXT_COLOR:Pr._defaultColor=Mr;break}}updateParams(kr,Mr){switch(kr){case tr.AnnotationEditorParamsType.FREETEXT_SIZE:On(this,pr,lm).call(this,Mr);break;case tr.AnnotationEditorParamsType.FREETEXT_COLOR:On(this,pr,cm).call(this,Mr);break}}static get defaultPropertiesToUpdate(){return[[tr.AnnotationEditorParamsType.FREETEXT_SIZE,Pr._defaultFontSize],[tr.AnnotationEditorParamsType.FREETEXT_COLOR,Pr._defaultColor||nr.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[tr.AnnotationEditorParamsType.FREETEXT_SIZE,jr(this,dr)],[tr.AnnotationEditorParamsType.FREETEXT_COLOR,jr(this,fr)]]}_translateEmpty(kr,Mr){this._uiManager.translateSelectedEditors(kr,Mr,!0)}getInitialTranslation(){const kr=this.parentScale;return[-Pr._internalPadding*kr,-(Pr._internalPadding+jr(this,dr))*kr]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(tr.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",jr(this,ur)),this.editorDiv.addEventListener("focus",jr(this,or)),this.editorDiv.addEventListener("blur",jr(this,sr)),this.editorDiv.addEventListener("input",jr(this,lr)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",jr(this,mr)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",jr(this,ur)),this.editorDiv.removeEventListener("focus",jr(this,or)),this.editorDiv.removeEventListener("blur",jr(this,sr)),this.editorDiv.removeEventListener("input",jr(this,lr)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(kr){this._focusEventsAllowed&&(super.focusin(kr),kr.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var kr;if(this.width){On(this,pr,u1).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(kr=this._initialOptions)!=null&&kr.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const kr=jr(this,cr),Mr=Gn(this,cr,On(this,pr,um).call(this).trimEnd());if(kr===Mr)return;const Hr=Gr=>{if(Gn(this,cr,Gr),!Gr){this.remove();return}On(this,pr,c1).call(this),this._uiManager.rebuild(this),On(this,pr,n0).call(this)};this.addCommands({cmd:()=>{Hr(Mr)},undo:()=>{Hr(kr)},mustExec:!1}),On(this,pr,n0).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(kr){this.enterInEditMode()}keydown(kr){kr.target===this.div&&kr.key==="Enter"&&(this.enterInEditMode(),kr.preventDefault())}editorDivKeydown(kr){Pr._keyboardManager.exec(this,kr)}editorDivFocus(kr){this.isEditing=!0}editorDivBlur(kr){this.isEditing=!1}editorDivInput(kr){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let kr,Mr;this.width&&(kr=this.x,Mr=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",jr(this,mr)),this.enableEditing(),nr.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Gr=>{var zr;return(zr=this.editorDiv)==null?void 0:zr.setAttribute("aria-label",Gr)}),nr.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Gr=>{var zr;return(zr=this.editorDiv)==null?void 0:zr.setAttribute("default-content",Gr)}),this.editorDiv.contentEditable=!0;const{style:Hr}=this.editorDiv;if(Hr.fontSize=`calc(${jr(this,dr)}px * var(--scale-factor))`,Hr.color=jr(this,fr),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,rr.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Gr,zr]=this.parentDimensions;if(this.annotationElementId){const{position:Br}=jr(this,xr);let[Vr,Rr]=this.getInitialTranslation();[Vr,Rr]=this.pageTranslationToScreen(Vr,Rr);const[Xr,an]=this.pageDimensions,[yr,br]=this.pageTranslation;let Er,Lr;switch(this.rotation){case 0:Er=kr+(Br[0]-yr)/Xr,Lr=Mr+this.height-(Br[1]-br)/an;break;case 90:Er=kr+(Br[0]-yr)/Xr,Lr=Mr-(Br[1]-br)/an,[Vr,Rr]=[Rr,-Vr];break;case 180:Er=kr-this.width+(Br[0]-yr)/Xr,Lr=Mr-(Br[1]-br)/an,[Vr,Rr]=[-Vr,-Rr];break;case 270:Er=kr+(Br[0]-yr-this.height*an)/Xr,Lr=Mr+(Br[1]-br-this.width*Xr)/an,[Vr,Rr]=[-Rr,Vr];break}this.setAt(Er*Gr,Lr*zr,Vr,Rr)}else this.setAt(kr*Gr,Mr*zr,this.width*Gr,this.height*zr);On(this,pr,c1).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(kr,Mr,Hr){let Gr=null;if(kr instanceof ir.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Br,fontColor:Vr},rect:Rr,rotation:Xr,id:an},textContent:yr,textPosition:br,parent:{page:{pageNumber:Er}}}=kr;if(!yr||yr.length===0)return null;Gr=kr={annotationType:tr.AnnotationEditorType.FREETEXT,color:Array.from(Vr),fontSize:Br,value:yr.join(`
`),position:br,pageIndex:Er-1,rect:Rr,rotation:Xr,id:an,deleted:!1}}const zr=super.deserialize(kr,Mr,Hr);return Gn(zr,dr,kr.fontSize),Gn(zr,fr,tr.Util.makeHexColor(...kr.color)),Gn(zr,cr,kr.value),zr.annotationElementId=kr.id||null,Gn(zr,xr,Gr),zr}serialize(kr=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Mr=Pr._internalPadding*this.parentScale,Hr=this.getRect(Mr,Mr),Gr=nr.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:jr(this,fr)),zr={annotationType:tr.AnnotationEditorType.FREETEXT,color:Gr,fontSize:jr(this,dr),value:jr(this,cr),pageIndex:this.pageIndex,rect:Hr,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return kr?zr:this.annotationElementId&&!On(this,pr,fm).call(this,zr)?null:(zr.id=this.annotationElementId,zr)}};sr=new WeakMap,or=new WeakMap,lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakSet,lm=function(kr){const Mr=Gr=>{this.editorDiv.style.fontSize=`calc(${Gr}px * var(--scale-factor))`,this.translate(0,-(Gr-jr(this,dr))*this.parentScale),Gn(this,dr,Gr),On(this,pr,n0).call(this)},Hr=jr(this,dr);this.addCommands({cmd:()=>{Mr(kr)},undo:()=>{Mr(Hr)},mustExec:!0,type:tr.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},cm=function(kr){const Mr=jr(this,fr);this.addCommands({cmd:()=>{Gn(this,fr,this.editorDiv.style.color=kr)},undo:()=>{Gn(this,fr,this.editorDiv.style.color=Mr)},mustExec:!0,type:tr.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},um=function(){const kr=this.editorDiv.getElementsByTagName("div");if(kr.length===0)return this.editorDiv.innerText;const Mr=[];for(const Hr of kr)Mr.push(Hr.innerText.replace(/\r\n?|\n/,""));return Mr.join(`
`)},n0=function(){const[kr,Mr]=this.parentDimensions;let Hr;if(this.isAttachedToDOM)Hr=this.div.getBoundingClientRect();else{const{currentLayer:Gr,div:zr}=this,Br=zr.style.display;zr.style.display="hidden",Gr.div.append(this.div),Hr=zr.getBoundingClientRect(),zr.remove(),zr.style.display=Br}this.rotation%180===this.parentRotation%180?(this.width=Hr.width/kr,this.height=Hr.height/Mr):(this.width=Hr.height/kr,this.height=Hr.width/Mr),this.fixAndSetPosition()},c1=function(){if(this.editorDiv.replaceChildren(),!!jr(this,cr))for(const kr of jr(this,cr).split(`
`)){const Mr=document.createElement("div");Mr.append(kr?document.createTextNode(kr):document.createElement("br")),this.editorDiv.append(Mr)}},fm=function(kr){const{value:Mr,fontSize:Hr,color:Gr,rect:zr,pageIndex:Br}=jr(this,xr);return kr.value!==Mr||kr.fontSize!==Hr||kr.rect.some((Vr,Rr)=>Math.abs(Vr-zr[Rr])>=1)||kr.color.some((Vr,Rr)=>Vr!==Gr[Rr])||kr.pageIndex!==Br},u1=function(kr=!1){if(!this.annotationElementId)return;if(On(this,pr,n0).call(this),!kr&&(this.width===0||this.height===0)){setTimeout(()=>On(this,pr,u1).call(this,!0),0);return}const Mr=Pr._internalPadding*this.parentScale;jr(this,xr).rect=this.getRect(Mr,Mr)},Xs(Pr,"_freeTextDefaultContent",""),Xs(Pr,"_internalPadding",0),Xs(Pr,"_defaultColor",null),Xs(Pr,"_defaultFontSize",10),Xs(Pr,"_type","freetext");let ar=Pr;_e.FreeTextEditor=ar},(e,_e,er)=>{var Lr,Ur,Zl,hm,fn,_n,Kr,Cn,Dn,wn,Qr,xn,tn,on,vn,Sn,Ln,Wn,$n,En,ba,Qn,dm,_d,f1,h1,ws,ds,Ps,Zn,Mn,zn,cs,d1,As,yn,_i,rs,pm,p1;Object.defineProperty(_e,"__esModule",{value:!0}),_e.StampAnnotationElement=_e.InkAnnotationElement=_e.FreeTextAnnotationElement=_e.AnnotationLayer=void 0;var tr=er(1),rr=er(6),nr=er(3),ir=er(30),ar=er(31),sr=er(32);const or=1e3,lr=9,ur=new WeakSet;function fr(bs){return{width:bs[2]-bs[0],height:bs[3]-bs[1]}}class cr{static create(gn){switch(gn.data.annotationType){case tr.AnnotationType.LINK:return new dr(gn);case tr.AnnotationType.TEXT:return new xr(gn);case tr.AnnotationType.WIDGET:switch(gn.data.fieldType){case"Tx":return new gr(gn);case"Btn":return gn.data.radioButton?new Tr(gn):gn.data.checkBox?new Cr(gn):new Fr(gn);case"Ch":return new _r(gn);case"Sig":return new vr(gn)}return new pr(gn);case tr.AnnotationType.POPUP:return new Ar(gn);case tr.AnnotationType.FREETEXT:return new Ir(gn);case tr.AnnotationType.LINE:return new wr(gn);case tr.AnnotationType.SQUARE:return new kr(gn);case tr.AnnotationType.CIRCLE:return new Mr(gn);case tr.AnnotationType.POLYLINE:return new Hr(gn);case tr.AnnotationType.CARET:return new zr(gn);case tr.AnnotationType.INK:return new Br(gn);case tr.AnnotationType.POLYGON:return new Gr(gn);case tr.AnnotationType.HIGHLIGHT:return new Vr(gn);case tr.AnnotationType.UNDERLINE:return new Rr(gn);case tr.AnnotationType.SQUIGGLY:return new Xr(gn);case tr.AnnotationType.STRIKEOUT:return new an(gn);case tr.AnnotationType.STAMP:return new yr(gn);case tr.AnnotationType.FILEATTACHMENT:return new br(gn);default:return new mr(gn)}}}const Or=class Or{constructor(gn,{isRenderable:pn=!1,ignoreBorder:Pn=!1,createQuadrilaterals:Rn=!1}={}){Vn(this,Lr,!1);this.isRenderable=pn,this.data=gn.data,this.layer=gn.layer,this.linkService=gn.linkService,this.downloadManager=gn.downloadManager,this.imageResourcesPath=gn.imageResourcesPath,this.renderForms=gn.renderForms,this.svgFactory=gn.svgFactory,this.annotationStorage=gn.annotationStorage,this.enableScripting=gn.enableScripting,this.hasJSActions=gn.hasJSActions,this._fieldObjects=gn.fieldObjects,this.parent=gn.parent,pn&&(this.container=this._createContainer(Pn)),Rn&&this._createQuadrilaterals()}static _hasPopupData({titleObj:gn,contentsObj:pn,richText:Pn}){return!!(gn!=null&&gn.str||pn!=null&&pn.str||Pn!=null&&Pn.str)}get hasPopupData(){return Or._hasPopupData(this.data)}_createContainer(gn){const{data:pn,parent:{page:Pn,viewport:Rn}}=this,Yn=document.createElement("section");Yn.setAttribute("data-annotation-id",pn.id),this instanceof pr||(Yn.tabIndex=or),Yn.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Yn.setAttribute("aria-haspopup","dialog"),pn.noRotate&&Yn.classList.add("norotate");const{pageWidth:xa,pageHeight:$a,pageX:ys,pageY:xs}=Rn.rawDims;if(!pn.rect||this instanceof Ar){const{rotation:sn}=pn;return!pn.hasOwnCanvas&&sn!==0&&this.setRotation(sn,Yn),Yn}const{width:Jr,height:Yr}=fr(pn.rect),qr=tr.Util.normalizeRect([pn.rect[0],Pn.view[3]-pn.rect[1]+Pn.view[1],pn.rect[2],Pn.view[3]-pn.rect[3]+Pn.view[1]]);if(!gn&&pn.borderStyle.width>0){Yn.style.borderWidth=`${pn.borderStyle.width}px`;const sn=pn.borderStyle.horizontalCornerRadius,un=pn.borderStyle.verticalCornerRadius;if(sn>0||un>0){const In=`calc(${sn}px * var(--scale-factor)) / calc(${un}px * var(--scale-factor))`;Yn.style.borderRadius=In}else if(this instanceof Tr){const In=`calc(${Jr}px * var(--scale-factor)) / calc(${Yr}px * var(--scale-factor))`;Yn.style.borderRadius=In}switch(pn.borderStyle.style){case tr.AnnotationBorderStyleType.SOLID:Yn.style.borderStyle="solid";break;case tr.AnnotationBorderStyleType.DASHED:Yn.style.borderStyle="dashed";break;case tr.AnnotationBorderStyleType.BEVELED:(0,tr.warn)("Unimplemented border style: beveled");break;case tr.AnnotationBorderStyleType.INSET:(0,tr.warn)("Unimplemented border style: inset");break;case tr.AnnotationBorderStyleType.UNDERLINE:Yn.style.borderBottomStyle="solid";break}const Tn=pn.borderColor||null;Tn?(Gn(this,Lr,!0),Yn.style.borderColor=tr.Util.makeHexColor(Tn[0]|0,Tn[1]|0,Tn[2]|0)):Yn.style.borderWidth=0}Yn.style.left=`${100*(qr[0]-ys)/xa}%`,Yn.style.top=`${100*(qr[1]-xs)/$a}%`;const{rotation:en}=pn;return pn.hasOwnCanvas||en===0?(Yn.style.width=`${100*Jr/xa}%`,Yn.style.height=`${100*Yr/$a}%`):this.setRotation(en,Yn),Yn}setRotation(gn,pn=this.container){if(!this.data.rect)return;const{pageWidth:Pn,pageHeight:Rn}=this.parent.viewport.rawDims,{width:Yn,height:xa}=fr(this.data.rect);let $a,ys;gn%180===0?($a=100*Yn/Pn,ys=100*xa/Rn):($a=100*xa/Pn,ys=100*Yn/Rn),pn.style.width=`${$a}%`,pn.style.height=`${ys}%`,pn.setAttribute("data-main-rotation",(360-gn)%360)}get _commonActions(){const gn=(pn,Pn,Rn)=>{const Yn=Rn.detail[pn],xa=Yn[0],$a=Yn.slice(1);Rn.target.style[Pn]=ir.ColorConverters[`${xa}_HTML`]($a),this.annotationStorage.setValue(this.data.id,{[Pn]:ir.ColorConverters[`${xa}_rgb`]($a)})};return(0,tr.shadow)(this,"_commonActions",{display:pn=>{const{display:Pn}=pn.detail,Rn=Pn%2===1;this.container.style.visibility=Rn?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Rn,noPrint:Pn===1||Pn===2})},print:pn=>{this.annotationStorage.setValue(this.data.id,{noPrint:!pn.detail.print})},hidden:pn=>{const{hidden:Pn}=pn.detail;this.container.style.visibility=Pn?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Pn,noView:Pn})},focus:pn=>{setTimeout(()=>pn.target.focus({preventScroll:!1}),0)},userName:pn=>{pn.target.title=pn.detail.userName},readonly:pn=>{pn.target.disabled=pn.detail.readonly},required:pn=>{this._setRequired(pn.target,pn.detail.required)},bgColor:pn=>{gn("bgColor","backgroundColor",pn)},fillColor:pn=>{gn("fillColor","backgroundColor",pn)},fgColor:pn=>{gn("fgColor","color",pn)},textColor:pn=>{gn("textColor","color",pn)},borderColor:pn=>{gn("borderColor","borderColor",pn)},strokeColor:pn=>{gn("strokeColor","borderColor",pn)},rotation:pn=>{const Pn=pn.detail.rotation;this.setRotation(Pn),this.annotationStorage.setValue(this.data.id,{rotation:Pn})}})}_dispatchEventFromSandbox(gn,pn){const Pn=this._commonActions;for(const Rn of Object.keys(pn.detail)){const Yn=gn[Rn]||Pn[Rn];Yn==null||Yn(pn)}}_setDefaultPropertiesFromJS(gn){if(!this.enableScripting)return;const pn=this.annotationStorage.getRawValue(this.data.id);if(!pn)return;const Pn=this._commonActions;for(const[Rn,Yn]of Object.entries(pn)){const xa=Pn[Rn];if(xa){const $a={detail:{[Rn]:Yn},target:gn};xa($a),delete pn[Rn]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:gn}=this.data;if(!gn)return;const[pn,Pn,Rn,Yn]=this.data.rect;if(gn.length===1){const[,{x:un,y:Tn},{x:In,y:Fn}]=gn[0];if(Rn===un&&Yn===Tn&&pn===In&&Pn===Fn)return}const{style:xa}=this.container;let $a;if(jr(this,Lr)){const{borderColor:un,borderWidth:Tn}=xa;xa.borderWidth=0,$a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${un}" stroke-width="${Tn}">`],this.container.classList.add("hasBorder")}const ys=Rn-pn,xs=Yn-Pn,{svgFactory:Jr}=this,Yr=Jr.createElement("svg");Yr.classList.add("quadrilateralsContainer"),Yr.setAttribute("width",0),Yr.setAttribute("height",0);const qr=Jr.createElement("defs");Yr.append(qr);const en=Jr.createElement("clipPath"),sn=`clippath_${this.data.id}`;en.setAttribute("id",sn),en.setAttribute("clipPathUnits","objectBoundingBox"),qr.append(en);for(const[,{x:un,y:Tn},{x:In,y:Fn}]of gn){const kn=Jr.createElement("rect"),Nn=(In-pn)/ys,Kn=(Yn-Tn)/xs,is=(un-In)/ys,ps=(Tn-Fn)/xs;kn.setAttribute("x",Nn),kn.setAttribute("y",Kn),kn.setAttribute("width",is),kn.setAttribute("height",ps),en.append(kn),$a==null||$a.push(`<rect vector-effect="non-scaling-stroke" x="${Nn}" y="${Kn}" width="${is}" height="${ps}"/>`)}jr(this,Lr)&&($a.push("</g></svg>')"),xa.backgroundImage=$a.join("")),this.container.append(Yr),this.container.style.clipPath=`url(#${sn})`}_createPopup(){const{container:gn,data:pn}=this;gn.setAttribute("aria-haspopup","dialog");const Pn=new Ar({data:{color:pn.color,titleObj:pn.titleObj,modificationDate:pn.modificationDate,contentsObj:pn.contentsObj,richText:pn.richText,parentRect:pn.rect,borderStyle:0,id:`popup_${pn.id}`,rotation:pn.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Pn.render())}render(){(0,tr.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(gn,pn=null){const Pn=[];if(this._fieldObjects){const Rn=this._fieldObjects[gn];if(Rn)for(const{page:Yn,id:xa,exportValues:$a}of Rn){if(Yn===-1||xa===pn)continue;const ys=typeof $a=="string"?$a:null,xs=document.querySelector(`[data-element-id="${xa}"]`);if(xs&&!ur.has(xs)){(0,tr.warn)(`_getElementsByName - element not allowed: ${xa}`);continue}Pn.push({id:xa,exportValue:ys,domElement:xs})}return Pn}for(const Rn of document.getElementsByName(gn)){const{exportValue:Yn}=Rn,xa=Rn.getAttribute("data-element-id");xa!==pn&&ur.has(Rn)&&Pn.push({id:xa,exportValue:Yn,domElement:Rn})}return Pn}show(){var gn;this.container&&(this.container.hidden=!1),(gn=this.popup)==null||gn.maybeShow()}hide(){var gn;this.container&&(this.container.hidden=!0),(gn=this.popup)==null||gn.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const gn=this.getElementsToTriggerPopup();if(Array.isArray(gn))for(const pn of gn)pn.classList.add("highlightArea");else gn.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:gn,data:{id:pn}}=this;this.container.addEventListener("dblclick",()=>{var Pn;(Pn=this.linkService.eventBus)==null||Pn.dispatch("switchannotationeditormode",{source:this,mode:gn,editId:pn})})}};Lr=new WeakMap;let mr=Or;class dr extends mr{constructor(pn,Pn=null){super(pn,{isRenderable:!0,ignoreBorder:!!(Pn!=null&&Pn.ignoreBorder),createQuadrilaterals:!0});Vn(this,Ur);this.isTooltipOnly=pn.data.isTooltipOnly}render(){const{data:pn,linkService:Pn}=this,Rn=document.createElement("a");Rn.setAttribute("data-element-id",pn.id);let Yn=!1;return pn.url?(Pn.addLinkAttributes(Rn,pn.url,pn.newWindow),Yn=!0):pn.action?(this._bindNamedAction(Rn,pn.action),Yn=!0):pn.attachment?(this._bindAttachment(Rn,pn.attachment),Yn=!0):pn.setOCGState?(On(this,Ur,hm).call(this,Rn,pn.setOCGState),Yn=!0):pn.dest?(this._bindLink(Rn,pn.dest),Yn=!0):(pn.actions&&(pn.actions.Action||pn.actions["Mouse Up"]||pn.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Rn,pn),Yn=!0),pn.resetForm?(this._bindResetFormAction(Rn,pn.resetForm),Yn=!0):this.isTooltipOnly&&!Yn&&(this._bindLink(Rn,""),Yn=!0)),this.container.classList.add("linkAnnotation"),Yn&&this.container.append(Rn),this.container}_bindLink(pn,Pn){pn.href=this.linkService.getDestinationHash(Pn),pn.onclick=()=>(Pn&&this.linkService.goToDestination(Pn),!1),(Pn||Pn==="")&&On(this,Ur,Zl).call(this)}_bindNamedAction(pn,Pn){pn.href=this.linkService.getAnchorUrl(""),pn.onclick=()=>(this.linkService.executeNamedAction(Pn),!1),On(this,Ur,Zl).call(this)}_bindAttachment(pn,Pn){pn.href=this.linkService.getAnchorUrl(""),pn.onclick=()=>{var Rn;return(Rn=this.downloadManager)==null||Rn.openOrDownloadData(this.container,Pn.content,Pn.filename),!1},On(this,Ur,Zl).call(this)}_bindJSAction(pn,Pn){pn.href=this.linkService.getAnchorUrl("");const Rn=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Yn of Object.keys(Pn.actions)){const xa=Rn.get(Yn);xa&&(pn[xa]=()=>{var $a;return($a=this.linkService.eventBus)==null||$a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Pn.id,name:Yn}}),!1})}pn.onclick||(pn.onclick=()=>!1),On(this,Ur,Zl).call(this)}_bindResetFormAction(pn,Pn){const Rn=pn.onclick;if(Rn||(pn.href=this.linkService.getAnchorUrl("")),On(this,Ur,Zl).call(this),!this._fieldObjects){(0,tr.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Rn||(pn.onclick=()=>!1);return}pn.onclick=()=>{var Yr;Rn==null||Rn();const{fields:Yn,refs:xa,include:$a}=Pn,ys=[];if(Yn.length!==0||xa.length!==0){const qr=new Set(xa);for(const en of Yn){const sn=this._fieldObjects[en]||[];for(const{id:un}of sn)qr.add(un)}for(const en of Object.values(this._fieldObjects))for(const sn of en)qr.has(sn.id)===$a&&ys.push(sn)}else for(const qr of Object.values(this._fieldObjects))ys.push(...qr);const xs=this.annotationStorage,Jr=[];for(const qr of ys){const{id:en}=qr;switch(Jr.push(en),qr.type){case"text":{const un=qr.defaultValue||"";xs.setValue(en,{value:un});break}case"checkbox":case"radiobutton":{const un=qr.defaultValue===qr.exportValues;xs.setValue(en,{value:un});break}case"combobox":case"listbox":{const un=qr.defaultValue||"";xs.setValue(en,{value:un});break}default:continue}const sn=document.querySelector(`[data-element-id="${en}"]`);if(sn){if(!ur.has(sn)){(0,tr.warn)(`_bindResetFormAction - element not allowed: ${en}`);continue}}else continue;sn.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Yr=this.linkService.eventBus)==null||Yr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Jr,name:"ResetForm"}})),!1}}}Ur=new WeakSet,Zl=function(){this.container.setAttribute("data-internal-link","")},hm=function(pn,Pn){pn.href=this.linkService.getAnchorUrl(""),pn.onclick=()=>(this.linkService.executeSetOCGState(Pn),!1),On(this,Ur,Zl).call(this)};class xr extends mr{constructor(gn){super(gn,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const gn=document.createElement("img");return gn.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",gn.alt="[{{type}} Annotation]",gn.dataset.l10nId="text_annotation_type",gn.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(gn),this.container}}class pr extends mr{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(gn){var pn;this.data.hasOwnCanvas&&(((pn=gn.previousSibling)==null?void 0:pn.nodeName)==="CANVAS"&&(gn.previousSibling.hidden=!0),gn.hidden=!1)}_getKeyModifier(gn){const{isWin:pn,isMac:Pn}=tr.FeatureTest.platform;return pn&&gn.ctrlKey||Pn&&gn.metaKey}_setEventListener(gn,pn,Pn,Rn,Yn){Pn.includes("mouse")?gn.addEventListener(Pn,xa=>{var $a;($a=this.linkService.eventBus)==null||$a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Rn,value:Yn(xa),shift:xa.shiftKey,modifier:this._getKeyModifier(xa)}})}):gn.addEventListener(Pn,xa=>{var $a;if(Pn==="blur"){if(!pn.focused||!xa.relatedTarget)return;pn.focused=!1}else if(Pn==="focus"){if(pn.focused)return;pn.focused=!0}Yn&&(($a=this.linkService.eventBus)==null||$a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Rn,value:Yn(xa)}}))})}_setEventListeners(gn,pn,Pn,Rn){var Yn,xa,$a;for(const[ys,xs]of Pn)(xs==="Action"||(Yn=this.data.actions)!=null&&Yn[xs])&&((xs==="Focus"||xs==="Blur")&&(pn||(pn={focused:!1})),this._setEventListener(gn,pn,ys,xs,Rn),xs==="Focus"&&!((xa=this.data.actions)!=null&&xa.Blur)?this._setEventListener(gn,pn,"blur","Blur",null):xs==="Blur"&&!(($a=this.data.actions)!=null&&$a.Focus)&&this._setEventListener(gn,pn,"focus","Focus",null))}_setBackgroundColor(gn){const pn=this.data.backgroundColor||null;gn.style.backgroundColor=pn===null?"transparent":tr.Util.makeHexColor(pn[0],pn[1],pn[2])}_setTextStyle(gn){const pn=["left","center","right"],{fontColor:Pn}=this.data.defaultAppearanceData,Rn=this.data.defaultAppearanceData.fontSize||lr,Yn=gn.style;let xa;const $a=2,ys=xs=>Math.round(10*xs)/10;if(this.data.multiLine){const xs=Math.abs(this.data.rect[3]-this.data.rect[1]-$a),Jr=Math.round(xs/(tr.LINE_FACTOR*Rn))||1,Yr=xs/Jr;xa=Math.min(Rn,ys(Yr/tr.LINE_FACTOR))}else{const xs=Math.abs(this.data.rect[3]-this.data.rect[1]-$a);xa=Math.min(Rn,ys(xs/tr.LINE_FACTOR))}Yn.fontSize=`calc(${xa}px * var(--scale-factor))`,Yn.color=tr.Util.makeHexColor(Pn[0],Pn[1],Pn[2]),this.data.textAlignment!==null&&(Yn.textAlign=pn[this.data.textAlignment])}_setRequired(gn,pn){pn?gn.setAttribute("required",!0):gn.removeAttribute("required"),gn.setAttribute("aria-required",pn)}}class gr extends pr{constructor(gn){const pn=gn.renderForms||!gn.data.hasAppearance&&!!gn.data.fieldValue;super(gn,{isRenderable:pn})}setPropertyOnSiblings(gn,pn,Pn,Rn){const Yn=this.annotationStorage;for(const xa of this._getElementsByName(gn.name,gn.id))xa.domElement&&(xa.domElement[pn]=Pn),Yn.setValue(xa.id,{[Rn]:Pn})}render(){var Rn,Yn;const gn=this.annotationStorage,pn=this.data.id;this.container.classList.add("textWidgetAnnotation");let Pn=null;if(this.renderForms){const xa=gn.getValue(pn,{value:this.data.fieldValue});let $a=xa.value||"";const ys=gn.getValue(pn,{charLimit:this.data.maxLen}).charLimit;ys&&$a.length>ys&&($a=$a.slice(0,ys));let xs=xa.formattedValue||((Rn=this.data.textContent)==null?void 0:Rn.join(`
`))||null;xs&&this.data.comb&&(xs=xs.replaceAll(/\s+/g,""));const Jr={userValue:$a,formattedValue:xs,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Pn=document.createElement("textarea"),Pn.textContent=xs??$a,this.data.doNotScroll&&(Pn.style.overflowY="hidden")):(Pn=document.createElement("input"),Pn.type="text",Pn.setAttribute("value",xs??$a),this.data.doNotScroll&&(Pn.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Pn.hidden=!0),ur.add(Pn),Pn.setAttribute("data-element-id",pn),Pn.disabled=this.data.readOnly,Pn.name=this.data.fieldName,Pn.tabIndex=or,this._setRequired(Pn,this.data.required),ys&&(Pn.maxLength=ys),Pn.addEventListener("input",qr=>{gn.setValue(pn,{value:qr.target.value}),this.setPropertyOnSiblings(Pn,"value",qr.target.value,"value"),Jr.formattedValue=null}),Pn.addEventListener("resetform",qr=>{const en=this.data.defaultFieldValue??"";Pn.value=Jr.userValue=en,Jr.formattedValue=null});let Yr=qr=>{const{formattedValue:en}=Jr;en!=null&&(qr.target.value=en),qr.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Pn.addEventListener("focus",en=>{if(Jr.focused)return;const{target:sn}=en;Jr.userValue&&(sn.value=Jr.userValue),Jr.lastCommittedValue=sn.value,Jr.commitKey=1,Jr.focused=!0}),Pn.addEventListener("updatefromsandbox",en=>{this.showElementAndHideCanvas(en.target);const sn={value(un){Jr.userValue=un.detail.value??"",gn.setValue(pn,{value:Jr.userValue.toString()}),un.target.value=Jr.userValue},formattedValue(un){const{formattedValue:Tn}=un.detail;Jr.formattedValue=Tn,Tn!=null&&un.target!==document.activeElement&&(un.target.value=Tn),gn.setValue(pn,{formattedValue:Tn})},selRange(un){un.target.setSelectionRange(...un.detail.selRange)},charLimit:un=>{var kn;const{charLimit:Tn}=un.detail,{target:In}=un;if(Tn===0){In.removeAttribute("maxLength");return}In.setAttribute("maxLength",Tn);let Fn=Jr.userValue;!Fn||Fn.length<=Tn||(Fn=Fn.slice(0,Tn),In.value=Jr.userValue=Fn,gn.setValue(pn,{value:Fn}),(kn=this.linkService.eventBus)==null||kn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:pn,name:"Keystroke",value:Fn,willCommit:!0,commitKey:1,selStart:In.selectionStart,selEnd:In.selectionEnd}}))}};this._dispatchEventFromSandbox(sn,en)}),Pn.addEventListener("keydown",en=>{var Tn;Jr.commitKey=1;let sn=-1;if(en.key==="Escape"?sn=0:en.key==="Enter"&&!this.data.multiLine?sn=2:en.key==="Tab"&&(Jr.commitKey=3),sn===-1)return;const{value:un}=en.target;Jr.lastCommittedValue!==un&&(Jr.lastCommittedValue=un,Jr.userValue=un,(Tn=this.linkService.eventBus)==null||Tn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:pn,name:"Keystroke",value:un,willCommit:!0,commitKey:sn,selStart:en.target.selectionStart,selEnd:en.target.selectionEnd}}))});const qr=Yr;Yr=null,Pn.addEventListener("blur",en=>{var un;if(!Jr.focused||!en.relatedTarget)return;Jr.focused=!1;const{value:sn}=en.target;Jr.userValue=sn,Jr.lastCommittedValue!==sn&&((un=this.linkService.eventBus)==null||un.dispatch("dispatcheventinsandbox",{source:this,detail:{id:pn,name:"Keystroke",value:sn,willCommit:!0,commitKey:Jr.commitKey,selStart:en.target.selectionStart,selEnd:en.target.selectionEnd}})),qr(en)}),(Yn=this.data.actions)!=null&&Yn.Keystroke&&Pn.addEventListener("beforeinput",en=>{var Kn;Jr.lastCommittedValue=null;const{data:sn,target:un}=en,{value:Tn,selectionStart:In,selectionEnd:Fn}=un;let kn=In,Nn=Fn;switch(en.inputType){case"deleteWordBackward":{const is=Tn.substring(0,In).match(/\w*[^\w]*$/);is&&(kn-=is[0].length);break}case"deleteWordForward":{const is=Tn.substring(In).match(/^[^\w]*\w*/);is&&(Nn+=is[0].length);break}case"deleteContentBackward":In===Fn&&(kn-=1);break;case"deleteContentForward":In===Fn&&(Nn+=1);break}en.preventDefault(),(Kn=this.linkService.eventBus)==null||Kn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:pn,name:"Keystroke",value:Tn,change:sn||"",willCommit:!1,selStart:kn,selEnd:Nn}})}),this._setEventListeners(Pn,Jr,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],en=>en.target.value)}if(Yr&&Pn.addEventListener("blur",Yr),this.data.comb){const en=(this.data.rect[2]-this.data.rect[0])/ys;Pn.classList.add("comb"),Pn.style.letterSpacing=`calc(${en}px * var(--scale-factor) - 1ch)`}}else Pn=document.createElement("div"),Pn.textContent=this.data.fieldValue,Pn.style.verticalAlign="middle",Pn.style.display="table-cell";return this._setTextStyle(Pn),this._setBackgroundColor(Pn),this._setDefaultPropertiesFromJS(Pn),this.container.append(Pn),this.container}}class vr extends pr{constructor(gn){super(gn,{isRenderable:!!gn.data.hasOwnCanvas})}}class Cr extends pr{constructor(gn){super(gn,{isRenderable:gn.renderForms})}render(){const gn=this.annotationStorage,pn=this.data,Pn=pn.id;let Rn=gn.getValue(Pn,{value:pn.exportValue===pn.fieldValue}).value;typeof Rn=="string"&&(Rn=Rn!=="Off",gn.setValue(Pn,{value:Rn})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Yn=document.createElement("input");return ur.add(Yn),Yn.setAttribute("data-element-id",Pn),Yn.disabled=pn.readOnly,this._setRequired(Yn,this.data.required),Yn.type="checkbox",Yn.name=pn.fieldName,Rn&&Yn.setAttribute("checked",!0),Yn.setAttribute("exportValue",pn.exportValue),Yn.tabIndex=or,Yn.addEventListener("change",xa=>{const{name:$a,checked:ys}=xa.target;for(const xs of this._getElementsByName($a,Pn)){const Jr=ys&&xs.exportValue===pn.exportValue;xs.domElement&&(xs.domElement.checked=Jr),gn.setValue(xs.id,{value:Jr})}gn.setValue(Pn,{value:ys})}),Yn.addEventListener("resetform",xa=>{const $a=pn.defaultFieldValue||"Off";xa.target.checked=$a===pn.exportValue}),this.enableScripting&&this.hasJSActions&&(Yn.addEventListener("updatefromsandbox",xa=>{const $a={value(ys){ys.target.checked=ys.detail.value!=="Off",gn.setValue(Pn,{value:ys.target.checked})}};this._dispatchEventFromSandbox($a,xa)}),this._setEventListeners(Yn,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xa=>xa.target.checked)),this._setBackgroundColor(Yn),this._setDefaultPropertiesFromJS(Yn),this.container.append(Yn),this.container}}class Tr extends pr{constructor(gn){super(gn,{isRenderable:gn.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const gn=this.annotationStorage,pn=this.data,Pn=pn.id;let Rn=gn.getValue(Pn,{value:pn.fieldValue===pn.buttonValue}).value;typeof Rn=="string"&&(Rn=Rn!==pn.buttonValue,gn.setValue(Pn,{value:Rn}));const Yn=document.createElement("input");if(ur.add(Yn),Yn.setAttribute("data-element-id",Pn),Yn.disabled=pn.readOnly,this._setRequired(Yn,this.data.required),Yn.type="radio",Yn.name=pn.fieldName,Rn&&Yn.setAttribute("checked",!0),Yn.tabIndex=or,Yn.addEventListener("change",xa=>{const{name:$a,checked:ys}=xa.target;for(const xs of this._getElementsByName($a,Pn))gn.setValue(xs.id,{value:!1});gn.setValue(Pn,{value:ys})}),Yn.addEventListener("resetform",xa=>{const $a=pn.defaultFieldValue;xa.target.checked=$a!=null&&$a===pn.buttonValue}),this.enableScripting&&this.hasJSActions){const xa=pn.buttonValue;Yn.addEventListener("updatefromsandbox",$a=>{const ys={value:xs=>{const Jr=xa===xs.detail.value;for(const Yr of this._getElementsByName(xs.target.name)){const qr=Jr&&Yr.id===Pn;Yr.domElement&&(Yr.domElement.checked=qr),gn.setValue(Yr.id,{value:qr})}}};this._dispatchEventFromSandbox(ys,$a)}),this._setEventListeners(Yn,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$a=>$a.target.checked)}return this._setBackgroundColor(Yn),this._setDefaultPropertiesFromJS(Yn),this.container.append(Yn),this.container}}class Fr extends dr{constructor(gn){super(gn,{ignoreBorder:gn.data.hasAppearance})}render(){const gn=super.render();gn.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(gn.title=this.data.alternativeText);const pn=gn.lastChild;return this.enableScripting&&this.hasJSActions&&pn&&(this._setDefaultPropertiesFromJS(pn),pn.addEventListener("updatefromsandbox",Pn=>{this._dispatchEventFromSandbox({},Pn)})),gn}}class _r extends pr{constructor(gn){super(gn,{isRenderable:gn.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const gn=this.annotationStorage,pn=this.data.id,Pn=gn.getValue(pn,{value:this.data.fieldValue}),Rn=document.createElement("select");ur.add(Rn),Rn.setAttribute("data-element-id",pn),Rn.disabled=this.data.readOnly,this._setRequired(Rn,this.data.required),Rn.name=this.data.fieldName,Rn.tabIndex=or;let Yn=this.data.combo&&this.data.options.length>0;this.data.combo||(Rn.size=this.data.options.length,this.data.multiSelect&&(Rn.multiple=!0)),Rn.addEventListener("resetform",Jr=>{const Yr=this.data.defaultFieldValue;for(const qr of Rn.options)qr.selected=qr.value===Yr});for(const Jr of this.data.options){const Yr=document.createElement("option");Yr.textContent=Jr.displayValue,Yr.value=Jr.exportValue,Pn.value.includes(Jr.exportValue)&&(Yr.setAttribute("selected",!0),Yn=!1),Rn.append(Yr)}let xa=null;if(Yn){const Jr=document.createElement("option");Jr.value=" ",Jr.setAttribute("hidden",!0),Jr.setAttribute("selected",!0),Rn.prepend(Jr),xa=()=>{Jr.remove(),Rn.removeEventListener("input",xa),xa=null},Rn.addEventListener("input",xa)}const $a=Jr=>{const Yr=Jr?"value":"textContent",{options:qr,multiple:en}=Rn;return en?Array.prototype.filter.call(qr,sn=>sn.selected).map(sn=>sn[Yr]):qr.selectedIndex===-1?null:qr[qr.selectedIndex][Yr]};let ys=$a(!1);const xs=Jr=>{const Yr=Jr.target.options;return Array.prototype.map.call(Yr,qr=>({displayValue:qr.textContent,exportValue:qr.value}))};return this.enableScripting&&this.hasJSActions?(Rn.addEventListener("updatefromsandbox",Jr=>{const Yr={value(qr){xa==null||xa();const en=qr.detail.value,sn=new Set(Array.isArray(en)?en:[en]);for(const un of Rn.options)un.selected=sn.has(un.value);gn.setValue(pn,{value:$a(!0)}),ys=$a(!1)},multipleSelection(qr){Rn.multiple=!0},remove(qr){const en=Rn.options,sn=qr.detail.remove;en[sn].selected=!1,Rn.remove(sn),en.length>0&&Array.prototype.findIndex.call(en,Tn=>Tn.selected)===-1&&(en[0].selected=!0),gn.setValue(pn,{value:$a(!0),items:xs(qr)}),ys=$a(!1)},clear(qr){for(;Rn.length!==0;)Rn.remove(0);gn.setValue(pn,{value:null,items:[]}),ys=$a(!1)},insert(qr){const{index:en,displayValue:sn,exportValue:un}=qr.detail.insert,Tn=Rn.children[en],In=document.createElement("option");In.textContent=sn,In.value=un,Tn?Tn.before(In):Rn.append(In),gn.setValue(pn,{value:$a(!0),items:xs(qr)}),ys=$a(!1)},items(qr){const{items:en}=qr.detail;for(;Rn.length!==0;)Rn.remove(0);for(const sn of en){const{displayValue:un,exportValue:Tn}=sn,In=document.createElement("option");In.textContent=un,In.value=Tn,Rn.append(In)}Rn.options.length>0&&(Rn.options[0].selected=!0),gn.setValue(pn,{value:$a(!0),items:xs(qr)}),ys=$a(!1)},indices(qr){const en=new Set(qr.detail.indices);for(const sn of qr.target.options)sn.selected=en.has(sn.index);gn.setValue(pn,{value:$a(!0)}),ys=$a(!1)},editable(qr){qr.target.disabled=!qr.detail.editable}};this._dispatchEventFromSandbox(Yr,Jr)}),Rn.addEventListener("input",Jr=>{var qr;const Yr=$a(!0);gn.setValue(pn,{value:Yr}),Jr.preventDefault(),(qr=this.linkService.eventBus)==null||qr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:pn,name:"Keystroke",value:ys,changeEx:Yr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Rn,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Jr=>Jr.target.value)):Rn.addEventListener("input",function(Jr){gn.setValue(pn,{value:$a(!0)})}),this.data.combo&&this._setTextStyle(Rn),this._setBackgroundColor(Rn),this._setDefaultPropertiesFromJS(Rn),this.container.append(Rn),this.container}}class Ar extends mr{constructor(gn){const{data:pn,elements:Pn}=gn;super(gn,{isRenderable:mr._hasPopupData(pn)}),this.elements=Pn}render(){this.container.classList.add("popupAnnotation");const gn=new Pr({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),pn=[];for(const Pn of this.elements)Pn.popup=gn,pn.push(Pn.data.id),Pn.addHighlightArea();return this.container.setAttribute("aria-controls",pn.map(Pn=>`${tr.AnnotationPrefix}${Pn}`).join(",")),this.container}}class Pr{constructor({container:gn,color:pn,elements:Pn,titleObj:Rn,modificationDate:Yn,contentsObj:xa,richText:$a,parent:ys,rect:xs,parentRect:Jr,open:Yr}){Vn(this,Qn);Vn(this,fn,null);Vn(this,_n,On(this,Qn,dm).bind(this));Vn(this,Kr,On(this,Qn,h1).bind(this));Vn(this,Cn,On(this,Qn,f1).bind(this));Vn(this,Dn,On(this,Qn,_d).bind(this));Vn(this,wn,null);Vn(this,Qr,null);Vn(this,xn,null);Vn(this,tn,null);Vn(this,on,null);Vn(this,vn,null);Vn(this,Sn,!1);Vn(this,Ln,null);Vn(this,Wn,null);Vn(this,$n,null);Vn(this,En,null);Vn(this,ba,!1);var en;Gn(this,Qr,gn),Gn(this,En,Rn),Gn(this,xn,xa),Gn(this,$n,$a),Gn(this,on,ys),Gn(this,wn,pn),Gn(this,Wn,xs),Gn(this,vn,Jr),Gn(this,tn,Pn);const qr=rr.PDFDateString.toDateObject(Yn);qr&&Gn(this,fn,ys.l10n.get("annotation_date_string",{date:qr.toLocaleDateString(),time:qr.toLocaleTimeString()})),this.trigger=Pn.flatMap(sn=>sn.getElementsToTriggerPopup());for(const sn of this.trigger)sn.addEventListener("click",jr(this,Dn)),sn.addEventListener("mouseenter",jr(this,Cn)),sn.addEventListener("mouseleave",jr(this,Kr)),sn.classList.add("popupTriggerArea");for(const sn of Pn)(en=sn.container)==null||en.addEventListener("keydown",jr(this,_n));jr(this,Qr).hidden=!0,Yr&&On(this,Qn,_d).call(this)}render(){if(jr(this,Ln))return;const{page:{view:gn},viewport:{rawDims:{pageWidth:pn,pageHeight:Pn,pageX:Rn,pageY:Yn}}}=jr(this,on),xa=Gn(this,Ln,document.createElement("div"));if(xa.className="popup",jr(this,wn)){const kn=xa.style.outlineColor=tr.Util.makeHexColor(...jr(this,wn));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?xa.style.backgroundColor=`color-mix(in srgb, ${kn} 30%, white)`:xa.style.backgroundColor=tr.Util.makeHexColor(...jr(this,wn).map(Kn=>Math.floor(.7*(255-Kn)+Kn)))}const $a=document.createElement("span");$a.className="header";const ys=document.createElement("h1");if($a.append(ys),{dir:ys.dir,str:ys.textContent}=jr(this,En),xa.append($a),jr(this,fn)){const kn=document.createElement("span");kn.classList.add("popupDate"),jr(this,fn).then(Nn=>{kn.textContent=Nn}),$a.append(kn)}const xs=jr(this,xn),Jr=jr(this,$n);if(Jr!=null&&Jr.str&&(!(xs!=null&&xs.str)||xs.str===Jr.str))sr.XfaLayer.render({xfaHtml:Jr.html,intent:"richText",div:xa}),xa.lastChild.classList.add("richText","popupContent");else{const kn=this._formatContents(xs);xa.append(kn)}let Yr=!!jr(this,vn),qr=Yr?jr(this,vn):jr(this,Wn);for(const kn of jr(this,tn))if(!qr||tr.Util.intersect(kn.data.rect,qr)!==null){qr=kn.data.rect,Yr=!0;break}const en=tr.Util.normalizeRect([qr[0],gn[3]-qr[1]+gn[1],qr[2],gn[3]-qr[3]+gn[1]]),un=Yr?qr[2]-qr[0]+5:0,Tn=en[0]+un,In=en[1],{style:Fn}=jr(this,Qr);Fn.left=`${100*(Tn-Rn)/pn}%`,Fn.top=`${100*(In-Yn)/Pn}%`,jr(this,Qr).append(xa)}_formatContents({str:gn,dir:pn}){const Pn=document.createElement("p");Pn.classList.add("popupContent"),Pn.dir=pn;const Rn=gn.split(/(?:\r\n?|\n)/);for(let Yn=0,xa=Rn.length;Yn<xa;++Yn){const $a=Rn[Yn];Pn.append(document.createTextNode($a)),Yn<xa-1&&Pn.append(document.createElement("br"))}return Pn}forceHide(){Gn(this,ba,this.isVisible),jr(this,ba)&&(jr(this,Qr).hidden=!0)}maybeShow(){jr(this,ba)&&(Gn(this,ba,!1),jr(this,Qr).hidden=!1)}get isVisible(){return jr(this,Qr).hidden===!1}}fn=new WeakMap,_n=new WeakMap,Kr=new WeakMap,Cn=new WeakMap,Dn=new WeakMap,wn=new WeakMap,Qr=new WeakMap,xn=new WeakMap,tn=new WeakMap,on=new WeakMap,vn=new WeakMap,Sn=new WeakMap,Ln=new WeakMap,Wn=new WeakMap,$n=new WeakMap,En=new WeakMap,ba=new WeakMap,Qn=new WeakSet,dm=function(gn){gn.altKey||gn.shiftKey||gn.ctrlKey||gn.metaKey||(gn.key==="Enter"||gn.key==="Escape"&&jr(this,Sn))&&On(this,Qn,_d).call(this)},_d=function(){Gn(this,Sn,!jr(this,Sn)),jr(this,Sn)?(On(this,Qn,f1).call(this),jr(this,Qr).addEventListener("click",jr(this,Dn)),jr(this,Qr).addEventListener("keydown",jr(this,_n))):(On(this,Qn,h1).call(this),jr(this,Qr).removeEventListener("click",jr(this,Dn)),jr(this,Qr).removeEventListener("keydown",jr(this,_n)))},f1=function(){jr(this,Ln)||this.render(),this.isVisible?jr(this,Sn)&&jr(this,Qr).classList.add("focused"):(jr(this,Qr).hidden=!1,jr(this,Qr).style.zIndex=parseInt(jr(this,Qr).style.zIndex)+1e3)},h1=function(){jr(this,Qr).classList.remove("focused"),!(jr(this,Sn)||!this.isVisible)&&(jr(this,Qr).hidden=!0,jr(this,Qr).style.zIndex=parseInt(jr(this,Qr).style.zIndex)-1e3)};class Ir extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0}),this.textContent=gn.data.textContent,this.textPosition=gn.data.textPosition,this.annotationEditorType=tr.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const gn=document.createElement("div");gn.classList.add("annotationTextContent"),gn.setAttribute("role","comment");for(const pn of this.textContent){const Pn=document.createElement("span");Pn.textContent=pn,gn.append(Pn)}this.container.append(gn)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}_e.FreeTextAnnotationElement=Ir;class wr extends mr{constructor(pn){super(pn,{isRenderable:!0,ignoreBorder:!0});Vn(this,ws,null)}render(){this.container.classList.add("lineAnnotation");const pn=this.data,{width:Pn,height:Rn}=fr(pn.rect),Yn=this.svgFactory.create(Pn,Rn,!0),xa=Gn(this,ws,this.svgFactory.createElement("svg:line"));return xa.setAttribute("x1",pn.rect[2]-pn.lineCoordinates[0]),xa.setAttribute("y1",pn.rect[3]-pn.lineCoordinates[1]),xa.setAttribute("x2",pn.rect[2]-pn.lineCoordinates[2]),xa.setAttribute("y2",pn.rect[3]-pn.lineCoordinates[3]),xa.setAttribute("stroke-width",pn.borderStyle.width||1),xa.setAttribute("stroke","transparent"),xa.setAttribute("fill","transparent"),Yn.append(xa),this.container.append(Yn),!pn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return jr(this,ws)}addHighlightArea(){this.container.classList.add("highlightArea")}}ws=new WeakMap;class kr extends mr{constructor(pn){super(pn,{isRenderable:!0,ignoreBorder:!0});Vn(this,ds,null)}render(){this.container.classList.add("squareAnnotation");const pn=this.data,{width:Pn,height:Rn}=fr(pn.rect),Yn=this.svgFactory.create(Pn,Rn,!0),xa=pn.borderStyle.width,$a=Gn(this,ds,this.svgFactory.createElement("svg:rect"));return $a.setAttribute("x",xa/2),$a.setAttribute("y",xa/2),$a.setAttribute("width",Pn-xa),$a.setAttribute("height",Rn-xa),$a.setAttribute("stroke-width",xa||1),$a.setAttribute("stroke","transparent"),$a.setAttribute("fill","transparent"),Yn.append($a),this.container.append(Yn),!pn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return jr(this,ds)}addHighlightArea(){this.container.classList.add("highlightArea")}}ds=new WeakMap;class Mr extends mr{constructor(pn){super(pn,{isRenderable:!0,ignoreBorder:!0});Vn(this,Ps,null)}render(){this.container.classList.add("circleAnnotation");const pn=this.data,{width:Pn,height:Rn}=fr(pn.rect),Yn=this.svgFactory.create(Pn,Rn,!0),xa=pn.borderStyle.width,$a=Gn(this,Ps,this.svgFactory.createElement("svg:ellipse"));return $a.setAttribute("cx",Pn/2),$a.setAttribute("cy",Rn/2),$a.setAttribute("rx",Pn/2-xa/2),$a.setAttribute("ry",Rn/2-xa/2),$a.setAttribute("stroke-width",xa||1),$a.setAttribute("stroke","transparent"),$a.setAttribute("fill","transparent"),Yn.append($a),this.container.append(Yn),!pn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return jr(this,Ps)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ps=new WeakMap;class Hr extends mr{constructor(pn){super(pn,{isRenderable:!0,ignoreBorder:!0});Vn(this,Zn,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const pn=this.data,{width:Pn,height:Rn}=fr(pn.rect),Yn=this.svgFactory.create(Pn,Rn,!0);let xa=[];for(const ys of pn.vertices){const xs=ys.x-pn.rect[0],Jr=pn.rect[3]-ys.y;xa.push(xs+","+Jr)}xa=xa.join(" ");const $a=Gn(this,Zn,this.svgFactory.createElement(this.svgElementName));return $a.setAttribute("points",xa),$a.setAttribute("stroke-width",pn.borderStyle.width||1),$a.setAttribute("stroke","transparent"),$a.setAttribute("fill","transparent"),Yn.append($a),this.container.append(Yn),!pn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return jr(this,Zn)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zn=new WeakMap;class Gr extends Hr{constructor(gn){super(gn),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class zr extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Br extends mr{constructor(pn){super(pn,{isRenderable:!0,ignoreBorder:!0});Vn(this,Mn,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=tr.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const pn=this.data,{width:Pn,height:Rn}=fr(pn.rect),Yn=this.svgFactory.create(Pn,Rn,!0);for(const xa of pn.inkLists){let $a=[];for(const xs of xa){const Jr=xs.x-pn.rect[0],Yr=pn.rect[3]-xs.y;$a.push(`${Jr},${Yr}`)}$a=$a.join(" ");const ys=this.svgFactory.createElement(this.svgElementName);jr(this,Mn).push(ys),ys.setAttribute("points",$a),ys.setAttribute("stroke-width",pn.borderStyle.width||1),ys.setAttribute("stroke","transparent"),ys.setAttribute("fill","transparent"),!pn.popupRef&&this.hasPopupData&&this._createPopup(),Yn.append(ys)}return this.container.append(Yn),this.container}getElementsToTriggerPopup(){return jr(this,Mn)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mn=new WeakMap,_e.InkAnnotationElement=Br;class Vr extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Rr extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Xr extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class an extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class yr extends mr{constructor(gn){super(gn,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}_e.StampAnnotationElement=yr;class br extends mr{constructor(pn){var Yn;super(pn,{isRenderable:!0});Vn(this,cs);Vn(this,zn,null);const{filename:Pn,content:Rn}=this.data.file;this.filename=(0,rr.getFilenameFromUrl)(Pn,!0),this.content=Rn,(Yn=this.linkService.eventBus)==null||Yn.dispatch("fileattachmentannotation",{source:this,filename:Pn,content:Rn})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:pn,data:Pn}=this;let Rn;Pn.hasAppearance||Pn.fillAlpha===0?Rn=document.createElement("div"):(Rn=document.createElement("img"),Rn.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Pn.name)?"paperclip":"pushpin"}.svg`,Pn.fillAlpha&&Pn.fillAlpha<1&&(Rn.style=`filter: opacity(${Math.round(Pn.fillAlpha*100)}%);`)),Rn.addEventListener("dblclick",On(this,cs,d1).bind(this)),Gn(this,zn,Rn);const{isMac:Yn}=tr.FeatureTest.platform;return pn.addEventListener("keydown",xa=>{xa.key==="Enter"&&(Yn?xa.metaKey:xa.ctrlKey)&&On(this,cs,d1).call(this)}),!Pn.popupRef&&this.hasPopupData?this._createPopup():Rn.classList.add("popupTriggerArea"),pn.append(Rn),pn}getElementsToTriggerPopup(){return jr(this,zn)}addHighlightArea(){this.container.classList.add("highlightArea")}}zn=new WeakMap,cs=new WeakSet,d1=function(){var pn;(pn=this.downloadManager)==null||pn.openOrDownloadData(this.container,this.content,this.filename)};class Er{constructor({div:gn,accessibilityManager:pn,annotationCanvasMap:Pn,l10n:Rn,page:Yn,viewport:xa}){Vn(this,rs);Vn(this,As,null);Vn(this,yn,null);Vn(this,_i,new Map);this.div=gn,Gn(this,As,pn),Gn(this,yn,Pn),this.l10n=Rn,this.page=Yn,this.viewport=xa,this.zIndex=0,this.l10n||(this.l10n=ar.NullL10n)}async render(gn){const{annotations:pn}=gn,Pn=this.div;(0,rr.setLayerDimensions)(Pn,this.viewport);const Rn=new Map,Yn={data:null,layer:Pn,linkService:gn.linkService,downloadManager:gn.downloadManager,imageResourcesPath:gn.imageResourcesPath||"",renderForms:gn.renderForms!==!1,svgFactory:new rr.DOMSVGFactory,annotationStorage:gn.annotationStorage||new nr.AnnotationStorage,enableScripting:gn.enableScripting===!0,hasJSActions:gn.hasJSActions,fieldObjects:gn.fieldObjects,parent:this,elements:null};for(const xa of pn){if(xa.noHTML)continue;const $a=xa.annotationType===tr.AnnotationType.POPUP;if($a){const Jr=Rn.get(xa.id);if(!Jr)continue;Yn.elements=Jr}else{const{width:Jr,height:Yr}=fr(xa.rect);if(Jr<=0||Yr<=0)continue}Yn.data=xa;const ys=cr.create(Yn);if(!ys.isRenderable)continue;if(!$a&&xa.popupRef){const Jr=Rn.get(xa.popupRef);Jr?Jr.push(ys):Rn.set(xa.popupRef,[ys])}ys.annotationEditorType>0&&jr(this,_i).set(ys.data.id,ys);const xs=ys.render();xa.hidden&&(xs.style.visibility="hidden"),On(this,rs,pm).call(this,xs,xa.id)}On(this,rs,p1).call(this),await this.l10n.translate(Pn)}update({viewport:gn}){const pn=this.div;this.viewport=gn,(0,rr.setLayerDimensions)(pn,{rotation:gn.rotation}),On(this,rs,p1).call(this),pn.hidden=!1}getEditableAnnotations(){return Array.from(jr(this,_i).values())}getEditableAnnotation(gn){return jr(this,_i).get(gn)}}As=new WeakMap,yn=new WeakMap,_i=new WeakMap,rs=new WeakSet,pm=function(gn,pn){var Rn;const Pn=gn.firstChild||gn;Pn.id=`${tr.AnnotationPrefix}${pn}`,this.div.append(gn),(Rn=jr(this,As))==null||Rn.moveElementInDOM(this.div,gn,Pn,!1)},p1=function(){if(!jr(this,yn))return;const gn=this.div;for(const[pn,Pn]of jr(this,yn)){const Rn=gn.querySelector(`[data-annotation-id="${pn}"]`);if(!Rn)continue;const{firstChild:Yn}=Rn;Yn?Yn.nodeName==="CANVAS"?Yn.replaceWith(Pn):Yn.before(Pn):Rn.append(Pn)}jr(this,yn).clear()},_e.AnnotationLayer=Er},(e,_e)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.ColorConverters=void 0;function er(nr){return Math.floor(Math.max(0,Math.min(1,nr))*255).toString(16).padStart(2,"0")}function tr(nr){return Math.max(0,Math.min(255,255*nr))}class rr{static CMYK_G([ir,ar,sr,or]){return["G",1-Math.min(1,.3*ir+.59*sr+.11*ar+or)]}static G_CMYK([ir]){return["CMYK",0,0,0,1-ir]}static G_RGB([ir]){return["RGB",ir,ir,ir]}static G_rgb([ir]){return ir=tr(ir),[ir,ir,ir]}static G_HTML([ir]){const ar=er(ir);return`#${ar}${ar}${ar}`}static RGB_G([ir,ar,sr]){return["G",.3*ir+.59*ar+.11*sr]}static RGB_rgb(ir){return ir.map(tr)}static RGB_HTML(ir){return`#${ir.map(er).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([ir,ar,sr,or]){return["RGB",1-Math.min(1,ir+or),1-Math.min(1,sr+or),1-Math.min(1,ar+or)]}static CMYK_rgb([ir,ar,sr,or]){return[tr(1-Math.min(1,ir+or)),tr(1-Math.min(1,sr+or)),tr(1-Math.min(1,ar+or))]}static CMYK_HTML(ir){const ar=this.CMYK_RGB(ir).slice(1);return this.RGB_HTML(ar)}static RGB_CMYK([ir,ar,sr]){const or=1-ir,lr=1-ar,ur=1-sr,fr=Math.min(or,lr,ur);return["CMYK",or,lr,ur,fr]}}_e.ColorConverters=rr},(e,_e)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.NullL10n=void 0,_e.getL10nFallback=tr;const er={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};er.print_progress_percent="{{progress}}%";function tr(ir,ar){switch(ir){case"find_match_count":ir=`find_match_count[${ar.total===1?"one":"other"}]`;break;case"find_match_count_limit":ir=`find_match_count_limit[${ar.limit===1?"one":"other"}]`;break}return er[ir]||""}function rr(ir,ar){return ar?ir.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(sr,or)=>or in ar?ar[or]:"{{"+or+"}}"):ir}const nr={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(ir,ar=null,sr=tr(ir,ar)){return rr(sr,ar)},async translate(ir){}};_e.NullL10n=nr},(e,_e,er)=>{Object.defineProperty(_e,"__esModule",{value:!0}),_e.XfaLayer=void 0;var tr=er(25);class rr{static setupStorage(ir,ar,sr,or,lr){const ur=or.getValue(ar,{value:null});switch(sr.name){case"textarea":if(ur.value!==null&&(ir.textContent=ur.value),lr==="print")break;ir.addEventListener("input",fr=>{or.setValue(ar,{value:fr.target.value})});break;case"input":if(sr.attributes.type==="radio"||sr.attributes.type==="checkbox"){if(ur.value===sr.attributes.xfaOn?ir.setAttribute("checked",!0):ur.value===sr.attributes.xfaOff&&ir.removeAttribute("checked"),lr==="print")break;ir.addEventListener("change",fr=>{or.setValue(ar,{value:fr.target.checked?fr.target.getAttribute("xfaOn"):fr.target.getAttribute("xfaOff")})})}else{if(ur.value!==null&&ir.setAttribute("value",ur.value),lr==="print")break;ir.addEventListener("input",fr=>{or.setValue(ar,{value:fr.target.value})})}break;case"select":if(ur.value!==null){ir.setAttribute("value",ur.value);for(const fr of sr.children)fr.attributes.value===ur.value?fr.attributes.selected=!0:fr.attributes.hasOwnProperty("selected")&&delete fr.attributes.selected}ir.addEventListener("input",fr=>{const cr=fr.target.options,mr=cr.selectedIndex===-1?"":cr[cr.selectedIndex].value;or.setValue(ar,{value:mr})});break}}static setAttributes({html:ir,element:ar,storage:sr=null,intent:or,linkService:lr}){const{attributes:ur}=ar,fr=ir instanceof HTMLAnchorElement;ur.type==="radio"&&(ur.name=`${ur.name}-${or}`);for(const[cr,mr]of Object.entries(ur))if(mr!=null)switch(cr){case"class":mr.length&&ir.setAttribute(cr,mr.join(" "));break;case"dataId":break;case"id":ir.setAttribute("data-element-id",mr);break;case"style":Object.assign(ir.style,mr);break;case"textContent":ir.textContent=mr;break;default:(!fr||cr!=="href"&&cr!=="newWindow")&&ir.setAttribute(cr,mr)}fr&&lr.addLinkAttributes(ir,ur.href,ur.newWindow),sr&&ur.dataId&&this.setupStorage(ir,ur.dataId,ar,sr)}static render(ir){var dr;const ar=ir.annotationStorage,sr=ir.linkService,or=ir.xfaHtml,lr=ir.intent||"display",ur=document.createElement(or.name);or.attributes&&this.setAttributes({html:ur,element:or,intent:lr,linkService:sr});const fr=[[or,-1,ur]],cr=ir.div;if(cr.append(ur),ir.viewport){const xr=`matrix(${ir.viewport.transform.join(",")})`;cr.style.transform=xr}lr!=="richText"&&cr.setAttribute("class","xfaLayer xfaFont");const mr=[];for(;fr.length>0;){const[xr,pr,gr]=fr.at(-1);if(pr+1===xr.children.length){fr.pop();continue}const vr=xr.children[++fr.at(-1)[1]];if(vr===null)continue;const{name:Cr}=vr;if(Cr==="#text"){const Fr=document.createTextNode(vr.value);mr.push(Fr),gr.append(Fr);continue}const Tr=(dr=vr==null?void 0:vr.attributes)!=null&&dr.xmlns?document.createElementNS(vr.attributes.xmlns,Cr):document.createElement(Cr);if(gr.append(Tr),vr.attributes&&this.setAttributes({html:Tr,element:vr,storage:ar,intent:lr,linkService:sr}),vr.children&&vr.children.length>0)fr.push([vr,-1,Tr]);else if(vr.value){const Fr=document.createTextNode(vr.value);tr.XfaText.shouldBuildText(Cr)&&mr.push(Fr),Tr.append(Fr)}}for(const xr of cr.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))xr.setAttribute("readOnly",!0);return{textDivs:mr}}static update(ir){const ar=`matrix(${ir.viewport.transform.join(",")})`;ir.div.style.transform=ar,ir.div.hidden=!1}}_e.XfaLayer=rr},(e,_e,er)=>{var or,lr,ur,fr,cr,mr,dr,xr,pr,gr,vr,Cr,Tr,Fr,_r,mm,gm,xm,vm,m1,_m,g1,wm,ym,bm,Sm,Em,El,x1,ep,tp,Su,v1,rp,Ur,Am,_1,km,Tm,w1,np,Eu;Object.defineProperty(_e,"__esModule",{value:!0}),_e.InkEditor=void 0;var tr=er(1),rr=er(4),nr=er(29),ir=er(6),ar=er(5);const wn=class wn extends rr.AnnotationEditor{constructor(tn){super({...tn,name:"inkEditor"});Vn(this,_r);Vn(this,or,0);Vn(this,lr,0);Vn(this,ur,this.canvasPointermove.bind(this));Vn(this,fr,this.canvasPointerleave.bind(this));Vn(this,cr,this.canvasPointerup.bind(this));Vn(this,mr,this.canvasPointerdown.bind(this));Vn(this,dr,new Path2D);Vn(this,xr,!1);Vn(this,pr,!1);Vn(this,gr,!1);Vn(this,vr,null);Vn(this,Cr,0);Vn(this,Tr,0);Vn(this,Fr,null);this.color=tn.color||null,this.thickness=tn.thickness||null,this.opacity=tn.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(tn){rr.AnnotationEditor.initialize(tn,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(tn,on){switch(tn){case tr.AnnotationEditorParamsType.INK_THICKNESS:wn._defaultThickness=on;break;case tr.AnnotationEditorParamsType.INK_COLOR:wn._defaultColor=on;break;case tr.AnnotationEditorParamsType.INK_OPACITY:wn._defaultOpacity=on/100;break}}updateParams(tn,on){switch(tn){case tr.AnnotationEditorParamsType.INK_THICKNESS:On(this,_r,mm).call(this,on);break;case tr.AnnotationEditorParamsType.INK_COLOR:On(this,_r,gm).call(this,on);break;case tr.AnnotationEditorParamsType.INK_OPACITY:On(this,_r,xm).call(this,on);break}}static get defaultPropertiesToUpdate(){return[[tr.AnnotationEditorParamsType.INK_THICKNESS,wn._defaultThickness],[tr.AnnotationEditorParamsType.INK_COLOR,wn._defaultColor||rr.AnnotationEditor._defaultLineColor],[tr.AnnotationEditorParamsType.INK_OPACITY,Math.round(wn._defaultOpacity*100)]]}get propertiesToUpdate(){return[[tr.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wn._defaultThickness],[tr.AnnotationEditorParamsType.INK_COLOR,this.color||wn._defaultColor||rr.AnnotationEditor._defaultLineColor],[tr.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??wn._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(On(this,_r,ep).call(this),On(this,_r,tp).call(this)),this.isAttachedToDOM||(this.parent.add(this),On(this,_r,Su).call(this)),On(this,_r,Eu).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,jr(this,vr).disconnect(),Gn(this,vr,null),super.remove())}setParent(tn){!this.parent&&tn?this._uiManager.removeShouldRescale(this):this.parent&&tn===null&&this._uiManager.addShouldRescale(this),super.setParent(tn)}onScaleChanging(){const[tn,on]=this.parentDimensions,vn=this.width*tn,Sn=this.height*on;this.setDimensions(vn,Sn)}enableEditMode(){jr(this,xr)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",jr(this,mr)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",jr(this,mr)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){jr(this,xr)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Gn(this,xr,!0),this.div.classList.add("disabled"),On(this,_r,Eu).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(tn){this._focusEventsAllowed&&(super.focusin(tn),this.enableEditMode())}canvasPointerdown(tn){tn.button!==0||!this.isInEditMode()||jr(this,xr)||(this.setInForeground(),tn.preventDefault(),tn.type!=="mouse"&&this.div.focus(),On(this,_r,_m).call(this,tn.offsetX,tn.offsetY))}canvasPointermove(tn){tn.preventDefault(),On(this,_r,g1).call(this,tn.offsetX,tn.offsetY)}canvasPointerup(tn){tn.preventDefault(),On(this,_r,x1).call(this,tn)}canvasPointerleave(tn){On(this,_r,x1).call(this,tn)}get isResizable(){return!this.isEmpty()&&jr(this,xr)}render(){if(this.div)return this.div;let tn,on;this.width&&(tn=this.x,on=this.y),super.render(),rr.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then($n=>{var En;return(En=this.div)==null?void 0:En.setAttribute("aria-label",$n)});const[vn,Sn,Ln,Wn]=On(this,_r,vm).call(this);if(this.setAt(vn,Sn,0,0),this.setDims(Ln,Wn),On(this,_r,ep).call(this),this.width){const[$n,En]=this.parentDimensions;this.setAspectRatio(this.width*$n,this.height*En),this.setAt(tn*$n,on*En,this.width*$n,this.height*En),Gn(this,gr,!0),On(this,_r,Su).call(this),this.setDims(this.width*$n,this.height*En),On(this,_r,El).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return On(this,_r,tp).call(this),this.div}setDimensions(tn,on){const vn=Math.round(tn),Sn=Math.round(on);if(jr(this,Cr)===vn&&jr(this,Tr)===Sn)return;Gn(this,Cr,vn),Gn(this,Tr,Sn),this.canvas.style.visibility="hidden";const[Ln,Wn]=this.parentDimensions;this.width=tn/Ln,this.height=on/Wn,this.fixAndSetPosition(),jr(this,xr)&&On(this,_r,v1).call(this,tn,on),On(this,_r,Su).call(this),On(this,_r,El).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(tn,on,vn){var ws,ds,Ps;if(tn instanceof nr.InkAnnotationElement)return null;const Sn=super.deserialize(tn,on,vn);Sn.thickness=tn.thickness,Sn.color=tr.Util.makeHexColor(...tn.color),Sn.opacity=tn.opacity;const[Ln,Wn]=Sn.pageDimensions,$n=Sn.width*Ln,En=Sn.height*Wn,ba=Sn.parentScale,Qn=tn.thickness/2;Gn(Sn,xr,!0),Gn(Sn,Cr,Math.round($n)),Gn(Sn,Tr,Math.round(En));const{paths:vs,rect:es,rotation:ls}=tn;for(let{bezier:Zn}of vs){Zn=On(ws=wn,Ur,km).call(ws,Zn,es,ls);const Mn=[];Sn.paths.push(Mn);let zn=ba*(Zn[0]-Qn),cs=ba*(Zn[1]-Qn);for(let As=2,yn=Zn.length;As<yn;As+=6){const _i=ba*(Zn[As]-Qn),rs=ba*(Zn[As+1]-Qn),os=ba*(Zn[As+2]-Qn),ms=ba*(Zn[As+3]-Qn),bs=ba*(Zn[As+4]-Qn),gn=ba*(Zn[As+5]-Qn);Mn.push([[zn,cs],[_i,rs],[os,ms],[bs,gn]]),zn=bs,cs=gn}const Ls=On(this,Ur,Am).call(this,Mn);Sn.bezierPath2D.push(Ls)}const Xn=On(ds=Sn,_r,w1).call(ds);return Gn(Sn,lr,Math.max(rr.AnnotationEditor.MIN_SIZE,Xn[2]-Xn[0])),Gn(Sn,or,Math.max(rr.AnnotationEditor.MIN_SIZE,Xn[3]-Xn[1])),On(Ps=Sn,_r,v1).call(Ps,$n,En),Sn}serialize(){if(this.isEmpty())return null;const tn=this.getRect(0,0),on=rr.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:tr.AnnotationEditorType.INK,color:on,thickness:this.thickness,opacity:this.opacity,paths:On(this,_r,Tm).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,tn),pageIndex:this.pageIndex,rect:tn,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};or=new WeakMap,lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakMap,gr=new WeakMap,vr=new WeakMap,Cr=new WeakMap,Tr=new WeakMap,Fr=new WeakMap,_r=new WeakSet,mm=function(tn){const on=this.thickness;this.addCommands({cmd:()=>{this.thickness=tn,On(this,_r,Eu).call(this)},undo:()=>{this.thickness=on,On(this,_r,Eu).call(this)},mustExec:!0,type:tr.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},gm=function(tn){const on=this.color;this.addCommands({cmd:()=>{this.color=tn,On(this,_r,El).call(this)},undo:()=>{this.color=on,On(this,_r,El).call(this)},mustExec:!0,type:tr.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},xm=function(tn){tn/=100;const on=this.opacity;this.addCommands({cmd:()=>{this.opacity=tn,On(this,_r,El).call(this)},undo:()=>{this.opacity=on,On(this,_r,El).call(this)},mustExec:!0,type:tr.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},vm=function(){const{parentRotation:tn,parentDimensions:[on,vn]}=this;switch(tn){case 90:return[0,vn,vn,on];case 180:return[on,vn,on,vn];case 270:return[on,0,vn,on];default:return[0,0,on,vn]}},m1=function(){const{ctx:tn,color:on,opacity:vn,thickness:Sn,parentScale:Ln,scaleFactor:Wn}=this;tn.lineWidth=Sn*Ln/Wn,tn.lineCap="round",tn.lineJoin="round",tn.miterLimit=10,tn.strokeStyle=`${on}${(0,ar.opacityToHex)(vn)}`},_m=function(tn,on){this.canvas.addEventListener("contextmenu",ir.noContextMenu),this.canvas.addEventListener("pointerleave",jr(this,fr)),this.canvas.addEventListener("pointermove",jr(this,ur)),this.canvas.addEventListener("pointerup",jr(this,cr)),this.canvas.removeEventListener("pointerdown",jr(this,mr)),this.isEditing=!0,jr(this,gr)||(Gn(this,gr,!0),On(this,_r,Su).call(this),this.thickness||(this.thickness=wn._defaultThickness),this.color||(this.color=wn._defaultColor||rr.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=wn._defaultOpacity)),this.currentPath.push([tn,on]),Gn(this,pr,!1),On(this,_r,m1).call(this),Gn(this,Fr,()=>{On(this,_r,bm).call(this),jr(this,Fr)&&window.requestAnimationFrame(jr(this,Fr))}),window.requestAnimationFrame(jr(this,Fr))},g1=function(tn,on){const[vn,Sn]=this.currentPath.at(-1);if(this.currentPath.length>1&&tn===vn&&on===Sn)return;const Ln=this.currentPath;let Wn=jr(this,dr);if(Ln.push([tn,on]),Gn(this,pr,!0),Ln.length<=2){Wn.moveTo(...Ln[0]),Wn.lineTo(tn,on);return}Ln.length===3&&(Gn(this,dr,Wn=new Path2D),Wn.moveTo(...Ln[0])),On(this,_r,Sm).call(this,Wn,...Ln.at(-3),...Ln.at(-2),tn,on)},wm=function(){if(this.currentPath.length===0)return;const tn=this.currentPath.at(-1);jr(this,dr).lineTo(...tn)},ym=function(tn,on){Gn(this,Fr,null),tn=Math.min(Math.max(tn,0),this.canvas.width),on=Math.min(Math.max(on,0),this.canvas.height),On(this,_r,g1).call(this,tn,on),On(this,_r,wm).call(this);let vn;if(this.currentPath.length!==1)vn=On(this,_r,Em).call(this);else{const En=[tn,on];vn=[[En,En.slice(),En.slice(),En]]}const Sn=jr(this,dr),Ln=this.currentPath;this.currentPath=[],Gn(this,dr,new Path2D);const Wn=()=>{this.allRawPaths.push(Ln),this.paths.push(vn),this.bezierPath2D.push(Sn),this.rebuild()},$n=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(On(this,_r,ep).call(this),On(this,_r,tp).call(this)),On(this,_r,Eu).call(this))};this.addCommands({cmd:Wn,undo:$n,mustExec:!0})},bm=function(){if(!jr(this,pr))return;Gn(this,pr,!1);const tn=Math.ceil(this.thickness*this.parentScale),on=this.currentPath.slice(-3),vn=on.map(Wn=>Wn[0]),Sn=on.map(Wn=>Wn[1]);Math.min(...vn)-tn,Math.max(...vn)+tn,Math.min(...Sn)-tn,Math.max(...Sn)+tn;const{ctx:Ln}=this;Ln.save(),Ln.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Wn of this.bezierPath2D)Ln.stroke(Wn);Ln.stroke(jr(this,dr)),Ln.restore()},Sm=function(tn,on,vn,Sn,Ln,Wn,$n){const En=(on+Sn)/2,ba=(vn+Ln)/2,Qn=(Sn+Wn)/2,vs=(Ln+$n)/2;tn.bezierCurveTo(En+2*(Sn-En)/3,ba+2*(Ln-ba)/3,Qn+2*(Sn-Qn)/3,vs+2*(Ln-vs)/3,Qn,vs)},Em=function(){const tn=this.currentPath;if(tn.length<=2)return[[tn[0],tn[0],tn.at(-1),tn.at(-1)]];const on=[];let vn,[Sn,Ln]=tn[0];for(vn=1;vn<tn.length-2;vn++){const[es,ls]=tn[vn],[Xn,ws]=tn[vn+1],ds=(es+Xn)/2,Ps=(ls+ws)/2,Zn=[Sn+2*(es-Sn)/3,Ln+2*(ls-Ln)/3],Mn=[ds+2*(es-ds)/3,Ps+2*(ls-Ps)/3];on.push([[Sn,Ln],Zn,Mn,[ds,Ps]]),[Sn,Ln]=[ds,Ps]}const[Wn,$n]=tn[vn],[En,ba]=tn[vn+1],Qn=[Sn+2*(Wn-Sn)/3,Ln+2*($n-Ln)/3],vs=[En+2*(Wn-En)/3,ba+2*($n-ba)/3];return on.push([[Sn,Ln],Qn,vs,[En,ba]]),on},El=function(){if(this.isEmpty()){On(this,_r,rp).call(this);return}On(this,_r,m1).call(this);const{canvas:tn,ctx:on}=this;on.setTransform(1,0,0,1,0,0),on.clearRect(0,0,tn.width,tn.height),On(this,_r,rp).call(this);for(const vn of this.bezierPath2D)on.stroke(vn)},x1=function(tn){this.canvas.removeEventListener("pointerleave",jr(this,fr)),this.canvas.removeEventListener("pointermove",jr(this,ur)),this.canvas.removeEventListener("pointerup",jr(this,cr)),this.canvas.addEventListener("pointerdown",jr(this,mr)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",ir.noContextMenu)},10),On(this,_r,ym).call(this,tn.offsetX,tn.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ep=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",rr.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(tn=>{var on;return(on=this.canvas)==null?void 0:on.setAttribute("aria-label",tn)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},tp=function(){Gn(this,vr,new ResizeObserver(tn=>{const on=tn[0].contentRect;on.width&&on.height&&this.setDimensions(on.width,on.height)})),jr(this,vr).observe(this.div)},Su=function(){if(!jr(this,gr))return;const[tn,on]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*tn),this.canvas.height=Math.ceil(this.height*on),On(this,_r,rp).call(this)},v1=function(tn,on){const vn=On(this,_r,np).call(this),Sn=(tn-vn)/jr(this,lr),Ln=(on-vn)/jr(this,or);this.scaleFactor=Math.min(Sn,Ln)},rp=function(){const tn=On(this,_r,np).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+tn,this.translationY*this.scaleFactor+tn)},Ur=new WeakSet,Am=function(tn){const on=new Path2D;for(let vn=0,Sn=tn.length;vn<Sn;vn++){const[Ln,Wn,$n,En]=tn[vn];vn===0&&on.moveTo(...Ln),on.bezierCurveTo(Wn[0],Wn[1],$n[0],$n[1],En[0],En[1])}return on},_1=function(tn,on,vn){const[Sn,Ln,Wn,$n]=on;switch(vn){case 0:for(let En=0,ba=tn.length;En<ba;En+=2)tn[En]+=Sn,tn[En+1]=$n-tn[En+1];break;case 90:for(let En=0,ba=tn.length;En<ba;En+=2){const Qn=tn[En];tn[En]=tn[En+1]+Sn,tn[En+1]=Qn+Ln}break;case 180:for(let En=0,ba=tn.length;En<ba;En+=2)tn[En]=Wn-tn[En],tn[En+1]+=Ln;break;case 270:for(let En=0,ba=tn.length;En<ba;En+=2){const Qn=tn[En];tn[En]=Wn-tn[En+1],tn[En+1]=$n-Qn}break;default:throw new Error("Invalid rotation")}return tn},km=function(tn,on,vn){const[Sn,Ln,Wn,$n]=on;switch(vn){case 0:for(let En=0,ba=tn.length;En<ba;En+=2)tn[En]-=Sn,tn[En+1]=$n-tn[En+1];break;case 90:for(let En=0,ba=tn.length;En<ba;En+=2){const Qn=tn[En];tn[En]=tn[En+1]-Ln,tn[En+1]=Qn-Sn}break;case 180:for(let En=0,ba=tn.length;En<ba;En+=2)tn[En]=Wn-tn[En],tn[En+1]-=Ln;break;case 270:for(let En=0,ba=tn.length;En<ba;En+=2){const Qn=tn[En];tn[En]=$n-tn[En+1],tn[En+1]=Wn-Qn}break;default:throw new Error("Invalid rotation")}return tn},Tm=function(tn,on,vn,Sn){var ba,Qn;const Ln=[],Wn=this.thickness/2,$n=tn*on+Wn,En=tn*vn+Wn;for(const vs of this.paths){const es=[],ls=[];for(let Xn=0,ws=vs.length;Xn<ws;Xn++){const[ds,Ps,Zn,Mn]=vs[Xn],zn=tn*ds[0]+$n,cs=tn*ds[1]+En,Ls=tn*Ps[0]+$n,As=tn*Ps[1]+En,yn=tn*Zn[0]+$n,_i=tn*Zn[1]+En,rs=tn*Mn[0]+$n,os=tn*Mn[1]+En;Xn===0&&(es.push(zn,cs),ls.push(zn,cs)),es.push(Ls,As,yn,_i,rs,os),ls.push(Ls,As),Xn===ws-1&&ls.push(rs,os)}Ln.push({bezier:On(ba=wn,Ur,_1).call(ba,es,Sn,this.rotation),points:On(Qn=wn,Ur,_1).call(Qn,ls,Sn,this.rotation)})}return Ln},w1=function(){let tn=1/0,on=-1/0,vn=1/0,Sn=-1/0;for(const Ln of this.paths)for(const[Wn,$n,En,ba]of Ln){const Qn=tr.Util.bezierBoundingBox(...Wn,...$n,...En,...ba);tn=Math.min(tn,Qn[0]),vn=Math.min(vn,Qn[1]),on=Math.max(on,Qn[2]),Sn=Math.max(Sn,Qn[3])}return[tn,vn,on,Sn]},np=function(){return jr(this,xr)?Math.ceil(this.thickness*this.parentScale):0},Eu=function(tn=!1){if(this.isEmpty())return;if(!jr(this,xr)){On(this,_r,El).call(this);return}const on=On(this,_r,w1).call(this),vn=On(this,_r,np).call(this);Gn(this,lr,Math.max(rr.AnnotationEditor.MIN_SIZE,on[2]-on[0])),Gn(this,or,Math.max(rr.AnnotationEditor.MIN_SIZE,on[3]-on[1]));const Sn=Math.ceil(vn+jr(this,lr)*this.scaleFactor),Ln=Math.ceil(vn+jr(this,or)*this.scaleFactor),[Wn,$n]=this.parentDimensions;this.width=Sn/Wn,this.height=Ln/$n,this.setAspectRatio(Sn,Ln);const En=this.translationX,ba=this.translationY;this.translationX=-on[0],this.translationY=-on[1],On(this,_r,Su).call(this),On(this,_r,El).call(this),Gn(this,Cr,Sn),Gn(this,Tr,Ln),this.setDims(Sn,Ln);const Qn=tn?vn/this.scaleFactor/2:0;this.translate(En-this.translationX-Qn,ba-this.translationY-Qn)},Vn(wn,Ur),Xs(wn,"_defaultColor",null),Xs(wn,"_defaultOpacity",1),Xs(wn,"_defaultThickness",1),Xs(wn,"_type","ink");let sr=wn;_e.InkEditor=sr},(e,_e,er)=>{var sr,or,lr,ur,fr,cr,mr,dr,xr,pr,gr,i0,a0,ip,y1,Cm,Fm,b1,ap,Pm;Object.defineProperty(_e,"__esModule",{value:!0}),_e.StampEditor=void 0;var tr=er(1),rr=er(4),nr=er(6),ir=er(29);const kr=class kr extends rr.AnnotationEditor{constructor(Gr){super({...Gr,name:"stampEditor"});Vn(this,gr);Vn(this,sr,null);Vn(this,or,null);Vn(this,lr,null);Vn(this,ur,null);Vn(this,fr,null);Vn(this,cr,null);Vn(this,mr,null);Vn(this,dr,null);Vn(this,xr,!1);Vn(this,pr,!1);Gn(this,ur,Gr.bitmapUrl),Gn(this,fr,Gr.bitmapFile)}static initialize(Gr){rr.AnnotationEditor.initialize(Gr)}static get supportedTypes(){const Gr=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,tr.shadow)(this,"supportedTypes",Gr.map(zr=>`image/${zr}`))}static get supportedTypesStr(){return(0,tr.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Gr){return this.supportedTypes.includes(Gr)}static paste(Gr,zr){zr.pasteEditor(tr.AnnotationEditorType.STAMP,{bitmapFile:Gr.getAsFile()})}remove(){var Gr,zr;jr(this,or)&&(Gn(this,sr,null),this._uiManager.imageManager.deleteId(jr(this,or)),(Gr=jr(this,cr))==null||Gr.remove(),Gn(this,cr,null),(zr=jr(this,mr))==null||zr.disconnect(),Gn(this,mr,null)),super.remove()}rebuild(){if(!this.parent){jr(this,or)&&On(this,gr,ip).call(this);return}super.rebuild(),this.div!==null&&(jr(this,or)&&On(this,gr,ip).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(jr(this,lr)||jr(this,sr)||jr(this,ur)||jr(this,fr))}get isResizable(){return!0}render(){if(this.div)return this.div;let Gr,zr;if(this.width&&(Gr=this.x,zr=this.y),super.render(),this.div.hidden=!0,jr(this,sr)?On(this,gr,y1).call(this):On(this,gr,ip).call(this),this.width){const[Br,Vr]=this.parentDimensions;this.setAt(Gr*Br,zr*Vr,this.width*Br,this.height*Vr)}return this.div}static deserialize(Gr,zr,Br){if(Gr instanceof ir.StampAnnotationElement)return null;const Vr=super.deserialize(Gr,zr,Br),{rect:Rr,bitmapUrl:Xr,bitmapId:an,isSvg:yr,accessibilityData:br}=Gr;an&&Br.imageManager.isValidId(an)?Gn(Vr,or,an):Gn(Vr,ur,Xr),Gn(Vr,xr,yr);const[Er,Lr]=Vr.pageDimensions;return Vr.width=(Rr[2]-Rr[0])/Er,Vr.height=(Rr[3]-Rr[1])/Lr,br&&(Vr.altTextData=br),Vr}serialize(Gr=!1,zr=null){if(this.isEmpty())return null;const Br={annotationType:tr.AnnotationEditorType.STAMP,bitmapId:jr(this,or),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:jr(this,xr),structTreeParentId:this._structTreeParentId};if(Gr)return Br.bitmapUrl=On(this,gr,ap).call(this,!0),Br.accessibilityData=this.altTextData,Br;const{decorative:Vr,altText:Rr}=this.altTextData;if(!Vr&&Rr&&(Br.accessibilityData={type:"Figure",alt:Rr}),zr===null)return Br;zr.stamps||(zr.stamps=new Map);const Xr=jr(this,xr)?(Br.rect[2]-Br.rect[0])*(Br.rect[3]-Br.rect[1]):null;if(!zr.stamps.has(jr(this,or)))zr.stamps.set(jr(this,or),{area:Xr,serialized:Br}),Br.bitmap=On(this,gr,ap).call(this,!1);else if(jr(this,xr)){const an=zr.stamps.get(jr(this,or));Xr>an.area&&(an.area=Xr,an.serialized.bitmap.close(),an.serialized.bitmap=On(this,gr,ap).call(this,!1))}return Br}};sr=new WeakMap,or=new WeakMap,lr=new WeakMap,ur=new WeakMap,fr=new WeakMap,cr=new WeakMap,mr=new WeakMap,dr=new WeakMap,xr=new WeakMap,pr=new WeakMap,gr=new WeakSet,i0=function(Gr,zr=!1){if(!Gr){this.remove();return}Gn(this,sr,Gr.bitmap),zr||(Gn(this,or,Gr.id),Gn(this,xr,Gr.isSvg)),On(this,gr,y1).call(this)},a0=function(){Gn(this,lr,null),this._uiManager.enableWaiting(!1),jr(this,cr)&&this.div.focus()},ip=function(){if(jr(this,or)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(jr(this,or)).then(zr=>On(this,gr,i0).call(this,zr,!0)).finally(()=>On(this,gr,a0).call(this));return}if(jr(this,ur)){const zr=jr(this,ur);Gn(this,ur,null),this._uiManager.enableWaiting(!0),Gn(this,lr,this._uiManager.imageManager.getFromUrl(zr).then(Br=>On(this,gr,i0).call(this,Br)).finally(()=>On(this,gr,a0).call(this)));return}if(jr(this,fr)){const zr=jr(this,fr);Gn(this,fr,null),this._uiManager.enableWaiting(!0),Gn(this,lr,this._uiManager.imageManager.getFromFile(zr).then(Br=>On(this,gr,i0).call(this,Br)).finally(()=>On(this,gr,a0).call(this)));return}const Gr=document.createElement("input");Gr.type="file",Gr.accept=kr.supportedTypesStr,Gn(this,lr,new Promise(zr=>{Gr.addEventListener("change",async()=>{if(!Gr.files||Gr.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Br=await this._uiManager.imageManager.getFromFile(Gr.files[0]);On(this,gr,i0).call(this,Br)}zr()}),Gr.addEventListener("cancel",()=>{this.remove(),zr()})}).finally(()=>On(this,gr,a0).call(this))),Gr.click()},y1=function(){const{div:Gr}=this;let{width:zr,height:Br}=jr(this,sr);const[Vr,Rr]=this.pageDimensions,Xr=.75;if(this.width)zr=this.width*Vr,Br=this.height*Rr;else if(zr>Xr*Vr||Br>Xr*Rr){const Er=Math.min(Xr*Vr/zr,Xr*Rr/Br);zr*=Er,Br*=Er}const[an,yr]=this.parentDimensions;this.setDims(zr*an/Vr,Br*yr/Rr),this._uiManager.enableWaiting(!1);const br=Gn(this,cr,document.createElement("canvas"));Gr.append(br),Gr.hidden=!1,On(this,gr,b1).call(this,zr,Br),On(this,gr,Pm).call(this),jr(this,pr)||(this.parent.addUndoableEditor(this),Gn(this,pr,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Cm=function(Gr,zr){var Xr;const[Br,Vr]=this.parentDimensions;this.width=Gr/Br,this.height=zr/Vr,this.setDims(Gr,zr),(Xr=this._initialOptions)!=null&&Xr.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,jr(this,dr)!==null&&clearTimeout(jr(this,dr)),Gn(this,dr,setTimeout(()=>{Gn(this,dr,null),On(this,gr,b1).call(this,Gr,zr)},200))},Fm=function(Gr,zr){const{width:Br,height:Vr}=jr(this,sr);let Rr=Br,Xr=Vr,an=jr(this,sr);for(;Rr>2*Gr||Xr>2*zr;){const yr=Rr,br=Xr;Rr>2*Gr&&(Rr=Rr>=16384?Math.floor(Rr/2)-1:Math.ceil(Rr/2)),Xr>2*zr&&(Xr=Xr>=16384?Math.floor(Xr/2)-1:Math.ceil(Xr/2));const Er=new OffscreenCanvas(Rr,Xr);Er.getContext("2d").drawImage(an,0,0,yr,br,0,0,Rr,Xr),an=Er.transferToImageBitmap()}return an},b1=function(Gr,zr){Gr=Math.ceil(Gr),zr=Math.ceil(zr);const Br=jr(this,cr);if(!Br||Br.width===Gr&&Br.height===zr)return;Br.width=Gr,Br.height=zr;const Vr=jr(this,xr)?jr(this,sr):On(this,gr,Fm).call(this,Gr,zr),Rr=Br.getContext("2d");Rr.filter=this._uiManager.hcmFilter,Rr.drawImage(Vr,0,0,Vr.width,Vr.height,0,0,Gr,zr)},ap=function(Gr){if(Gr){if(jr(this,xr)){const Vr=this._uiManager.imageManager.getSvgUrl(jr(this,or));if(Vr)return Vr}const zr=document.createElement("canvas");return{width:zr.width,height:zr.height}=jr(this,sr),zr.getContext("2d").drawImage(jr(this,sr),0,0),zr.toDataURL()}if(jr(this,xr)){const[zr,Br]=this.pageDimensions,Vr=Math.round(this.width*zr*nr.PixelsPerInch.PDF_TO_CSS_UNITS),Rr=Math.round(this.height*Br*nr.PixelsPerInch.PDF_TO_CSS_UNITS),Xr=new OffscreenCanvas(Vr,Rr);return Xr.getContext("2d").drawImage(jr(this,sr),0,0,jr(this,sr).width,jr(this,sr).height,0,0,Vr,Rr),Xr.transferToImageBitmap()}return structuredClone(jr(this,sr))},Pm=function(){Gn(this,mr,new ResizeObserver(Gr=>{const zr=Gr[0].contentRect;zr.width&&zr.height&&On(this,gr,Cm).call(this,zr.width,zr.height)})),jr(this,mr).observe(this.div)},Xs(kr,"_type","stamp");let ar=kr;_e.StampEditor=ar}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var _e=__webpack_module_cache__[e];if(_e!==void 0)return _e.exports;var er=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](er,er.exports,__w_pdfjs_require__),er.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return _e.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return nr.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return _e.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return _e.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return ir.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return ar.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return _e.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return _e.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return tr.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return _e.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return sr.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return _e.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return _e.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return _e.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return _e.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return er.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return tr.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return er.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return _e.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return _e.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return tr.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return _e.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return tr.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return er.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return _e.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return _e.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return _e.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return or.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return er.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return _e.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return er.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return tr.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return tr.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return tr.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return tr.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return tr.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return tr.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return tr.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return _e.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return rr.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return tr.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return _e.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return rr.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return er.version}});var _e=__w_pdfjs_require__(1),er=__w_pdfjs_require__(2),tr=__w_pdfjs_require__(6),rr=__w_pdfjs_require__(26),nr=__w_pdfjs_require__(27),ir=__w_pdfjs_require__(5),ar=__w_pdfjs_require__(29),sr=__w_pdfjs_require__(14),or=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var _e=[],er=0,tr=e.length;er<tr;++er)_e[er]=e.charCodeAt(er);return _e}function utf16leread(e){for(var _e=[],er=0;er<e.length>>1;++er)_e[er]=String.fromCharCode(e.charCodeAt(2*er)+(e.charCodeAt(2*er+1)<<8));return _e.join("")}function utf16beread(e){for(var _e=[],er=0;er<e.length>>1;++er)_e[er]=String.fromCharCode(e.charCodeAt(2*er+1)+(e.charCodeAt(2*er)<<8));return _e.join("")}var debom=function(e){var _e=e.charCodeAt(0),er=e.charCodeAt(1);return _e==255&&er==254?utf16leread(e.slice(2)):_e==254&&er==255?utf16beread(e.slice(2)):_e==65279?e.slice(1):e},_getchar=function e(_e){return String.fromCharCode(_e)},_getansi=function e(_e){return String.fromCharCode(_e)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var _e="",er=0,tr=0,rr=0,nr=0,ir=0,ar=0,sr=0,or=0;or<e.length;)er=e.charCodeAt(or++),nr=er>>2,tr=e.charCodeAt(or++),ir=(er&3)<<4|tr>>4,rr=e.charCodeAt(or++),ar=(tr&15)<<2|rr>>6,sr=rr&63,isNaN(tr)?ar=sr=64:isNaN(rr)&&(sr=64),_e+=Base64_map.charAt(nr)+Base64_map.charAt(ir)+Base64_map.charAt(ar)+Base64_map.charAt(sr);return _e}function Base64_decode(e){var _e="",er=0,tr=0,rr=0,nr=0,ir=0,ar=0,sr=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var or=0;or<e.length;)nr=Base64_map.indexOf(e.charAt(or++)),ir=Base64_map.indexOf(e.charAt(or++)),er=nr<<2|ir>>4,_e+=String.fromCharCode(er),ar=Base64_map.indexOf(e.charAt(or++)),tr=(ir&15)<<4|ar>>2,ar!==64&&(_e+=String.fromCharCode(tr)),sr=Base64_map.indexOf(e.charAt(or++)),rr=(ar&3)<<6|sr,sr!==64&&(_e+=String.fromCharCode(rr));return _e}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(_e,er){return er?new Buffer(_e,er):new Buffer(_e)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function e(_e){return has_buf?Buffer_from(_e,"binary"):_e.split("").map(function(er){return er.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var _e=new ArrayBuffer(e.length),er=new Uint8Array(_e),tr=0;tr!=e.length;++tr)er[tr]=e.charCodeAt(tr)&255;return _e}function a2s(e){if(Array.isArray(e))return e.map(function(tr){return String.fromCharCode(tr)}).join("");for(var _e=[],er=0;er<e.length;++er)_e[er]=String.fromCharCode(e[er]);return _e.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var _e=new Array(e.length),er=0;er<e.length;++er)_e[er]=e[er];return _e}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(_e){return Buffer.isBuffer(_e)?_e:Buffer_from(_e)}))}:function(e){if(typeof Uint8Array<"u"){var _e=0,er=0;for(_e=0;_e<e.length;++_e)er+=e[_e].length;var tr=new Uint8Array(er),rr=0;for(_e=0,er=0;_e<e.length;er+=rr,++_e)if(rr=e[_e].length,e[_e]instanceof Uint8Array)tr.set(e[_e],er);else{if(typeof e[_e]=="string")throw"wtf";tr.set(new Uint8Array(e[_e]),er)}return tr}return[].concat.apply([],e.map(function(nr){return Array.isArray(nr)?nr:[].slice.call(nr)}))};function utf8decode(e){for(var _e=[],er=0,tr=e.length+250,rr=new_raw_buf(e.length+255),nr=0;nr<e.length;++nr){var ir=e.charCodeAt(nr);if(ir<128)rr[er++]=ir;else if(ir<2048)rr[er++]=192|ir>>6&31,rr[er++]=128|ir&63;else if(ir>=55296&&ir<57344){ir=(ir&1023)+64;var ar=e.charCodeAt(++nr)&1023;rr[er++]=240|ir>>8&7,rr[er++]=128|ir>>2&63,rr[er++]=128|ar>>6&15|(ir&3)<<4,rr[er++]=128|ar&63}else rr[er++]=224|ir>>12&15,rr[er++]=128|ir>>6&63,rr[er++]=128|ir&63;er>tr&&(_e.push(rr.slice(0,er)),er=0,rr=new_raw_buf(65535),tr=65530)}return _e.push(rr.slice(0,er)),bconcat(_e)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var _e="",er=e.length-1;er>=0;)_e+=e.charAt(er--);return _e}function pad0(e,_e){var er=""+e;return er.length>=_e?er:fill("0",_e-er.length)+er}function pad_(e,_e){var er=""+e;return er.length>=_e?er:fill(" ",_e-er.length)+er}function rpad_(e,_e){var er=""+e;return er.length>=_e?er:er+fill(" ",_e-er.length)}function pad0r1(e,_e){var er=""+Math.round(e);return er.length>=_e?er:fill("0",_e-er.length)+er}function pad0r2(e,_e){var er=""+e;return er.length>=_e?er:fill("0",_e-er.length)+er}var p2_32=Math.pow(2,32);function pad0r(e,_e){if(e>p2_32||e<-p2_32)return pad0r1(e,_e);var er=Math.round(e);return pad0r2(er,_e)}function SSF_isgeneral(e,_e){return _e=_e||0,e.length>=7+_e&&(e.charCodeAt(_e)|32)===103&&(e.charCodeAt(_e+1)|32)===101&&(e.charCodeAt(_e+2)|32)===110&&(e.charCodeAt(_e+3)|32)===101&&(e.charCodeAt(_e+4)|32)===114&&(e.charCodeAt(_e+5)|32)===97&&(e.charCodeAt(_e+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,_e,er){for(var tr=e<0?-1:1,rr=e*tr,nr=0,ir=1,ar=0,sr=1,or=0,lr=0,ur=Math.floor(rr);or<_e&&(ur=Math.floor(rr),ar=ur*ir+nr,lr=ur*or+sr,!(rr-ur<5e-8));)rr=1/(rr-ur),nr=ir,ir=ar,sr=or,or=lr;if(lr>_e&&(or>_e?(lr=sr,ar=nr):(lr=or,ar=ir)),!er)return[0,tr*ar,lr];var fr=Math.floor(tr*ar/lr);return[fr,tr*ar-fr*lr,lr]}function SSF_parse_date_code(e,_e,er){if(e>2958465||e<0)return null;var tr=e|0,rr=Math.floor(86400*(e-tr)),nr=0,ir=[],ar={D:tr,T:rr,u:86400*(e-tr)-rr,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(ar.u)<1e-6&&(ar.u=0),_e&&_e.date1904&&(tr+=1462),ar.u>.9999&&(ar.u=0,++rr==86400&&(ar.T=rr=0,++tr,++ar.D)),tr===60)ir=er?[1317,10,29]:[1900,2,29],nr=3;else if(tr===0)ir=er?[1317,8,29]:[1900,1,0],nr=6;else{tr>60&&--tr;var sr=new Date(1900,0,1);sr.setDate(sr.getDate()+tr-1),ir=[sr.getFullYear(),sr.getMonth()+1,sr.getDate()],nr=sr.getDay(),tr<60&&(nr=(nr+6)%7),er&&(nr=SSF_fix_hijri(sr,ir))}return ar.y=ir[0],ar.m=ir[1],ar.d=ir[2],ar.S=rr%60,rr=Math.floor(rr/60),ar.M=rr%60,rr=Math.floor(rr/60),ar.H=rr,ar.q=nr,ar}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,_e){var er=e.getTime();return _e?er-=1461*24*60*60*1e3:e>=SSFbase1904&&(er+=24*60*60*1e3),(er-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var _e=e<0?12:11,er=SSF_strip_decimal(e.toFixed(12));return er.length<=_e||(er=e.toPrecision(10),er.length<=_e)?er:e.toExponential(5)}function SSF_large_exp(e){var _e=SSF_strip_decimal(e.toFixed(11));return _e.length>(e<0?12:11)||_e==="0"||_e==="-0"?e.toPrecision(6):_e}function SSF_general_num(e){var _e=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),er;return _e>=-4&&_e<=-1?er=e.toPrecision(10+_e):Math.abs(_e)<=9?er=SSF_small_exp(e):_e===10?er=e.toFixed(10).substr(0,12):er=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(er.toUpperCase()))}function SSF_general(e,_e){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,_e&&_e.date1904),_e)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,_e){_e[0]-=581;var er=e.getDay();return e<60&&(er=(er+6)%7),er}function SSF_write_date(e,_e,er,tr){var rr="",nr=0,ir=0,ar=er.y,sr,or=0;switch(e){case 98:ar=er.y+543;case 121:switch(_e.length){case 1:case 2:sr=ar%100,or=2;break;default:sr=ar%1e4,or=4;break}break;case 109:switch(_e.length){case 1:case 2:sr=er.m,or=_e.length;break;case 3:return months[er.m-1][1];case 5:return months[er.m-1][0];default:return months[er.m-1][2]}break;case 100:switch(_e.length){case 1:case 2:sr=er.d,or=_e.length;break;case 3:return days[er.q][0];default:return days[er.q][1]}break;case 104:switch(_e.length){case 1:case 2:sr=1+(er.H+11)%12,or=_e.length;break;default:throw"bad hour format: "+_e}break;case 72:switch(_e.length){case 1:case 2:sr=er.H,or=_e.length;break;default:throw"bad hour format: "+_e}break;case 77:switch(_e.length){case 1:case 2:sr=er.M,or=_e.length;break;default:throw"bad minute format: "+_e}break;case 115:if(_e!="s"&&_e!="ss"&&_e!=".0"&&_e!=".00"&&_e!=".000")throw"bad second format: "+_e;return er.u===0&&(_e=="s"||_e=="ss")?pad0(er.S,_e.length):(tr>=2?ir=tr===3?1e3:100:ir=tr===1?10:1,nr=Math.round(ir*(er.S+er.u)),nr>=60*ir&&(nr=0),_e==="s"?nr===0?"0":""+nr/ir:(rr=pad0(nr,2+tr),_e==="ss"?rr.substr(0,2):"."+rr.substr(2,_e.length-1)));case 90:switch(_e){case"[h]":case"[hh]":sr=er.D*24+er.H;break;case"[m]":case"[mm]":sr=(er.D*24+er.H)*60+er.M;break;case"[s]":case"[ss]":sr=((er.D*24+er.H)*60+er.M)*60+Math.round(er.S+er.u);break;default:throw"bad abstime format: "+_e}or=_e.length===3?1:2;break;case 101:sr=ar,or=1;break}var lr=or>0?pad0(sr,or):"";return lr}function commaify(e){var _e=3;if(e.length<=_e)return e;for(var er=e.length%_e,tr=e.substr(0,er);er!=e.length;er+=_e)tr+=(tr.length>0?",":"")+e.substr(er,_e);return tr}var pct1=/%/g;function write_num_pct(e,_e,er){var tr=_e.replace(pct1,""),rr=_e.length-tr.length;return write_num(e,tr,er*Math.pow(10,2*rr))+fill("%",rr)}function write_num_cm(e,_e,er){for(var tr=_e.length-1;_e.charCodeAt(tr-1)===44;)--tr;return write_num(e,_e.substr(0,tr),er/Math.pow(10,3*(_e.length-tr)))}function write_num_exp(e,_e){var er,tr=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(_e==0)return"0.0E+0";if(_e<0)return"-"+write_num_exp(e,-_e);var rr=e.indexOf(".");rr===-1&&(rr=e.indexOf("E"));var nr=Math.floor(Math.log(_e)*Math.LOG10E)%rr;if(nr<0&&(nr+=rr),er=(_e/Math.pow(10,nr)).toPrecision(tr+1+(rr+nr)%rr),er.indexOf("e")===-1){var ir=Math.floor(Math.log(_e)*Math.LOG10E);for(er.indexOf(".")===-1?er=er.charAt(0)+"."+er.substr(1)+"E+"+(ir-er.length+nr):er+="E+"+(ir-nr);er.substr(0,2)==="0.";)er=er.charAt(0)+er.substr(2,rr)+"."+er.substr(2+rr),er=er.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");er=er.replace(/\+-/,"-")}er=er.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(ar,sr,or,lr){return sr+or+lr.substr(0,(rr+nr)%rr)+"."+lr.substr(nr)+"E"})}else er=_e.toExponential(tr);return e.match(/E\+00$/)&&er.match(/e[+-]\d$/)&&(er=er.substr(0,er.length-1)+"0"+er.charAt(er.length-1)),e.match(/E\-/)&&er.match(/e\+/)&&(er=er.replace(/e\+/,"e")),er.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,_e,er){var tr=parseInt(e[4],10),rr=Math.round(_e*tr),nr=Math.floor(rr/tr),ir=rr-nr*tr,ar=tr;return er+(nr===0?"":""+nr)+" "+(ir===0?fill(" ",e[1].length+1+e[4].length):pad_(ir,e[1].length)+e[2]+"/"+e[3]+pad0(ar,e[4].length))}function write_num_f2(e,_e,er){return er+(_e===0?"":""+_e)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var _e="",er,tr=0;tr!=e.length;++tr)switch(er=e.charCodeAt(tr)){case 35:break;case 63:_e+=" ";break;case 48:_e+="0";break;default:_e+=String.fromCharCode(er)}return _e}function rnd(e,_e){var er=Math.pow(10,_e);return""+Math.round(e*er)/er}function dec(e,_e){var er=e-Math.floor(e),tr=Math.pow(10,_e);return _e<(""+Math.round(er*tr)).length?0:Math.round(er*tr)}function carry(e,_e){return _e<(""+Math.round((e-Math.floor(e))*Math.pow(10,_e))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,_e,er){if(e.charCodeAt(0)===40&&!_e.match(closeparen)){var tr=_e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return er>=0?write_num_flt("n",tr,er):"("+write_num_flt("n",tr,-er)+")"}if(_e.charCodeAt(_e.length-1)===44)return write_num_cm(e,_e,er);if(_e.indexOf("%")!==-1)return write_num_pct(e,_e,er);if(_e.indexOf("E")!==-1)return write_num_exp(_e,er);if(_e.charCodeAt(0)===36)return"$"+write_num_flt(e,_e.substr(_e.charAt(1)==" "?2:1),er);var rr,nr,ir,ar,sr=Math.abs(er),or=er<0?"-":"";if(_e.match(/^00+$/))return or+pad0r(sr,_e.length);if(_e.match(/^[#?]+$/))return rr=pad0r(er,0),rr==="0"&&(rr=""),rr.length>_e.length?rr:hashq(_e.substr(0,_e.length-rr.length))+rr;if(nr=_e.match(frac1))return write_num_f1(nr,sr,or);if(_e.match(/^#+0+$/))return or+pad0r(sr,_e.length-_e.indexOf("0"));if(nr=_e.match(dec1))return rr=rnd(er,nr[1].length).replace(/^([^\.]+)$/,"$1."+hashq(nr[1])).replace(/\.$/,"."+hashq(nr[1])).replace(/\.(\d*)$/,function(mr,dr){return"."+dr+fill("0",hashq(nr[1]).length-dr.length)}),_e.indexOf("0.")!==-1?rr:rr.replace(/^0\./,".");if(_e=_e.replace(/^#+([0.])/,"$1"),nr=_e.match(/^(0*)\.(#*)$/))return or+rnd(sr,nr[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,nr[1].length?"0.":".");if(nr=_e.match(/^#{1,3},##0(\.?)$/))return or+commaify(pad0r(sr,0));if(nr=_e.match(/^#,##0\.([#0]*0)$/))return er<0?"-"+write_num_flt(e,_e,-er):commaify(""+(Math.floor(er)+carry(er,nr[1].length)))+"."+pad0(dec(er,nr[1].length),nr[1].length);if(nr=_e.match(/^#,#*,#0/))return write_num_flt(e,_e.replace(/^#,#*,/,""),er);if(nr=_e.match(/^([0#]+)(\\?-([0#]+))+$/))return rr=_strrev(write_num_flt(e,_e.replace(/[\\-]/g,""),er)),ir=0,_strrev(_strrev(_e.replace(/\\/g,"")).replace(/[0#]/g,function(mr){return ir<rr.length?rr.charAt(ir++):mr==="0"?"0":""}));if(_e.match(phone))return rr=write_num_flt(e,"##########",er),"("+rr.substr(0,3)+") "+rr.substr(3,3)+"-"+rr.substr(6);var lr="";if(nr=_e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ir=Math.min(nr[4].length,7),ar=SSF_frac(sr,Math.pow(10,ir)-1,!1),rr=""+or,lr=write_num("n",nr[1],ar[1]),lr.charAt(lr.length-1)==" "&&(lr=lr.substr(0,lr.length-1)+"0"),rr+=lr+nr[2]+"/"+nr[3],lr=rpad_(ar[2],ir),lr.length<nr[4].length&&(lr=hashq(nr[4].substr(nr[4].length-lr.length))+lr),rr+=lr,rr;if(nr=_e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ir=Math.min(Math.max(nr[1].length,nr[4].length),7),ar=SSF_frac(sr,Math.pow(10,ir)-1,!0),or+(ar[0]||(ar[1]?"":"0"))+" "+(ar[1]?pad_(ar[1],ir)+nr[2]+"/"+nr[3]+rpad_(ar[2],ir):fill(" ",2*ir+1+nr[2].length+nr[3].length));if(nr=_e.match(/^[#0?]+$/))return rr=pad0r(er,0),_e.length<=rr.length?rr:hashq(_e.substr(0,_e.length-rr.length))+rr;if(nr=_e.match(/^([#0?]+)\.([#0]+)$/)){rr=""+er.toFixed(Math.min(nr[2].length,10)).replace(/([^0])0+$/,"$1"),ir=rr.indexOf(".");var ur=_e.indexOf(".")-ir,fr=_e.length-rr.length-ur;return hashq(_e.substr(0,ur)+rr+_e.substr(_e.length-fr))}if(nr=_e.match(/^00,000\.([#0]*0)$/))return ir=dec(er,nr[1].length),er<0?"-"+write_num_flt(e,_e,-er):commaify(flr(er)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(mr){return"00,"+(mr.length<3?pad0(0,3-mr.length):"")+mr})+"."+pad0(ir,nr[1].length);switch(_e){case"###,##0.00":return write_num_flt(e,"#,##0.00",er);case"###,###":case"##,###":case"#,###":var cr=commaify(pad0r(sr,0));return cr!=="0"?or+cr:"";case"###,###.00":return write_num_flt(e,"###,##0.00",er).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",er).replace(/^0\./,".")}throw new Error("unsupported format |"+_e+"|")}function write_num_cm2(e,_e,er){for(var tr=_e.length-1;_e.charCodeAt(tr-1)===44;)--tr;return write_num(e,_e.substr(0,tr),er/Math.pow(10,3*(_e.length-tr)))}function write_num_pct2(e,_e,er){var tr=_e.replace(pct1,""),rr=_e.length-tr.length;return write_num(e,tr,er*Math.pow(10,2*rr))+fill("%",rr)}function write_num_exp2(e,_e){var er,tr=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(_e==0)return"0.0E+0";if(_e<0)return"-"+write_num_exp2(e,-_e);var rr=e.indexOf(".");rr===-1&&(rr=e.indexOf("E"));var nr=Math.floor(Math.log(_e)*Math.LOG10E)%rr;if(nr<0&&(nr+=rr),er=(_e/Math.pow(10,nr)).toPrecision(tr+1+(rr+nr)%rr),!er.match(/[Ee]/)){var ir=Math.floor(Math.log(_e)*Math.LOG10E);er.indexOf(".")===-1?er=er.charAt(0)+"."+er.substr(1)+"E+"+(ir-er.length+nr):er+="E+"+(ir-nr),er=er.replace(/\+-/,"-")}er=er.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(ar,sr,or,lr){return sr+or+lr.substr(0,(rr+nr)%rr)+"."+lr.substr(nr)+"E"})}else er=_e.toExponential(tr);return e.match(/E\+00$/)&&er.match(/e[+-]\d$/)&&(er=er.substr(0,er.length-1)+"0"+er.charAt(er.length-1)),e.match(/E\-/)&&er.match(/e\+/)&&(er=er.replace(/e\+/,"e")),er.replace("e","E")}function write_num_int(e,_e,er){if(e.charCodeAt(0)===40&&!_e.match(closeparen)){var tr=_e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return er>=0?write_num_int("n",tr,er):"("+write_num_int("n",tr,-er)+")"}if(_e.charCodeAt(_e.length-1)===44)return write_num_cm2(e,_e,er);if(_e.indexOf("%")!==-1)return write_num_pct2(e,_e,er);if(_e.indexOf("E")!==-1)return write_num_exp2(_e,er);if(_e.charCodeAt(0)===36)return"$"+write_num_int(e,_e.substr(_e.charAt(1)==" "?2:1),er);var rr,nr,ir,ar,sr=Math.abs(er),or=er<0?"-":"";if(_e.match(/^00+$/))return or+pad0(sr,_e.length);if(_e.match(/^[#?]+$/))return rr=""+er,er===0&&(rr=""),rr.length>_e.length?rr:hashq(_e.substr(0,_e.length-rr.length))+rr;if(nr=_e.match(frac1))return write_num_f2(nr,sr,or);if(_e.match(/^#+0+$/))return or+pad0(sr,_e.length-_e.indexOf("0"));if(nr=_e.match(dec1))return rr=(""+er).replace(/^([^\.]+)$/,"$1."+hashq(nr[1])).replace(/\.$/,"."+hashq(nr[1])),rr=rr.replace(/\.(\d*)$/,function(mr,dr){return"."+dr+fill("0",hashq(nr[1]).length-dr.length)}),_e.indexOf("0.")!==-1?rr:rr.replace(/^0\./,".");if(_e=_e.replace(/^#+([0.])/,"$1"),nr=_e.match(/^(0*)\.(#*)$/))return or+(""+sr).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,nr[1].length?"0.":".");if(nr=_e.match(/^#{1,3},##0(\.?)$/))return or+commaify(""+sr);if(nr=_e.match(/^#,##0\.([#0]*0)$/))return er<0?"-"+write_num_int(e,_e,-er):commaify(""+er)+"."+fill("0",nr[1].length);if(nr=_e.match(/^#,#*,#0/))return write_num_int(e,_e.replace(/^#,#*,/,""),er);if(nr=_e.match(/^([0#]+)(\\?-([0#]+))+$/))return rr=_strrev(write_num_int(e,_e.replace(/[\\-]/g,""),er)),ir=0,_strrev(_strrev(_e.replace(/\\/g,"")).replace(/[0#]/g,function(mr){return ir<rr.length?rr.charAt(ir++):mr==="0"?"0":""}));if(_e.match(phone))return rr=write_num_int(e,"##########",er),"("+rr.substr(0,3)+") "+rr.substr(3,3)+"-"+rr.substr(6);var lr="";if(nr=_e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ir=Math.min(nr[4].length,7),ar=SSF_frac(sr,Math.pow(10,ir)-1,!1),rr=""+or,lr=write_num("n",nr[1],ar[1]),lr.charAt(lr.length-1)==" "&&(lr=lr.substr(0,lr.length-1)+"0"),rr+=lr+nr[2]+"/"+nr[3],lr=rpad_(ar[2],ir),lr.length<nr[4].length&&(lr=hashq(nr[4].substr(nr[4].length-lr.length))+lr),rr+=lr,rr;if(nr=_e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ir=Math.min(Math.max(nr[1].length,nr[4].length),7),ar=SSF_frac(sr,Math.pow(10,ir)-1,!0),or+(ar[0]||(ar[1]?"":"0"))+" "+(ar[1]?pad_(ar[1],ir)+nr[2]+"/"+nr[3]+rpad_(ar[2],ir):fill(" ",2*ir+1+nr[2].length+nr[3].length));if(nr=_e.match(/^[#0?]+$/))return rr=""+er,_e.length<=rr.length?rr:hashq(_e.substr(0,_e.length-rr.length))+rr;if(nr=_e.match(/^([#0]+)\.([#0]+)$/)){rr=""+er.toFixed(Math.min(nr[2].length,10)).replace(/([^0])0+$/,"$1"),ir=rr.indexOf(".");var ur=_e.indexOf(".")-ir,fr=_e.length-rr.length-ur;return hashq(_e.substr(0,ur)+rr+_e.substr(_e.length-fr))}if(nr=_e.match(/^00,000\.([#0]*0)$/))return er<0?"-"+write_num_int(e,_e,-er):commaify(""+er).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(mr){return"00,"+(mr.length<3?pad0(0,3-mr.length):"")+mr})+"."+pad0(0,nr[1].length);switch(_e){case"###,###":case"##,###":case"#,###":var cr=commaify(""+sr);return cr!=="0"?or+cr:"";default:if(_e.match(/\.[0#?]*$/))return write_num_int(e,_e.slice(0,_e.lastIndexOf(".")),er)+hashq(_e.slice(_e.lastIndexOf(".")))}throw new Error("unsupported format |"+_e+"|")}function write_num(e,_e,er){return(er|0)===er?write_num_int(e,_e,er):write_num_flt(e,_e,er)}function SSF_split_fmt(e){for(var _e=[],er=!1,tr=0,rr=0;tr<e.length;++tr)switch(e.charCodeAt(tr)){case 34:er=!er;break;case 95:case 42:case 92:++tr;break;case 59:_e[_e.length]=e.substr(rr,tr-rr),rr=tr+1}if(_e[_e.length]=e.substr(rr),er===!0)throw new Error("Format |"+e+"| unterminated string ");return _e}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var _e=0,er="",tr="";_e<e.length;)switch(er=e.charAt(_e)){case"G":SSF_isgeneral(e,_e)&&(_e+=6),_e++;break;case'"':for(;e.charCodeAt(++_e)!==34&&_e<e.length;);++_e;break;case"\\":_e+=2;break;case"_":_e+=2;break;case"@":++_e;break;case"B":case"b":if(e.charAt(_e+1)==="1"||e.charAt(_e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(_e,3).toUpperCase()==="A/P"||e.substr(_e,5).toUpperCase()==="AM/PM"||e.substr(_e,5).toUpperCase()==="/")return!0;++_e;break;case"[":for(tr=er;e.charAt(_e++)!=="]"&&_e<e.length;)tr+=e.charAt(_e);if(tr.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;_e<e.length&&("0#?.,E+-%".indexOf(er=e.charAt(++_e))>-1||er=="\\"&&e.charAt(_e+1)=="-"&&"0#".indexOf(e.charAt(_e+2))>-1););break;case"?":for(;e.charAt(++_e)===er;);break;case"*":++_e,(e.charAt(_e)==" "||e.charAt(_e)=="*")&&++_e;break;case"(":case")":++_e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;_e<e.length&&"0123456789".indexOf(e.charAt(++_e))>-1;);break;case" ":++_e;break;default:++_e;break}return!1}function eval_fmt(e,_e,er,tr){for(var rr=[],nr="",ir=0,ar="",sr="t",or,lr,ur,fr="H";ir<e.length;)switch(ar=e.charAt(ir)){case"G":if(!SSF_isgeneral(e,ir))throw new Error("unrecognized character "+ar+" in "+e);rr[rr.length]={t:"G",v:"General"},ir+=7;break;case'"':for(nr="";(ur=e.charCodeAt(++ir))!==34&&ir<e.length;)nr+=String.fromCharCode(ur);rr[rr.length]={t:"t",v:nr},++ir;break;case"\\":var cr=e.charAt(++ir),mr=cr==="("||cr===")"?cr:"t";rr[rr.length]={t:mr,v:cr},++ir;break;case"_":rr[rr.length]={t:"t",v:" "},ir+=2;break;case"@":rr[rr.length]={t:"T",v:_e},++ir;break;case"B":case"b":if(e.charAt(ir+1)==="1"||e.charAt(ir+1)==="2"){if(or==null&&(or=SSF_parse_date_code(_e,er,e.charAt(ir+1)==="2"),or==null))return"";rr[rr.length]={t:"X",v:e.substr(ir,2)},sr=ar,ir+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":ar=ar.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(_e<0||or==null&&(or=SSF_parse_date_code(_e,er),or==null))return"";for(nr=ar;++ir<e.length&&e.charAt(ir).toLowerCase()===ar;)nr+=ar;ar==="m"&&sr.toLowerCase()==="h"&&(ar="M"),ar==="h"&&(ar=fr),rr[rr.length]={t:ar,v:nr},sr=ar;break;case"A":case"a":case"":var dr={t:ar,v:ar};if(or==null&&(or=SSF_parse_date_code(_e,er)),e.substr(ir,3).toUpperCase()==="A/P"?(or!=null&&(dr.v=or.H>=12?"P":"A"),dr.t="T",fr="h",ir+=3):e.substr(ir,5).toUpperCase()==="AM/PM"?(or!=null&&(dr.v=or.H>=12?"PM":"AM"),dr.t="T",ir+=5,fr="h"):e.substr(ir,5).toUpperCase()==="/"?(or!=null&&(dr.v=or.H>=12?"":""),dr.t="T",ir+=5,fr="h"):(dr.t="t",++ir),or==null&&dr.t==="T")return"";rr[rr.length]=dr,sr=ar;break;case"[":for(nr=ar;e.charAt(ir++)!=="]"&&ir<e.length;)nr+=e.charAt(ir);if(nr.slice(-1)!=="]")throw'unterminated "[" block: |'+nr+"|";if(nr.match(SSF_abstime)){if(or==null&&(or=SSF_parse_date_code(_e,er),or==null))return"";rr[rr.length]={t:"Z",v:nr.toLowerCase()},sr=nr.charAt(1)}else nr.indexOf("$")>-1&&(nr=(nr.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(rr[rr.length]={t:"t",v:nr}));break;case".":if(or!=null){for(nr=ar;++ir<e.length&&(ar=e.charAt(ir))==="0";)nr+=ar;rr[rr.length]={t:"s",v:nr};break}case"0":case"#":for(nr=ar;++ir<e.length&&"0#?.,E+-%".indexOf(ar=e.charAt(ir))>-1;)nr+=ar;rr[rr.length]={t:"n",v:nr};break;case"?":for(nr=ar;e.charAt(++ir)===ar;)nr+=ar;rr[rr.length]={t:ar,v:nr},sr=ar;break;case"*":++ir,(e.charAt(ir)==" "||e.charAt(ir)=="*")&&++ir;break;case"(":case")":rr[rr.length]={t:tr===1?"t":ar,v:ar},++ir;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(nr=ar;ir<e.length&&"0123456789".indexOf(e.charAt(++ir))>-1;)nr+=e.charAt(ir);rr[rr.length]={t:"D",v:nr};break;case" ":rr[rr.length]={t:ar,v:ar},++ir;break;case"$":rr[rr.length]={t:"t",v:"$"},++ir;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(ar)===-1)throw new Error("unrecognized character "+ar+" in "+e);rr[rr.length]={t:"t",v:ar},++ir;break}var xr=0,pr=0,gr;for(ir=rr.length-1,sr="t";ir>=0;--ir)switch(rr[ir].t){case"h":case"H":rr[ir].t=fr,sr="h",xr<1&&(xr=1);break;case"s":(gr=rr[ir].v.match(/\.0+$/))&&(pr=Math.max(pr,gr[0].length-1)),xr<3&&(xr=3);case"d":case"y":case"M":case"e":sr=rr[ir].t;break;case"m":sr==="s"&&(rr[ir].t="M",xr<2&&(xr=2));break;case"X":break;case"Z":xr<1&&rr[ir].v.match(/[Hh]/)&&(xr=1),xr<2&&rr[ir].v.match(/[Mm]/)&&(xr=2),xr<3&&rr[ir].v.match(/[Ss]/)&&(xr=3)}switch(xr){case 0:break;case 1:or.u>=.5&&(or.u=0,++or.S),or.S>=60&&(or.S=0,++or.M),or.M>=60&&(or.M=0,++or.H);break;case 2:or.u>=.5&&(or.u=0,++or.S),or.S>=60&&(or.S=0,++or.M);break}var vr="",Cr;for(ir=0;ir<rr.length;++ir)switch(rr[ir].t){case"t":case"T":case" ":case"D":break;case"X":rr[ir].v="",rr[ir].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":rr[ir].v=SSF_write_date(rr[ir].t.charCodeAt(0),rr[ir].v,or,pr),rr[ir].t="t";break;case"n":case"?":for(Cr=ir+1;rr[Cr]!=null&&((ar=rr[Cr].t)==="?"||ar==="D"||(ar===" "||ar==="t")&&rr[Cr+1]!=null&&(rr[Cr+1].t==="?"||rr[Cr+1].t==="t"&&rr[Cr+1].v==="/")||rr[ir].t==="("&&(ar===" "||ar==="n"||ar===")")||ar==="t"&&(rr[Cr].v==="/"||rr[Cr].v===" "&&rr[Cr+1]!=null&&rr[Cr+1].t=="?"));)rr[ir].v+=rr[Cr].v,rr[Cr]={v:"",t:";"},++Cr;vr+=rr[ir].v,ir=Cr-1;break;case"G":rr[ir].t="t",rr[ir].v=SSF_general(_e,er);break}var Tr="",Fr,_r;if(vr.length>0){vr.charCodeAt(0)==40?(Fr=_e<0&&vr.charCodeAt(0)===45?-_e:_e,_r=write_num("n",vr,Fr)):(Fr=_e<0&&tr>1?-_e:_e,_r=write_num("n",vr,Fr),Fr<0&&rr[0]&&rr[0].t=="t"&&(_r=_r.substr(1),rr[0].v="-"+rr[0].v)),Cr=_r.length-1;var Ar=rr.length;for(ir=0;ir<rr.length;++ir)if(rr[ir]!=null&&rr[ir].t!="t"&&rr[ir].v.indexOf(".")>-1){Ar=ir;break}var Pr=rr.length;if(Ar===rr.length&&_r.indexOf("E")===-1){for(ir=rr.length-1;ir>=0;--ir)rr[ir]==null||"n?".indexOf(rr[ir].t)===-1||(Cr>=rr[ir].v.length-1?(Cr-=rr[ir].v.length,rr[ir].v=_r.substr(Cr+1,rr[ir].v.length)):Cr<0?rr[ir].v="":(rr[ir].v=_r.substr(0,Cr+1),Cr=-1),rr[ir].t="t",Pr=ir);Cr>=0&&Pr<rr.length&&(rr[Pr].v=_r.substr(0,Cr+1)+rr[Pr].v)}else if(Ar!==rr.length&&_r.indexOf("E")===-1){for(Cr=_r.indexOf(".")-1,ir=Ar;ir>=0;--ir)if(!(rr[ir]==null||"n?".indexOf(rr[ir].t)===-1)){for(lr=rr[ir].v.indexOf(".")>-1&&ir===Ar?rr[ir].v.indexOf(".")-1:rr[ir].v.length-1,Tr=rr[ir].v.substr(lr+1);lr>=0;--lr)Cr>=0&&(rr[ir].v.charAt(lr)==="0"||rr[ir].v.charAt(lr)==="#")&&(Tr=_r.charAt(Cr--)+Tr);rr[ir].v=Tr,rr[ir].t="t",Pr=ir}for(Cr>=0&&Pr<rr.length&&(rr[Pr].v=_r.substr(0,Cr+1)+rr[Pr].v),Cr=_r.indexOf(".")+1,ir=Ar;ir<rr.length;++ir)if(!(rr[ir]==null||"n?(".indexOf(rr[ir].t)===-1&&ir!==Ar)){for(lr=rr[ir].v.indexOf(".")>-1&&ir===Ar?rr[ir].v.indexOf(".")+1:0,Tr=rr[ir].v.substr(0,lr);lr<rr[ir].v.length;++lr)Cr<_r.length&&(Tr+=_r.charAt(Cr++));rr[ir].v=Tr,rr[ir].t="t",Pr=ir}}}for(ir=0;ir<rr.length;++ir)rr[ir]!=null&&"n?".indexOf(rr[ir].t)>-1&&(Fr=tr>1&&_e<0&&ir>0&&rr[ir-1].v==="-"?-_e:_e,rr[ir].v=write_num(rr[ir].t,rr[ir].v,Fr),rr[ir].t="t");var Ir="";for(ir=0;ir!==rr.length;++ir)rr[ir]!=null&&(Ir+=rr[ir].v);return Ir}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,_e){if(_e==null)return!1;var er=parseFloat(_e[2]);switch(_e[1]){case"=":if(e==er)return!0;break;case">":if(e>er)return!0;break;case"<":if(e<er)return!0;break;case"<>":if(e!=er)return!0;break;case">=":if(e>=er)return!0;break;case"<=":if(e<=er)return!0;break}return!1}function choose_fmt(e,_e){var er=SSF_split_fmt(e),tr=er.length,rr=er[tr-1].indexOf("@");if(tr<4&&rr>-1&&--tr,er.length>4)throw new Error("cannot find right format for |"+er.join("|")+"|");if(typeof _e!="number")return[4,er.length===4||rr>-1?er[er.length-1]:"@"];switch(er.length){case 1:er=rr>-1?["General","General","General",er[0]]:[er[0],er[0],er[0],"@"];break;case 2:er=rr>-1?[er[0],er[0],er[0],er[1]]:[er[0],er[1],er[0],"@"];break;case 3:er=rr>-1?[er[0],er[1],er[0],er[2]]:[er[0],er[1],er[2],"@"];break}var nr=_e>0?er[0]:_e<0?er[1]:er[2];if(er[0].indexOf("[")===-1&&er[1].indexOf("[")===-1)return[tr,nr];if(er[0].match(/\[[=<>]/)!=null||er[1].match(/\[[=<>]/)!=null){var ir=er[0].match(cfregex2),ar=er[1].match(cfregex2);return chkcond(_e,ir)?[tr,er[0]]:chkcond(_e,ar)?[tr,er[1]]:[tr,er[ir!=null&&ar!=null?2:1]]}return[tr,nr]}function SSF_format(e,_e,er){er==null&&(er={});var tr="";switch(typeof e){case"string":e=="m/d/yy"&&er.dateNF?tr=er.dateNF:tr=e;break;case"number":e==14&&er.dateNF?tr=er.dateNF:tr=(er.table!=null?er.table:table_fmt)[e],tr==null&&(tr=er.table&&er.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),tr==null&&(tr=SSF_default_str[e]||"General");break}if(SSF_isgeneral(tr,0))return SSF_general(_e,er);_e instanceof Date&&(_e=datenum_local(_e,er.date1904));var rr=choose_fmt(tr,_e);if(SSF_isgeneral(rr[1]))return SSF_general(_e,er);if(_e===!0)_e="TRUE";else if(_e===!1)_e="FALSE";else if(_e===""||_e==null)return"";return eval_fmt(rr[1],_e,er,rr[0])}function SSF_load(e,_e){if(typeof _e!="number"){_e=+_e||-1;for(var er=0;er<392;++er){if(table_fmt[er]==null){_e<0&&(_e=er);continue}if(table_fmt[er]==e){_e=er;break}}_e<0&&(_e=391)}return table_fmt[_e]=e,_e}function SSF_load_table(e){for(var _e=0;_e!=392;++_e)e[_e]!==void 0&&SSF_load(e[_e],_e)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var _e=typeof e=="number"?table_fmt[e]:e;return _e=_e.replace(dateNFregex,"(\\d+)"),new RegExp("^"+_e+"$")}function dateNF_fix(e,_e,er){var tr=-1,rr=-1,nr=-1,ir=-1,ar=-1,sr=-1;(_e.match(dateNFregex)||[]).forEach(function(ur,fr){var cr=parseInt(er[fr+1],10);switch(ur.toLowerCase().charAt(0)){case"y":tr=cr;break;case"d":nr=cr;break;case"h":ir=cr;break;case"s":sr=cr;break;case"m":ir>=0?ar=cr:rr=cr;break}}),sr>=0&&ar==-1&&rr>=0&&(ar=rr,rr=-1);var or=(""+(tr>=0?tr:new Date().getFullYear())).slice(-4)+"-"+("00"+(rr>=1?rr:1)).slice(-2)+"-"+("00"+(nr>=1?nr:1)).slice(-2);or.length==7&&(or="0"+or),or.length==8&&(or="20"+or);var lr=("00"+(ir>=0?ir:0)).slice(-2)+":"+("00"+(ar>=0?ar:0)).slice(-2)+":"+("00"+(sr>=0?sr:0)).slice(-2);return ir==-1&&ar==-1&&sr==-1?or:tr==-1&&rr==-1&&nr==-1?lr:or+"T"+lr}var CRC32=function(){var e={};e.version="1.2.0";function _e(){for(var _r=0,Ar=new Array(256),Pr=0;Pr!=256;++Pr)_r=Pr,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,_r=_r&1?-306674912^_r>>>1:_r>>>1,Ar[Pr]=_r;return typeof Int32Array<"u"?new Int32Array(Ar):Ar}var er=_e();function tr(_r){var Ar=0,Pr=0,Ir=0,wr=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ir=0;Ir!=256;++Ir)wr[Ir]=_r[Ir];for(Ir=0;Ir!=256;++Ir)for(Pr=_r[Ir],Ar=256+Ir;Ar<4096;Ar+=256)Pr=wr[Ar]=Pr>>>8^_r[Pr&255];var kr=[];for(Ir=1;Ir!=16;++Ir)kr[Ir-1]=typeof Int32Array<"u"?wr.subarray(Ir*256,Ir*256+256):wr.slice(Ir*256,Ir*256+256);return kr}var rr=tr(er),nr=rr[0],ir=rr[1],ar=rr[2],sr=rr[3],or=rr[4],lr=rr[5],ur=rr[6],fr=rr[7],cr=rr[8],mr=rr[9],dr=rr[10],xr=rr[11],pr=rr[12],gr=rr[13],vr=rr[14];function Cr(_r,Ar){for(var Pr=Ar^-1,Ir=0,wr=_r.length;Ir<wr;)Pr=Pr>>>8^er[(Pr^_r.charCodeAt(Ir++))&255];return~Pr}function Tr(_r,Ar){for(var Pr=Ar^-1,Ir=_r.length-15,wr=0;wr<Ir;)Pr=vr[_r[wr++]^Pr&255]^gr[_r[wr++]^Pr>>8&255]^pr[_r[wr++]^Pr>>16&255]^xr[_r[wr++]^Pr>>>24]^dr[_r[wr++]]^mr[_r[wr++]]^cr[_r[wr++]]^fr[_r[wr++]]^ur[_r[wr++]]^lr[_r[wr++]]^or[_r[wr++]]^sr[_r[wr++]]^ar[_r[wr++]]^ir[_r[wr++]]^nr[_r[wr++]]^er[_r[wr++]];for(Ir+=15;wr<Ir;)Pr=Pr>>>8^er[(Pr^_r[wr++])&255];return~Pr}function Fr(_r,Ar){for(var Pr=Ar^-1,Ir=0,wr=_r.length,kr=0,Mr=0;Ir<wr;)kr=_r.charCodeAt(Ir++),kr<128?Pr=Pr>>>8^er[(Pr^kr)&255]:kr<2048?(Pr=Pr>>>8^er[(Pr^(192|kr>>6&31))&255],Pr=Pr>>>8^er[(Pr^(128|kr&63))&255]):kr>=55296&&kr<57344?(kr=(kr&1023)+64,Mr=_r.charCodeAt(Ir++)&1023,Pr=Pr>>>8^er[(Pr^(240|kr>>8&7))&255],Pr=Pr>>>8^er[(Pr^(128|kr>>2&63))&255],Pr=Pr>>>8^er[(Pr^(128|Mr>>6&15|(kr&3)<<4))&255],Pr=Pr>>>8^er[(Pr^(128|Mr&63))&255]):(Pr=Pr>>>8^er[(Pr^(224|kr>>12&15))&255],Pr=Pr>>>8^er[(Pr^(128|kr>>6&63))&255],Pr=Pr>>>8^er[(Pr^(128|kr&63))&255]);return~Pr}return e.table=er,e.bstr=Cr,e.buf=Tr,e.str=Fr,e}(),CFB=function e(){var _e={};_e.version="1.2.1";function er(Jr,Yr){for(var qr=Jr.split("/"),en=Yr.split("/"),sn=0,un=0,Tn=Math.min(qr.length,en.length);sn<Tn;++sn){if(un=qr[sn].length-en[sn].length)return un;if(qr[sn]!=en[sn])return qr[sn]<en[sn]?-1:1}return qr.length-en.length}function tr(Jr){if(Jr.charAt(Jr.length-1)=="/")return Jr.slice(0,-1).indexOf("/")===-1?Jr:tr(Jr.slice(0,-1));var Yr=Jr.lastIndexOf("/");return Yr===-1?Jr:Jr.slice(0,Yr+1)}function rr(Jr){if(Jr.charAt(Jr.length-1)=="/")return rr(Jr.slice(0,-1));var Yr=Jr.lastIndexOf("/");return Yr===-1?Jr:Jr.slice(Yr+1)}function nr(Jr,Yr){typeof Yr=="string"&&(Yr=new Date(Yr));var qr=Yr.getHours();qr=qr<<6|Yr.getMinutes(),qr=qr<<5|Yr.getSeconds()>>>1,Jr.write_shift(2,qr);var en=Yr.getFullYear()-1980;en=en<<4|Yr.getMonth()+1,en=en<<5|Yr.getDate(),Jr.write_shift(2,en)}function ir(Jr){var Yr=Jr.read_shift(2)&65535,qr=Jr.read_shift(2)&65535,en=new Date,sn=qr&31;qr>>>=5;var un=qr&15;qr>>>=4,en.setMilliseconds(0),en.setFullYear(qr+1980),en.setMonth(un-1),en.setDate(sn);var Tn=Yr&31;Yr>>>=5;var In=Yr&63;return Yr>>>=6,en.setHours(Yr),en.setMinutes(In),en.setSeconds(Tn<<1),en}function ar(Jr){prep_blob(Jr,0);for(var Yr={},qr=0;Jr.l<=Jr.length-4;){var en=Jr.read_shift(2),sn=Jr.read_shift(2),un=Jr.l+sn,Tn={};switch(en){case 21589:qr=Jr.read_shift(1),qr&1&&(Tn.mtime=Jr.read_shift(4)),sn>5&&(qr&2&&(Tn.atime=Jr.read_shift(4)),qr&4&&(Tn.ctime=Jr.read_shift(4))),Tn.mtime&&(Tn.mt=new Date(Tn.mtime*1e3));break}Jr.l=un,Yr[en]=Tn}return Yr}var sr;function or(){return sr||(sr={})}function lr(Jr,Yr){if(Jr[0]==80&&Jr[1]==75)return As(Jr,Yr);if((Jr[0]|32)==109&&(Jr[1]|32)==105)return Pn(Jr,Yr);if(Jr.length<512)throw new Error("CFB file size "+Jr.length+" < 512");var qr=3,en=512,sn=0,un=0,Tn=0,In=0,Fn=0,kn=[],Nn=Jr.slice(0,512);prep_blob(Nn,0);var Kn=ur(Nn);switch(qr=Kn[0],qr){case 3:en=512;break;case 4:en=4096;break;case 0:if(Kn[1]==0)return As(Jr,Yr);default:throw new Error("Major Version: Expected 3 or 4 saw "+qr)}en!==512&&(Nn=Jr.slice(0,en),prep_blob(Nn,28));var is=Jr.slice(0,en);fr(Nn,qr);var ps=Nn.read_shift(4,"i");if(qr===3&&ps!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ps);Nn.l+=4,Tn=Nn.read_shift(4,"i"),Nn.l+=4,Nn.chk("00100000","Mini Stream Cutoff Size: "),In=Nn.read_shift(4,"i"),sn=Nn.read_shift(4,"i"),Fn=Nn.read_shift(4,"i"),un=Nn.read_shift(4,"i");for(var ns=-1,ss=0;ss<109&&(ns=Nn.read_shift(4,"i"),!(ns<0));++ss)kn[ss]=ns;var Ss=cr(Jr,en);xr(Fn,un,Ss,en,kn);var ks=gr(Ss,Tn,kn,en);ks[Tn].name="!Directory",sn>0&&In!==Mr&&(ks[In].name="!MiniFAT"),ks[kn[0]].name="!FAT",ks.fat_addrs=kn,ks.ssz=en;var Ns={},Us=[],Is=[],Gs=[];vr(Tn,ks,Ss,Us,sn,Ns,Is,In),mr(Is,Gs,Us),Us.shift();var so={FileIndex:Is,FullPaths:Gs};return Yr&&Yr.raw&&(so.raw={header:is,sectors:Ss}),so}function ur(Jr){if(Jr[Jr.l]==80&&Jr[Jr.l+1]==75)return[0,0];Jr.chk(Hr,"Header Signature: "),Jr.l+=16;var Yr=Jr.read_shift(2,"u");return[Jr.read_shift(2,"u"),Yr]}function fr(Jr,Yr){var qr=9;switch(Jr.l+=2,qr=Jr.read_shift(2)){case 9:if(Yr!=3)throw new Error("Sector Shift: Expected 9 saw "+qr);break;case 12:if(Yr!=4)throw new Error("Sector Shift: Expected 12 saw "+qr);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+qr)}Jr.chk("0600","Mini Sector Shift: "),Jr.chk("000000000000","Reserved: ")}function cr(Jr,Yr){for(var qr=Math.ceil(Jr.length/Yr)-1,en=[],sn=1;sn<qr;++sn)en[sn-1]=Jr.slice(sn*Yr,(sn+1)*Yr);return en[qr-1]=Jr.slice(qr*Yr),en}function mr(Jr,Yr,qr){for(var en=0,sn=0,un=0,Tn=0,In=0,Fn=qr.length,kn=[],Nn=[];en<Fn;++en)kn[en]=Nn[en]=en,Yr[en]=qr[en];for(;In<Nn.length;++In)en=Nn[In],sn=Jr[en].L,un=Jr[en].R,Tn=Jr[en].C,kn[en]===en&&(sn!==-1&&kn[sn]!==sn&&(kn[en]=kn[sn]),un!==-1&&kn[un]!==un&&(kn[en]=kn[un])),Tn!==-1&&(kn[Tn]=en),sn!==-1&&en!=kn[en]&&(kn[sn]=kn[en],Nn.lastIndexOf(sn)<In&&Nn.push(sn)),un!==-1&&en!=kn[en]&&(kn[un]=kn[en],Nn.lastIndexOf(un)<In&&Nn.push(un));for(en=1;en<Fn;++en)kn[en]===en&&(un!==-1&&kn[un]!==un?kn[en]=kn[un]:sn!==-1&&kn[sn]!==sn&&(kn[en]=kn[sn]));for(en=1;en<Fn;++en)if(Jr[en].type!==0){if(In=en,In!=kn[In])do In=kn[In],Yr[en]=Yr[In]+"/"+Yr[en];while(In!==0&&kn[In]!==-1&&In!=kn[In]);kn[en]=-1}for(Yr[0]+="/",en=1;en<Fn;++en)Jr[en].type!==2&&(Yr[en]+="/")}function dr(Jr,Yr,qr){for(var en=Jr.start,sn=Jr.size,un=[],Tn=en;qr&&sn>0&&Tn>=0;)un.push(Yr.slice(Tn*kr,Tn*kr+kr)),sn-=kr,Tn=__readInt32LE(qr,Tn*4);return un.length===0?new_buf(0):bconcat(un).slice(0,Jr.size)}function xr(Jr,Yr,qr,en,sn){var un=Mr;if(Jr===Mr){if(Yr!==0)throw new Error("DIFAT chain shorter than expected")}else if(Jr!==-1){var Tn=qr[Jr],In=(en>>>2)-1;if(!Tn)return;for(var Fn=0;Fn<In&&(un=__readInt32LE(Tn,Fn*4))!==Mr;++Fn)sn.push(un);xr(__readInt32LE(Tn,en-4),Yr-1,qr,en,sn)}}function pr(Jr,Yr,qr,en,sn){var un=[],Tn=[];sn||(sn=[]);var In=en-1,Fn=0,kn=0;for(Fn=Yr;Fn>=0;){sn[Fn]=!0,un[un.length]=Fn,Tn.push(Jr[Fn]);var Nn=qr[Math.floor(Fn*4/en)];if(kn=Fn*4&In,en<4+kn)throw new Error("FAT boundary crossed: "+Fn+" 4 "+en);if(!Jr[Nn])break;Fn=__readInt32LE(Jr[Nn],kn)}return{nodes:un,data:__toBuffer([Tn])}}function gr(Jr,Yr,qr,en){var sn=Jr.length,un=[],Tn=[],In=[],Fn=[],kn=en-1,Nn=0,Kn=0,is=0,ps=0;for(Nn=0;Nn<sn;++Nn)if(In=[],is=Nn+Yr,is>=sn&&(is-=sn),!Tn[is]){Fn=[];var ns=[];for(Kn=is;Kn>=0;){ns[Kn]=!0,Tn[Kn]=!0,In[In.length]=Kn,Fn.push(Jr[Kn]);var ss=qr[Math.floor(Kn*4/en)];if(ps=Kn*4&kn,en<4+ps)throw new Error("FAT boundary crossed: "+Kn+" 4 "+en);if(!Jr[ss]||(Kn=__readInt32LE(Jr[ss],ps),ns[Kn]))break}un[is]={nodes:In,data:__toBuffer([Fn])}}return un}function vr(Jr,Yr,qr,en,sn,un,Tn,In){for(var Fn=0,kn=en.length?2:0,Nn=Yr[Jr].data,Kn=0,is=0,ps;Kn<Nn.length;Kn+=128){var ns=Nn.slice(Kn,Kn+128);prep_blob(ns,64),is=ns.read_shift(2),ps=__utf16le(ns,0,is-kn),en.push(ps);var ss={name:ps,type:ns.read_shift(1),color:ns.read_shift(1),L:ns.read_shift(4,"i"),R:ns.read_shift(4,"i"),C:ns.read_shift(4,"i"),clsid:ns.read_shift(16),state:ns.read_shift(4,"i"),start:0,size:0},Ss=ns.read_shift(2)+ns.read_shift(2)+ns.read_shift(2)+ns.read_shift(2);Ss!==0&&(ss.ct=Cr(ns,ns.l-8));var ks=ns.read_shift(2)+ns.read_shift(2)+ns.read_shift(2)+ns.read_shift(2);ks!==0&&(ss.mt=Cr(ns,ns.l-8)),ss.start=ns.read_shift(4,"i"),ss.size=ns.read_shift(4,"i"),ss.size<0&&ss.start<0&&(ss.size=ss.type=0,ss.start=Mr,ss.name=""),ss.type===5?(Fn=ss.start,sn>0&&Fn!==Mr&&(Yr[Fn].name="!StreamData")):ss.size>=4096?(ss.storage="fat",Yr[ss.start]===void 0&&(Yr[ss.start]=pr(qr,ss.start,Yr.fat_addrs,Yr.ssz)),Yr[ss.start].name=ss.name,ss.content=Yr[ss.start].data.slice(0,ss.size)):(ss.storage="minifat",ss.size<0?ss.size=0:Fn!==Mr&&ss.start!==Mr&&Yr[Fn]&&(ss.content=dr(ss,Yr[Fn].data,(Yr[In]||{}).data))),ss.content&&prep_blob(ss.content,0),un[ps]=ss,Tn.push(ss)}}function Cr(Jr,Yr){return new Date((__readUInt32LE(Jr,Yr+4)/1e7*Math.pow(2,32)+__readUInt32LE(Jr,Yr)/1e7-11644473600)*1e3)}function Tr(Jr,Yr){return or(),lr(sr.readFileSync(Jr),Yr)}function Fr(Jr,Yr){var qr=Yr&&Yr.type;switch(qr||has_buf&&Buffer.isBuffer(Jr)&&(qr="buffer"),qr||"base64"){case"file":return Tr(Jr,Yr);case"base64":return lr(s2a(Base64_decode(Jr)),Yr);case"binary":return lr(s2a(Jr),Yr)}return lr(Jr,Yr)}function _r(Jr,Yr){var qr=Yr||{},en=qr.root||"Root Entry";if(Jr.FullPaths||(Jr.FullPaths=[]),Jr.FileIndex||(Jr.FileIndex=[]),Jr.FullPaths.length!==Jr.FileIndex.length)throw new Error("inconsistent CFB structure");Jr.FullPaths.length===0&&(Jr.FullPaths[0]=en+"/",Jr.FileIndex[0]={name:en,type:5}),qr.CLSID&&(Jr.FileIndex[0].clsid=qr.CLSID),Ar(Jr)}function Ar(Jr){var Yr="Sh33tJ5";if(!CFB.find(Jr,"/"+Yr)){var qr=new_buf(4);qr[0]=55,qr[1]=qr[3]=50,qr[2]=54,Jr.FileIndex.push({name:Yr,type:2,content:qr,size:4,L:69,R:69,C:69}),Jr.FullPaths.push(Jr.FullPaths[0]+Yr),Pr(Jr)}}function Pr(Jr,Yr){_r(Jr);for(var qr=!1,en=!1,sn=Jr.FullPaths.length-1;sn>=0;--sn){var un=Jr.FileIndex[sn];switch(un.type){case 0:en?qr=!0:(Jr.FileIndex.pop(),Jr.FullPaths.pop());break;case 1:case 2:case 5:en=!0,isNaN(un.R*un.L*un.C)&&(qr=!0),un.R>-1&&un.L>-1&&un.R==un.L&&(qr=!0);break;default:qr=!0;break}}if(!(!qr&&!Yr)){var Tn=new Date(1987,1,19),In=0,Fn=Object.create?Object.create(null):{},kn=[];for(sn=0;sn<Jr.FullPaths.length;++sn)Fn[Jr.FullPaths[sn]]=!0,Jr.FileIndex[sn].type!==0&&kn.push([Jr.FullPaths[sn],Jr.FileIndex[sn]]);for(sn=0;sn<kn.length;++sn){var Nn=tr(kn[sn][0]);en=Fn[Nn],en||(kn.push([Nn,{name:rr(Nn).replace("/",""),type:1,clsid:zr,ct:Tn,mt:Tn,content:null}]),Fn[Nn]=!0)}for(kn.sort(function(ps,ns){return er(ps[0],ns[0])}),Jr.FullPaths=[],Jr.FileIndex=[],sn=0;sn<kn.length;++sn)Jr.FullPaths[sn]=kn[sn][0],Jr.FileIndex[sn]=kn[sn][1];for(sn=0;sn<kn.length;++sn){var Kn=Jr.FileIndex[sn],is=Jr.FullPaths[sn];if(Kn.name=rr(is).replace("/",""),Kn.L=Kn.R=Kn.C=-(Kn.color=1),Kn.size=Kn.content?Kn.content.length:0,Kn.start=0,Kn.clsid=Kn.clsid||zr,sn===0)Kn.C=kn.length>1?1:-1,Kn.size=0,Kn.type=5;else if(is.slice(-1)=="/"){for(In=sn+1;In<kn.length&&tr(Jr.FullPaths[In])!=is;++In);for(Kn.C=In>=kn.length?-1:In,In=sn+1;In<kn.length&&tr(Jr.FullPaths[In])!=tr(is);++In);Kn.R=In>=kn.length?-1:In,Kn.type=1}else tr(Jr.FullPaths[sn+1]||"")==tr(is)&&(Kn.R=sn+1),Kn.type=2}}}function Ir(Jr,Yr){var qr=Yr||{};if(qr.fileType=="mad")return Rn(Jr,qr);switch(Pr(Jr),qr.fileType){case"zip":return _i(Jr,qr)}var en=function(ps){for(var ns=0,ss=0,Ss=0;Ss<ps.FileIndex.length;++Ss){var ks=ps.FileIndex[Ss];if(ks.content){var Ns=ks.content.length;Ns>0&&(Ns<4096?ns+=Ns+63>>6:ss+=Ns+511>>9)}}for(var Us=ps.FullPaths.length+3>>2,Is=ns+7>>3,Gs=ns+127>>7,so=Is+ss+Us+Gs,ro=so+127>>7,Qs=ro<=109?0:Math.ceil((ro-109)/127);so+ro+Qs+127>>7>ro;)Qs=++ro<=109?0:Math.ceil((ro-109)/127);var qs=[1,Qs,ro,Gs,Us,ss,ns,0];return ps.FileIndex[0].size=ns<<6,qs[7]=(ps.FileIndex[0].start=qs[0]+qs[1]+qs[2]+qs[3]+qs[4]+qs[5])+(qs[6]+7>>3),qs}(Jr),sn=new_buf(en[7]<<9),un=0,Tn=0;{for(un=0;un<8;++un)sn.write_shift(1,Gr[un]);for(un=0;un<8;++un)sn.write_shift(2,0);for(sn.write_shift(2,62),sn.write_shift(2,3),sn.write_shift(2,65534),sn.write_shift(2,9),sn.write_shift(2,6),un=0;un<3;++un)sn.write_shift(2,0);for(sn.write_shift(4,0),sn.write_shift(4,en[2]),sn.write_shift(4,en[0]+en[1]+en[2]+en[3]-1),sn.write_shift(4,0),sn.write_shift(4,4096),sn.write_shift(4,en[3]?en[0]+en[1]+en[2]-1:Mr),sn.write_shift(4,en[3]),sn.write_shift(-4,en[1]?en[0]-1:Mr),sn.write_shift(4,en[1]),un=0;un<109;++un)sn.write_shift(-4,un<en[2]?en[1]+un:-1)}if(en[1])for(Tn=0;Tn<en[1];++Tn){for(;un<236+Tn*127;++un)sn.write_shift(-4,un<en[2]?en[1]+un:-1);sn.write_shift(-4,Tn===en[1]-1?Mr:Tn+1)}var In=function(ps){for(Tn+=ps;un<Tn-1;++un)sn.write_shift(-4,un+1);ps&&(++un,sn.write_shift(-4,Mr))};for(Tn=un=0,Tn+=en[1];un<Tn;++un)sn.write_shift(-4,Br.DIFSECT);for(Tn+=en[2];un<Tn;++un)sn.write_shift(-4,Br.FATSECT);In(en[3]),In(en[4]);for(var Fn=0,kn=0,Nn=Jr.FileIndex[0];Fn<Jr.FileIndex.length;++Fn)Nn=Jr.FileIndex[Fn],Nn.content&&(kn=Nn.content.length,!(kn<4096)&&(Nn.start=Tn,In(kn+511>>9)));for(In(en[6]+7>>3);sn.l&511;)sn.write_shift(-4,Br.ENDOFCHAIN);for(Tn=un=0,Fn=0;Fn<Jr.FileIndex.length;++Fn)Nn=Jr.FileIndex[Fn],Nn.content&&(kn=Nn.content.length,!(!kn||kn>=4096)&&(Nn.start=Tn,In(kn+63>>6)));for(;sn.l&511;)sn.write_shift(-4,Br.ENDOFCHAIN);for(un=0;un<en[4]<<2;++un){var Kn=Jr.FullPaths[un];if(!Kn||Kn.length===0){for(Fn=0;Fn<17;++Fn)sn.write_shift(4,0);for(Fn=0;Fn<3;++Fn)sn.write_shift(4,-1);for(Fn=0;Fn<12;++Fn)sn.write_shift(4,0);continue}Nn=Jr.FileIndex[un],un===0&&(Nn.start=Nn.size?Nn.start-1:Mr);var is=un===0&&qr.root||Nn.name;if(kn=2*(is.length+1),sn.write_shift(64,is,"utf16le"),sn.write_shift(2,kn),sn.write_shift(1,Nn.type),sn.write_shift(1,Nn.color),sn.write_shift(-4,Nn.L),sn.write_shift(-4,Nn.R),sn.write_shift(-4,Nn.C),Nn.clsid)sn.write_shift(16,Nn.clsid,"hex");else for(Fn=0;Fn<4;++Fn)sn.write_shift(4,0);sn.write_shift(4,Nn.state||0),sn.write_shift(4,0),sn.write_shift(4,0),sn.write_shift(4,0),sn.write_shift(4,0),sn.write_shift(4,Nn.start),sn.write_shift(4,Nn.size),sn.write_shift(4,0)}for(un=1;un<Jr.FileIndex.length;++un)if(Nn=Jr.FileIndex[un],Nn.size>=4096)if(sn.l=Nn.start+1<<9,has_buf&&Buffer.isBuffer(Nn.content))Nn.content.copy(sn,sn.l,0,Nn.size),sn.l+=Nn.size+511&-512;else{for(Fn=0;Fn<Nn.size;++Fn)sn.write_shift(1,Nn.content[Fn]);for(;Fn&511;++Fn)sn.write_shift(1,0)}for(un=1;un<Jr.FileIndex.length;++un)if(Nn=Jr.FileIndex[un],Nn.size>0&&Nn.size<4096)if(has_buf&&Buffer.isBuffer(Nn.content))Nn.content.copy(sn,sn.l,0,Nn.size),sn.l+=Nn.size+63&-64;else{for(Fn=0;Fn<Nn.size;++Fn)sn.write_shift(1,Nn.content[Fn]);for(;Fn&63;++Fn)sn.write_shift(1,0)}if(has_buf)sn.l=sn.length;else for(;sn.l<sn.length;)sn.write_shift(1,0);return sn}function wr(Jr,Yr){var qr=Jr.FullPaths.map(function(Fn){return Fn.toUpperCase()}),en=qr.map(function(Fn){var kn=Fn.split("/");return kn[kn.length-(Fn.slice(-1)=="/"?2:1)]}),sn=!1;Yr.charCodeAt(0)===47?(sn=!0,Yr=qr[0].slice(0,-1)+Yr):sn=Yr.indexOf("/")!==-1;var un=Yr.toUpperCase(),Tn=sn===!0?qr.indexOf(un):en.indexOf(un);if(Tn!==-1)return Jr.FileIndex[Tn];var In=!un.match(chr1);for(un=un.replace(chr0,""),In&&(un=un.replace(chr1,"!")),Tn=0;Tn<qr.length;++Tn)if((In?qr[Tn].replace(chr1,"!"):qr[Tn]).replace(chr0,"")==un||(In?en[Tn].replace(chr1,"!"):en[Tn]).replace(chr0,"")==un)return Jr.FileIndex[Tn];return null}var kr=64,Mr=-2,Hr="d0cf11e0a1b11ae1",Gr=[208,207,17,224,161,177,26,225],zr="00000000000000000000000000000000",Br={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Mr,FREESECT:-1,HEADER_SIGNATURE:Hr,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:zr,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Vr(Jr,Yr,qr){or();var en=Ir(Jr,qr);sr.writeFileSync(Yr,en)}function Rr(Jr){for(var Yr=new Array(Jr.length),qr=0;qr<Jr.length;++qr)Yr[qr]=String.fromCharCode(Jr[qr]);return Yr.join("")}function Xr(Jr,Yr){var qr=Ir(Jr,Yr);switch(Yr&&Yr.type||"buffer"){case"file":return or(),sr.writeFileSync(Yr.filename,qr),qr;case"binary":return typeof qr=="string"?qr:Rr(qr);case"base64":return Base64_encode(typeof qr=="string"?qr:Rr(qr));case"buffer":if(has_buf)return Buffer.isBuffer(qr)?qr:Buffer_from(qr);case"array":return typeof qr=="string"?s2a(qr):qr}return qr}var an;function yr(Jr){try{var Yr=Jr.InflateRaw,qr=new Yr;if(qr._processChunk(new Uint8Array([3,0]),qr._finishFlushFlag),qr.bytesRead)an=Jr;else throw new Error("zlib does not expose bytesRead")}catch(en){console.error("cannot use native zlib: "+(en.message||en))}}function br(Jr,Yr){if(!an)return cs(Jr,Yr);var qr=an.InflateRaw,en=new qr,sn=en._processChunk(Jr.slice(Jr.l),en._finishFlushFlag);return Jr.l+=en.bytesRead,sn}function Er(Jr){return an?an.deflateRawSync(Jr):ls(Jr)}var Lr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Or=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ur=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function $r(Jr){var Yr=(Jr<<1|Jr<<11)&139536|(Jr<<5|Jr<<15)&558144;return(Yr>>16|Yr>>8|Yr)&255}for(var Zr=typeof Uint8Array<"u",fn=Zr?new Uint8Array(256):[],_n=0;_n<256;++_n)fn[_n]=$r(_n);function Kr(Jr,Yr){var qr=fn[Jr&255];return Yr<=8?qr>>>8-Yr:(qr=qr<<8|fn[Jr>>8&255],Yr<=16?qr>>>16-Yr:(qr=qr<<8|fn[Jr>>16&255],qr>>>24-Yr))}function Cn(Jr,Yr){var qr=Yr&7,en=Yr>>>3;return(Jr[en]|(qr<=6?0:Jr[en+1]<<8))>>>qr&3}function Dn(Jr,Yr){var qr=Yr&7,en=Yr>>>3;return(Jr[en]|(qr<=5?0:Jr[en+1]<<8))>>>qr&7}function wn(Jr,Yr){var qr=Yr&7,en=Yr>>>3;return(Jr[en]|(qr<=4?0:Jr[en+1]<<8))>>>qr&15}function Qr(Jr,Yr){var qr=Yr&7,en=Yr>>>3;return(Jr[en]|(qr<=3?0:Jr[en+1]<<8))>>>qr&31}function xn(Jr,Yr){var qr=Yr&7,en=Yr>>>3;return(Jr[en]|(qr<=1?0:Jr[en+1]<<8))>>>qr&127}function tn(Jr,Yr,qr){var en=Yr&7,sn=Yr>>>3,un=(1<<qr)-1,Tn=Jr[sn]>>>en;return qr<8-en||(Tn|=Jr[sn+1]<<8-en,qr<16-en)||(Tn|=Jr[sn+2]<<16-en,qr<24-en)||(Tn|=Jr[sn+3]<<24-en),Tn&un}function on(Jr,Yr,qr){var en=Yr&7,sn=Yr>>>3;return en<=5?Jr[sn]|=(qr&7)<<en:(Jr[sn]|=qr<<en&255,Jr[sn+1]=(qr&7)>>8-en),Yr+3}function vn(Jr,Yr,qr){var en=Yr&7,sn=Yr>>>3;return qr=(qr&1)<<en,Jr[sn]|=qr,Yr+1}function Sn(Jr,Yr,qr){var en=Yr&7,sn=Yr>>>3;return qr<<=en,Jr[sn]|=qr&255,qr>>>=8,Jr[sn+1]=qr,Yr+8}function Ln(Jr,Yr,qr){var en=Yr&7,sn=Yr>>>3;return qr<<=en,Jr[sn]|=qr&255,qr>>>=8,Jr[sn+1]=qr&255,Jr[sn+2]=qr>>>8,Yr+16}function Wn(Jr,Yr){var qr=Jr.length,en=2*qr>Yr?2*qr:Yr+5,sn=0;if(qr>=Yr)return Jr;if(has_buf){var un=new_unsafe_buf(en);if(Jr.copy)Jr.copy(un);else for(;sn<Jr.length;++sn)un[sn]=Jr[sn];return un}else if(Zr){var Tn=new Uint8Array(en);if(Tn.set)Tn.set(Jr);else for(;sn<qr;++sn)Tn[sn]=Jr[sn];return Tn}return Jr.length=en,Jr}function $n(Jr){for(var Yr=new Array(Jr),qr=0;qr<Jr;++qr)Yr[qr]=0;return Yr}function En(Jr,Yr,qr){var en=1,sn=0,un=0,Tn=0,In=0,Fn=Jr.length,kn=Zr?new Uint16Array(32):$n(32);for(un=0;un<32;++un)kn[un]=0;for(un=Fn;un<qr;++un)Jr[un]=0;Fn=Jr.length;var Nn=Zr?new Uint16Array(Fn):$n(Fn);for(un=0;un<Fn;++un)kn[sn=Jr[un]]++,en<sn&&(en=sn),Nn[un]=0;for(kn[0]=0,un=1;un<=en;++un)kn[un+16]=In=In+kn[un-1]<<1;for(un=0;un<Fn;++un)In=Jr[un],In!=0&&(Nn[un]=kn[In+16]++);var Kn=0;for(un=0;un<Fn;++un)if(Kn=Jr[un],Kn!=0)for(In=Kr(Nn[un],en)>>en-Kn,Tn=(1<<en+4-Kn)-1;Tn>=0;--Tn)Yr[In|Tn<<Kn]=Kn&15|un<<4;return en}var ba=Zr?new Uint16Array(512):$n(512),Qn=Zr?new Uint16Array(32):$n(32);if(!Zr){for(var vs=0;vs<512;++vs)ba[vs]=0;for(vs=0;vs<32;++vs)Qn[vs]=0}(function(){for(var Jr=[],Yr=0;Yr<32;Yr++)Jr.push(5);En(Jr,Qn,32);var qr=[];for(Yr=0;Yr<=143;Yr++)qr.push(8);for(;Yr<=255;Yr++)qr.push(9);for(;Yr<=279;Yr++)qr.push(7);for(;Yr<=287;Yr++)qr.push(8);En(qr,ba,288)})();var es=function(){for(var Yr=Zr?new Uint8Array(32768):[],qr=0,en=0;qr<Ur.length-1;++qr)for(;en<Ur[qr+1];++en)Yr[en]=qr;for(;en<32768;++en)Yr[en]=29;var sn=Zr?new Uint8Array(259):[];for(qr=0,en=0;qr<Or.length-1;++qr)for(;en<Or[qr+1];++en)sn[en]=qr;function un(In,Fn){for(var kn=0;kn<In.length;){var Nn=Math.min(65535,In.length-kn),Kn=kn+Nn==In.length;for(Fn.write_shift(1,+Kn),Fn.write_shift(2,Nn),Fn.write_shift(2,~Nn&65535);Nn-- >0;)Fn[Fn.l++]=In[kn++]}return Fn.l}function Tn(In,Fn){for(var kn=0,Nn=0,Kn=Zr?new Uint16Array(32768):[];Nn<In.length;){var is=Math.min(65535,In.length-Nn);if(is<10){for(kn=on(Fn,kn,+(Nn+is==In.length)),kn&7&&(kn+=8-(kn&7)),Fn.l=kn/8|0,Fn.write_shift(2,is),Fn.write_shift(2,~is&65535);is-- >0;)Fn[Fn.l++]=In[Nn++];kn=Fn.l*8;continue}kn=on(Fn,kn,+(Nn+is==In.length)+2);for(var ps=0;is-- >0;){var ns=In[Nn];ps=(ps<<5^ns)&32767;var ss=-1,Ss=0;if((ss=Kn[ps])&&(ss|=Nn&-32768,ss>Nn&&(ss-=32768),ss<Nn))for(;In[ss+Ss]==In[Nn+Ss]&&Ss<250;)++Ss;if(Ss>2){ns=sn[Ss],ns<=22?kn=Sn(Fn,kn,fn[ns+1]>>1)-1:(Sn(Fn,kn,3),kn+=5,Sn(Fn,kn,fn[ns-23]>>5),kn+=3);var ks=ns<8?0:ns-4>>2;ks>0&&(Ln(Fn,kn,Ss-Or[ns]),kn+=ks),ns=Yr[Nn-ss],kn=Sn(Fn,kn,fn[ns]>>3),kn-=3;var Ns=ns<4?0:ns-2>>1;Ns>0&&(Ln(Fn,kn,Nn-ss-Ur[ns]),kn+=Ns);for(var Us=0;Us<Ss;++Us)Kn[ps]=Nn&32767,ps=(ps<<5^In[Nn])&32767,++Nn;is-=Ss-1}else ns<=143?ns=ns+48:kn=vn(Fn,kn,1),kn=Sn(Fn,kn,fn[ns]),Kn[ps]=Nn&32767,++Nn}kn=Sn(Fn,kn,0)-1}return Fn.l=(kn+7)/8|0,Fn.l}return function(Fn,kn){return Fn.length<8?un(Fn,kn):Tn(Fn,kn)}}();function ls(Jr){var Yr=new_buf(50+Math.floor(Jr.length*1.1)),qr=es(Jr,Yr);return Yr.slice(0,qr)}var Xn=Zr?new Uint16Array(32768):$n(32768),ws=Zr?new Uint16Array(32768):$n(32768),ds=Zr?new Uint16Array(128):$n(128),Ps=1,Zn=1;function Mn(Jr,Yr){var qr=Qr(Jr,Yr)+257;Yr+=5;var en=Qr(Jr,Yr)+1;Yr+=5;var sn=wn(Jr,Yr)+4;Yr+=4;for(var un=0,Tn=Zr?new Uint8Array(19):$n(19),In=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fn=1,kn=Zr?new Uint8Array(8):$n(8),Nn=Zr?new Uint8Array(8):$n(8),Kn=Tn.length,is=0;is<sn;++is)Tn[Lr[is]]=un=Dn(Jr,Yr),Fn<un&&(Fn=un),kn[un]++,Yr+=3;var ps=0;for(kn[0]=0,is=1;is<=Fn;++is)Nn[is]=ps=ps+kn[is-1]<<1;for(is=0;is<Kn;++is)(ps=Tn[is])!=0&&(In[is]=Nn[ps]++);var ns=0;for(is=0;is<Kn;++is)if(ns=Tn[is],ns!=0){ps=fn[In[is]]>>8-ns;for(var ss=(1<<7-ns)-1;ss>=0;--ss)ds[ps|ss<<ns]=ns&7|is<<3}var Ss=[];for(Fn=1;Ss.length<qr+en;)switch(ps=ds[xn(Jr,Yr)],Yr+=ps&7,ps>>>=3){case 16:for(un=3+Cn(Jr,Yr),Yr+=2,ps=Ss[Ss.length-1];un-- >0;)Ss.push(ps);break;case 17:for(un=3+Dn(Jr,Yr),Yr+=3;un-- >0;)Ss.push(0);break;case 18:for(un=11+xn(Jr,Yr),Yr+=7;un-- >0;)Ss.push(0);break;default:Ss.push(ps),Fn<ps&&(Fn=ps);break}var ks=Ss.slice(0,qr),Ns=Ss.slice(qr);for(is=qr;is<286;++is)ks[is]=0;for(is=en;is<30;++is)Ns[is]=0;return Ps=En(ks,Xn,286),Zn=En(Ns,ws,30),Yr}function zn(Jr,Yr){if(Jr[0]==3&&!(Jr[1]&3))return[new_raw_buf(Yr),2];for(var qr=0,en=0,sn=new_unsafe_buf(Yr||1<<18),un=0,Tn=sn.length>>>0,In=0,Fn=0;!(en&1);){if(en=Dn(Jr,qr),qr+=3,en>>>1)en>>1==1?(In=9,Fn=5):(qr=Mn(Jr,qr),In=Ps,Fn=Zn);else{qr&7&&(qr+=8-(qr&7));var kn=Jr[qr>>>3]|Jr[(qr>>>3)+1]<<8;if(qr+=32,kn>0)for(!Yr&&Tn<un+kn&&(sn=Wn(sn,un+kn),Tn=sn.length);kn-- >0;)sn[un++]=Jr[qr>>>3],qr+=8;continue}for(;;){!Yr&&Tn<un+32767&&(sn=Wn(sn,un+32767),Tn=sn.length);var Nn=tn(Jr,qr,In),Kn=en>>>1==1?ba[Nn]:Xn[Nn];if(qr+=Kn&15,Kn>>>=4,!(Kn>>>8&255))sn[un++]=Kn;else{if(Kn==256)break;Kn-=257;var is=Kn<8?0:Kn-4>>2;is>5&&(is=0);var ps=un+Or[Kn];is>0&&(ps+=tn(Jr,qr,is),qr+=is),Nn=tn(Jr,qr,Fn),Kn=en>>>1==1?Qn[Nn]:ws[Nn],qr+=Kn&15,Kn>>>=4;var ns=Kn<4?0:Kn-2>>1,ss=Ur[Kn];for(ns>0&&(ss+=tn(Jr,qr,ns),qr+=ns),!Yr&&Tn<ps&&(sn=Wn(sn,ps+100),Tn=sn.length);un<ps;)sn[un]=sn[un-ss],++un}}}return Yr?[sn,qr+7>>>3]:[sn.slice(0,un),qr+7>>>3]}function cs(Jr,Yr){var qr=Jr.slice(Jr.l||0),en=zn(qr,Yr);return Jr.l+=en[1],en[0]}function Ls(Jr,Yr){if(Jr)typeof console<"u"&&console.error(Yr);else throw new Error(Yr)}function As(Jr,Yr){var qr=Jr;prep_blob(qr,0);var en=[],sn=[],un={FileIndex:en,FullPaths:sn};_r(un,{root:Yr.root});for(var Tn=qr.length-4;(qr[Tn]!=80||qr[Tn+1]!=75||qr[Tn+2]!=5||qr[Tn+3]!=6)&&Tn>=0;)--Tn;qr.l=Tn+4,qr.l+=4;var In=qr.read_shift(2);qr.l+=6;var Fn=qr.read_shift(4);for(qr.l=Fn,Tn=0;Tn<In;++Tn){qr.l+=20;var kn=qr.read_shift(4),Nn=qr.read_shift(4),Kn=qr.read_shift(2),is=qr.read_shift(2),ps=qr.read_shift(2);qr.l+=8;var ns=qr.read_shift(4),ss=ar(qr.slice(qr.l+Kn,qr.l+Kn+is));qr.l+=Kn+is+ps;var Ss=qr.l;qr.l=ns+4,yn(qr,kn,Nn,un,ss),qr.l=Ss}return un}function yn(Jr,Yr,qr,en,sn){Jr.l+=2;var un=Jr.read_shift(2),Tn=Jr.read_shift(2),In=ir(Jr);if(un&8257)throw new Error("Unsupported ZIP encryption");for(var Fn=Jr.read_shift(4),kn=Jr.read_shift(4),Nn=Jr.read_shift(4),Kn=Jr.read_shift(2),is=Jr.read_shift(2),ps="",ns=0;ns<Kn;++ns)ps+=String.fromCharCode(Jr[Jr.l++]);if(is){var ss=ar(Jr.slice(Jr.l,Jr.l+is));(ss[21589]||{}).mt&&(In=ss[21589].mt),((sn||{})[21589]||{}).mt&&(In=sn[21589].mt)}Jr.l+=is;var Ss=Jr.slice(Jr.l,Jr.l+kn);switch(Tn){case 8:Ss=br(Jr,Nn);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Tn)}var ks=!1;un&8&&(Fn=Jr.read_shift(4),Fn==134695760&&(Fn=Jr.read_shift(4),ks=!0),kn=Jr.read_shift(4),Nn=Jr.read_shift(4)),kn!=Yr&&Ls(ks,"Bad compressed size: "+Yr+" != "+kn),Nn!=qr&&Ls(ks,"Bad uncompressed size: "+qr+" != "+Nn),xa(en,ps,Ss,{unsafe:!0,mt:In})}function _i(Jr,Yr){var qr=Yr||{},en=[],sn=[],un=new_buf(1),Tn=qr.compression?8:0,In=0,Fn=0,kn=0,Nn=0,Kn=0,is=Jr.FullPaths[0],ps=is,ns=Jr.FileIndex[0],ss=[],Ss=0;for(Fn=1;Fn<Jr.FullPaths.length;++Fn)if(ps=Jr.FullPaths[Fn].slice(is.length),ns=Jr.FileIndex[Fn],!(!ns.size||!ns.content||ps=="Sh33tJ5")){var ks=Nn,Ns=new_buf(ps.length);for(kn=0;kn<ps.length;++kn)Ns.write_shift(1,ps.charCodeAt(kn)&127);Ns=Ns.slice(0,Ns.l),ss[Kn]=CRC32.buf(ns.content,0);var Us=ns.content;Tn==8&&(Us=Er(Us)),un=new_buf(30),un.write_shift(4,67324752),un.write_shift(2,20),un.write_shift(2,In),un.write_shift(2,Tn),ns.mt?nr(un,ns.mt):un.write_shift(4,0),un.write_shift(-4,ss[Kn]),un.write_shift(4,Us.length),un.write_shift(4,ns.content.length),un.write_shift(2,Ns.length),un.write_shift(2,0),Nn+=un.length,en.push(un),Nn+=Ns.length,en.push(Ns),Nn+=Us.length,en.push(Us),un=new_buf(46),un.write_shift(4,33639248),un.write_shift(2,0),un.write_shift(2,20),un.write_shift(2,In),un.write_shift(2,Tn),un.write_shift(4,0),un.write_shift(-4,ss[Kn]),un.write_shift(4,Us.length),un.write_shift(4,ns.content.length),un.write_shift(2,Ns.length),un.write_shift(2,0),un.write_shift(2,0),un.write_shift(2,0),un.write_shift(2,0),un.write_shift(4,0),un.write_shift(4,ks),Ss+=un.l,sn.push(un),Ss+=Ns.length,sn.push(Ns),++Kn}return un=new_buf(22),un.write_shift(4,101010256),un.write_shift(2,0),un.write_shift(2,0),un.write_shift(2,Kn),un.write_shift(2,Kn),un.write_shift(4,Ss),un.write_shift(4,Nn),un.write_shift(2,0),bconcat([bconcat(en),bconcat(sn),un])}var rs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function os(Jr,Yr){if(Jr.ctype)return Jr.ctype;var qr=Jr.name||"",en=qr.match(/\.([^\.]+)$/);return en&&rs[en[1]]||Yr&&(en=(qr=Yr).match(/[\.\\]([^\.\\])+$/),en&&rs[en[1]])?rs[en[1]]:"application/octet-stream"}function ms(Jr){for(var Yr=Base64_encode(Jr),qr=[],en=0;en<Yr.length;en+=76)qr.push(Yr.slice(en,en+76));return qr.join(`\r
`)+`\r
`}function bs(Jr){var Yr=Jr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(kn){var Nn=kn.charCodeAt(0).toString(16).toUpperCase();return"="+(Nn.length==1?"0"+Nn:Nn)});Yr=Yr.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Yr.charAt(0)==`
`&&(Yr="=0D"+Yr.slice(1)),Yr=Yr.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var qr=[],en=Yr.split(`\r
`),sn=0;sn<en.length;++sn){var un=en[sn];if(un.length==0){qr.push("");continue}for(var Tn=0;Tn<un.length;){var In=76,Fn=un.slice(Tn,Tn+In);Fn.charAt(In-1)=="="?In--:Fn.charAt(In-2)=="="?In-=2:Fn.charAt(In-3)=="="&&(In-=3),Fn=un.slice(Tn,Tn+In),Tn+=In,Tn<un.length&&(Fn+="="),qr.push(Fn)}}return qr.join(`\r
`)}function gn(Jr){for(var Yr=[],qr=0;qr<Jr.length;++qr){for(var en=Jr[qr];qr<=Jr.length&&en.charAt(en.length-1)=="=";)en=en.slice(0,en.length-1)+Jr[++qr];Yr.push(en)}for(var sn=0;sn<Yr.length;++sn)Yr[sn]=Yr[sn].replace(/[=][0-9A-Fa-f]{2}/g,function(un){return String.fromCharCode(parseInt(un.slice(1),16))});return s2a(Yr.join(`\r
`))}function pn(Jr,Yr,qr){for(var en="",sn="",un="",Tn,In=0;In<10;++In){var Fn=Yr[In];if(!Fn||Fn.match(/^\s*$/))break;var kn=Fn.match(/^(.*?):\s*([^\s].*)$/);if(kn)switch(kn[1].toLowerCase()){case"content-location":en=kn[2].trim();break;case"content-type":un=kn[2].trim();break;case"content-transfer-encoding":sn=kn[2].trim();break}}switch(++In,sn.toLowerCase()){case"base64":Tn=s2a(Base64_decode(Yr.slice(In).join("")));break;case"quoted-printable":Tn=gn(Yr.slice(In));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+sn)}var Nn=xa(Jr,en.slice(qr.length),Tn,{unsafe:!0});un&&(Nn.ctype=un)}function Pn(Jr,Yr){if(Rr(Jr.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var qr=Yr&&Yr.root||"",en=(has_buf&&Buffer.isBuffer(Jr)?Jr.toString("binary"):Rr(Jr)).split(`\r
`),sn=0,un="";for(sn=0;sn<en.length;++sn)if(un=en[sn],!!/^Content-Location:/i.test(un)&&(un=un.slice(un.indexOf("file")),qr||(qr=un.slice(0,un.lastIndexOf("/")+1)),un.slice(0,qr.length)!=qr))for(;qr.length>0&&(qr=qr.slice(0,qr.length-1),qr=qr.slice(0,qr.lastIndexOf("/")+1),un.slice(0,qr.length)!=qr););var Tn=(en[1]||"").match(/boundary="(.*?)"/);if(!Tn)throw new Error("MAD cannot find boundary");var In="--"+(Tn[1]||""),Fn=[],kn=[],Nn={FileIndex:Fn,FullPaths:kn};_r(Nn);var Kn,is=0;for(sn=0;sn<en.length;++sn){var ps=en[sn];ps!==In&&ps!==In+"--"||(is++&&pn(Nn,en.slice(Kn,sn),qr),Kn=sn)}return Nn}function Rn(Jr,Yr){var qr=Yr||{},en=qr.boundary||"SheetJS";en="------="+en;for(var sn=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+en.slice(2)+'"',"","",""],un=Jr.FullPaths[0],Tn=un,In=Jr.FileIndex[0],Fn=1;Fn<Jr.FullPaths.length;++Fn)if(Tn=Jr.FullPaths[Fn].slice(un.length),In=Jr.FileIndex[Fn],!(!In.size||!In.content||Tn=="Sh33tJ5")){Tn=Tn.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ss){return"_x"+Ss.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ss){return"_u"+Ss.charCodeAt(0).toString(16)+"_"});for(var kn=In.content,Nn=has_buf&&Buffer.isBuffer(kn)?kn.toString("binary"):Rr(kn),Kn=0,is=Math.min(1024,Nn.length),ps=0,ns=0;ns<=is;++ns)(ps=Nn.charCodeAt(ns))>=32&&ps<128&&++Kn;var ss=Kn>=is*4/5;sn.push(en),sn.push("Content-Location: "+(qr.root||"file:///C:/SheetJS/")+Tn),sn.push("Content-Transfer-Encoding: "+(ss?"quoted-printable":"base64")),sn.push("Content-Type: "+os(In,Tn)),sn.push(""),sn.push(ss?bs(Nn):ms(Nn))}return sn.push(en+`--\r
`),sn.join(`\r
`)}function Yn(Jr){var Yr={};return _r(Yr,Jr),Yr}function xa(Jr,Yr,qr,en){var sn=en&&en.unsafe;sn||_r(Jr);var un=!sn&&CFB.find(Jr,Yr);if(!un){var Tn=Jr.FullPaths[0];Yr.slice(0,Tn.length)==Tn?Tn=Yr:(Tn.slice(-1)!="/"&&(Tn+="/"),Tn=(Tn+Yr).replace("//","/")),un={name:rr(Yr),type:2},Jr.FileIndex.push(un),Jr.FullPaths.push(Tn),sn||CFB.utils.cfb_gc(Jr)}return un.content=qr,un.size=qr?qr.length:0,en&&(en.CLSID&&(un.clsid=en.CLSID),en.mt&&(un.mt=en.mt),en.ct&&(un.ct=en.ct)),un}function $a(Jr,Yr){_r(Jr);var qr=CFB.find(Jr,Yr);if(qr){for(var en=0;en<Jr.FileIndex.length;++en)if(Jr.FileIndex[en]==qr)return Jr.FileIndex.splice(en,1),Jr.FullPaths.splice(en,1),!0}return!1}function ys(Jr,Yr,qr){_r(Jr);var en=CFB.find(Jr,Yr);if(en){for(var sn=0;sn<Jr.FileIndex.length;++sn)if(Jr.FileIndex[sn]==en)return Jr.FileIndex[sn].name=rr(qr),Jr.FullPaths[sn]=qr,!0}return!1}function xs(Jr){Pr(Jr,!0)}return _e.find=wr,_e.read=Fr,_e.parse=lr,_e.write=Xr,_e.writeFile=Vr,_e.utils={cfb_new:Yn,cfb_add:xa,cfb_del:$a,cfb_mov:ys,cfb_gc:xs,ReadShift,CheckField,prep_blob,bconcat,use_zlib:yr,_deflateRaw:ls,_inflateRaw:cs,consts:Br},_e}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,_e,er){if(typeof Deno<"u"){if(er&&typeof _e=="string")switch(er){case"utf8":_e=new TextEncoder(er).encode(_e);break;case"binary":_e=s2ab(_e);break;default:throw new Error("Unsupported encoding "+er)}return Deno.writeFileSync(e,_e)}var tr=er=="utf8"?utf8write(_e):_e;if(typeof IE_SaveFile<"u")return IE_SaveFile(tr,e);if(typeof Blob<"u"){var rr=new Blob([blobify(tr)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(rr,e);if(typeof saveAs<"u")return saveAs(rr,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var nr=URL.createObjectURL(rr);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(nr)},6e4),chrome.downloads.download({url:nr,filename:e,saveAs:!0});var ir=document.createElement("a");if(ir.download!=null)return ir.download=e,ir.href=nr,document.body.appendChild(ir),ir.click(),document.body.removeChild(ir),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(nr)},6e4),nr}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var ar=File(e);return ar.open("w"),ar.encoding="binary",Array.isArray(_e)&&(_e=a2s(_e)),ar.write(_e),ar.close(),_e}catch(sr){if(!sr.message||!sr.message.match(/onstruct/))throw sr}throw new Error("cannot save file "+e)}function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var _e=File(e);_e.open("r"),_e.encoding="binary";var er=_e.read();return _e.close(),er}catch(tr){if(!tr.message||!tr.message.match(/onstruct/))throw tr}throw new Error("Cannot access file "+e)}function keys(e){for(var _e=Object.keys(e),er=[],tr=0;tr<_e.length;++tr)Object.prototype.hasOwnProperty.call(e,_e[tr])&&er.push(_e[tr]);return er}function evert_key(e,_e){for(var er=[],tr=keys(e),rr=0;rr!==tr.length;++rr)er[e[tr[rr]][_e]]==null&&(er[e[tr[rr]][_e]]=tr[rr]);return er}function evert(e){for(var _e=[],er=keys(e),tr=0;tr!==er.length;++tr)_e[e[er[tr]]]=er[tr];return _e}function evert_num(e){for(var _e=[],er=keys(e),tr=0;tr!==er.length;++tr)_e[e[er[tr]]]=parseInt(er[tr],10);return _e}function evert_arr(e){for(var _e=[],er=keys(e),tr=0;tr!==er.length;++tr)_e[e[er[tr]]]==null&&(_e[e[er[tr]]]=[]),_e[e[er[tr]]].push(er[tr]);return _e}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,_e){var er=e.getTime(),tr=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(er-tr)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var _e=new Date;return _e.setTime(e*24*60*60*1e3+dnthresh),_e.getTimezoneOffset()!==refoffset&&_e.setTime(_e.getTime()+(_e.getTimezoneOffset()-refoffset)*6e4),_e}function parse_isodur(e){var _e=0,er=0,tr=!1,rr=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!rr)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var nr=1;nr!=rr.length;++nr)if(rr[nr]){switch(er=1,nr>3&&(tr=!0),rr[nr].slice(rr[nr].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+rr[nr].slice(rr[nr].length-1));case"D":er*=24;case"H":er*=60;case"M":if(tr)er*=60;else throw new Error("Unsupported ISO Duration Field: M")}_e+=er*parseInt(rr[nr],10)}return _e}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,_e){var er=new Date(e);if(good_pd)return _e>0?er.setTime(er.getTime()+er.getTimezoneOffset()*60*1e3):_e<0&&er.setTime(er.getTime()-er.getTimezoneOffset()*60*1e3),er;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(er.getFullYear())){var tr=er.getFullYear();return e.indexOf(""+tr)>-1||er.setFullYear(er.getFullYear()+100),er}var rr=e.match(/\d+/g)||["2017","2","19","0","0","0"],nr=new Date(+rr[0],+rr[1]-1,+rr[2],+rr[3]||0,+rr[4]||0,+rr[5]||0);return e.indexOf("Z")>-1&&(nr=new Date(nr.getTime()-nr.getTimezoneOffset()*60*1e3)),nr}function cc2str(e,_e){if(has_buf&&Buffer.isBuffer(e)){if(_e){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(_e){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var er={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(nr){return er[nr]||nr})}catch{}for(var tr=[],rr=0;rr!=e.length;++rr)tr.push(String.fromCharCode(e[rr]));return tr.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var _e={};for(var er in e)Object.prototype.hasOwnProperty.call(e,er)&&(_e[er]=dup(e[er]));return _e}function fill(e,_e){for(var er="";er.length<_e;)er+=e;return er}function fuzzynum(e){var _e=Number(e);if(!isNaN(_e))return isFinite(_e)?_e:NaN;if(!/\d/.test(e))return _e;var er=1,tr=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return er*=100,""});return!isNaN(_e=Number(tr))||(tr=tr.replace(/[(](.*)[)]/,function(rr,nr){return er=-er,nr}),!isNaN(_e=Number(tr)))?_e/er:_e}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var _e=new Date(e),er=new Date(NaN),tr=_e.getYear(),rr=_e.getMonth(),nr=_e.getDate();if(isNaN(nr))return er;var ir=e.toLowerCase();if(ir.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(ir=ir.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),ir.length>3&&lower_months.indexOf(ir)==-1)return er}else if(ir.match(/[a-z]/))return er;return tr<0||tr>8099?er:(rr>0||nr>1)&&tr!=101?_e:e.match(/[^-0-9:,\/\\]/)?er:_e}var split_regex=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(er,tr,rr){if(e||typeof tr=="string")return er.split(tr);for(var nr=er.split(tr),ir=[nr[0]],ar=1;ar<nr.length;++ar)ir.push(rr),ir.push(nr[ar]);return ir}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var _e=e._data.getContent();return typeof _e=="string"?char_codes(_e):Array.prototype.slice.call(_e)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,_e){for(var er=e.FullPaths||keys(e.files),tr=_e.toLowerCase().replace(/[\/]/g,"\\"),rr=tr.replace(/\\/g,"/"),nr=0;nr<er.length;++nr){var ir=er[nr].replace(/^Root Entry[\/]/,"").toLowerCase();if(tr==ir||rr==ir)return e.files?e.files[er[nr]]:e.FileIndex[nr]}return null}function getzipfile(e,_e){var er=safegetzipfile(e,_e);if(er==null)throw new Error("Cannot find file "+_e+" in zip");return er}function getzipdata(e,_e,er){if(!er)return getdata(getzipfile(e,_e));if(!_e)return null;try{return getzipdata(e,_e)}catch{return null}}function getzipstr(e,_e,er){if(!er)return getdatastr(getzipfile(e,_e));if(!_e)return null;try{return getzipstr(e,_e)}catch{return null}}function getzipbin(e,_e,er){return getdatabin(getzipfile(e,_e))}function zipentries(e){for(var _e=e.FullPaths||keys(e.files),er=[],tr=0;tr<_e.length;++tr)_e[tr].slice(-1)!="/"&&er.push(_e[tr].replace(/^Root Entry[\/]/,""));return er.sort()}function zip_add_file(e,_e,er){if(e.FullPaths){if(typeof er=="string"){var tr;return has_buf?tr=Buffer_from(er):tr=utf8decode(er),CFB.utils.cfb_add(e,_e,tr)}CFB.utils.cfb_add(e,_e,er)}else e.file(_e,er)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(e,_e){switch(_e.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+_e.type)}function resolve_path(e,_e){if(e.charAt(0)=="/")return e.slice(1);var er=_e.split("/");_e.slice(-1)!="/"&&er.pop();for(var tr=e.split("/");tr.length!==0;){var rr=tr.shift();rr===".."?er.pop():rr!=="."&&er.push(rr)}return er.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,_e,er){for(var tr={},rr=0,nr=0;rr!==e.length&&!((nr=e.charCodeAt(rr))===32||nr===10||nr===13);++rr);if(_e||(tr[0]=e.slice(0,rr)),rr===e.length)return tr;var ir=e.match(attregexg),ar=0,sr="",or=0,lr="",ur="",fr=1;if(ir)for(or=0;or!=ir.length;++or){for(ur=ir[or],nr=0;nr!=ur.length&&ur.charCodeAt(nr)!==61;++nr);for(lr=ur.slice(0,nr).trim();ur.charCodeAt(nr+1)==32;)++nr;for(fr=(rr=ur.charCodeAt(nr+1))==34||rr==39?1:0,sr=ur.slice(nr+1+fr,ur.length-fr),ar=0;ar!=lr.length&&lr.charCodeAt(ar)!==58;++ar);if(ar===lr.length)lr.indexOf("_")>0&&(lr=lr.slice(0,lr.indexOf("_"))),tr[lr]=sr,tr[lr.toLowerCase()]=sr;else{var cr=(ar===5&&lr.slice(0,5)==="xmlns"?"xmlns":"")+lr.slice(ar+1);if(tr[cr]&&lr.slice(ar-3,ar)=="ext")continue;tr[cr]=sr,tr[cr.toLowerCase()]=sr}}return tr}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,_e=/_x([\da-fA-F]{4})_/ig;return function er(tr){var rr=tr+"",nr=rr.indexOf("<![CDATA[");if(nr==-1)return rr.replace(e,function(ar,sr){return encodings[ar]||String.fromCharCode(parseInt(sr,ar.indexOf("x")>-1?16:10))||ar}).replace(_e,function(ar,sr){return String.fromCharCode(parseInt(sr,16))});var ir=rr.indexOf("]]>");return er(rr.slice(0,nr))+rr.slice(nr+9,ir)+er(rr.slice(ir+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var _e=e+"";return _e.replace(decregex,function(er){return rencoding[er]}).replace(charegex,function(er){return"_x"+("000"+er.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var _e=e+"";return _e.replace(decregex,function(er){return rencoding[er]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(er){return"&#x"+("000"+er.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var _e=e+"";return _e.replace(decregex,function(er){return rencoding[er]}).replace(htmlcharegex,function(er){return"&#x"+er.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function _e(er,tr){return String.fromCharCode(parseInt(tr,10))}return function(tr){return tr.replace(e,_e)}}();function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var _e="",er=0,tr=0,rr=0,nr=0,ir=0,ar=0;er<e.length;){if(tr=e.charCodeAt(er++),tr<128){_e+=String.fromCharCode(tr);continue}if(rr=e.charCodeAt(er++),tr>191&&tr<224){ir=(tr&31)<<6,ir|=rr&63,_e+=String.fromCharCode(ir);continue}if(nr=e.charCodeAt(er++),tr<240){_e+=String.fromCharCode((tr&15)<<12|(rr&63)<<6|nr&63);continue}ir=e.charCodeAt(er++),ar=((tr&7)<<18|(rr&63)<<12|(nr&63)<<6|ir&63)-65536,_e+=String.fromCharCode(55296+(ar>>>10&1023)),_e+=String.fromCharCode(56320+(ar&1023))}return _e}function utf8readb(e){var _e=new_raw_buf(2*e.length),er,tr,rr=1,nr=0,ir=0,ar;for(tr=0;tr<e.length;tr+=rr)rr=1,(ar=e.charCodeAt(tr))<128?er=ar:ar<224?(er=(ar&31)*64+(e.charCodeAt(tr+1)&63),rr=2):ar<240?(er=(ar&15)*4096+(e.charCodeAt(tr+1)&63)*64+(e.charCodeAt(tr+2)&63),rr=3):(rr=4,er=(ar&7)*262144+(e.charCodeAt(tr+1)&63)*4096+(e.charCodeAt(tr+2)&63)*64+(e.charCodeAt(tr+3)&63),er-=65536,ir=55296+(er>>>10&1023),er=56320+(er&1023)),ir!==0&&(_e[nr++]=ir&255,_e[nr++]=ir>>>8,ir=0),_e[nr++]=er%256,_e[nr++]=er>>>8;return _e.slice(0,nr).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var _e=[],er=0,tr=0,rr=0;er<e.length;)switch(tr=e.charCodeAt(er++),!0){case tr<128:_e.push(String.fromCharCode(tr));break;case tr<2048:_e.push(String.fromCharCode(192+(tr>>6))),_e.push(String.fromCharCode(128+(tr&63)));break;case(tr>=55296&&tr<57344):tr-=55296,rr=e.charCodeAt(er++)-56320+(tr<<10),_e.push(String.fromCharCode(240+(rr>>18&7))),_e.push(String.fromCharCode(144+(rr>>12&63))),_e.push(String.fromCharCode(128+(rr>>6&63))),_e.push(String.fromCharCode(128+(rr&63)));break;default:_e.push(String.fromCharCode(224+(tr>>12))),_e.push(String.fromCharCode(128+(tr>>6&63))),_e.push(String.fromCharCode(128+(tr&63)))}return _e.join("")},matchtag=function(){var e={};return function(er,tr){var rr=er+"|"+(tr||"");return e[rr]?e[rr]:e[rr]=new RegExp("<(?:\\w+:)?"+er+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+er+">",tr||"")}}(),htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(_e){return[new RegExp("&"+_e[0]+";","ig"),_e[1]]});return function(er){for(var tr=er.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),rr=0;rr<e.length;++rr)tr=tr.replace(e[rr][0],e[rr][1]);return tr}}(),vtregex=function(){var e={};return function(er){return e[er]!==void 0?e[er]:e[er]=new RegExp("<(?:vt:)?"+er+">([\\s\\S]*?)</(?:vt:)?"+er+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,_e){var er=parsexmltag(e),tr=e.match(vtregex(er.baseType))||[],rr=[];if(tr.length!=er.size){if(_e.WTF)throw new Error("unexpected vector length "+tr.length+" != "+er.size);return rr}return tr.forEach(function(nr){var ir=nr.replace(vtvregex,"").match(vtmregex);ir&&rr.push({v:utf8read(ir[2]),t:ir[1]})}),rr}var wtregex=/(^\s|\s$|\n)/;function writetag(e,_e){return"<"+e+(_e.match(wtregex)?' xml:space="preserve"':"")+">"+_e+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(_e){return" "+_e+'="'+e[_e]+'"'}).join("")}function writextag(e,_e,er){return"<"+e+(er!=null?wxt_helper(er):"")+(_e!=null?(_e.match(wtregex)?' xml:space="preserve"':"")+">"+_e+"</"+e:"/")+">"}function write_w3cdtf(e,_e){try{return e.toISOString().replace(/\.\d*/,"")}catch(er){if(_e)throw er}return""}function write_vt(e,_e){switch(typeof e){case"string":var er=writextag("vt:lpwstr",escapexml(e));return er=er.replace(/&quot;/g,"_x0022_"),er;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,_e){for(var er=1-2*(e[_e+7]>>>7),tr=((e[_e+7]&127)<<4)+(e[_e+6]>>>4&15),rr=e[_e+6]&15,nr=5;nr>=0;--nr)rr=rr*256+e[_e+nr];return tr==2047?rr==0?er*(1/0):NaN:(tr==0?tr=-1022:(tr-=1023,rr+=Math.pow(2,52)),er*Math.pow(2,tr-52)*rr)}function write_double_le(e,_e,er){var tr=(_e<0||1/_e==-1/0?1:0)<<7,rr=0,nr=0,ir=tr?-_e:_e;isFinite(ir)?ir==0?rr=nr=0:(rr=Math.floor(Math.log(ir)/Math.LN2),nr=ir*Math.pow(2,52-rr),rr<=-1023&&(!isFinite(nr)||nr<Math.pow(2,52))?rr=-1022:(nr-=Math.pow(2,52),rr+=1023)):(rr=2047,nr=isNaN(_e)?26985:0);for(var ar=0;ar<=5;++ar,nr/=256)e[er+ar]=nr&255;e[er+6]=(rr&15)<<4|nr&15,e[er+7]=rr>>4|tr}var ___toBuffer=function(e){for(var _e=[],er=10240,tr=0;tr<e[0].length;++tr)if(e[0][tr])for(var rr=0,nr=e[0][tr].length;rr<nr;rr+=er)_e.push.apply(_e,e[0][tr].slice(rr,rr+er));return _e},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(_e){return Buffer.isBuffer(_e)?_e:Buffer_from(_e)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,_e,er){for(var tr=[],rr=_e;rr<er;rr+=2)tr.push(String.fromCharCode(__readUInt16LE(e,rr)));return tr.join("").replace(chr0,"")},__utf16le=has_buf?function(e,_e,er){return Buffer.isBuffer(e)?e.toString("utf16le",_e,er).replace(chr0,""):___utf16le(e,_e,er)}:___utf16le,___hexlify=function(e,_e,er){for(var tr=[],rr=_e;rr<_e+er;++rr)tr.push(("0"+e[rr].toString(16)).slice(-2));return tr.join("")},__hexlify=has_buf?function(e,_e,er){return Buffer.isBuffer(e)?e.toString("hex",_e,_e+er):___hexlify(e,_e,er)}:___hexlify,___utf8=function(e,_e,er){for(var tr=[],rr=_e;rr<er;rr++)tr.push(String.fromCharCode(__readUInt8(e,rr)));return tr.join("")},__utf8=has_buf?function e(_e,er,tr){return Buffer.isBuffer(_e)?_e.toString("utf8",er,tr):___utf8(_e,er,tr)}:___utf8,___lpstr=function(e,_e){var er=__readUInt32LE(e,_e);return er>0?__utf8(e,_e+4,_e+4+er-1):""},__lpstr=___lpstr,___cpstr=function(e,_e){var er=__readUInt32LE(e,_e);return er>0?__utf8(e,_e+4,_e+4+er-1):""},__cpstr=___cpstr,___lpwstr=function(e,_e){var er=2*__readUInt32LE(e,_e);return er>0?__utf8(e,_e+4,_e+4+er-1):""},__lpwstr=___lpwstr,___lpp4=function e(_e,er){var tr=__readUInt32LE(_e,er);return tr>0?__utf16le(_e,er+4,er+4+tr):""},__lpp4=___lpp4,___8lpp4=function(e,_e){var er=__readUInt32LE(e,_e);return er>0?__utf8(e,_e+4,_e+4+er):""},__8lpp4=___8lpp4,___double=function(e,_e){return read_double_le(e,_e)},__double=___double,is_buf=function e(_e){return Array.isArray(_e)||typeof Uint8Array<"u"&&_e instanceof Uint8Array};has_buf&&(__lpstr=function(_e,er){if(!Buffer.isBuffer(_e))return ___lpstr(_e,er);var tr=_e.readUInt32LE(er);return tr>0?_e.toString("utf8",er+4,er+4+tr-1):""},__cpstr=function(_e,er){if(!Buffer.isBuffer(_e))return ___cpstr(_e,er);var tr=_e.readUInt32LE(er);return tr>0?_e.toString("utf8",er+4,er+4+tr-1):""},__lpwstr=function(_e,er){if(!Buffer.isBuffer(_e))return ___lpwstr(_e,er);var tr=2*_e.readUInt32LE(er);return _e.toString("utf16le",er+4,er+4+tr-1)},__lpp4=function(_e,er){if(!Buffer.isBuffer(_e))return ___lpp4(_e,er);var tr=_e.readUInt32LE(er);return _e.toString("utf16le",er+4,er+4+tr)},__8lpp4=function(_e,er){if(!Buffer.isBuffer(_e))return ___8lpp4(_e,er);var tr=_e.readUInt32LE(er);return _e.toString("utf8",er+4,er+4+tr)},__double=function(_e,er){return Buffer.isBuffer(_e)?_e.readDoubleLE(er):___double(_e,er)},is_buf=function(_e){return Buffer.isBuffer(_e)||Array.isArray(_e)||typeof Uint8Array<"u"&&_e instanceof Uint8Array});var __readUInt8=function(e,_e){return e[_e]},__readUInt16LE=function(e,_e){return e[_e+1]*256+e[_e]},__readInt16LE=function(e,_e){var er=e[_e+1]*256+e[_e];return er<32768?er:(65535-er+1)*-1},__readUInt32LE=function(e,_e){return e[_e+3]*(1<<24)+(e[_e+2]<<16)+(e[_e+1]<<8)+e[_e]},__readInt32LE=function(e,_e){return e[_e+3]<<24|e[_e+2]<<16|e[_e+1]<<8|e[_e]},__readInt32BE=function(e,_e){return e[_e]<<24|e[_e+1]<<16|e[_e+2]<<8|e[_e+3]};function ReadShift(e,_e){var er="",tr,rr,nr=[],ir,ar,sr,or;switch(_e){case"dbcs":if(or=this.l,has_buf&&Buffer.isBuffer(this))er=this.slice(this.l,this.l+2*e).toString("utf16le");else for(sr=0;sr<e;++sr)er+=String.fromCharCode(__readUInt16LE(this,or)),or+=2;e*=2;break;case"utf8":er=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,er=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":er=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":er=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":er=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),er=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),er=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,er="";(ir=__readUInt8(this,this.l+e++))!==0;)nr.push(_getchar(ir));er=nr.join("");break;case"_wstr":for(e=0,er="";(ir=__readUInt16LE(this,this.l+e))!==0;)nr.push(_getchar(ir)),e+=2;e+=2,er=nr.join("");break;case"dbcs-cont":for(er="",or=this.l,sr=0;sr<e;++sr){if(this.lens&&this.lens.indexOf(or)!==-1)return ir=__readUInt8(this,or),this.l=or+1,ar=ReadShift.call(this,e-sr,ir?"dbcs-cont":"sbcs-cont"),nr.join("")+ar;nr.push(_getchar(__readUInt16LE(this,or))),or+=2}er=nr.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(er="",or=this.l,sr=0;sr!=e;++sr){if(this.lens&&this.lens.indexOf(or)!==-1)return ir=__readUInt8(this,or),this.l=or+1,ar=ReadShift.call(this,e-sr,ir?"dbcs-cont":"sbcs-cont"),nr.join("")+ar;nr.push(_getchar(__readUInt8(this,or))),or+=1}er=nr.join("");break;default:switch(e){case 1:return tr=__readUInt8(this,this.l),this.l++,tr;case 2:return tr=(_e==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,tr;case 4:case-4:return _e==="i"||!(this[this.l+3]&128)?(tr=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,tr):(rr=__readUInt32LE(this,this.l),this.l+=4,rr);case 8:case-8:if(_e==="f")return e==8?rr=__double(this,this.l):rr=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,rr;e=8;case 16:er=__hexlify(this,this.l,e);break}}return this.l+=e,er}var __writeUInt32LE=function(e,_e,er){e[er]=_e&255,e[er+1]=_e>>>8&255,e[er+2]=_e>>>16&255,e[er+3]=_e>>>24&255},__writeInt32LE=function(e,_e,er){e[er]=_e&255,e[er+1]=_e>>8&255,e[er+2]=_e>>16&255,e[er+3]=_e>>24&255},__writeUInt16LE=function(e,_e,er){e[er]=_e&255,e[er+1]=_e>>>8&255};function WriteShift(e,_e,er){var tr=0,rr=0;if(er==="dbcs"){for(rr=0;rr!=_e.length;++rr)__writeUInt16LE(this,_e.charCodeAt(rr),this.l+2*rr);tr=2*_e.length}else if(er==="sbcs"){for(_e=_e.replace(/[^\x00-\x7F]/g,"_"),rr=0;rr!=_e.length;++rr)this[this.l+rr]=_e.charCodeAt(rr)&255;tr=_e.length}else if(er==="hex"){for(;rr<e;++rr)this[this.l++]=parseInt(_e.slice(2*rr,2*rr+2),16)||0;return this}else if(er==="utf16le"){var nr=Math.min(this.l+e,this.length);for(rr=0;rr<Math.min(_e.length,e);++rr){var ir=_e.charCodeAt(rr);this[this.l++]=ir&255,this[this.l++]=ir>>8}for(;this.l<nr;)this[this.l++]=0;return this}else switch(e){case 1:tr=1,this[this.l]=_e&255;break;case 2:tr=2,this[this.l]=_e&255,_e>>>=8,this[this.l+1]=_e&255;break;case 3:tr=3,this[this.l]=_e&255,_e>>>=8,this[this.l+1]=_e&255,_e>>>=8,this[this.l+2]=_e&255;break;case 4:tr=4,__writeUInt32LE(this,_e,this.l);break;case 8:if(tr=8,er==="f"){write_double_le(this,_e,this.l);break}case 16:break;case-4:tr=4,__writeInt32LE(this,_e,this.l);break}return this.l+=tr,this}function CheckField(e,_e){var er=__hexlify(this,this.l,e.length>>1);if(er!==e)throw new Error(_e+"Expected "+e+" saw "+er);this.l+=e.length>>1}function prep_blob(e,_e){e.l=_e,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,_e){e.l+=_e}function new_buf(e){var _e=new_raw_buf(e);return prep_blob(_e,0),_e}function recordhopper(e,_e,er){if(e){var tr,rr,nr;prep_blob(e,e.l||0);for(var ir=e.length,ar=0,sr=0;e.l<ir;){ar=e.read_shift(1),ar&128&&(ar=(ar&127)+((e.read_shift(1)&127)<<7));var or=XLSBRecordEnum[ar]||XLSBRecordEnum[65535];for(tr=e.read_shift(1),nr=tr&127,rr=1;rr<4&&tr&128;++rr)nr+=((tr=e.read_shift(1))&127)<<7*rr;sr=e.l+nr;var lr=or.f&&or.f(e,nr,er);if(e.l=sr,_e(lr,or,ar))return}}}function buf_array(){var e=[],_e=has_buf?256:2048,er=function(or){var lr=new_buf(or);return prep_blob(lr,0),lr},tr=er(_e),rr=function(){tr&&(tr.length>tr.l&&(tr=tr.slice(0,tr.l),tr.l=tr.length),tr.length>0&&e.push(tr),tr=null)},nr=function(or){return tr&&or<tr.length-tr.l?tr:(rr(),tr=er(Math.max(or+1,_e)))},ir=function(){return rr(),bconcat(e)},ar=function(or){rr(),tr=or,tr.l==null&&(tr.l=tr.length),nr(_e)};return{next:nr,push:ar,end:ir,_bufs:e}}function write_record(e,_e,er,tr){var rr=+_e,nr;if(!isNaN(rr)){tr||(tr=XLSBRecordEnum[rr].p||(er||[]).length||0),nr=1+(rr>=128?1:0)+1,tr>=128&&++nr,tr>=16384&&++nr,tr>=2097152&&++nr;var ir=e.next(nr);rr<=127?ir.write_shift(1,rr):(ir.write_shift(1,(rr&127)+128),ir.write_shift(1,rr>>7));for(var ar=0;ar!=4;++ar)if(tr>=128)ir.write_shift(1,(tr&127)+128),tr>>=7;else{ir.write_shift(1,tr);break}tr>0&&is_buf(er)&&e.push(er)}}function shift_cell_xls(e,_e,er){var tr=dup(e);if(_e.s?(tr.cRel&&(tr.c+=_e.s.c),tr.rRel&&(tr.r+=_e.s.r)):(tr.cRel&&(tr.c+=_e.c),tr.rRel&&(tr.r+=_e.r)),!er||er.biff<12){for(;tr.c>=256;)tr.c-=256;for(;tr.r>=65536;)tr.r-=65536}return tr}function shift_range_xls(e,_e,er){var tr=dup(e);return tr.s=shift_cell_xls(tr.s,_e.s,er),tr.e=shift_cell_xls(tr.e,_e.s,er),tr}function encode_cell_xls(e,_e){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=_e>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=_e>8?1048576:_e>5?65536:16384;var er=encode_cell(e);return!e.cRel&&e.cRel!=null&&(er=fix_col(er)),!e.rRel&&e.rRel!=null&&(er=fix_row(er)),er}function encode_range_xls(e,_e){return e.s.r==0&&!e.s.rRel&&e.e.r==(_e.biff>=12?1048575:_e.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(_e.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,_e.biff)+":"+encode_cell_xls(e.e,_e.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var _e=unfix_col(e),er=0,tr=0;tr!==_e.length;++tr)er=26*er+_e.charCodeAt(tr)-64;return er-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var _e="";for(++e;e;e=Math.floor((e-1)/26))_e=String.fromCharCode((e-1)%26+65)+_e;return _e}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var _e=0,er=0,tr=0;tr<e.length;++tr){var rr=e.charCodeAt(tr);rr>=48&&rr<=57?_e=10*_e+(rr-48):rr>=65&&rr<=90&&(er=26*er+(rr-64))}return{c:er-1,r:_e-1}}function encode_cell(e){for(var _e=e.c+1,er="";_e;_e=(_e-1)/26|0)er=String.fromCharCode((_e-1)%26+65)+er;return er+(e.r+1)}function decode_range(e){var _e=e.indexOf(":");return _e==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,_e)),e:decode_cell(e.slice(_e+1))}}function encode_range(e,_e){return typeof _e>"u"||typeof _e=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof _e!="string"&&(_e=encode_cell(_e)),e==_e?e:e+":"+_e)}function safe_decode_range(e){var _e={s:{c:0,r:0},e:{c:0,r:0}},er=0,tr=0,rr=0,nr=e.length;for(er=0;tr<nr&&!((rr=e.charCodeAt(tr)-64)<1||rr>26);++tr)er=26*er+rr;for(_e.s.c=--er,er=0;tr<nr&&!((rr=e.charCodeAt(tr)-48)<0||rr>9);++tr)er=10*er+rr;if(_e.s.r=--er,tr===nr||rr!=10)return _e.e.c=_e.s.c,_e.e.r=_e.s.r,_e;for(++tr,er=0;tr!=nr&&!((rr=e.charCodeAt(tr)-64)<1||rr>26);++tr)er=26*er+rr;for(_e.e.c=--er,er=0;tr!=nr&&!((rr=e.charCodeAt(tr)-48)<0||rr>9);++tr)er=10*er+rr;return _e.e.r=--er,_e}function safe_format_cell(e,_e){var er=e.t=="d"&&_e instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,er?datenum(_e):_e)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(er?14:0),er?datenum(_e):_e)}catch{return""+_e}}function format_cell(e,_e,er){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&er&&er.dateNF&&(e.z=er.dateNF),e.t=="e"?BErr[e.v]||e.v:_e==null?safe_format_cell(e,e.v):safe_format_cell(e,_e))}function sheet_to_workbook(e,_e){var er=_e&&_e.sheet?_e.sheet:"Sheet1",tr={};return tr[er]=e,{SheetNames:[er],Sheets:tr}}function sheet_add_aoa(e,_e,er){var tr=er||{},rr=e?Array.isArray(e):tr.dense,nr=e||(rr?[]:{}),ir=0,ar=0;if(nr&&tr.origin!=null){if(typeof tr.origin=="number")ir=tr.origin;else{var sr=typeof tr.origin=="string"?decode_cell(tr.origin):tr.origin;ir=sr.r,ar=sr.c}nr["!ref"]||(nr["!ref"]="A1:A1")}var or={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(nr["!ref"]){var lr=safe_decode_range(nr["!ref"]);or.s.c=lr.s.c,or.s.r=lr.s.r,or.e.c=Math.max(or.e.c,lr.e.c),or.e.r=Math.max(or.e.r,lr.e.r),ir==-1&&(or.e.r=ir=lr.e.r+1)}for(var ur=0;ur!=_e.length;++ur)if(_e[ur]){if(!Array.isArray(_e[ur]))throw new Error("aoa_to_sheet expects an array of arrays");for(var fr=0;fr!=_e[ur].length;++fr)if(!(typeof _e[ur][fr]>"u")){var cr={v:_e[ur][fr]},mr=ir+ur,dr=ar+fr;if(or.s.r>mr&&(or.s.r=mr),or.s.c>dr&&(or.s.c=dr),or.e.r<mr&&(or.e.r=mr),or.e.c<dr&&(or.e.c=dr),_e[ur][fr]&&typeof _e[ur][fr]=="object"&&!Array.isArray(_e[ur][fr])&&!(_e[ur][fr]instanceof Date))cr=_e[ur][fr];else if(Array.isArray(cr.v)&&(cr.f=_e[ur][fr][1],cr.v=cr.v[0]),cr.v===null)if(cr.f)cr.t="n";else if(tr.nullError)cr.t="e",cr.v=0;else if(tr.sheetStubs)cr.t="z";else continue;else typeof cr.v=="number"?cr.t="n":typeof cr.v=="boolean"?cr.t="b":cr.v instanceof Date?(cr.z=tr.dateNF||table_fmt[14],tr.cellDates?(cr.t="d",cr.w=SSF_format(cr.z,datenum(cr.v))):(cr.t="n",cr.v=datenum(cr.v),cr.w=SSF_format(cr.z,cr.v))):cr.t="s";if(rr)nr[mr]||(nr[mr]=[]),nr[mr][dr]&&nr[mr][dr].z&&(cr.z=nr[mr][dr].z),nr[mr][dr]=cr;else{var xr=encode_cell({c:dr,r:mr});nr[xr]&&nr[xr].z&&(cr.z=nr[xr].z),nr[xr]=cr}}}return or.s.c<1e7&&(nr["!ref"]=encode_range(or)),nr}function aoa_to_sheet(e,_e){return sheet_add_aoa(null,e,_e)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,_e){return _e||(_e=new_buf(4)),_e.write_shift(4,e),_e}function parse_XLWideString(e){var _e=e.read_shift(4);return _e===0?"":e.read_shift(_e,"dbcs")}function write_XLWideString(e,_e){var er=!1;return _e==null&&(er=!0,_e=new_buf(4+2*e.length)),_e.write_shift(4,e.length),e.length>0&&_e.write_shift(0,e,"dbcs"),er?_e.slice(0,_e.l):_e}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,_e){return _e||(_e=new_buf(4)),_e.write_shift(2,0),_e.write_shift(2,0),_e}function parse_RichStr(e,_e){var er=e.l,tr=e.read_shift(1),rr=parse_XLWideString(e),nr=[],ir={t:rr,h:rr};if(tr&1){for(var ar=e.read_shift(4),sr=0;sr!=ar;++sr)nr.push(parse_StrRun(e));ir.r=nr}else ir.r=[{ich:0,ifnt:0}];return e.l=er+_e,ir}function write_RichStr(e,_e){var er=!1;return _e==null&&(er=!0,_e=new_buf(15+4*e.t.length)),_e.write_shift(1,0),write_XLWideString(e.t,_e),er?_e.slice(0,_e.l):_e}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,_e){var er=!1;return _e==null&&(er=!0,_e=new_buf(23+4*e.t.length)),_e.write_shift(1,1),write_XLWideString(e.t,_e),_e.write_shift(4,1),write_StrRun({},_e),er?_e.slice(0,_e.l):_e}function parse_XLSBCell(e){var _e=e.read_shift(4),er=e.read_shift(2);return er+=e.read_shift(1)<<16,e.l++,{c:_e,iStyleRef:er}}function write_XLSBCell(e,_e){return _e==null&&(_e=new_buf(8)),_e.write_shift(-4,e.c),_e.write_shift(3,e.iStyleRef||e.s),_e.write_shift(1,0),_e}function parse_XLSBShortCell(e){var _e=e.read_shift(2);return _e+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:_e}}function write_XLSBShortCell(e,_e){return _e==null&&(_e=new_buf(4)),_e.write_shift(3,e.iStyleRef||e.s),_e.write_shift(1,0),_e}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var _e=e.read_shift(4);return _e===0||_e===4294967295?"":e.read_shift(_e,"dbcs")}function write_XLNullableWideString(e,_e){var er=!1;return _e==null&&(er=!0,_e=new_buf(127)),_e.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&_e.write_shift(0,e,"dbcs"),er?_e.slice(0,_e.l):_e}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var _e=e.slice(e.l,e.l+4),er=_e[0]&1,tr=_e[0]&2;e.l+=4;var rr=tr===0?__double([0,0,0,0,_e[0]&252,_e[1],_e[2],_e[3]],0):__readInt32LE(_e,0)>>2;return er?rr/100:rr}function write_RkNumber(e,_e){_e==null&&(_e=new_buf(4));var er=0,tr=0,rr=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?tr=1:rr==(rr|0)&&rr>=-536870912&&rr<1<<29&&(tr=1,er=1),tr)_e.write_shift(-4,((er?rr:e)<<2)+(er+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var _e={s:{},e:{}};return _e.s.r=e.read_shift(4),_e.e.r=e.read_shift(4),_e.s.c=e.read_shift(4),_e.e.c=e.read_shift(4),_e}function write_RfX(e,_e){return _e||(_e=new_buf(16)),_e.write_shift(4,e.s.r),_e.write_shift(4,e.e.r),_e.write_shift(4,e.s.c),_e.write_shift(4,e.e.c),_e}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,_e){return(_e||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var _e={},er=e.read_shift(1),tr=er>>>1,rr=e.read_shift(1),nr=e.read_shift(2,"i"),ir=e.read_shift(1),ar=e.read_shift(1),sr=e.read_shift(1);switch(e.l++,tr){case 0:_e.auto=1;break;case 1:_e.index=rr;var or=XLSIcv[rr];or&&(_e.rgb=rgb2Hex(or));break;case 2:_e.rgb=rgb2Hex([ir,ar,sr]);break;case 3:_e.theme=rr;break}return nr!=0&&(_e.tint=nr>0?nr/32767:nr/32768),_e}function write_BrtColor(e,_e){if(_e||(_e=new_buf(8)),!e||e.auto)return _e.write_shift(4,0),_e.write_shift(4,0),_e;e.index!=null?(_e.write_shift(1,2),_e.write_shift(1,e.index)):e.theme!=null?(_e.write_shift(1,6),_e.write_shift(1,e.theme)):(_e.write_shift(1,5),_e.write_shift(1,0));var er=e.tint||0;if(er>0?er*=32767:er<0&&(er*=32768),_e.write_shift(2,er),!e.rgb||e.theme!=null)_e.write_shift(2,0),_e.write_shift(1,0),_e.write_shift(1,0);else{var tr=e.rgb||"FFFFFF";typeof tr=="number"&&(tr=("000000"+tr.toString(16)).slice(-6)),_e.write_shift(1,parseInt(tr.slice(0,2),16)),_e.write_shift(1,parseInt(tr.slice(2,4),16)),_e.write_shift(1,parseInt(tr.slice(4,6),16)),_e.write_shift(1,255)}return _e}function parse_FontFlags(e){var _e=e.read_shift(1);e.l++;var er={fBold:_e&1,fItalic:_e&2,fUnderline:_e&4,fStrikeout:_e&8,fOutline:_e&16,fShadow:_e&32,fCondense:_e&64,fExtend:_e&128};return er}function write_FontFlags(e,_e){_e||(_e=new_buf(2));var er=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return _e.write_shift(1,er),_e.write_shift(1,0),_e}function parse_ClipboardFormatOrString(e,_e){var er={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},tr=e.read_shift(4);switch(tr){case 0:return"";case 4294967295:case 4294967294:return er[e.read_shift(4)]||""}if(tr>400)throw new Error("Unsupported Clipboard: "+tr.toString(16));return e.l-=4,e.read_shift(0,_e==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(_e){return[_e>>16&255,_e>>8&255,_e&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var _e=new_ct();if(!e||!e.match)return _e;var er={};if((e.match(tagregex)||[]).forEach(function(tr){var rr=parsexmltag(tr);switch(rr[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":_e.xmlns=rr["xmlns"+(rr[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":er[rr.Extension]=rr.ContentType;break;case"<Override":_e[ct2type[rr.ContentType]]!==void 0&&_e[ct2type[rr.ContentType]].push(rr.PartName);break}}),_e.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+_e.xmlns);return _e.calcchain=_e.calcchains.length>0?_e.calcchains[0]:"",_e.sst=_e.strs.length>0?_e.strs[0]:"",_e.style=_e.styles.length>0?_e.styles[0]:"",_e.defaults=er,delete _e.calcchains,_e}function write_ct(e,_e){var er=evert_arr(ct2type),tr=[],rr;tr[tr.length]=XML_HEADER,tr[tr.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),tr=tr.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(sr){return writextag("Default",null,{Extension:sr[0],ContentType:sr[1]})}));var nr=function(sr){e[sr]&&e[sr].length>0&&(rr=e[sr][0],tr[tr.length]=writextag("Override",null,{PartName:(rr[0]=="/"?"":"/")+rr,ContentType:CT_LIST[sr][_e.bookType]||CT_LIST[sr].xlsx}))},ir=function(sr){(e[sr]||[]).forEach(function(or){tr[tr.length]=writextag("Override",null,{PartName:(or[0]=="/"?"":"/")+or,ContentType:CT_LIST[sr][_e.bookType]||CT_LIST[sr].xlsx})})},ar=function(sr){(e[sr]||[]).forEach(function(or){tr[tr.length]=writextag("Override",null,{PartName:(or[0]=="/"?"":"/")+or,ContentType:er[sr][0]})})};return nr("workbooks"),ir("sheets"),ir("charts"),ar("themes"),["strs","styles"].forEach(nr),["coreprops","extprops","custprops"].forEach(ar),ar("vba"),ar("comments"),ar("threadedcomments"),ar("drawings"),ir("metadata"),ar("people"),tr.length>2&&(tr[tr.length]="</Types>",tr[1]=tr[1].replace("/>",">")),tr.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var _e=e.lastIndexOf("/");return e.slice(0,_e+1)+"_rels/"+e.slice(_e+1)+".rels"}function parse_rels(e,_e){var er={"!id":{}};if(!e)return er;_e.charAt(0)!=="/"&&(_e="/"+_e);var tr={};return(e.match(tagregex)||[]).forEach(function(rr){var nr=parsexmltag(rr);if(nr[0]==="<Relationship"){var ir={};ir.Type=nr.Type,ir.Target=nr.Target,ir.Id=nr.Id,nr.TargetMode&&(ir.TargetMode=nr.TargetMode);var ar=nr.TargetMode==="External"?nr.Target:resolve_path(nr.Target,_e);er[ar]=ir,tr[nr.Id]=ir}}),er["!id"]=tr,er}function write_rels(e){var _e=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(er){_e[_e.length]=writextag("Relationship",null,e["!id"][er])}),_e.length>2&&(_e[_e.length]="</Relationships>",_e[1]=_e[1].replace("/>",">")),_e.join("")}function add_rels(e,_e,er,tr,rr,nr){if(rr||(rr={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),_e<0)for(_e=e["!idx"];e["!id"]["rId"+_e];++_e);if(e["!idx"]=_e+1,rr.Id="rId"+_e,rr.Type=tr,rr.Target=er,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(rr.Type)>-1&&(rr.TargetMode="External"),e["!id"][rr.Id])throw new Error("Cannot rewrite rId "+_e);return e["!id"][rr.Id]=rr,e[("/"+rr.Target).replace("//","/")]=rr,_e}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,_e){for(var er=xlml_normalize(e),tr,rr;tr=xlmlregex.exec(er);)switch(tr[3]){case"manifest":break;case"file-entry":if(rr=parsexmltag(tr[0],!1),rr.path=="/"&&rr.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(_e&&_e.WTF)throw tr}}function write_manifest(e){var _e=[XML_HEADER];_e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),_e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var er=0;er<e.length;++er)_e.push('  <manifest:file-entry manifest:full-path="'+e[er][0]+'" manifest:media-type="'+e[er][1]+`"/>
`);return _e.push("</manifest:manifest>"),_e.join("")}function write_rdf_type(e,_e,er){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(er||"odf")+"#"+_e+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,_e){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+_e+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var _e=[XML_HEADER];_e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var er=0;er!=e.length;++er)_e.push(write_rdf_type(e[er][0],e[er][1])),_e.push(write_rdf_has("",e[er][0]));return _e.push(write_rdf_type("","Document","pkg")),_e.push("</rdf:RDF>"),_e.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var e=new Array(CORE_PROPS.length),_e=0;_e<CORE_PROPS.length;++_e){var er=CORE_PROPS[_e],tr="(?:"+er[0].slice(0,er[0].indexOf(":"))+":)"+er[0].slice(er[0].indexOf(":")+1);e[_e]=new RegExp("<"+tr+"[^>]*>([\\s\\S]*?)</"+tr+">")}return e}();function parse_core_props(e){var _e={};e=utf8read(e);for(var er=0;er<CORE_PROPS.length;++er){var tr=CORE_PROPS[er],rr=e.match(CORE_PROPS_REGEX[er]);rr!=null&&rr.length>0&&(_e[tr[1]]=unescapexml(rr[1])),tr[2]==="date"&&_e[tr[1]]&&(_e[tr[1]]=parseDate(_e[tr[1]]))}return _e}function cp_doit(e,_e,er,tr,rr){rr[e]!=null||_e==null||_e===""||(rr[e]=_e,_e=escapexml(_e),tr[tr.length]=er?writextag(e,_e,er):writetag(e,_e))}function write_core_props(e,_e){var er=_e||{},tr=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],rr={};if(!e&&!er.Props)return tr.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,er.WTF),{"xsi:type":"dcterms:W3CDTF"},tr,rr),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,er.WTF),{"xsi:type":"dcterms:W3CDTF"},tr,rr));for(var nr=0;nr!=CORE_PROPS.length;++nr){var ir=CORE_PROPS[nr],ar=er.Props&&er.Props[ir[1]]!=null?er.Props[ir[1]]:e?e[ir[1]]:null;ar===!0?ar="1":ar===!1?ar="0":typeof ar=="number"&&(ar=String(ar)),ar!=null&&cp_doit(ir[0],ar,null,tr,rr)}return tr.length>2&&(tr[tr.length]="</cp:coreProperties>",tr[1]=tr[1].replace("/>",">")),tr.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(e,_e,er,tr){var rr=[];if(typeof e=="string")rr=parseVector(e,tr);else for(var nr=0;nr<e.length;++nr)rr=rr.concat(e[nr].map(function(lr){return{v:lr}}));var ir=typeof _e=="string"?parseVector(_e,tr).map(function(lr){return lr.v}):_e,ar=0,sr=0;if(ir.length>0)for(var or=0;or!==rr.length;or+=2){switch(sr=+rr[or+1].v,rr[or].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":er.Worksheets=sr,er.SheetNames=ir.slice(ar,ar+sr);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":er.NamedRanges=sr,er.DefinedNames=ir.slice(ar,ar+sr);break;case"Charts":case"Diagramme":er.Chartsheets=sr,er.ChartNames=ir.slice(ar,ar+sr);break}ar+=sr}}function parse_ext_props(e,_e,er){var tr={};return _e||(_e={}),e=utf8read(e),EXT_PROPS.forEach(function(rr){var nr=(e.match(matchtag(rr[0]))||[])[1];switch(rr[2]){case"string":nr&&(_e[rr[1]]=unescapexml(nr));break;case"bool":_e[rr[1]]=nr==="true";break;case"raw":var ir=e.match(new RegExp("<"+rr[0]+"[^>]*>([\\s\\S]*?)</"+rr[0]+">"));ir&&ir.length>0&&(tr[rr[1]]=ir[1]);break}}),tr.HeadingPairs&&tr.TitlesOfParts&&load_props_pairs(tr.HeadingPairs,tr.TitlesOfParts,_e,er),_e}function write_ext_props(e){var _e=[],er=writextag;return e||(e={}),e.Application="SheetJS",_e[_e.length]=XML_HEADER,_e[_e.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(tr){if(e[tr[1]]!==void 0){var rr;switch(tr[2]){case"string":rr=escapexml(String(e[tr[1]]));break;case"bool":rr=e[tr[1]]?"true":"false";break}rr!==void 0&&(_e[_e.length]=er(tr[0],rr))}}),_e[_e.length]=er("HeadingPairs",er("vt:vector",er("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+er("vt:variant",er("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),_e[_e.length]=er("TitlesOfParts",er("vt:vector",e.SheetNames.map(function(tr){return"<vt:lpstr>"+escapexml(tr)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),_e.length>2&&(_e[_e.length]="</Properties>",_e[1]=_e[1].replace("/>",">")),_e.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,_e){var er={},tr="",rr=e.match(custregex);if(rr)for(var nr=0;nr!=rr.length;++nr){var ir=rr[nr],ar=parsexmltag(ir);switch(ar[0]){case"<?xml":break;case"<Properties":break;case"<property":tr=unescapexml(ar.name);break;case"</property>":tr=null;break;default:if(ir.indexOf("<vt:")===0){var sr=ir.split(">"),or=sr[0].slice(4),lr=sr[1];switch(or){case"lpstr":case"bstr":case"lpwstr":er[tr]=unescapexml(lr);break;case"bool":er[tr]=parsexmlbool(lr);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":er[tr]=parseInt(lr,10);break;case"r4":case"r8":case"decimal":er[tr]=parseFloat(lr);break;case"filetime":case"date":er[tr]=parseDate(lr);break;case"cy":case"error":er[tr]=unescapexml(lr);break;default:if(or.slice(-1)=="/")break;_e.WTF&&typeof console<"u"&&console.warn("Unexpected",ir,or,sr)}}else if(ir.slice(0,2)!=="</"){if(_e.WTF)throw new Error(ir)}}}return er}function write_cust_props(e){var _e=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return _e.join("");var er=1;return keys(e).forEach(function(rr){++er,_e[_e.length]=writextag("property",write_vt(e[rr]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:er,name:escapexml(rr)})}),_e.length>2&&(_e[_e.length]="</Properties>",_e[1]=_e[1].replace("/>",">")),_e.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,_e,er){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),_e=evert_XLMLDPM[_e]||_e,e[_e]=er}function xlml_write_docprops(e,_e){var er=[];return keys(XLMLDocPropsMap).map(function(tr){for(var rr=0;rr<CORE_PROPS.length;++rr)if(CORE_PROPS[rr][1]==tr)return CORE_PROPS[rr];for(rr=0;rr<EXT_PROPS.length;++rr)if(EXT_PROPS[rr][1]==tr)return EXT_PROPS[rr];throw tr}).forEach(function(tr){if(e[tr[1]]!=null){var rr=_e&&_e.Props&&_e.Props[tr[1]]!=null?_e.Props[tr[1]]:e[tr[1]];switch(tr[2]){case"date":rr=new Date(rr).toISOString().replace(/\.\d*Z/,"Z");break}typeof rr=="number"?rr=String(rr):rr===!0||rr===!1?rr=rr?"1":"0":rr instanceof Date&&(rr=new Date(rr).toISOString().replace(/\.\d*Z/,"")),er.push(writetag(XLMLDocPropsMap[tr[1]]||tr[1],rr))}}),writextag("DocumentProperties",er.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,_e){var er=["Worksheets","SheetNames"],tr="CustomDocumentProperties",rr=[];return e&&keys(e).forEach(function(nr){if(Object.prototype.hasOwnProperty.call(e,nr)){for(var ir=0;ir<CORE_PROPS.length;++ir)if(nr==CORE_PROPS[ir][1])return;for(ir=0;ir<EXT_PROPS.length;++ir)if(nr==EXT_PROPS[ir][1])return;for(ir=0;ir<er.length;++ir)if(nr==er[ir])return;var ar=e[nr],sr="string";typeof ar=="number"?(sr="float",ar=String(ar)):ar===!0||ar===!1?(sr="boolean",ar=ar?"1":"0"):ar=String(ar),rr.push(writextag(escapexmltag(nr),ar,{"dt:dt":sr}))}}),_e&&keys(_e).forEach(function(nr){if(Object.prototype.hasOwnProperty.call(_e,nr)&&!(e&&Object.prototype.hasOwnProperty.call(e,nr))){var ir=_e[nr],ar="string";typeof ir=="number"?(ar="float",ir=String(ir)):ir===!0||ir===!1?(ar="boolean",ir=ir?"1":"0"):ir instanceof Date?(ar="dateTime.tz",ir=ir.toISOString()):ir=String(ir),rr.push(writextag(escapexmltag(nr),ir,{"dt:dt":ar}))}}),"<"+tr+' xmlns="'+XLMLNS.o+'">'+rr.join("")+"</"+tr+">"}function parse_FILETIME(e){var _e=e.read_shift(4),er=e.read_shift(4);return new Date((er/1e7*Math.pow(2,32)+_e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(e){var _e=typeof e=="string"?new Date(Date.parse(e)):e,er=_e.getTime()/1e3+11644473600,tr=er%Math.pow(2,32),rr=(er-tr)/Math.pow(2,32);tr*=1e7,rr*=1e7;var nr=tr/Math.pow(2,32)|0;nr>0&&(tr=tr%Math.pow(2,32),rr+=nr);var ir=new_buf(8);return ir.write_shift(4,tr),ir.write_shift(4,rr),ir}function parse_lpstr(e,_e,er){var tr=e.l,rr=e.read_shift(0,"lpstr-cp");if(er)for(;e.l-tr&3;)++e.l;return rr}function parse_lpwstr(e,_e,er){var tr=e.read_shift(0,"lpwstr");return tr}function parse_VtStringBase(e,_e,er){return _e===31?parse_lpwstr(e):parse_lpstr(e,_e,er)}function parse_VtString(e,_e,er){return parse_VtStringBase(e,_e,er===!1?0:4)}function parse_VtUnalignedString(e,_e){if(!_e)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,_e,0)}function parse_VtVecLpwstrValue(e){for(var _e=e.read_shift(4),er=[],tr=0;tr!=_e;++tr){var rr=e.l;er[tr]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-rr&2&&(e.l+=2)}return er}function parse_VtVecUnalignedLpstrValue(e){for(var _e=e.read_shift(4),er=[],tr=0;tr!=_e;++tr)er[tr]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return er}function parse_VtHeadingPair(e){var _e=e.l,er=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-_e&2&&(e.l+=2);var tr=parse_TypedPropertyValue(e,VT_I4);return[er,tr]}function parse_VtVecHeadingPairValue(e){for(var _e=e.read_shift(4),er=[],tr=0;tr<_e/2;++tr)er.push(parse_VtHeadingPair(e));return er}function parse_dictionary(e,_e){for(var er=e.read_shift(4),tr={},rr=0;rr!=er;++rr){var nr=e.read_shift(4),ir=e.read_shift(4);tr[nr]=e.read_shift(ir,_e===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),_e===1200&&ir%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),tr}function parse_BLOB(e){var _e=e.read_shift(4),er=e.slice(e.l,e.l+_e);return e.l+=_e,(_e&3)>0&&(e.l+=4-(_e&3)&3),er}function parse_ClipboardData(e){var _e={};return _e.Size=e.read_shift(4),e.l+=_e.Size+3-(_e.Size-1)%4,_e}function parse_TypedPropertyValue(e,_e,er){var tr=e.read_shift(2),rr,nr=er||{};if(e.l+=2,_e!==VT_VARIANT&&tr!==_e&&VT_CUSTOM.indexOf(_e)===-1&&!((_e&65534)==4126&&(tr&65534)==4126))throw new Error("Expected type "+_e+" saw "+tr);switch(_e===VT_VARIANT?tr:_e){case 2:return rr=e.read_shift(2,"i"),nr.raw||(e.l+=2),rr;case 3:return rr=e.read_shift(4,"i"),rr;case 11:return e.read_shift(4)!==0;case 19:return rr=e.read_shift(4),rr;case 30:return parse_lpstr(e,tr,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,tr,!nr.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,tr).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return tr==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+_e+" "+tr)}}function write_TypedPropertyValue(e,_e){var er=new_buf(4),tr=new_buf(4);switch(er.write_shift(4,e==80?31:e),e){case 3:tr.write_shift(-4,_e);break;case 5:tr=new_buf(8),tr.write_shift(8,_e,"f");break;case 11:tr.write_shift(4,_e?1:0);break;case 64:tr=write_FILETIME(_e);break;case 31:case 80:for(tr=new_buf(4+2*(_e.length+1)+(_e.length%2?0:2)),tr.write_shift(4,_e.length+1),tr.write_shift(0,_e,"dbcs");tr.l!=tr.length;)tr.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+_e)}return bconcat([er,tr])}function parse_PropertySet(e,_e){var er=e.l,tr=e.read_shift(4),rr=e.read_shift(4),nr=[],ir=0,ar=0,sr=-1,or={};for(ir=0;ir!=rr;++ir){var lr=e.read_shift(4),ur=e.read_shift(4);nr[ir]=[lr,ur+er]}nr.sort(function(gr,vr){return gr[1]-vr[1]});var fr={};for(ir=0;ir!=rr;++ir){if(e.l!==nr[ir][1]){var cr=!0;if(ir>0&&_e)switch(_e[nr[ir-1][0]].t){case 2:e.l+2===nr[ir][1]&&(e.l+=2,cr=!1);break;case 80:e.l<=nr[ir][1]&&(e.l=nr[ir][1],cr=!1);break;case 4108:e.l<=nr[ir][1]&&(e.l=nr[ir][1],cr=!1);break}if((!_e||ir==0)&&e.l<=nr[ir][1]&&(cr=!1,e.l=nr[ir][1]),cr)throw new Error("Read Error: Expected address "+nr[ir][1]+" at "+e.l+" :"+ir)}if(_e){var mr=_e[nr[ir][0]];if(fr[mr.n]=parse_TypedPropertyValue(e,mr.t,{raw:!0}),mr.p==="version"&&(fr[mr.n]=String(fr[mr.n]>>16)+"."+("0000"+String(fr[mr.n]&65535)).slice(-4)),mr.n=="CodePage")switch(fr[mr.n]){case 0:fr[mr.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(ar=fr[mr.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+fr[mr.n])}}else if(nr[ir][0]===1){if(ar=fr.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(ar),sr!==-1){var dr=e.l;e.l=nr[sr][1],or=parse_dictionary(e,ar),e.l=dr}}else if(nr[ir][0]===0){if(ar===0){sr=ir,e.l=nr[ir+1][1];continue}or=parse_dictionary(e,ar)}else{var xr=or[nr[ir][0]],pr;switch(e[e.l]){case 65:e.l+=4,pr=parse_BLOB(e);break;case 30:e.l+=4,pr=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,pr=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,pr=e.read_shift(4,"i");break;case 19:e.l+=4,pr=e.read_shift(4);break;case 5:e.l+=4,pr=e.read_shift(8,"f");break;case 11:e.l+=4,pr=parsebool(e,4);break;case 64:e.l+=4,pr=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}fr[xr]=pr}}return e.l=er+tr,fr}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,_e,er){var tr=new_buf(8),rr=[],nr=[],ir=8,ar=0,sr=new_buf(8),or=new_buf(8);if(sr.write_shift(4,2),sr.write_shift(4,1200),or.write_shift(4,1),nr.push(sr),rr.push(or),ir+=8+sr.length,!_e){or=new_buf(8),or.write_shift(4,0),rr.unshift(or);var lr=[new_buf(4)];for(lr[0].write_shift(4,e.length),ar=0;ar<e.length;++ar){var ur=e[ar][0];for(sr=new_buf(8+2*(ur.length+1)+(ur.length%2?0:2)),sr.write_shift(4,ar+2),sr.write_shift(4,ur.length+1),sr.write_shift(0,ur,"dbcs");sr.l!=sr.length;)sr.write_shift(1,0);lr.push(sr)}sr=bconcat(lr),nr.unshift(sr),ir+=8+sr.length}for(ar=0;ar<e.length;++ar)if(!(_e&&!_e[e[ar][0]])&&!(XLSPSSkip.indexOf(e[ar][0])>-1||PseudoPropsPairs.indexOf(e[ar][0])>-1)&&e[ar][1]!=null){var fr=e[ar][1],cr=0;if(_e){cr=+_e[e[ar][0]];var mr=er[cr];if(mr.p=="version"&&typeof fr=="string"){var dr=fr.split(".");fr=(+dr[0]<<16)+(+dr[1]||0)}sr=write_TypedPropertyValue(mr.t,fr)}else{var xr=guess_property_type(fr);xr==-1&&(xr=31,fr=String(fr)),sr=write_TypedPropertyValue(xr,fr)}nr.push(sr),or=new_buf(8),or.write_shift(4,_e?cr:2+ar),rr.push(or),ir+=8+sr.length}var pr=8*(nr.length+1);for(ar=0;ar<nr.length;++ar)rr[ar].write_shift(4,pr),pr+=nr[ar].length;return tr.write_shift(4,ir),tr.write_shift(4,nr.length),bconcat([tr].concat(rr).concat(nr))}function parse_PropertySetStream(e,_e,er){var tr=e.content;if(!tr)return{};prep_blob(tr,0);var rr,nr,ir,ar,sr=0;tr.chk("feff","Byte Order: "),tr.read_shift(2);var or=tr.read_shift(4),lr=tr.read_shift(16);if(lr!==CFB.utils.consts.HEADER_CLSID&&lr!==er)throw new Error("Bad PropertySet CLSID "+lr);if(rr=tr.read_shift(4),rr!==1&&rr!==2)throw new Error("Unrecognized #Sets: "+rr);if(nr=tr.read_shift(16),ar=tr.read_shift(4),rr===1&&ar!==tr.l)throw new Error("Length mismatch: "+ar+" !== "+tr.l);rr===2&&(ir=tr.read_shift(16),sr=tr.read_shift(4));var ur=parse_PropertySet(tr,_e),fr={SystemIdentifier:or};for(var cr in ur)fr[cr]=ur[cr];if(fr.FMTID=nr,rr===1)return fr;if(sr-tr.l==2&&(tr.l+=2),tr.l!==sr)throw new Error("Length mismatch 2: "+tr.l+" !== "+sr);var mr;try{mr=parse_PropertySet(tr,null)}catch{}for(cr in mr)fr[cr]=mr[cr];return fr.FMTID=[nr,ir],fr}function write_PropertySetStream(e,_e,er,tr,rr,nr){var ir=new_buf(rr?68:48),ar=[ir];ir.write_shift(2,65534),ir.write_shift(2,0),ir.write_shift(4,842412599),ir.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),ir.write_shift(4,rr?2:1),ir.write_shift(16,_e,"hex"),ir.write_shift(4,rr?68:48);var sr=write_PropertySet(e,er,tr);if(ar.push(sr),rr){var or=write_PropertySet(rr,null,null);ir.write_shift(16,nr,"hex"),ir.write_shift(4,68+sr.length),ar.push(or)}return bconcat(ar)}function parsenoop2(e,_e){return e.read_shift(_e),null}function writezeroes(e,_e){_e||(_e=new_buf(e));for(var er=0;er<e;++er)_e.write_shift(1,0);return _e}function parslurp(e,_e,er){for(var tr=[],rr=e.l+_e;e.l<rr;)tr.push(er(e,rr-e.l));if(rr!==e.l)throw new Error("Slurp error");return tr}function parsebool(e,_e){return e.read_shift(_e)===1}function writebool(e,_e){return _e||(_e=new_buf(2)),_e.write_shift(2,+!!e),_e}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,_e){return _e||(_e=new_buf(2)),_e.write_shift(2,e),_e}function parseuint16a(e,_e){return parslurp(e,_e,parseuint16)}function parse_Bes(e){var _e=e.read_shift(1),er=e.read_shift(1);return er===1?_e:_e===1}function write_Bes(e,_e,er){return er||(er=new_buf(2)),er.write_shift(1,_e=="e"?+e:+!!e),er.write_shift(1,_e=="e"?1:0),er}function parse_ShortXLUnicodeString(e,_e,er){var tr=e.read_shift(er&&er.biff>=12?2:1),rr="sbcs-cont";if(er&&er.biff>=8,!er||er.biff==8){var nr=e.read_shift(1);nr&&(rr="dbcs-cont")}else er.biff==12&&(rr="wstr");er.biff>=2&&er.biff<=5&&(rr="cpstr");var ir=tr?e.read_shift(tr,rr):"";return ir}function parse_XLUnicodeRichExtendedString(e){var _e=e.read_shift(2),er=e.read_shift(1),tr=er&4,rr=er&8,nr=1+(er&1),ir=0,ar,sr={};rr&&(ir=e.read_shift(2)),tr&&(ar=e.read_shift(4));var or=nr==2?"dbcs-cont":"sbcs-cont",lr=_e===0?"":e.read_shift(_e,or);return rr&&(e.l+=4*ir),tr&&(e.l+=ar),sr.t=lr,rr||(sr.raw="<t>"+sr.t+"</t>",sr.r=sr.t),sr}function write_XLUnicodeRichExtendedString(e){var _e=e.t||"",er=new_buf(3);er.write_shift(2,_e.length),er.write_shift(1,1);var tr=new_buf(2*_e.length);tr.write_shift(2*_e.length,_e,"utf16le");var rr=[er,tr];return bconcat(rr)}function parse_XLUnicodeStringNoCch(e,_e,er){var tr;if(er){if(er.biff>=2&&er.biff<=5)return e.read_shift(_e,"cpstr");if(er.biff>=12)return e.read_shift(_e,"dbcs-cont")}var rr=e.read_shift(1);return rr===0?tr=e.read_shift(_e,"sbcs-cont"):tr=e.read_shift(_e,"dbcs-cont"),tr}function parse_XLUnicodeString(e,_e,er){var tr=e.read_shift(er&&er.biff==2?1:2);return tr===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,tr,er)}function parse_XLUnicodeString2(e,_e,er){if(er.biff>5)return parse_XLUnicodeString(e,_e,er);var tr=e.read_shift(1);return tr===0?(e.l++,""):e.read_shift(tr,er.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,_e,er){return er||(er=new_buf(3+2*e.length)),er.write_shift(2,e.length),er.write_shift(1,1),er.write_shift(31,e,"utf16le"),er}function parse_ControlInfo(e){var _e=e.read_shift(1);e.l++;var er=e.read_shift(2);return e.l+=2,[_e,er]}function parse_URLMoniker(e){var _e=e.read_shift(4),er=e.l,tr=!1;_e>24&&(e.l+=_e-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(tr=!0),e.l=er);var rr=e.read_shift((tr?_e-24:_e)>>1,"utf16le").replace(chr0,"");return tr&&(e.l+=24),rr}function parse_FileMoniker(e){for(var _e=e.read_shift(2),er="";_e-- >0;)er+="../";var tr=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var rr=e.read_shift(4);if(rr===0)return er+tr.replace(/\\/g,"/");var nr=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var ir=e.read_shift(nr>>1,"utf16le").replace(chr0,"");return er+ir}function parse_HyperlinkMoniker(e,_e){var er=e.read_shift(16);switch(er){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+er)}}function parse_HyperlinkString(e){var _e=e.read_shift(4),er=_e>0?e.read_shift(_e,"utf16le").replace(chr0,""):"";return er}function write_HyperlinkString(e,_e){_e||(_e=new_buf(6+e.length*2)),_e.write_shift(4,1+e.length);for(var er=0;er<e.length;++er)_e.write_shift(2,e.charCodeAt(er));return _e.write_shift(2,0),_e}function parse_Hyperlink(e,_e){var er=e.l+_e,tr=e.read_shift(4);if(tr!==2)throw new Error("Unrecognized streamVersion: "+tr);var rr=e.read_shift(2);e.l+=2;var nr,ir,ar,sr,or="",lr,ur;rr&16&&(nr=parse_HyperlinkString(e,er-e.l)),rr&128&&(ir=parse_HyperlinkString(e,er-e.l)),(rr&257)===257&&(ar=parse_HyperlinkString(e,er-e.l)),(rr&257)===1&&(sr=parse_HyperlinkMoniker(e,er-e.l)),rr&8&&(or=parse_HyperlinkString(e,er-e.l)),rr&32&&(lr=e.read_shift(16)),rr&64&&(ur=parse_FILETIME(e)),e.l=er;var fr=ir||ar||sr||"";fr&&or&&(fr+="#"+or),fr||(fr="#"+or),rr&2&&fr.charAt(0)=="/"&&fr.charAt(1)!="/"&&(fr="file://"+fr);var cr={Target:fr};return lr&&(cr.guid=lr),ur&&(cr.time=ur),nr&&(cr.Tooltip=nr),cr}function write_Hyperlink(e){var _e=new_buf(512),er=0,tr=e.Target;tr.slice(0,7)=="file://"&&(tr=tr.slice(7));var rr=tr.indexOf("#"),nr=rr>-1?31:23;switch(tr.charAt(0)){case"#":nr=28;break;case".":nr&=-3;break}_e.write_shift(4,2),_e.write_shift(4,nr);var ir=[8,6815827,6619237,4849780,83];for(er=0;er<ir.length;++er)_e.write_shift(4,ir[er]);if(nr==28)tr=tr.slice(1),write_HyperlinkString(tr,_e);else if(nr&2){for(ir="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),er=0;er<ir.length;++er)_e.write_shift(1,parseInt(ir[er],16));var ar=rr>-1?tr.slice(0,rr):tr;for(_e.write_shift(4,2*(ar.length+1)),er=0;er<ar.length;++er)_e.write_shift(2,ar.charCodeAt(er));_e.write_shift(2,0),nr&8&&write_HyperlinkString(rr>-1?tr.slice(rr+1):"",_e)}else{for(ir="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),er=0;er<ir.length;++er)_e.write_shift(1,parseInt(ir[er],16));for(var sr=0;tr.slice(sr*3,sr*3+3)=="../"||tr.slice(sr*3,sr*3+3)=="..\\";)++sr;for(_e.write_shift(2,sr),_e.write_shift(4,tr.length-3*sr+1),er=0;er<tr.length-3*sr;++er)_e.write_shift(1,tr.charCodeAt(er+3*sr)&255);for(_e.write_shift(1,0),_e.write_shift(2,65535),_e.write_shift(2,57005),er=0;er<6;++er)_e.write_shift(4,0)}return _e.slice(0,_e.l)}function parse_LongRGBA(e){var _e=e.read_shift(1),er=e.read_shift(1),tr=e.read_shift(1),rr=e.read_shift(1);return[_e,er,tr,rr]}function parse_LongRGB(e,_e){var er=parse_LongRGBA(e);return er[3]=0,er}function parse_XLSCell(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(2);return{r:_e,c:er,ixfe:tr}}function write_XLSCell(e,_e,er,tr){return tr||(tr=new_buf(6)),tr.write_shift(2,e),tr.write_shift(2,_e),tr.write_shift(2,er||0),tr}function parse_frtHeader(e){var _e=e.read_shift(2),er=e.read_shift(2);return e.l+=8,{type:_e,flags:er}}function parse_OptXLUnicodeString(e,_e,er){return _e===0?"":parse_XLUnicodeString2(e,_e,er)}function parse_XTI(e,_e,er){var tr=er.biff>8?4:2,rr=e.read_shift(tr),nr=e.read_shift(tr,"i"),ir=e.read_shift(tr,"i");return[rr,nr,ir]}function parse_RkRec(e){var _e=e.read_shift(2),er=parse_RkNumber(e);return[_e,er]}function parse_AddinUdf(e,_e,er){e.l+=4,_e-=4;var tr=e.l+_e,rr=parse_ShortXLUnicodeString(e,_e,er),nr=e.read_shift(2);if(tr-=e.l,nr!==tr)throw new Error("Malformed AddinUdf: padding = "+tr+" != "+nr);return e.l+=nr,rr}function parse_Ref8U(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(2),rr=e.read_shift(2);return{s:{c:tr,r:_e},e:{c:rr,r:er}}}function write_Ref8U(e,_e){return _e||(_e=new_buf(8)),_e.write_shift(2,e.s.r),_e.write_shift(2,e.e.r),_e.write_shift(2,e.s.c),_e.write_shift(2,e.e.c),_e}function parse_RefU(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(1),rr=e.read_shift(1);return{s:{c:tr,r:_e},e:{c:rr,r:er}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(2);return e.l+=12,[er,_e,tr]}function parse_FtNts(e){var _e={};return e.l+=4,e.l+=16,_e.fSharedNote=e.read_shift(2),e.l+=4,_e}function parse_FtCf(e){var _e={};return e.l+=4,e.cf=e.read_shift(2),_e}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,_e){for(var er=e.l+_e,tr=[];e.l<er;){var rr=e.read_shift(2);e.l-=2;try{tr.push(FtTab[rr](e,er-e.l))}catch{return e.l=er,tr}}return e.l!=er&&(e.l=er),tr}function parse_BOF(e,_e){var er={BIFFVer:0,dt:0};switch(er.BIFFVer=e.read_shift(2),_e-=2,_e>=2&&(er.dt=e.read_shift(2),e.l-=2),er.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(_e>6)throw new Error("Unexpected BIFF Ver "+er.BIFFVer)}return e.read_shift(_e),er}function write_BOF(e,_e,er){var tr=1536,rr=16;switch(er.bookType){case"biff8":break;case"biff5":tr=1280,rr=8;break;case"biff4":tr=4,rr=6;break;case"biff3":tr=3,rr=6;break;case"biff2":tr=2,rr=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var nr=new_buf(rr);return nr.write_shift(2,tr),nr.write_shift(2,_e),rr>4&&nr.write_shift(2,29282),rr>6&&nr.write_shift(2,1997),rr>8&&(nr.write_shift(2,49161),nr.write_shift(2,1),nr.write_shift(2,1798),nr.write_shift(2,0)),nr}function parse_InterfaceHdr(e,_e){return _e===0||e.read_shift(2),1200}function parse_WriteAccess(e,_e,er){if(er.enc)return e.l+=_e,"";var tr=e.l,rr=parse_XLUnicodeString2(e,0,er);return e.read_shift(_e+tr-e.l),rr}function write_WriteAccess(e,_e){var er=!_e||_e.biff==8,tr=new_buf(er?112:54);for(tr.write_shift(_e.biff==8?2:1,7),er&&tr.write_shift(1,0),tr.write_shift(4,859007059),tr.write_shift(4,5458548|(er?0:536870912));tr.l<tr.length;)tr.write_shift(1,er?0:32);return tr}function parse_WsBool(e,_e,er){var tr=er&&er.biff==8||_e==2?e.read_shift(2):(e.l+=_e,0);return{fDialog:tr&16,fBelow:tr&64,fRight:tr&128}}function parse_BoundSheet8(e,_e,er){var tr=e.read_shift(4),rr=e.read_shift(1)&3,nr=e.read_shift(1);switch(nr){case 0:nr="Worksheet";break;case 1:nr="Macrosheet";break;case 2:nr="Chartsheet";break;case 6:nr="VBAModule";break}var ir=parse_ShortXLUnicodeString(e,0,er);return ir.length===0&&(ir="Sheet1"),{pos:tr,hs:rr,dt:nr,name:ir}}function write_BoundSheet8(e,_e){var er=!_e||_e.biff>=8?2:1,tr=new_buf(8+er*e.name.length);tr.write_shift(4,e.pos),tr.write_shift(1,e.hs||0),tr.write_shift(1,e.dt),tr.write_shift(1,e.name.length),_e.biff>=8&&tr.write_shift(1,1),tr.write_shift(er*e.name.length,e.name,_e.biff<8?"sbcs":"utf16le");var rr=tr.slice(0,tr.l);return rr.l=tr.l,rr}function parse_SST(e,_e){for(var er=e.l+_e,tr=e.read_shift(4),rr=e.read_shift(4),nr=[],ir=0;ir!=rr&&e.l<er;++ir)nr.push(parse_XLUnicodeRichExtendedString(e));return nr.Count=tr,nr.Unique=rr,nr}function write_SST(e,_e){var er=new_buf(8);er.write_shift(4,e.Count),er.write_shift(4,e.Unique);for(var tr=[],rr=0;rr<e.length;++rr)tr[rr]=write_XLUnicodeRichExtendedString(e[rr]);var nr=bconcat([er].concat(tr));return nr.parts=[er.length].concat(tr.map(function(ir){return ir.length})),nr}function parse_ExtSST(e,_e){var er={};return er.dsst=e.read_shift(2),e.l+=_e-2,er}function parse_Row(e){var _e={};_e.r=e.read_shift(2),_e.c=e.read_shift(2),_e.cnt=e.read_shift(2)-_e.c;var er=e.read_shift(2);e.l+=4;var tr=e.read_shift(1);return e.l+=3,tr&7&&(_e.level=tr&7),tr&32&&(_e.hidden=!0),tr&64&&(_e.hpt=er/20),_e}function parse_ForceFullCalculation(e){var _e=parse_frtHeader(e);if(_e.type!=2211)throw new Error("Invalid Future Record "+_e.type);var er=e.read_shift(4);return er!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,_e,er){var tr=0;er&&er.biff==2||(tr=e.read_shift(2));var rr=e.read_shift(2);er&&er.biff==2&&(tr=1-(rr>>15),rr&=32767);var nr={Unsynced:tr&1,DyZero:(tr&2)>>1,ExAsc:(tr&4)>>2,ExDsc:(tr&8)>>3};return[nr,rr]}function parse_Window1(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(2),rr=e.read_shift(2),nr=e.read_shift(2),ir=e.read_shift(2),ar=e.read_shift(2),sr=e.read_shift(2),or=e.read_shift(2);return{Pos:[_e,er],Dim:[tr,rr],Flags:nr,CurTab:ir,FirstTab:ar,Selected:sr,TabRatio:or}}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function parse_Window2(e,_e,er){if(er&&er.biff>=2&&er.biff<5)return{};var tr=e.read_shift(2);return{RTL:tr&64}}function write_Window2(e){var _e=new_buf(18),er=1718;return e&&e.RTL&&(er|=64),_e.write_shift(2,er),_e.write_shift(4,0),_e.write_shift(4,64),_e.write_shift(4,0),_e.write_shift(4,0),_e}function parse_Pane(){}function parse_Font(e,_e,er){var tr={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(er&&er.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return tr.name=parse_ShortXLUnicodeString(e,0,er),tr}function write_Font(e,_e){var er=e.name||"Arial",tr=_e&&_e.biff==5,rr=tr?15+er.length:16+2*er.length,nr=new_buf(rr);return nr.write_shift(2,e.sz*20),nr.write_shift(4,0),nr.write_shift(2,400),nr.write_shift(4,0),nr.write_shift(2,0),nr.write_shift(1,er.length),tr||nr.write_shift(1,1),nr.write_shift((tr?1:2)*er.length,er,tr?"sbcs":"utf16le"),nr}function parse_LabelSst(e){var _e=parse_XLSCell(e);return _e.isst=e.read_shift(4),_e}function write_LabelSst(e,_e,er,tr){var rr=new_buf(10);return write_XLSCell(e,_e,tr,rr),rr.write_shift(4,er),rr}function parse_Label(e,_e,er){er.biffguess&&er.biff==2&&(er.biff=5);var tr=e.l+_e,rr=parse_XLSCell(e);er.biff==2&&e.l++;var nr=parse_XLUnicodeString(e,tr-e.l,er);return rr.val=nr,rr}function write_Label(e,_e,er,tr,rr){var nr=!rr||rr.biff==8,ir=new_buf(8+ +nr+(1+nr)*er.length);return write_XLSCell(e,_e,tr,ir),ir.write_shift(2,er.length),nr&&ir.write_shift(1,1),ir.write_shift((1+nr)*er.length,er,nr?"utf16le":"sbcs"),ir}function parse_Format(e,_e,er){var tr=e.read_shift(2),rr=parse_XLUnicodeString2(e,0,er);return[tr,rr]}function write_Format(e,_e,er,tr){var rr=er&&er.biff==5;tr||(tr=new_buf(rr?3+_e.length:5+2*_e.length)),tr.write_shift(2,e),tr.write_shift(rr?1:2,_e.length),rr||tr.write_shift(1,1),tr.write_shift((rr?1:2)*_e.length,_e,rr?"sbcs":"utf16le");var nr=tr.length>tr.l?tr.slice(0,tr.l):tr;return nr.l==null&&(nr.l=nr.length),nr}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,_e,er){var tr=e.l+_e,rr=er.biff==8||!er.biff?4:2,nr=e.read_shift(rr),ir=e.read_shift(rr),ar=e.read_shift(2),sr=e.read_shift(2);return e.l=tr,{s:{r:nr,c:ar},e:{r:ir,c:sr}}}function write_Dimensions(e,_e){var er=_e.biff==8||!_e.biff?4:2,tr=new_buf(2*er+6);return tr.write_shift(er,e.s.r),tr.write_shift(er,e.e.r+1),tr.write_shift(2,e.s.c),tr.write_shift(2,e.e.c+1),tr.write_shift(2,0),tr}function parse_RK(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=parse_RkRec(e);return{r:_e,c:er,ixfe:tr[0],rknum:tr[1]}}function parse_MulRk(e,_e){for(var er=e.l+_e-2,tr=e.read_shift(2),rr=e.read_shift(2),nr=[];e.l<er;)nr.push(parse_RkRec(e));if(e.l!==er)throw new Error("MulRK read error");var ir=e.read_shift(2);if(nr.length!=ir-rr+1)throw new Error("MulRK length mismatch");return{r:tr,c:rr,C:ir,rkrec:nr}}function parse_MulBlank(e,_e){for(var er=e.l+_e-2,tr=e.read_shift(2),rr=e.read_shift(2),nr=[];e.l<er;)nr.push(e.read_shift(2));if(e.l!==er)throw new Error("MulBlank read error");var ir=e.read_shift(2);if(nr.length!=ir-rr+1)throw new Error("MulBlank length mismatch");return{r:tr,c:rr,C:ir,ixfe:nr}}function parse_CellStyleXF(e,_e,er,tr){var rr={},nr=e.read_shift(4),ir=e.read_shift(4),ar=e.read_shift(4),sr=e.read_shift(2);return rr.patternType=XLSFillPattern[ar>>26],tr.cellStyles&&(rr.alc=nr&7,rr.fWrap=nr>>3&1,rr.alcV=nr>>4&7,rr.fJustLast=nr>>7&1,rr.trot=nr>>8&255,rr.cIndent=nr>>16&15,rr.fShrinkToFit=nr>>20&1,rr.iReadOrder=nr>>22&2,rr.fAtrNum=nr>>26&1,rr.fAtrFnt=nr>>27&1,rr.fAtrAlc=nr>>28&1,rr.fAtrBdr=nr>>29&1,rr.fAtrPat=nr>>30&1,rr.fAtrProt=nr>>31&1,rr.dgLeft=ir&15,rr.dgRight=ir>>4&15,rr.dgTop=ir>>8&15,rr.dgBottom=ir>>12&15,rr.icvLeft=ir>>16&127,rr.icvRight=ir>>23&127,rr.grbitDiag=ir>>30&3,rr.icvTop=ar&127,rr.icvBottom=ar>>7&127,rr.icvDiag=ar>>14&127,rr.dgDiag=ar>>21&15,rr.icvFore=sr&127,rr.icvBack=sr>>7&127,rr.fsxButton=sr>>14&1),rr}function parse_XF(e,_e,er){var tr={};return tr.ifnt=e.read_shift(2),tr.numFmtId=e.read_shift(2),tr.flags=e.read_shift(2),tr.fStyle=tr.flags>>2&1,_e-=6,tr.data=parse_CellStyleXF(e,_e,tr.fStyle,er),tr}function write_XF(e,_e,er,tr){var rr=er&&er.biff==5;tr||(tr=new_buf(rr?16:20)),tr.write_shift(2,0),e.style?(tr.write_shift(2,e.numFmtId||0),tr.write_shift(2,65524)):(tr.write_shift(2,e.numFmtId||0),tr.write_shift(2,_e<<4));var nr=0;return e.numFmtId>0&&rr&&(nr|=1024),tr.write_shift(4,nr),tr.write_shift(4,0),rr||tr.write_shift(4,0),tr.write_shift(2,0),tr}function parse_Guts(e){e.l+=4;var _e=[e.read_shift(2),e.read_shift(2)];if(_e[0]!==0&&_e[0]--,_e[1]!==0&&_e[1]--,_e[0]>7||_e[1]>7)throw new Error("Bad Gutters: "+_e.join("|"));return _e}function write_Guts(e){var _e=new_buf(8);return _e.write_shift(4,0),_e.write_shift(2,0),_e.write_shift(2,0),_e}function parse_BoolErr(e,_e,er){var tr=parse_XLSCell(e);(er.biff==2||_e==9)&&++e.l;var rr=parse_Bes(e);return tr.val=rr,tr.t=rr===!0||rr===!1?"b":"e",tr}function write_BoolErr(e,_e,er,tr,rr,nr){var ir=new_buf(8);return write_XLSCell(e,_e,tr,ir),write_Bes(er,nr,ir),ir}function parse_Number(e,_e,er){er.biffguess&&er.biff==2&&(er.biff=5);var tr=parse_XLSCell(e),rr=parse_Xnum(e);return tr.val=rr,tr}function write_Number(e,_e,er,tr){var rr=new_buf(14);return write_XLSCell(e,_e,tr,rr),write_Xnum(er,rr),rr}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,_e,er){var tr=e.l+_e,rr=e.read_shift(2),nr=e.read_shift(2);if(er.sbcch=nr,nr==1025||nr==14849)return[nr,rr];if(nr<1||nr>255)throw new Error("Unexpected SupBook type: "+nr);for(var ir=parse_XLUnicodeStringNoCch(e,nr),ar=[];tr>e.l;)ar.push(parse_XLUnicodeString(e));return[nr,rr,ir,ar]}function parse_ExternName(e,_e,er){var tr=e.read_shift(2),rr,nr={fBuiltIn:tr&1,fWantAdvise:tr>>>1&1,fWantPict:tr>>>2&1,fOle:tr>>>3&1,fOleLink:tr>>>4&1,cf:tr>>>5&1023,fIcon:tr>>>15&1};return er.sbcch===14849&&(rr=parse_AddinUdf(e,_e-2,er)),nr.body=rr||e.read_shift(_e-2),typeof rr=="string"&&(nr.Name=rr),nr}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,_e,er){var tr=e.l+_e,rr=e.read_shift(2),nr=e.read_shift(1),ir=e.read_shift(1),ar=e.read_shift(er&&er.biff==2?1:2),sr=0;(!er||er.biff>=5)&&(er.biff!=5&&(e.l+=2),sr=e.read_shift(2),er.biff==5&&(e.l+=2),e.l+=4);var or=parse_XLUnicodeStringNoCch(e,ir,er);rr&32&&(or=XLSLblBuiltIn[or.charCodeAt(0)]);var lr=tr-e.l;er&&er.biff==2&&--lr;var ur=tr==e.l||ar===0||!(lr>0)?[]:parse_NameParsedFormula(e,lr,er,ar);return{chKey:nr,Name:or,itab:sr,rgce:ur}}function parse_ExternSheet(e,_e,er){if(er.biff<8)return parse_BIFF5ExternSheet(e,_e,er);for(var tr=[],rr=e.l+_e,nr=e.read_shift(er.biff>8?4:2);nr--!==0;)tr.push(parse_XTI(e,er.biff>8?12:6,er));if(e.l!=rr)throw new Error("Bad ExternSheet: "+e.l+" != "+rr);return tr}function parse_BIFF5ExternSheet(e,_e,er){e[e.l+1]==3&&e[e.l]++;var tr=parse_ShortXLUnicodeString(e,_e,er);return tr.charCodeAt(0)==3?tr.slice(1):tr}function parse_NameCmt(e,_e,er){if(er.biff<8){e.l+=_e;return}var tr=e.read_shift(2),rr=e.read_shift(2),nr=parse_XLUnicodeStringNoCch(e,tr,er),ir=parse_XLUnicodeStringNoCch(e,rr,er);return[nr,ir]}function parse_ShrFmla(e,_e,er){var tr=parse_RefU(e);e.l++;var rr=e.read_shift(1);return _e-=8,[parse_SharedParsedFormula(e,_e,er),rr,tr]}function parse_Array(e,_e,er){var tr=parse_Ref(e);switch(er.biff){case 2:e.l++,_e-=7;break;case 3:case 4:e.l+=2,_e-=8;break;default:e.l+=6,_e-=12}return[tr,parse_ArrayParsedFormula(e,_e,er)]}function parse_MTRSettings(e){var _e=e.read_shift(4)!==0,er=e.read_shift(4)!==0,tr=e.read_shift(4);return[_e,er,tr]}function parse_NoteSh(e,_e,er){if(!(er.biff<8)){var tr=e.read_shift(2),rr=e.read_shift(2),nr=e.read_shift(2),ir=e.read_shift(2),ar=parse_XLUnicodeString2(e,0,er);return er.biff<8&&e.read_shift(1),[{r:tr,c:rr},ar,ir,nr]}}function parse_Note(e,_e,er){return parse_NoteSh(e,_e,er)}function parse_MergeCells(e,_e){for(var er=[],tr=e.read_shift(2);tr--;)er.push(parse_Ref8U(e));return er}function write_MergeCells(e){var _e=new_buf(2+e.length*8);_e.write_shift(2,e.length);for(var er=0;er<e.length;++er)write_Ref8U(e[er],_e);return _e}function parse_Obj(e,_e,er){if(er&&er.biff<8)return parse_BIFF5Obj(e,_e,er);var tr=parse_FtCmo(e),rr=parse_FtArray(e,_e-22,tr[1]);return{cmo:tr,ft:rr}}var parse_BIFF5OT={8:function(e,_e){var er=e.l+_e;e.l+=10;var tr=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var rr=e.read_shift(1);return e.l+=rr,e.l=er,{fmt:tr}}};function parse_BIFF5Obj(e,_e,er){e.l+=4;var tr=e.read_shift(2),rr=e.read_shift(2),nr=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,_e-=36;var ir=[];return ir.push((parse_BIFF5OT[tr]||parsenoop)(e,_e,er)),{cmo:[rr,tr,nr],ft:ir}}function parse_TxO(e,_e,er){var tr=e.l,rr="";try{e.l+=4;var nr=(er.lastobj||{cmo:[0,0]}).cmo[1],ir;[0,5,7,11,12,14].indexOf(nr)==-1?e.l+=6:ir=parse_ControlInfo(e,6,er);var ar=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var sr=e.read_shift(2);e.l+=sr;for(var or=1;or<e.lens.length-1;++or){if(e.l-tr!=e.lens[or])throw new Error("TxO: bad continue record");var lr=e[e.l],ur=parse_XLUnicodeStringNoCch(e,e.lens[or+1]-e.lens[or]-1);if(rr+=ur,rr.length>=(lr?ar:2*ar))break}if(rr.length!==ar&&rr.length!==ar*2)throw new Error("cchText: "+ar+" != "+rr.length);return e.l=tr+_e,{t:rr}}catch{return e.l=tr+_e,{t:rr}}}function parse_HLink(e,_e){var er=parse_Ref8U(e);e.l+=16;var tr=parse_Hyperlink(e,_e-24);return[er,tr]}function write_HLink(e){var _e=new_buf(24),er=decode_cell(e[0]);_e.write_shift(2,er.r),_e.write_shift(2,er.r),_e.write_shift(2,er.c),_e.write_shift(2,er.c);for(var tr="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),rr=0;rr<16;++rr)_e.write_shift(1,parseInt(tr[rr],16));return bconcat([_e,write_Hyperlink(e[1])])}function parse_HLinkTooltip(e,_e){e.read_shift(2);var er=parse_Ref8U(e),tr=e.read_shift((_e-10)/2,"dbcs-cont");return tr=tr.replace(chr0,""),[er,tr]}function write_HLinkTooltip(e){var _e=e[1].Tooltip,er=new_buf(10+2*(_e.length+1));er.write_shift(2,2048);var tr=decode_cell(e[0]);er.write_shift(2,tr.r),er.write_shift(2,tr.r),er.write_shift(2,tr.c),er.write_shift(2,tr.c);for(var rr=0;rr<_e.length;++rr)er.write_shift(2,_e.charCodeAt(rr));return er.write_shift(2,0),er}function parse_Country(e){var _e=[0,0],er;return er=e.read_shift(2),_e[0]=CountryEnum[er]||er,er=e.read_shift(2),_e[1]=CountryEnum[er]||er,_e}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ClrtClient(e){for(var _e=e.read_shift(2),er=[];_e-- >0;)er.push(parse_LongRGB(e));return er}function parse_Palette(e){for(var _e=e.read_shift(2),er=[];_e-- >0;)er.push(parse_LongRGB(e));return er}function parse_XFCRC(e){e.l+=2;var _e={cxfs:0,crc:0};return _e.cxfs=e.read_shift(2),_e.crc=e.read_shift(4),_e}function parse_ColInfo(e,_e,er){if(!er.cellStyles)return parsenoop(e,_e);var tr=er&&er.biff>=12?4:2,rr=e.read_shift(tr),nr=e.read_shift(tr),ir=e.read_shift(tr),ar=e.read_shift(tr),sr=e.read_shift(2);tr==2&&(e.l+=2);var or={s:rr,e:nr,w:ir,ixfe:ar,flags:sr};return(er.biff>=5||!er.biff)&&(or.level=sr>>8&7),or}function write_ColInfo(e,_e){var er=new_buf(12);er.write_shift(2,_e),er.write_shift(2,_e),er.write_shift(2,e.width*256),er.write_shift(2,0);var tr=0;return e.hidden&&(tr|=1),er.write_shift(1,tr),tr=e.level||0,er.write_shift(1,tr),er.write_shift(2,0),er}function parse_Setup(e,_e){var er={};return _e<32||(e.l+=16,er.header=parse_Xnum(e),er.footer=parse_Xnum(e),e.l+=2),er}function parse_ShtProps(e,_e,er){var tr={area:!1};if(er.biff!=5)return e.l+=_e,tr;var rr=e.read_shift(1);return e.l+=3,rr&16&&(tr.area=!0),tr}function write_RRTabId(e){for(var _e=new_buf(2*e),er=0;er<e;++er)_e.write_shift(2,er+1);return _e}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(4),rr={fmt:_e,env:er,len:tr,data:e.slice(e.l,e.l+tr)};return e.l+=tr,rr}function parse_BIFF2STR(e,_e,er){er.biffguess&&er.biff==5&&(er.biff=2);var tr=parse_XLSCell(e);++e.l;var rr=parse_XLUnicodeString2(e,_e-7,er);return tr.t="str",tr.val=rr,tr}function parse_BIFF2NUM(e){var _e=parse_XLSCell(e);++e.l;var er=parse_Xnum(e);return _e.t="n",_e.val=er,_e}function write_BIFF2NUM(e,_e,er){var tr=new_buf(15);return write_BIFF2Cell(tr,e,_e),tr.write_shift(8,er,"f"),tr}function parse_BIFF2INT(e){var _e=parse_XLSCell(e);++e.l;var er=e.read_shift(2);return _e.t="n",_e.val=er,_e}function write_BIFF2INT(e,_e,er){var tr=new_buf(9);return write_BIFF2Cell(tr,e,_e),tr.write_shift(2,er),tr}function parse_BIFF2STRING(e){var _e=e.read_shift(1);return _e===0?(e.l++,""):e.read_shift(_e,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,_e){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=_e-13}function parse_RString(e,_e,er){var tr=e.l+_e,rr=parse_XLSCell(e),nr=e.read_shift(2),ir=parse_XLUnicodeStringNoCch(e,nr,er);return e.l=tr,rr.t="str",rr.val=ir,rr}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},_e=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function er(ar,sr){var or=[],lr=new_raw_buf(1);switch(sr.type){case"base64":lr=s2a(Base64_decode(ar));break;case"binary":lr=s2a(ar);break;case"buffer":case"array":lr=ar;break}prep_blob(lr,0);var ur=lr.read_shift(1),fr=!!(ur&136),cr=!1,mr=!1;switch(ur){case 2:break;case 3:break;case 48:cr=!0,fr=!0;break;case 49:cr=!0,fr=!0;break;case 131:break;case 139:break;case 140:mr=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+ur.toString(16))}var dr=0,xr=521;ur==2&&(dr=lr.read_shift(2)),lr.l+=3,ur!=2&&(dr=lr.read_shift(4)),dr>1048576&&(dr=1e6),ur!=2&&(xr=lr.read_shift(2));var pr=lr.read_shift(2),gr=sr.codepage||1252;ur!=2&&(lr.l+=16,lr.read_shift(1),lr[lr.l]!==0&&(gr=e[lr[lr.l]]),lr.l+=1,lr.l+=2),mr&&(lr.l+=36);for(var vr=[],Cr={},Tr=Math.min(lr.length,ur==2?521:xr-10-(cr?264:0)),Fr=mr?32:11;lr.l<Tr&&lr[lr.l]!=13;)switch(Cr={},Cr.name=$cptable.utils.decode(gr,lr.slice(lr.l,lr.l+Fr)).replace(/[\u0000\r\n].*$/g,""),lr.l+=Fr,Cr.type=String.fromCharCode(lr.read_shift(1)),ur!=2&&!mr&&(Cr.offset=lr.read_shift(4)),Cr.len=lr.read_shift(1),ur==2&&(Cr.offset=lr.read_shift(2)),Cr.dec=lr.read_shift(1),Cr.name.length&&vr.push(Cr),ur!=2&&(lr.l+=mr?13:14),Cr.type){case"B":(!cr||Cr.len!=8)&&sr.WTF&&console.log("Skipping "+Cr.name+":"+Cr.type);break;case"G":case"P":sr.WTF&&console.log("Skipping "+Cr.name+":"+Cr.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Cr.type)}if(lr[lr.l]!==13&&(lr.l=xr-1),lr.read_shift(1)!==13)throw new Error("DBF Terminator not found "+lr.l+" "+lr[lr.l]);lr.l=xr;var _r=0,Ar=0;for(or[0]=[],Ar=0;Ar!=vr.length;++Ar)or[0][Ar]=vr[Ar].name;for(;dr-- >0;){if(lr[lr.l]===42){lr.l+=pr;continue}for(++lr.l,or[++_r]=[],Ar=0,Ar=0;Ar!=vr.length;++Ar){var Pr=lr.slice(lr.l,lr.l+vr[Ar].len);lr.l+=vr[Ar].len,prep_blob(Pr,0);var Ir=$cptable.utils.decode(gr,Pr);switch(vr[Ar].type){case"C":Ir.trim().length&&(or[_r][Ar]=Ir.replace(/\s+$/,""));break;case"D":Ir.length===8?or[_r][Ar]=new Date(+Ir.slice(0,4),+Ir.slice(4,6)-1,+Ir.slice(6,8)):or[_r][Ar]=Ir;break;case"F":or[_r][Ar]=parseFloat(Ir.trim());break;case"+":case"I":or[_r][Ar]=mr?Pr.read_shift(-4,"i")^2147483648:Pr.read_shift(4,"i");break;case"L":switch(Ir.trim().toUpperCase()){case"Y":case"T":or[_r][Ar]=!0;break;case"N":case"F":or[_r][Ar]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ir+"|")}break;case"M":if(!fr)throw new Error("DBF Unexpected MEMO for type "+ur.toString(16));or[_r][Ar]="##MEMO##"+(mr?parseInt(Ir.trim(),10):Pr.read_shift(4));break;case"N":Ir=Ir.replace(/\u0000/g,"").trim(),Ir&&Ir!="."&&(or[_r][Ar]=+Ir||0);break;case"@":or[_r][Ar]=new Date(Pr.read_shift(-8,"f")-621356832e5);break;case"T":or[_r][Ar]=new Date((Pr.read_shift(4)-2440588)*864e5+Pr.read_shift(4));break;case"Y":or[_r][Ar]=Pr.read_shift(4,"i")/1e4+Pr.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":or[_r][Ar]=-Pr.read_shift(-8,"f");break;case"B":if(cr&&vr[Ar].len==8){or[_r][Ar]=Pr.read_shift(8,"f");break}case"G":case"P":Pr.l+=vr[Ar].len;break;case"0":if(vr[Ar].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+vr[Ar].type)}}}if(ur!=2&&lr.l<lr.length&&lr[lr.l++]!=26)throw new Error("DBF EOF Marker missing "+(lr.l-1)+" of "+lr.length+" "+lr[lr.l-1].toString(16));return sr&&sr.sheetRows&&(or=or.slice(0,sr.sheetRows)),sr.DBF=vr,or}function tr(ar,sr){var or=sr||{};or.dateNF||(or.dateNF="yyyymmdd");var lr=aoa_to_sheet(er(ar,or),or);return lr["!cols"]=or.DBF.map(function(ur){return{wch:ur.len,DBF:ur}}),delete or.DBF,lr}function rr(ar,sr){try{return sheet_to_workbook(tr(ar,sr),sr)}catch(or){if(sr&&sr.WTF)throw or}return{SheetNames:[],Sheets:{}}}var nr={B:8,C:250,L:1,D:8,"?":0,"":0};function ir(ar,sr){var or=sr||{};if(+or.codepage>=0&&set_cp(+or.codepage),or.type=="string")throw new Error("Cannot write DBF to JS string");var lr=buf_array(),ur=sheet_to_json(ar,{header:1,raw:!0,cellDates:!0}),fr=ur[0],cr=ur.slice(1),mr=ar["!cols"]||[],dr=0,xr=0,pr=0,gr=1;for(dr=0;dr<fr.length;++dr){if(((mr[dr]||{}).DBF||{}).name){fr[dr]=mr[dr].DBF.name,++pr;continue}if(fr[dr]!=null){if(++pr,typeof fr[dr]=="number"&&(fr[dr]=fr[dr].toString(10)),typeof fr[dr]!="string")throw new Error("DBF Invalid column name "+fr[dr]+" |"+typeof fr[dr]+"|");if(fr.indexOf(fr[dr])!==dr){for(xr=0;xr<1024;++xr)if(fr.indexOf(fr[dr]+"_"+xr)==-1){fr[dr]+="_"+xr;break}}}}var vr=safe_decode_range(ar["!ref"]),Cr=[],Tr=[],Fr=[];for(dr=0;dr<=vr.e.c-vr.s.c;++dr){var _r="",Ar="",Pr=0,Ir=[];for(xr=0;xr<cr.length;++xr)cr[xr][dr]!=null&&Ir.push(cr[xr][dr]);if(Ir.length==0||fr[dr]==null){Cr[dr]="?";continue}for(xr=0;xr<Ir.length;++xr){switch(typeof Ir[xr]){case"number":Ar="B";break;case"string":Ar="C";break;case"boolean":Ar="L";break;case"object":Ar=Ir[xr]instanceof Date?"D":"C";break;default:Ar="C"}Pr=Math.max(Pr,String(Ir[xr]).length),_r=_r&&_r!=Ar?"C":Ar}Pr>250&&(Pr=250),Ar=((mr[dr]||{}).DBF||{}).type,Ar=="C"&&mr[dr].DBF.len>Pr&&(Pr=mr[dr].DBF.len),_r=="B"&&Ar=="N"&&(_r="N",Fr[dr]=mr[dr].DBF.dec,Pr=mr[dr].DBF.len),Tr[dr]=_r=="C"||Ar=="N"?Pr:nr[_r]||0,gr+=Tr[dr],Cr[dr]=_r}var wr=lr.next(32);for(wr.write_shift(4,318902576),wr.write_shift(4,cr.length),wr.write_shift(2,296+32*pr),wr.write_shift(2,gr),dr=0;dr<4;++dr)wr.write_shift(4,0);for(wr.write_shift(4,0|(+_e[current_ansi]||3)<<8),dr=0,xr=0;dr<fr.length;++dr)if(fr[dr]!=null){var kr=lr.next(32),Mr=(fr[dr].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);kr.write_shift(1,Mr,"sbcs"),kr.write_shift(1,Cr[dr]=="?"?"C":Cr[dr],"sbcs"),kr.write_shift(4,xr),kr.write_shift(1,Tr[dr]||nr[Cr[dr]]||0),kr.write_shift(1,Fr[dr]||0),kr.write_shift(1,2),kr.write_shift(4,0),kr.write_shift(1,0),kr.write_shift(4,0),kr.write_shift(4,0),xr+=Tr[dr]||nr[Cr[dr]]||0}var Hr=lr.next(264);for(Hr.write_shift(4,13),dr=0;dr<65;++dr)Hr.write_shift(4,0);for(dr=0;dr<cr.length;++dr){var Gr=lr.next(gr);for(Gr.write_shift(1,0),xr=0;xr<fr.length;++xr)if(fr[xr]!=null)switch(Cr[xr]){case"L":Gr.write_shift(1,cr[dr][xr]==null?63:cr[dr][xr]?84:70);break;case"B":Gr.write_shift(8,cr[dr][xr]||0,"f");break;case"N":var zr="0";for(typeof cr[dr][xr]=="number"&&(zr=cr[dr][xr].toFixed(Fr[xr]||0)),pr=0;pr<Tr[xr]-zr.length;++pr)Gr.write_shift(1,32);Gr.write_shift(1,zr,"sbcs");break;case"D":cr[dr][xr]?(Gr.write_shift(4,("0000"+cr[dr][xr].getFullYear()).slice(-4),"sbcs"),Gr.write_shift(2,("00"+(cr[dr][xr].getMonth()+1)).slice(-2),"sbcs"),Gr.write_shift(2,("00"+cr[dr][xr].getDate()).slice(-2),"sbcs")):Gr.write_shift(8,"00000000","sbcs");break;case"C":var Br=String(cr[dr][xr]!=null?cr[dr][xr]:"").slice(0,Tr[xr]);for(Gr.write_shift(1,Br,"sbcs"),pr=0;pr<Tr[xr]-Br.length;++pr)Gr.write_shift(1,32);break}}return lr.next(1).write_shift(1,26),lr.end()}return{to_workbook:rr,to_sheet:tr,from_sheet:ir}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},_e=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),er=function(fr,cr){var mr=e[cr];return typeof mr=="number"?_getansi(mr):mr},tr=function(fr,cr,mr){var dr=cr.charCodeAt(0)-32<<4|mr.charCodeAt(0)-48;return dr==59?fr:_getansi(dr)};e["|"]=254;function rr(fr,cr){switch(cr.type){case"base64":return nr(Base64_decode(fr),cr);case"binary":return nr(fr,cr);case"buffer":return nr(has_buf&&Buffer.isBuffer(fr)?fr.toString("binary"):a2s(fr),cr);case"array":return nr(cc2str(fr),cr)}throw new Error("Unrecognized type "+cr.type)}function nr(fr,cr){var mr=fr.split(/[\n\r]+/),dr=-1,xr=-1,pr=0,gr=0,vr=[],Cr=[],Tr=null,Fr={},_r=[],Ar=[],Pr=[],Ir=0,wr;for(+cr.codepage>=0&&set_cp(+cr.codepage);pr!==mr.length;++pr){Ir=0;var kr=mr[pr].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,tr).replace(_e,er),Mr=kr.replace(/;;/g,"\0").split(";").map(function(Lr){return Lr.replace(/\u0000/g,";")}),Hr=Mr[0],Gr;if(kr.length>0)switch(Hr){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Mr[1].charAt(0)=="P"&&Cr.push(kr.slice(3).replace(/;;/g,";"));break;case"C":var zr=!1,Br=!1,Vr=!1,Rr=!1,Xr=-1,an=-1;for(gr=1;gr<Mr.length;++gr)switch(Mr[gr].charAt(0)){case"A":break;case"X":xr=parseInt(Mr[gr].slice(1))-1,Br=!0;break;case"Y":for(dr=parseInt(Mr[gr].slice(1))-1,Br||(xr=0),wr=vr.length;wr<=dr;++wr)vr[wr]=[];break;case"K":Gr=Mr[gr].slice(1),Gr.charAt(0)==='"'?Gr=Gr.slice(1,Gr.length-1):Gr==="TRUE"?Gr=!0:Gr==="FALSE"?Gr=!1:isNaN(fuzzynum(Gr))?isNaN(fuzzydate(Gr).getDate())||(Gr=parseDate(Gr)):(Gr=fuzzynum(Gr),Tr!==null&&fmt_is_date(Tr)&&(Gr=numdate(Gr))),zr=!0;break;case"E":Rr=!0;var yr=rc_to_a1(Mr[gr].slice(1),{r:dr,c:xr});vr[dr][xr]=[vr[dr][xr],yr];break;case"S":Vr=!0,vr[dr][xr]=[vr[dr][xr],"S5S"];break;case"G":break;case"R":Xr=parseInt(Mr[gr].slice(1))-1;break;case"C":an=parseInt(Mr[gr].slice(1))-1;break;default:if(cr&&cr.WTF)throw new Error("SYLK bad record "+kr)}if(zr&&(vr[dr][xr]&&vr[dr][xr].length==2?vr[dr][xr][0]=Gr:vr[dr][xr]=Gr,Tr=null),Vr){if(Rr)throw new Error("SYLK shared formula cannot have own formula");var br=Xr>-1&&vr[Xr][an];if(!br||!br[1])throw new Error("SYLK shared formula cannot find base");vr[dr][xr][1]=shift_formula_str(br[1],{r:dr-Xr,c:xr-an})}break;case"F":var Er=0;for(gr=1;gr<Mr.length;++gr)switch(Mr[gr].charAt(0)){case"X":xr=parseInt(Mr[gr].slice(1))-1,++Er;break;case"Y":for(dr=parseInt(Mr[gr].slice(1))-1,wr=vr.length;wr<=dr;++wr)vr[wr]=[];break;case"M":Ir=parseInt(Mr[gr].slice(1))/20;break;case"F":break;case"G":break;case"P":Tr=Cr[parseInt(Mr[gr].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Pr=Mr[gr].slice(1).split(" "),wr=parseInt(Pr[0],10);wr<=parseInt(Pr[1],10);++wr)Ir=parseInt(Pr[2],10),Ar[wr-1]=Ir===0?{hidden:!0}:{wch:Ir},process_col(Ar[wr-1]);break;case"C":xr=parseInt(Mr[gr].slice(1))-1,Ar[xr]||(Ar[xr]={});break;case"R":dr=parseInt(Mr[gr].slice(1))-1,_r[dr]||(_r[dr]={}),Ir>0?(_r[dr].hpt=Ir,_r[dr].hpx=pt2px(Ir)):Ir===0&&(_r[dr].hidden=!0);break;default:if(cr&&cr.WTF)throw new Error("SYLK bad record "+kr)}Er<1&&(Tr=null);break;default:if(cr&&cr.WTF)throw new Error("SYLK bad record "+kr)}}return _r.length>0&&(Fr["!rows"]=_r),Ar.length>0&&(Fr["!cols"]=Ar),cr&&cr.sheetRows&&(vr=vr.slice(0,cr.sheetRows)),[vr,Fr]}function ir(fr,cr){var mr=rr(fr,cr),dr=mr[0],xr=mr[1],pr=aoa_to_sheet(dr,cr);return keys(xr).forEach(function(gr){pr[gr]=xr[gr]}),pr}function ar(fr,cr){return sheet_to_workbook(ir(fr,cr),cr)}function sr(fr,cr,mr,dr){var xr="C;Y"+(mr+1)+";X"+(dr+1)+";K";switch(fr.t){case"n":xr+=fr.v||0,fr.f&&!fr.F&&(xr+=";E"+a1_to_rc(fr.f,{r:mr,c:dr}));break;case"b":xr+=fr.v?"TRUE":"FALSE";break;case"e":xr+=fr.w||fr.v;break;case"d":xr+='"'+(fr.w||fr.v)+'"';break;case"s":xr+='"'+fr.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return xr}function or(fr,cr){cr.forEach(function(mr,dr){var xr="F;W"+(dr+1)+" "+(dr+1)+" ";mr.hidden?xr+="0":(typeof mr.width=="number"&&!mr.wpx&&(mr.wpx=width2px(mr.width)),typeof mr.wpx=="number"&&!mr.wch&&(mr.wch=px2char(mr.wpx)),typeof mr.wch=="number"&&(xr+=Math.round(mr.wch))),xr.charAt(xr.length-1)!=" "&&fr.push(xr)})}function lr(fr,cr){cr.forEach(function(mr,dr){var xr="F;";mr.hidden?xr+="M0;":mr.hpt?xr+="M"+20*mr.hpt+";":mr.hpx&&(xr+="M"+20*px2pt(mr.hpx)+";"),xr.length>2&&fr.push(xr+"R"+(dr+1))})}function ur(fr,cr){var mr=["ID;PWXL;N;E"],dr=[],xr=safe_decode_range(fr["!ref"]),pr,gr=Array.isArray(fr),vr=`\r
`;mr.push("P;PGeneral"),mr.push("F;P0;DG0G8;M255"),fr["!cols"]&&or(mr,fr["!cols"]),fr["!rows"]&&lr(mr,fr["!rows"]),mr.push("B;Y"+(xr.e.r-xr.s.r+1)+";X"+(xr.e.c-xr.s.c+1)+";D"+[xr.s.c,xr.s.r,xr.e.c,xr.e.r].join(" "));for(var Cr=xr.s.r;Cr<=xr.e.r;++Cr)for(var Tr=xr.s.c;Tr<=xr.e.c;++Tr){var Fr=encode_cell({r:Cr,c:Tr});pr=gr?(fr[Cr]||[])[Tr]:fr[Fr],!(!pr||pr.v==null&&(!pr.f||pr.F))&&dr.push(sr(pr,fr,Cr,Tr))}return mr.join(vr)+vr+dr.join(vr)+vr+"E"+vr}return{to_workbook:ar,to_sheet:ir,from_sheet:ur}}(),DIF=function(){function e(nr,ir){switch(ir.type){case"base64":return _e(Base64_decode(nr),ir);case"binary":return _e(nr,ir);case"buffer":return _e(has_buf&&Buffer.isBuffer(nr)?nr.toString("binary"):a2s(nr),ir);case"array":return _e(cc2str(nr),ir)}throw new Error("Unrecognized type "+ir.type)}function _e(nr,ir){for(var ar=nr.split(`
`),sr=-1,or=-1,lr=0,ur=[];lr!==ar.length;++lr){if(ar[lr].trim()==="BOT"){ur[++sr]=[],or=0;continue}if(!(sr<0)){var fr=ar[lr].trim().split(","),cr=fr[0],mr=fr[1];++lr;for(var dr=ar[lr]||"";(dr.match(/["]/g)||[]).length&1&&lr<ar.length-1;)dr+=`
`+ar[++lr];switch(dr=dr.trim(),+cr){case-1:if(dr==="BOT"){ur[++sr]=[],or=0;continue}else if(dr!=="EOD")throw new Error("Unrecognized DIF special command "+dr);break;case 0:dr==="TRUE"?ur[sr][or]=!0:dr==="FALSE"?ur[sr][or]=!1:isNaN(fuzzynum(mr))?isNaN(fuzzydate(mr).getDate())?ur[sr][or]=mr:ur[sr][or]=parseDate(mr):ur[sr][or]=fuzzynum(mr),++or;break;case 1:dr=dr.slice(1,dr.length-1),dr=dr.replace(/""/g,'"'),dr&&dr.match(/^=".*"$/)&&(dr=dr.slice(2,-1)),ur[sr][or++]=dr!==""?dr:null;break}if(dr==="EOD")break}}return ir&&ir.sheetRows&&(ur=ur.slice(0,ir.sheetRows)),ur}function er(nr,ir){return aoa_to_sheet(e(nr,ir),ir)}function tr(nr,ir){return sheet_to_workbook(er(nr,ir),ir)}var rr=function(){var nr=function(sr,or,lr,ur,fr){sr.push(or),sr.push(lr+","+ur),sr.push('"'+fr.replace(/"/g,'""')+'"')},ir=function(sr,or,lr,ur){sr.push(or+","+lr),sr.push(or==1?'"'+ur.replace(/"/g,'""')+'"':ur)};return function(sr){var or=[],lr=safe_decode_range(sr["!ref"]),ur,fr=Array.isArray(sr);nr(or,"TABLE",0,1,"sheetjs"),nr(or,"VECTORS",0,lr.e.r-lr.s.r+1,""),nr(or,"TUPLES",0,lr.e.c-lr.s.c+1,""),nr(or,"DATA",0,0,"");for(var cr=lr.s.r;cr<=lr.e.r;++cr){ir(or,-1,0,"BOT");for(var mr=lr.s.c;mr<=lr.e.c;++mr){var dr=encode_cell({r:cr,c:mr});if(ur=fr?(sr[cr]||[])[mr]:sr[dr],!ur){ir(or,1,0,"");continue}switch(ur.t){case"n":var xr=ur.w;!xr&&ur.v!=null&&(xr=ur.v),xr==null?ur.f&&!ur.F?ir(or,1,0,"="+ur.f):ir(or,1,0,""):ir(or,0,xr,"V");break;case"b":ir(or,0,ur.v?1:0,ur.v?"TRUE":"FALSE");break;case"s":ir(or,1,0,isNaN(ur.v)?ur.v:'="'+ur.v+'"');break;case"d":ur.w||(ur.w=SSF_format(ur.z||table_fmt[14],datenum(parseDate(ur.v)))),ir(or,0,ur.w,"V");break;default:ir(or,1,0,"")}}}ir(or,-1,0,"EOD");var pr=`\r
`,gr=or.join(pr);return gr}}();return{to_workbook:tr,to_sheet:er,from_sheet:rr}}(),ETH=function(){function e(ur){return ur.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function _e(ur){return ur.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function er(ur,fr){for(var cr=ur.split(`
`),mr=-1,dr=-1,xr=0,pr=[];xr!==cr.length;++xr){var gr=cr[xr].trim().split(":");if(gr[0]==="cell"){var vr=decode_cell(gr[1]);if(pr.length<=vr.r)for(mr=pr.length;mr<=vr.r;++mr)pr[mr]||(pr[mr]=[]);switch(mr=vr.r,dr=vr.c,gr[2]){case"t":pr[mr][dr]=e(gr[3]);break;case"v":pr[mr][dr]=+gr[3];break;case"vtf":var Cr=gr[gr.length-1];case"vtc":switch(gr[3]){case"nl":pr[mr][dr]=!!+gr[4];break;default:pr[mr][dr]=+gr[4];break}gr[2]=="vtf"&&(pr[mr][dr]=[pr[mr][dr],Cr])}}}return fr&&fr.sheetRows&&(pr=pr.slice(0,fr.sheetRows)),pr}function tr(ur,fr){return aoa_to_sheet(er(ur,fr),fr)}function rr(ur,fr){return sheet_to_workbook(tr(ur,fr),fr)}var nr=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),ir=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,ar=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),sr="--SocialCalcSpreadsheetControlSave--";function or(ur){if(!ur||!ur["!ref"])return"";for(var fr=[],cr=[],mr,dr="",xr=decode_range(ur["!ref"]),pr=Array.isArray(ur),gr=xr.s.r;gr<=xr.e.r;++gr)for(var vr=xr.s.c;vr<=xr.e.c;++vr)if(dr=encode_cell({r:gr,c:vr}),mr=pr?(ur[gr]||[])[vr]:ur[dr],!(!mr||mr.v==null||mr.t==="z")){switch(cr=["cell",dr,"t"],mr.t){case"s":case"str":cr.push(_e(mr.v));break;case"n":mr.f?(cr[2]="vtf",cr[3]="n",cr[4]=mr.v,cr[5]=_e(mr.f)):(cr[2]="v",cr[3]=mr.v);break;case"b":cr[2]="vt"+(mr.f?"f":"c"),cr[3]="nl",cr[4]=mr.v?"1":"0",cr[5]=_e(mr.f||(mr.v?"TRUE":"FALSE"));break;case"d":var Cr=datenum(parseDate(mr.v));cr[2]="vtc",cr[3]="nd",cr[4]=""+Cr,cr[5]=mr.w||SSF_format(mr.z||table_fmt[14],Cr);break;case"e":continue}fr.push(cr.join(":"))}return fr.push("sheet:c:"+(xr.e.c-xr.s.c+1)+":r:"+(xr.e.r-xr.s.r+1)+":tvf:1"),fr.push("valueformat:1:text-wiki"),fr.join(`
`)}function lr(ur){return[nr,ir,ar,ir,or(ur),sr].join(`
`)}return{to_workbook:rr,to_sheet:tr,from_sheet:lr}}(),PRN=function(){function e(lr,ur,fr,cr,mr){mr.raw?ur[fr][cr]=lr:lr===""||(lr==="TRUE"?ur[fr][cr]=!0:lr==="FALSE"?ur[fr][cr]=!1:isNaN(fuzzynum(lr))?isNaN(fuzzydate(lr).getDate())?ur[fr][cr]=lr:ur[fr][cr]=parseDate(lr):ur[fr][cr]=fuzzynum(lr))}function _e(lr,ur){var fr=ur||{},cr=[];if(!lr||lr.length===0)return cr;for(var mr=lr.split(/[\r\n]/),dr=mr.length-1;dr>=0&&mr[dr].length===0;)--dr;for(var xr=10,pr=0,gr=0;gr<=dr;++gr)pr=mr[gr].indexOf(" "),pr==-1?pr=mr[gr].length:pr++,xr=Math.max(xr,pr);for(gr=0;gr<=dr;++gr){cr[gr]=[];var vr=0;for(e(mr[gr].slice(0,xr).trim(),cr,gr,vr,fr),vr=1;vr<=(mr[gr].length-xr)/10+1;++vr)e(mr[gr].slice(xr+(vr-1)*10,xr+vr*10).trim(),cr,gr,vr,fr)}return fr.sheetRows&&(cr=cr.slice(0,fr.sheetRows)),cr}var er={44:",",9:"	",59:";",124:"|"},tr={44:3,9:2,59:1,124:0};function rr(lr){for(var ur={},fr=!1,cr=0,mr=0;cr<lr.length;++cr)(mr=lr.charCodeAt(cr))==34?fr=!fr:!fr&&mr in er&&(ur[mr]=(ur[mr]||0)+1);mr=[];for(cr in ur)Object.prototype.hasOwnProperty.call(ur,cr)&&mr.push([ur[cr],cr]);if(!mr.length){ur=tr;for(cr in ur)Object.prototype.hasOwnProperty.call(ur,cr)&&mr.push([ur[cr],cr])}return mr.sort(function(dr,xr){return dr[0]-xr[0]||tr[dr[1]]-tr[xr[1]]}),er[mr.pop()[1]]||44}function nr(lr,ur){var fr=ur||{},cr="",mr=fr.dense?[]:{},dr={s:{c:0,r:0},e:{c:0,r:0}};lr.slice(0,4)=="sep="?lr.charCodeAt(5)==13&&lr.charCodeAt(6)==10?(cr=lr.charAt(4),lr=lr.slice(7)):lr.charCodeAt(5)==13||lr.charCodeAt(5)==10?(cr=lr.charAt(4),lr=lr.slice(6)):cr=rr(lr.slice(0,1024)):fr&&fr.FS?cr=fr.FS:cr=rr(lr.slice(0,1024));var xr=0,pr=0,gr=0,vr=0,Cr=0,Tr=cr.charCodeAt(0),Fr=!1,_r=0,Ar=lr.charCodeAt(0);lr=lr.replace(/\r\n/mg,`
`);var Pr=fr.dateNF!=null?dateNF_regex(fr.dateNF):null;function Ir(){var wr=lr.slice(vr,Cr),kr={};if(wr.charAt(0)=='"'&&wr.charAt(wr.length-1)=='"'&&(wr=wr.slice(1,-1).replace(/""/g,'"')),wr.length===0)kr.t="z";else if(fr.raw)kr.t="s",kr.v=wr;else if(wr.trim().length===0)kr.t="s",kr.v=wr;else if(wr.charCodeAt(0)==61)wr.charCodeAt(1)==34&&wr.charCodeAt(wr.length-1)==34?(kr.t="s",kr.v=wr.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(wr)?(kr.t="n",kr.f=wr.slice(1)):(kr.t="s",kr.v=wr);else if(wr=="TRUE")kr.t="b",kr.v=!0;else if(wr=="FALSE")kr.t="b",kr.v=!1;else if(!isNaN(gr=fuzzynum(wr)))kr.t="n",fr.cellText!==!1&&(kr.w=wr),kr.v=gr;else if(!isNaN(fuzzydate(wr).getDate())||Pr&&wr.match(Pr)){kr.z=fr.dateNF||table_fmt[14];var Mr=0;Pr&&wr.match(Pr)&&(wr=dateNF_fix(wr,fr.dateNF,wr.match(Pr)||[]),Mr=1),fr.cellDates?(kr.t="d",kr.v=parseDate(wr,Mr)):(kr.t="n",kr.v=datenum(parseDate(wr,Mr))),fr.cellText!==!1&&(kr.w=SSF_format(kr.z,kr.v instanceof Date?datenum(kr.v):kr.v)),fr.cellNF||delete kr.z}else kr.t="s",kr.v=wr;if(kr.t=="z"||(fr.dense?(mr[xr]||(mr[xr]=[]),mr[xr][pr]=kr):mr[encode_cell({c:pr,r:xr})]=kr),vr=Cr+1,Ar=lr.charCodeAt(vr),dr.e.c<pr&&(dr.e.c=pr),dr.e.r<xr&&(dr.e.r=xr),_r==Tr)++pr;else if(pr=0,++xr,fr.sheetRows&&fr.sheetRows<=xr)return!0}e:for(;Cr<lr.length;++Cr)switch(_r=lr.charCodeAt(Cr)){case 34:Ar===34&&(Fr=!Fr);break;case Tr:case 10:case 13:if(!Fr&&Ir())break e;break}return Cr-vr>0&&Ir(),mr["!ref"]=encode_range(dr),mr}function ir(lr,ur){return!(ur&&ur.PRN)||ur.FS||lr.slice(0,4)=="sep="||lr.indexOf("	")>=0||lr.indexOf(",")>=0||lr.indexOf(";")>=0?nr(lr,ur):aoa_to_sheet(_e(lr,ur),ur)}function ar(lr,ur){var fr="",cr=ur.type=="string"?[0,0,0,0]:firstbyte(lr,ur);switch(ur.type){case"base64":fr=Base64_decode(lr);break;case"binary":fr=lr;break;case"buffer":ur.codepage==65001?fr=lr.toString("utf8"):ur.codepage&&typeof $cptable<"u"||(fr=has_buf&&Buffer.isBuffer(lr)?lr.toString("binary"):a2s(lr));break;case"array":fr=cc2str(lr);break;case"string":fr=lr;break;default:throw new Error("Unrecognized type "+ur.type)}return cr[0]==239&&cr[1]==187&&cr[2]==191?fr=utf8read(fr.slice(3)):ur.type!="string"&&ur.type!="buffer"&&ur.codepage==65001?fr=utf8read(fr):ur.type=="binary"&&typeof $cptable<"u",fr.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(ur.type=="string"?fr:utf8read(fr),ur):ir(fr,ur)}function sr(lr,ur){return sheet_to_workbook(ar(lr,ur),ur)}function or(lr){for(var ur=[],fr=safe_decode_range(lr["!ref"]),cr,mr=Array.isArray(lr),dr=fr.s.r;dr<=fr.e.r;++dr){for(var xr=[],pr=fr.s.c;pr<=fr.e.c;++pr){var gr=encode_cell({r:dr,c:pr});if(cr=mr?(lr[dr]||[])[pr]:lr[gr],!cr||cr.v==null){xr.push("          ");continue}for(var vr=(cr.w||(format_cell(cr),cr.w)||"").slice(0,10);vr.length<10;)vr+=" ";xr.push(vr+(pr===0?" ":""))}ur.push(xr.join(""))}return ur.join(`
`)}return{to_workbook:sr,to_sheet:ar,from_sheet:or}}();function read_wb_ID(e,_e){var er=_e||{},tr=!!er.WTF;er.WTF=!0;try{var rr=SYLK.to_workbook(e,er);return er.WTF=tr,rr}catch(nr){if(er.WTF=tr,!nr.message.match(/SYLK bad record ID/)&&tr)throw nr;return PRN.to_workbook(e,_e)}}var WK_=function(){function e(yr,br,Er){if(yr){prep_blob(yr,yr.l||0);for(var Lr=Er.Enum||Xr;yr.l<yr.length;){var Or=yr.read_shift(2),Ur=Lr[Or]||Lr[65535],$r=yr.read_shift(2),Zr=yr.l+$r,fn=Ur.f&&Ur.f(yr,$r,Er);if(yr.l=Zr,br(fn,Ur,Or))return}}}function _e(yr,br){switch(br.type){case"base64":return er(s2a(Base64_decode(yr)),br);case"binary":return er(s2a(yr),br);case"buffer":case"array":return er(yr,br)}throw"Unsupported type "+br.type}function er(yr,br){if(!yr)return yr;var Er=br||{},Lr=Er.dense?[]:{},Or="Sheet1",Ur="",$r=0,Zr={},fn=[],_n=[],Kr={s:{r:0,c:0},e:{r:0,c:0}},Cn=Er.sheetRows||0;if(yr[2]==0&&(yr[3]==8||yr[3]==9)&&yr.length>=16&&yr[14]==5&&yr[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(yr[2]==2)Er.Enum=Xr,e(yr,function(xn,tn,on){switch(on){case 0:Er.vers=xn,xn>=4096&&(Er.qpro=!0);break;case 6:Kr=xn;break;case 204:xn&&(Ur=xn);break;case 222:Ur=xn;break;case 15:case 51:Er.qpro||(xn[1].v=xn[1].v.slice(1));case 13:case 14:case 16:on==14&&(xn[2]&112)==112&&(xn[2]&15)>1&&(xn[2]&15)<15&&(xn[1].z=Er.dateNF||table_fmt[14],Er.cellDates&&(xn[1].t="d",xn[1].v=numdate(xn[1].v))),Er.qpro&&xn[3]>$r&&(Lr["!ref"]=encode_range(Kr),Zr[Or]=Lr,fn.push(Or),Lr=Er.dense?[]:{},Kr={s:{r:0,c:0},e:{r:0,c:0}},$r=xn[3],Or=Ur||"Sheet"+($r+1),Ur="");var vn=Er.dense?(Lr[xn[0].r]||[])[xn[0].c]:Lr[encode_cell(xn[0])];if(vn){vn.t=xn[1].t,vn.v=xn[1].v,xn[1].z!=null&&(vn.z=xn[1].z),xn[1].f!=null&&(vn.f=xn[1].f);break}Er.dense?(Lr[xn[0].r]||(Lr[xn[0].r]=[]),Lr[xn[0].r][xn[0].c]=xn[1]):Lr[encode_cell(xn[0])]=xn[1];break}},Er);else if(yr[2]==26||yr[2]==14)Er.Enum=an,yr[2]==14&&(Er.qpro=!0,yr.l=0),e(yr,function(xn,tn,on){switch(on){case 204:Or=xn;break;case 22:xn[1].v=xn[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xn[3]>$r&&(Lr["!ref"]=encode_range(Kr),Zr[Or]=Lr,fn.push(Or),Lr=Er.dense?[]:{},Kr={s:{r:0,c:0},e:{r:0,c:0}},$r=xn[3],Or="Sheet"+($r+1)),Cn>0&&xn[0].r>=Cn)break;Er.dense?(Lr[xn[0].r]||(Lr[xn[0].r]=[]),Lr[xn[0].r][xn[0].c]=xn[1]):Lr[encode_cell(xn[0])]=xn[1],Kr.e.c<xn[0].c&&(Kr.e.c=xn[0].c),Kr.e.r<xn[0].r&&(Kr.e.r=xn[0].r);break;case 27:xn[14e3]&&(_n[xn[14e3][0]]=xn[14e3][1]);break;case 1537:_n[xn[0]]=xn[1],xn[0]==$r&&(Or=xn[1]);break}},Er);else throw new Error("Unrecognized LOTUS BOF "+yr[2]);if(Lr["!ref"]=encode_range(Kr),Zr[Ur||Or]=Lr,fn.push(Ur||Or),!_n.length)return{SheetNames:fn,Sheets:Zr};for(var Dn={},wn=[],Qr=0;Qr<_n.length;++Qr)Zr[fn[Qr]]?(wn.push(_n[Qr]||fn[Qr]),Dn[_n[Qr]]=Zr[_n[Qr]]||Zr[fn[Qr]]):(wn.push(_n[Qr]),Dn[_n[Qr]]={"!ref":"A1"});return{SheetNames:wn,Sheets:Dn}}function tr(yr,br){var Er=br||{};if(+Er.codepage>=0&&set_cp(+Er.codepage),Er.type=="string")throw new Error("Cannot write WK1 to JS string");var Lr=buf_array(),Or=safe_decode_range(yr["!ref"]),Ur=Array.isArray(yr),$r=[];write_biff_rec(Lr,0,nr(1030)),write_biff_rec(Lr,6,sr(Or));for(var Zr=Math.min(Or.e.r,8191),fn=Or.s.r;fn<=Zr;++fn)for(var _n=encode_row(fn),Kr=Or.s.c;Kr<=Or.e.c;++Kr){fn===Or.s.r&&($r[Kr]=encode_col(Kr));var Cn=$r[Kr]+_n,Dn=Ur?(yr[fn]||[])[Kr]:yr[Cn];if(!(!Dn||Dn.t=="z"))if(Dn.t=="n")(Dn.v|0)==Dn.v&&Dn.v>=-32768&&Dn.v<=32767?write_biff_rec(Lr,13,cr(fn,Kr,Dn.v)):write_biff_rec(Lr,14,dr(fn,Kr,Dn.v));else{var wn=format_cell(Dn);write_biff_rec(Lr,15,ur(fn,Kr,wn.slice(0,239)))}}return write_biff_rec(Lr,1),Lr.end()}function rr(yr,br){var Er=br||{};if(+Er.codepage>=0&&set_cp(+Er.codepage),Er.type=="string")throw new Error("Cannot write WK3 to JS string");var Lr=buf_array();write_biff_rec(Lr,0,ir(yr));for(var Or=0,Ur=0;Or<yr.SheetNames.length;++Or)(yr.Sheets[yr.SheetNames[Or]]||{})["!ref"]&&write_biff_rec(Lr,27,Rr(yr.SheetNames[Or],Ur++));var $r=0;for(Or=0;Or<yr.SheetNames.length;++Or){var Zr=yr.Sheets[yr.SheetNames[Or]];if(!(!Zr||!Zr["!ref"])){for(var fn=safe_decode_range(Zr["!ref"]),_n=Array.isArray(Zr),Kr=[],Cn=Math.min(fn.e.r,8191),Dn=fn.s.r;Dn<=Cn;++Dn)for(var wn=encode_row(Dn),Qr=fn.s.c;Qr<=fn.e.c;++Qr){Dn===fn.s.r&&(Kr[Qr]=encode_col(Qr));var xn=Kr[Qr]+wn,tn=_n?(Zr[Dn]||[])[Qr]:Zr[xn];if(!(!tn||tn.t=="z"))if(tn.t=="n")write_biff_rec(Lr,23,Ir(Dn,Qr,$r,tn.v));else{var on=format_cell(tn);write_biff_rec(Lr,22,_r(Dn,Qr,$r,on.slice(0,239)))}}++$r}}return write_biff_rec(Lr,1),Lr.end()}function nr(yr){var br=new_buf(2);return br.write_shift(2,yr),br}function ir(yr){var br=new_buf(26);br.write_shift(2,4096),br.write_shift(2,4),br.write_shift(4,0);for(var Er=0,Lr=0,Or=0,Ur=0;Ur<yr.SheetNames.length;++Ur){var $r=yr.SheetNames[Ur],Zr=yr.Sheets[$r];if(!(!Zr||!Zr["!ref"])){++Or;var fn=decode_range(Zr["!ref"]);Er<fn.e.r&&(Er=fn.e.r),Lr<fn.e.c&&(Lr=fn.e.c)}}return Er>8191&&(Er=8191),br.write_shift(2,Er),br.write_shift(1,Or),br.write_shift(1,Lr),br.write_shift(2,0),br.write_shift(2,0),br.write_shift(1,1),br.write_shift(1,2),br.write_shift(4,0),br.write_shift(4,0),br}function ar(yr,br,Er){var Lr={s:{c:0,r:0},e:{c:0,r:0}};return br==8&&Er.qpro?(Lr.s.c=yr.read_shift(1),yr.l++,Lr.s.r=yr.read_shift(2),Lr.e.c=yr.read_shift(1),yr.l++,Lr.e.r=yr.read_shift(2),Lr):(Lr.s.c=yr.read_shift(2),Lr.s.r=yr.read_shift(2),br==12&&Er.qpro&&(yr.l+=2),Lr.e.c=yr.read_shift(2),Lr.e.r=yr.read_shift(2),br==12&&Er.qpro&&(yr.l+=2),Lr.s.c==65535&&(Lr.s.c=Lr.e.c=Lr.s.r=Lr.e.r=0),Lr)}function sr(yr){var br=new_buf(8);return br.write_shift(2,yr.s.c),br.write_shift(2,yr.s.r),br.write_shift(2,yr.e.c),br.write_shift(2,yr.e.r),br}function or(yr,br,Er){var Lr=[{c:0,r:0},{t:"n",v:0},0,0];return Er.qpro&&Er.vers!=20768?(Lr[0].c=yr.read_shift(1),Lr[3]=yr.read_shift(1),Lr[0].r=yr.read_shift(2),yr.l+=2):(Lr[2]=yr.read_shift(1),Lr[0].c=yr.read_shift(2),Lr[0].r=yr.read_shift(2)),Lr}function lr(yr,br,Er){var Lr=yr.l+br,Or=or(yr,br,Er);if(Or[1].t="s",Er.vers==20768){yr.l++;var Ur=yr.read_shift(1);return Or[1].v=yr.read_shift(Ur,"utf8"),Or}return Er.qpro&&yr.l++,Or[1].v=yr.read_shift(Lr-yr.l,"cstr"),Or}function ur(yr,br,Er){var Lr=new_buf(7+Er.length);Lr.write_shift(1,255),Lr.write_shift(2,br),Lr.write_shift(2,yr),Lr.write_shift(1,39);for(var Or=0;Or<Lr.length;++Or){var Ur=Er.charCodeAt(Or);Lr.write_shift(1,Ur>=128?95:Ur)}return Lr.write_shift(1,0),Lr}function fr(yr,br,Er){var Lr=or(yr,br,Er);return Lr[1].v=yr.read_shift(2,"i"),Lr}function cr(yr,br,Er){var Lr=new_buf(7);return Lr.write_shift(1,255),Lr.write_shift(2,br),Lr.write_shift(2,yr),Lr.write_shift(2,Er,"i"),Lr}function mr(yr,br,Er){var Lr=or(yr,br,Er);return Lr[1].v=yr.read_shift(8,"f"),Lr}function dr(yr,br,Er){var Lr=new_buf(13);return Lr.write_shift(1,255),Lr.write_shift(2,br),Lr.write_shift(2,yr),Lr.write_shift(8,Er,"f"),Lr}function xr(yr,br,Er){var Lr=yr.l+br,Or=or(yr,br,Er);if(Or[1].v=yr.read_shift(8,"f"),Er.qpro)yr.l=Lr;else{var Ur=yr.read_shift(2);Cr(yr.slice(yr.l,yr.l+Ur),Or),yr.l+=Ur}return Or}function pr(yr,br,Er){var Lr=br&32768;return br&=-32769,br=(Lr?yr:0)+(br>=8192?br-16384:br),(Lr?"":"$")+(Er?encode_col(br):encode_row(br))}var gr={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},vr=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Cr(yr,br){prep_blob(yr,0);for(var Er=[],Lr=0,Or="",Ur="",$r="",Zr="";yr.l<yr.length;){var fn=yr[yr.l++];switch(fn){case 0:Er.push(yr.read_shift(8,"f"));break;case 1:Ur=pr(br[0].c,yr.read_shift(2),!0),Or=pr(br[0].r,yr.read_shift(2),!1),Er.push(Ur+Or);break;case 2:{var _n=pr(br[0].c,yr.read_shift(2),!0),Kr=pr(br[0].r,yr.read_shift(2),!1);Ur=pr(br[0].c,yr.read_shift(2),!0),Or=pr(br[0].r,yr.read_shift(2),!1),Er.push(_n+Kr+":"+Ur+Or)}break;case 3:if(yr.l<yr.length){console.error("WK1 premature formula end");return}break;case 4:Er.push("("+Er.pop()+")");break;case 5:Er.push(yr.read_shift(2));break;case 6:{for(var Cn="";fn=yr[yr.l++];)Cn+=String.fromCharCode(fn);Er.push('"'+Cn.replace(/"/g,'""')+'"')}break;case 8:Er.push("-"+Er.pop());break;case 23:Er.push("+"+Er.pop());break;case 22:Er.push("NOT("+Er.pop()+")");break;case 20:case 21:Zr=Er.pop(),$r=Er.pop(),Er.push(["AND","OR"][fn-20]+"("+$r+","+Zr+")");break;default:if(fn<32&&vr[fn])Zr=Er.pop(),$r=Er.pop(),Er.push($r+vr[fn]+Zr);else if(gr[fn]){if(Lr=gr[fn][1],Lr==69&&(Lr=yr[yr.l++]),Lr>Er.length){console.error("WK1 bad formula parse 0x"+fn.toString(16)+":|"+Er.join("|")+"|");return}var Dn=Er.slice(-Lr);Er.length-=Lr,Er.push(gr[fn][0]+"("+Dn.join(",")+")")}else return fn<=7?console.error("WK1 invalid opcode "+fn.toString(16)):fn<=24?console.error("WK1 unsupported op "+fn.toString(16)):fn<=30?console.error("WK1 invalid opcode "+fn.toString(16)):fn<=115?console.error("WK1 unsupported function opcode "+fn.toString(16)):console.error("WK1 unrecognized opcode "+fn.toString(16))}}Er.length==1?br[1].f=""+Er[0]:console.error("WK1 bad formula parse |"+Er.join("|")+"|")}function Tr(yr){var br=[{c:0,r:0},{t:"n",v:0},0];return br[0].r=yr.read_shift(2),br[3]=yr[yr.l++],br[0].c=yr[yr.l++],br}function Fr(yr,br){var Er=Tr(yr);return Er[1].t="s",Er[1].v=yr.read_shift(br-4,"cstr"),Er}function _r(yr,br,Er,Lr){var Or=new_buf(6+Lr.length);Or.write_shift(2,yr),Or.write_shift(1,Er),Or.write_shift(1,br),Or.write_shift(1,39);for(var Ur=0;Ur<Lr.length;++Ur){var $r=Lr.charCodeAt(Ur);Or.write_shift(1,$r>=128?95:$r)}return Or.write_shift(1,0),Or}function Ar(yr,br){var Er=Tr(yr);Er[1].v=yr.read_shift(2);var Lr=Er[1].v>>1;if(Er[1].v&1)switch(Lr&7){case 0:Lr=(Lr>>3)*5e3;break;case 1:Lr=(Lr>>3)*500;break;case 2:Lr=(Lr>>3)/20;break;case 3:Lr=(Lr>>3)/200;break;case 4:Lr=(Lr>>3)/2e3;break;case 5:Lr=(Lr>>3)/2e4;break;case 6:Lr=(Lr>>3)/16;break;case 7:Lr=(Lr>>3)/64;break}return Er[1].v=Lr,Er}function Pr(yr,br){var Er=Tr(yr),Lr=yr.read_shift(4),Or=yr.read_shift(4),Ur=yr.read_shift(2);if(Ur==65535)return Lr===0&&Or===3221225472?(Er[1].t="e",Er[1].v=15):Lr===0&&Or===3489660928?(Er[1].t="e",Er[1].v=42):Er[1].v=0,Er;var $r=Ur&32768;return Ur=(Ur&32767)-16446,Er[1].v=(1-$r*2)*(Or*Math.pow(2,Ur+32)+Lr*Math.pow(2,Ur)),Er}function Ir(yr,br,Er,Lr){var Or=new_buf(14);if(Or.write_shift(2,yr),Or.write_shift(1,Er),Or.write_shift(1,br),Lr==0)return Or.write_shift(4,0),Or.write_shift(4,0),Or.write_shift(2,65535),Or;var Ur=0,$r=0,Zr=0,fn=0;return Lr<0&&(Ur=1,Lr=-Lr),$r=Math.log2(Lr)|0,Lr/=Math.pow(2,$r-31),fn=Lr>>>0,fn&2147483648||(Lr/=2,++$r,fn=Lr>>>0),Lr-=fn,fn|=2147483648,fn>>>=0,Lr*=Math.pow(2,32),Zr=Lr>>>0,Or.write_shift(4,Zr),Or.write_shift(4,fn),$r+=16383+(Ur?32768:0),Or.write_shift(2,$r),Or}function wr(yr,br){var Er=Pr(yr);return yr.l+=br-14,Er}function kr(yr,br){var Er=Tr(yr),Lr=yr.read_shift(4);return Er[1].v=Lr>>6,Er}function Mr(yr,br){var Er=Tr(yr),Lr=yr.read_shift(8,"f");return Er[1].v=Lr,Er}function Hr(yr,br){var Er=Mr(yr);return yr.l+=br-10,Er}function Gr(yr,br){return yr[yr.l+br-1]==0?yr.read_shift(br,"cstr"):""}function zr(yr,br){var Er=yr[yr.l++];Er>br-1&&(Er=br-1);for(var Lr="";Lr.length<Er;)Lr+=String.fromCharCode(yr[yr.l++]);return Lr}function Br(yr,br,Er){if(!(!Er.qpro||br<21)){var Lr=yr.read_shift(1);yr.l+=17,yr.l+=1,yr.l+=2;var Or=yr.read_shift(br-21,"cstr");return[Lr,Or]}}function Vr(yr,br){for(var Er={},Lr=yr.l+br;yr.l<Lr;){var Or=yr.read_shift(2);if(Or==14e3){for(Er[Or]=[0,""],Er[Or][0]=yr.read_shift(2);yr[yr.l];)Er[Or][1]+=String.fromCharCode(yr[yr.l]),yr.l++;yr.l++}}return Er}function Rr(yr,br){var Er=new_buf(5+yr.length);Er.write_shift(2,14e3),Er.write_shift(2,br);for(var Lr=0;Lr<yr.length;++Lr){var Or=yr.charCodeAt(Lr);Er[Er.l++]=Or>127?95:Or}return Er[Er.l++]=0,Er}var Xr={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:ar},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:fr},14:{n:"NUMBER",f:mr},15:{n:"LABEL",f:lr},16:{n:"FORMULA",f:xr},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:lr},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Gr},222:{n:"SHEETNAMELP",f:zr},65535:{n:""}},an={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Fr},23:{n:"NUMBER17",f:Pr},24:{n:"NUMBER18",f:Ar},25:{n:"FORMULA19",f:wr},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Vr},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:kr},38:{n:"??"},39:{n:"NUMBER27",f:Mr},40:{n:"FORMULA28",f:Hr},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Gr},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Br},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:tr,book_to_wk3:rr,to_workbook:_e}}();function parse_rpr(e){var _e={},er=e.match(tagregex),tr=0,rr=!1;if(er)for(;tr!=er.length;++tr){var nr=parsexmltag(er[tr]);switch(nr[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!nr.val)break;case"<shadow>":case"<shadow/>":_e.shadow=1;break;case"</shadow>":break;case"<charset":if(nr.val=="1")break;_e.cp=CS2CP[parseInt(nr.val,10)];break;case"<outline":if(!nr.val)break;case"<outline>":case"<outline/>":_e.outline=1;break;case"</outline>":break;case"<rFont":_e.name=nr.val;break;case"<sz":_e.sz=nr.val;break;case"<strike":if(!nr.val)break;case"<strike>":case"<strike/>":_e.strike=1;break;case"</strike>":break;case"<u":if(!nr.val)break;switch(nr.val){case"double":_e.uval="double";break;case"singleAccounting":_e.uval="single-accounting";break;case"doubleAccounting":_e.uval="double-accounting";break}case"<u>":case"<u/>":_e.u=1;break;case"</u>":break;case"<b":if(nr.val=="0")break;case"<b>":case"<b/>":_e.b=1;break;case"</b>":break;case"<i":if(nr.val=="0")break;case"<i>":case"<i/>":_e.i=1;break;case"</i>":break;case"<color":nr.rgb&&(_e.color=nr.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":_e.family=nr.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":_e.valign=nr.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":rr=!0;break;case"</ext>":rr=!1;break;default:if(nr[0].charCodeAt(1)!==47&&!rr)throw new Error("Unrecognized rich format "+nr[0])}}return _e}var parse_rs=function(){var e=matchtag("t"),_e=matchtag("rPr");function er(nr){var ir=nr.match(e);if(!ir)return{t:"s",v:""};var ar={t:"s",v:unescapexml(ir[1])},sr=nr.match(_e);return sr&&(ar.s=parse_rpr(sr[1])),ar}var tr=/<(?:\w+:)?r>/g,rr=/<\/(?:\w+:)?r>/;return function(ir){return ir.replace(tr,"").split(rr).map(er).filter(function(ar){return ar.v})}}(),rs_to_html=function e(){var _e=/(\r\n|\n)/g;function er(rr,nr,ir){var ar=[];rr.u&&ar.push("text-decoration: underline;"),rr.uval&&ar.push("text-underline-style:"+rr.uval+";"),rr.sz&&ar.push("font-size:"+rr.sz+"pt;"),rr.outline&&ar.push("text-effect: outline;"),rr.shadow&&ar.push("text-shadow: auto;"),nr.push('<span style="'+ar.join("")+'">'),rr.b&&(nr.push("<b>"),ir.push("</b>")),rr.i&&(nr.push("<i>"),ir.push("</i>")),rr.strike&&(nr.push("<s>"),ir.push("</s>"));var sr=rr.valign||"";return sr=="superscript"||sr=="super"?sr="sup":sr=="subscript"&&(sr="sub"),sr!=""&&(nr.push("<"+sr+">"),ir.push("</"+sr+">")),ir.push("</span>"),rr}function tr(rr){var nr=[[],rr.v,[]];return rr.v?(rr.s&&er(rr.s,nr[0],nr[2]),nr[0].join("")+nr[1].replace(_e,"<br/>")+nr[2].join("")):""}return function(nr){return nr.map(tr).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,_e){var er=_e?_e.cellHTML:!0,tr={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(tr.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),tr.r=utf8read(e),er&&(tr.h=escapehtml(tr.t))):e.match(sirregex)&&(tr.r=utf8read(e),tr.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),er&&(tr.h=rs_to_html(parse_rs(tr.r)))),tr):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,_e){var er=[],tr="";if(!e)return er;var rr=e.match(sstr0);if(rr){tr=rr[2].replace(sstr1,"").split(sstr2);for(var nr=0;nr!=tr.length;++nr){var ir=parse_si(tr[nr].trim(),_e);ir!=null&&(er[er.length]=ir)}rr=parsexmltag(rr[1]),er.Count=rr.count,er.Unique=rr.uniqueCount}return er}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,_e){if(!_e.bookSST)return"";var er=[XML_HEADER];er[er.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var tr=0;tr!=e.length;++tr)if(e[tr]!=null){var rr=e[tr],nr="<si>";rr.r?nr+=rr.r:(nr+="<t",rr.t||(rr.t=""),rr.t.match(straywsregex)&&(nr+=' xml:space="preserve"'),nr+=">"+escapexml(rr.t)+"</t>"),nr+="</si>",er[er.length]=nr}return er.length>2&&(er[er.length]="</sst>",er[1]=er[1].replace("/>",">")),er.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,_e){var er=[],tr=!1;return recordhopper(e,function(nr,ir,ar){switch(ar){case 159:er.Count=nr[0],er.Unique=nr[1];break;case 19:er.push(nr);break;case 160:return!0;case 35:tr=!0;break;case 36:tr=!1;break;default:if(ir.T,!tr||_e.WTF)throw new Error("Unexpected record 0x"+ar.toString(16))}}),er}function write_BrtBeginSst(e,_e){return _e||(_e=new_buf(8)),_e.write_shift(4,e.Count),_e.write_shift(4,e.Unique),_e}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var _e=buf_array();write_record(_e,159,write_BrtBeginSst(e));for(var er=0;er<e.length;++er)write_record(_e,19,write_BrtSSTItem(e[er]));return write_record(_e,160),_e.end()}function _JS2ANSI(e){for(var _e=[],er=e.split(""),tr=0;tr<er.length;++tr)_e[tr]=er[tr].charCodeAt(0);return _e}function parse_CRYPTOVersion(e,_e){var er={};return er.Major=e.read_shift(2),er.Minor=e.read_shift(2),_e>=4&&(e.l+=_e-4),er}function parse_DataSpaceVersionInfo(e){var _e={};return _e.id=e.read_shift(0,"lpp4"),_e.R=parse_CRYPTOVersion(e,4),_e.U=parse_CRYPTOVersion(e,4),_e.W=parse_CRYPTOVersion(e,4),_e}function parse_DataSpaceMapEntry(e){for(var _e=e.read_shift(4),er=e.l+_e-4,tr={},rr=e.read_shift(4),nr=[];rr-- >0;)nr.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(tr.name=e.read_shift(0,"lpp4"),tr.comps=nr,e.l!=er)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+er);return tr}function parse_DataSpaceMap(e){var _e=[];e.l+=4;for(var er=e.read_shift(4);er-- >0;)_e.push(parse_DataSpaceMapEntry(e));return _e}function parse_DataSpaceDefinition(e){var _e=[];e.l+=4;for(var er=e.read_shift(4);er-- >0;)_e.push(e.read_shift(0,"lpp4"));return _e}function parse_TransformInfoHeader(e){var _e={};return e.read_shift(4),e.l+=4,_e.id=e.read_shift(0,"lpp4"),_e.name=e.read_shift(0,"lpp4"),_e.R=parse_CRYPTOVersion(e,4),_e.U=parse_CRYPTOVersion(e,4),_e.W=parse_CRYPTOVersion(e,4),_e}function parse_Primary(e){var _e=parse_TransformInfoHeader(e);if(_e.ename=e.read_shift(0,"8lpp4"),_e.blksz=e.read_shift(4),_e.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return _e}function parse_EncryptionHeader(e,_e){var er=e.l+_e,tr={};tr.Flags=e.read_shift(4)&63,e.l+=4,tr.AlgID=e.read_shift(4);var rr=!1;switch(tr.AlgID){case 26126:case 26127:case 26128:rr=tr.Flags==36;break;case 26625:rr=tr.Flags==4;break;case 0:rr=tr.Flags==16||tr.Flags==4||tr.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+tr.AlgID}if(!rr)throw new Error("Encryption Flags/AlgID mismatch");return tr.AlgIDHash=e.read_shift(4),tr.KeySize=e.read_shift(4),tr.ProviderType=e.read_shift(4),e.l+=8,tr.CSPName=e.read_shift(er-e.l>>1,"utf16le"),e.l=er,tr}function parse_EncryptionVerifier(e,_e){var er={},tr=e.l+_e;return e.l+=4,er.Salt=e.slice(e.l,e.l+16),e.l+=16,er.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),er.VerifierHash=e.slice(e.l,tr),e.l=tr,er}function parse_EncryptionInfo(e){var _e=parse_CRYPTOVersion(e);switch(_e.Minor){case 2:return[_e.Minor,parse_EncInfoStd(e)];case 3:return[_e.Minor,parse_EncInfoExt()];case 4:return[_e.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+_e.Minor)}function parse_EncInfoStd(e){var _e=e.read_shift(4);if((_e&63)!=36)throw new Error("EncryptionInfo mismatch");var er=e.read_shift(4),tr=parse_EncryptionHeader(e,er),rr=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:tr,v:rr}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var _e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var er=e.read_shift(e.length-e.l,"utf8"),tr={};return er.replace(tagregex,function(nr){var ir=parsexmltag(nr);switch(strip_ns(ir[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":_e.forEach(function(ar){tr[ar]=ir[ar]});break;case"<dataIntegrity":tr.encryptedHmacKey=ir.encryptedHmacKey,tr.encryptedHmacValue=ir.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":tr.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":tr.uri=ir.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":tr.encs.push(ir);break;default:throw ir[0]}}),tr}function parse_RC4CryptoHeader(e,_e){var er={},tr=er.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(_e-=4,tr.Minor!=2)throw new Error("unrecognized minor version code: "+tr.Minor);if(tr.Major>4||tr.Major<2)throw new Error("unrecognized major version code: "+tr.Major);er.Flags=e.read_shift(4),_e-=4;var rr=e.read_shift(4);return _e-=4,er.EncryptionHeader=parse_EncryptionHeader(e,rr),_e-=rr,er.EncryptionVerifier=parse_EncryptionVerifier(e,_e),er}function parse_RC4Header(e){var _e={},er=_e.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(er.Major!=1||er.Minor!=1)throw"unrecognized version code "+er.Major+" : "+er.Minor;return _e.Salt=e.read_shift(16),_e.EncryptedVerifier=e.read_shift(16),_e.EncryptedVerifierHash=e.read_shift(16),_e}function crypto_CreatePasswordVerifier_Method1(e){var _e=0,er,tr=_JS2ANSI(e),rr=tr.length+1,nr,ir,ar,sr,or;for(er=new_raw_buf(rr),er[0]=tr.length,nr=1;nr!=rr;++nr)er[nr]=tr[nr-1];for(nr=rr-1;nr>=0;--nr)ir=er[nr],ar=_e&16384?1:0,sr=_e<<1&32767,or=ar|sr,_e=or^ir;return _e^52811}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],_e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],er=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],tr=function(ir){return(ir/2|ir*128)&255},rr=function(ir,ar){return tr(ir^ar)},nr=function(ir){for(var ar=_e[ir.length-1],sr=104,or=ir.length-1;or>=0;--or)for(var lr=ir[or],ur=0;ur!=7;++ur)lr&64&&(ar^=er[sr]),lr*=2,--sr;return ar};return function(ir){for(var ar=_JS2ANSI(ir),sr=nr(ar),or=ar.length,lr=new_raw_buf(16),ur=0;ur!=16;++ur)lr[ur]=0;var fr,cr,mr;for((or&1)===1&&(fr=sr>>8,lr[or]=rr(e[0],fr),--or,fr=sr&255,cr=ar[ar.length-1],lr[or]=rr(cr,fr));or>0;)--or,fr=sr>>8,lr[or]=rr(ar[or],fr),--or,fr=sr&255,lr[or]=rr(ar[or],fr);for(or=15,mr=15-ar.length;mr>0;)fr=sr>>8,lr[or]=rr(e[mr],fr),--or,--mr,fr=sr&255,lr[or]=rr(ar[or],fr),--or,--mr;return lr}}(),crypto_DecryptData_Method1=function(e,_e,er,tr,rr){rr||(rr=_e),tr||(tr=crypto_CreateXorArray_Method1(e));var nr,ir;for(nr=0;nr!=_e.length;++nr)ir=_e[nr],ir^=tr[er],ir=(ir>>5|ir<<3)&255,rr[nr]=ir,++er;return[rr,er,tr]},crypto_MakeXorDecryptor=function(e){var _e=0,er=crypto_CreateXorArray_Method1(e);return function(tr){var rr=crypto_DecryptData_Method1("",tr,_e,er);return _e=rr[1],rr[0]}};function parse_XORObfuscation(e,_e,er,tr){var rr={key:parseuint16(e),verificationBytes:parseuint16(e)};return er.password&&(rr.verifier=crypto_CreatePasswordVerifier_Method1(er.password)),tr.valid=rr.verificationBytes===rr.verifier,tr.valid&&(tr.insitu=crypto_MakeXorDecryptor(er.password)),rr}function parse_FilePassHeader(e,_e,er){var tr=er||{};return tr.Info=e.read_shift(2),e.l-=2,tr.Info===1?tr.Data=parse_RC4Header(e):tr.Data=parse_RC4CryptoHeader(e,_e),tr}function parse_FilePass(e,_e,er){var tr={Type:er.biff>=8?e.read_shift(2):0};return tr.Type?parse_FilePassHeader(e,_e-2,tr):parse_XORObfuscation(e,er.biff>=8?_e:_e-2,er,tr),tr}var RTF=function(){function e(rr,nr){switch(nr.type){case"base64":return _e(Base64_decode(rr),nr);case"binary":return _e(rr,nr);case"buffer":return _e(has_buf&&Buffer.isBuffer(rr)?rr.toString("binary"):a2s(rr),nr);case"array":return _e(cc2str(rr),nr)}throw new Error("Unrecognized type "+nr.type)}function _e(rr,nr){var ir=nr||{},ar=ir.dense?[]:{},sr=rr.match(/\\trowd.*?\\row\b/g);if(!sr.length)throw new Error("RTF missing table");var or={s:{c:0,r:0},e:{c:0,r:sr.length-1}};return sr.forEach(function(lr,ur){Array.isArray(ar)&&(ar[ur]=[]);for(var fr=/\\\w+\b/g,cr=0,mr,dr=-1;mr=fr.exec(lr);){switch(mr[0]){case"\\cell":var xr=lr.slice(cr,fr.lastIndex-mr[0].length);if(xr[0]==" "&&(xr=xr.slice(1)),++dr,xr.length){var pr={v:xr,t:"s"};Array.isArray(ar)?ar[ur][dr]=pr:ar[encode_cell({r:ur,c:dr})]=pr}break}cr=fr.lastIndex}dr>or.e.c&&(or.e.c=dr)}),ar["!ref"]=encode_range(or),ar}function er(rr,nr){return sheet_to_workbook(e(rr,nr),nr)}function tr(rr){for(var nr=["{\\rtf1\\ansi"],ir=safe_decode_range(rr["!ref"]),ar,sr=Array.isArray(rr),or=ir.s.r;or<=ir.e.r;++or){nr.push("\\trowd\\trautofit1");for(var lr=ir.s.c;lr<=ir.e.c;++lr)nr.push("\\cellx"+(lr+1));for(nr.push("\\pard\\intbl"),lr=ir.s.c;lr<=ir.e.c;++lr){var ur=encode_cell({r:or,c:lr});ar=sr?(rr[or]||[])[lr]:rr[ur],!(!ar||ar.v==null&&(!ar.f||ar.F))&&(nr.push(" "+(ar.w||(format_cell(ar),ar.w))),nr.push("\\cell"))}nr.push("\\pard\\intbl\\row")}return nr.join("")+"}"}return{to_workbook:er,to_sheet:e,from_sheet:tr}}();function hex2RGB(e){var _e=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(_e.slice(0,2),16),parseInt(_e.slice(2,4),16),parseInt(_e.slice(4,6),16)]}function rgb2Hex(e){for(var _e=0,er=1;_e!=3;++_e)er=er*256+(e[_e]>255?255:e[_e]<0?0:e[_e]);return er.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var _e=e[0]/255,er=e[1]/255,tr=e[2]/255,rr=Math.max(_e,er,tr),nr=Math.min(_e,er,tr),ir=rr-nr;if(ir===0)return[0,0,_e];var ar=0,sr=0,or=rr+nr;switch(sr=ir/(or>1?2-or:or),rr){case _e:ar=((er-tr)/ir+6)%6;break;case er:ar=(tr-_e)/ir+2;break;case tr:ar=(_e-er)/ir+4;break}return[ar/6,sr,or/2]}function hsl2RGB(e){var _e=e[0],er=e[1],tr=e[2],rr=er*2*(tr<.5?tr:1-tr),nr=tr-rr/2,ir=[nr,nr,nr],ar=6*_e,sr;if(er!==0)switch(ar|0){case 0:case 6:sr=rr*ar,ir[0]+=rr,ir[1]+=sr;break;case 1:sr=rr*(2-ar),ir[0]+=sr,ir[1]+=rr;break;case 2:sr=rr*(ar-2),ir[1]+=rr,ir[2]+=sr;break;case 3:sr=rr*(4-ar),ir[1]+=sr,ir[2]+=rr;break;case 4:sr=rr*(ar-4),ir[2]+=rr,ir[0]+=sr;break;case 5:sr=rr*(6-ar),ir[2]+=sr,ir[0]+=rr;break}for(var or=0;or!=3;++or)ir[or]=Math.round(ir[or]*255);return ir}function rgb_tint(e,_e){if(_e===0)return e;var er=rgb2HSL(hex2RGB(e));return _e<0?er[2]=er[2]*(1+_e):er[2]=1-(1-er[2])*(1-_e),rgb2Hex(hsl2RGB(er))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var _e=Math.abs(e-cycle_width(e)),er=MDW;if(_e>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=_e&&(_e=Math.abs(e-cycle_width(e)),er=MDW);MDW=er}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,_e,er,tr){_e.Borders=[];var rr={},nr=!1;(e[0].match(tagregex)||[]).forEach(function(ir){var ar=parsexmltag(ir);switch(strip_ns(ar[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":rr={},ar.diagonalUp&&(rr.diagonalUp=parsexmlbool(ar.diagonalUp)),ar.diagonalDown&&(rr.diagonalDown=parsexmlbool(ar.diagonalDown)),_e.Borders.push(rr);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":nr=!0;break;case"</ext>":nr=!1;break;default:if(tr&&tr.WTF&&!nr)throw new Error("unrecognized "+ar[0]+" in borders")}})}function parse_fills(e,_e,er,tr){_e.Fills=[];var rr={},nr=!1;(e[0].match(tagregex)||[]).forEach(function(ir){var ar=parsexmltag(ir);switch(strip_ns(ar[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":rr={},_e.Fills.push(rr);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":_e.Fills.push(rr),rr={};break;case"<patternFill":case"<patternFill>":ar.patternType&&(rr.patternType=ar.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":rr.bgColor||(rr.bgColor={}),ar.indexed&&(rr.bgColor.indexed=parseInt(ar.indexed,10)),ar.theme&&(rr.bgColor.theme=parseInt(ar.theme,10)),ar.tint&&(rr.bgColor.tint=parseFloat(ar.tint)),ar.rgb&&(rr.bgColor.rgb=ar.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":rr.fgColor||(rr.fgColor={}),ar.theme&&(rr.fgColor.theme=parseInt(ar.theme,10)),ar.tint&&(rr.fgColor.tint=parseFloat(ar.tint)),ar.rgb!=null&&(rr.fgColor.rgb=ar.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":nr=!0;break;case"</ext>":nr=!1;break;default:if(tr&&tr.WTF&&!nr)throw new Error("unrecognized "+ar[0]+" in fills")}})}function parse_fonts(e,_e,er,tr){_e.Fonts=[];var rr={},nr=!1;(e[0].match(tagregex)||[]).forEach(function(ir){var ar=parsexmltag(ir);switch(strip_ns(ar[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":_e.Fonts.push(rr),rr={};break;case"<name":ar.val&&(rr.name=utf8read(ar.val));break;case"<name/>":case"</name>":break;case"<b":rr.bold=ar.val?parsexmlbool(ar.val):1;break;case"<b/>":rr.bold=1;break;case"<i":rr.italic=ar.val?parsexmlbool(ar.val):1;break;case"<i/>":rr.italic=1;break;case"<u":switch(ar.val){case"none":rr.underline=0;break;case"single":rr.underline=1;break;case"double":rr.underline=2;break;case"singleAccounting":rr.underline=33;break;case"doubleAccounting":rr.underline=34;break}break;case"<u/>":rr.underline=1;break;case"<strike":rr.strike=ar.val?parsexmlbool(ar.val):1;break;case"<strike/>":rr.strike=1;break;case"<outline":rr.outline=ar.val?parsexmlbool(ar.val):1;break;case"<outline/>":rr.outline=1;break;case"<shadow":rr.shadow=ar.val?parsexmlbool(ar.val):1;break;case"<shadow/>":rr.shadow=1;break;case"<condense":rr.condense=ar.val?parsexmlbool(ar.val):1;break;case"<condense/>":rr.condense=1;break;case"<extend":rr.extend=ar.val?parsexmlbool(ar.val):1;break;case"<extend/>":rr.extend=1;break;case"<sz":ar.val&&(rr.sz=+ar.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":ar.val&&(rr.vertAlign=ar.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":ar.val&&(rr.family=parseInt(ar.val,10));break;case"<family/>":case"</family>":break;case"<scheme":ar.val&&(rr.scheme=ar.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(ar.val=="1")break;ar.codepage=CS2CP[parseInt(ar.val,10)];break;case"<color":if(rr.color||(rr.color={}),ar.auto&&(rr.color.auto=parsexmlbool(ar.auto)),ar.rgb)rr.color.rgb=ar.rgb.slice(-6);else if(ar.indexed){rr.color.index=parseInt(ar.indexed,10);var sr=XLSIcv[rr.color.index];rr.color.index==81&&(sr=XLSIcv[1]),sr||(sr=XLSIcv[1]),rr.color.rgb=sr[0].toString(16)+sr[1].toString(16)+sr[2].toString(16)}else ar.theme&&(rr.color.theme=parseInt(ar.theme,10),ar.tint&&(rr.color.tint=parseFloat(ar.tint)),ar.theme&&er.themeElements&&er.themeElements.clrScheme&&(rr.color.rgb=rgb_tint(er.themeElements.clrScheme[rr.color.theme].rgb,rr.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":nr=!0;break;case"</AlternateContent>":nr=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":nr=!0;break;case"</ext>":nr=!1;break;default:if(tr&&tr.WTF&&!nr)throw new Error("unrecognized "+ar[0]+" in fonts")}})}function parse_numFmts(e,_e,er){_e.NumberFmt=[];for(var tr=keys(table_fmt),rr=0;rr<tr.length;++rr)_e.NumberFmt[tr[rr]]=table_fmt[tr[rr]];var nr=e[0].match(tagregex);if(nr)for(rr=0;rr<nr.length;++rr){var ir=parsexmltag(nr[rr]);switch(strip_ns(ir[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var ar=unescapexml(utf8read(ir.formatCode)),sr=parseInt(ir.numFmtId,10);if(_e.NumberFmt[sr]=ar,sr>0){if(sr>392){for(sr=392;sr>60&&_e.NumberFmt[sr]!=null;--sr);_e.NumberFmt[sr]=ar}SSF_load(ar,sr)}}break;case"</numFmt>":break;default:if(er.WTF)throw new Error("unrecognized "+ir[0]+" in numFmts")}}}function write_numFmts(e){var _e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(er){for(var tr=er[0];tr<=er[1];++tr)e[tr]!=null&&(_e[_e.length]=writextag("numFmt",null,{numFmtId:tr,formatCode:escapexml(e[tr])}))}),_e.length===1?"":(_e[_e.length]="</numFmts>",_e[0]=writextag("numFmts",null,{count:_e.length-2}).replace("/>",">"),_e.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,_e,er){_e.CellXf=[];var tr,rr=!1;(e[0].match(tagregex)||[]).forEach(function(nr){var ir=parsexmltag(nr),ar=0;switch(strip_ns(ir[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(tr=ir,delete tr[0],ar=0;ar<cellXF_uint.length;++ar)tr[cellXF_uint[ar]]&&(tr[cellXF_uint[ar]]=parseInt(tr[cellXF_uint[ar]],10));for(ar=0;ar<cellXF_bool.length;++ar)tr[cellXF_bool[ar]]&&(tr[cellXF_bool[ar]]=parsexmlbool(tr[cellXF_bool[ar]]));if(_e.NumberFmt&&tr.numFmtId>392){for(ar=392;ar>60;--ar)if(_e.NumberFmt[tr.numFmtId]==_e.NumberFmt[ar]){tr.numFmtId=ar;break}}_e.CellXf.push(tr);break;case"</xf>":break;case"<alignment":case"<alignment/>":var sr={};ir.vertical&&(sr.vertical=ir.vertical),ir.horizontal&&(sr.horizontal=ir.horizontal),ir.textRotation!=null&&(sr.textRotation=ir.textRotation),ir.indent&&(sr.indent=ir.indent),ir.wrapText&&(sr.wrapText=parsexmlbool(ir.wrapText)),tr.alignment=sr;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":rr=!0;break;case"</AlternateContent>":rr=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":rr=!0;break;case"</ext>":rr=!1;break;default:if(er&&er.WTF&&!rr)throw new Error("unrecognized "+ir[0]+" in cellXfs")}})}function write_cellXfs(e){var _e=[];return _e[_e.length]=writextag("cellXfs",null),e.forEach(function(er){_e[_e.length]=writextag("xf",null,er)}),_e[_e.length]="</cellXfs>",_e.length===2?"":(_e[0]=writextag("cellXfs",null,{count:_e.length-2}).replace("/>",">"),_e.join(""))}var parse_sty_xml=function e(){var _e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,er=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,tr=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,rr=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,nr=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(ar,sr,or){var lr={};if(!ar)return lr;ar=ar.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var ur;return(ur=ar.match(_e))&&parse_numFmts(ur,lr,or),(ur=ar.match(rr))&&parse_fonts(ur,lr,sr,or),(ur=ar.match(tr))&&parse_fills(ur,lr,sr,or),(ur=ar.match(nr))&&parse_borders(ur,lr,sr,or),(ur=ar.match(er))&&parse_cellXfs(ur,lr,or),lr}}();function write_sty_xml(e,_e){var er=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],tr;return e.SSF&&(tr=write_numFmts(e.SSF))!=null&&(er[er.length]=tr),er[er.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',er[er.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',er[er.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',er[er.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(tr=write_cellXfs(_e.cellXfs))&&(er[er.length]=tr),er[er.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',er[er.length]='<dxfs count="0"/>',er[er.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',er.length>2&&(er[er.length]="</styleSheet>",er[1]=er[1].replace("/>",">")),er.join("")}function parse_BrtFmt(e,_e){var er=e.read_shift(2),tr=parse_XLWideString(e);return[er,tr]}function write_BrtFmt(e,_e,er){er||(er=new_buf(6+4*_e.length)),er.write_shift(2,e),write_XLWideString(_e,er);var tr=er.length>er.l?er.slice(0,er.l):er;return er.l==null&&(er.l=er.length),tr}function parse_BrtFont(e,_e,er){var tr={};tr.sz=e.read_shift(2)/20;var rr=parse_FontFlags(e);rr.fItalic&&(tr.italic=1),rr.fCondense&&(tr.condense=1),rr.fExtend&&(tr.extend=1),rr.fShadow&&(tr.shadow=1),rr.fOutline&&(tr.outline=1),rr.fStrikeout&&(tr.strike=1);var nr=e.read_shift(2);switch(nr===700&&(tr.bold=1),e.read_shift(2)){case 1:tr.vertAlign="superscript";break;case 2:tr.vertAlign="subscript";break}var ir=e.read_shift(1);ir!=0&&(tr.underline=ir);var ar=e.read_shift(1);ar>0&&(tr.family=ar);var sr=e.read_shift(1);switch(sr>0&&(tr.charset=sr),e.l++,tr.color=parse_BrtColor(e),e.read_shift(1)){case 1:tr.scheme="major";break;case 2:tr.scheme="minor";break}return tr.name=parse_XLWideString(e),tr}function write_BrtFont(e,_e){_e||(_e=new_buf(25+4*32)),_e.write_shift(2,e.sz*20),write_FontFlags(e,_e),_e.write_shift(2,e.bold?700:400);var er=0;e.vertAlign=="superscript"?er=1:e.vertAlign=="subscript"&&(er=2),_e.write_shift(2,er),_e.write_shift(1,e.underline||0),_e.write_shift(1,e.family||0),_e.write_shift(1,e.charset||0),_e.write_shift(1,0),write_BrtColor(e.color,_e);var tr=0;return tr=2,_e.write_shift(1,tr),write_XLWideString(e.name,_e),_e.length>_e.l?_e.slice(0,_e.l):_e}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,_e){_e||(_e=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var er=rev_XLSBFillPTNames[e.patternType];er==null&&(er=40),_e.write_shift(4,er);var tr=0;if(er!=40)for(write_BrtColor({auto:1},_e),write_BrtColor({auto:1},_e);tr<12;++tr)_e.write_shift(4,0);else{for(;tr<4;++tr)_e.write_shift(4,0);for(;tr<12;++tr)_e.write_shift(4,0)}return _e.length>_e.l?_e.slice(0,_e.l):_e}function parse_BrtXF(e,_e){var er=e.l+_e,tr=e.read_shift(2),rr=e.read_shift(2);return e.l=er,{ixfe:tr,numFmtId:rr}}function write_BrtXF(e,_e,er){er||(er=new_buf(16)),er.write_shift(2,_e||0),er.write_shift(2,e.numFmtId||0),er.write_shift(2,0),er.write_shift(2,0),er.write_shift(2,0),er.write_shift(1,0),er.write_shift(1,0);var tr=0;return er.write_shift(1,tr),er.write_shift(1,0),er.write_shift(1,0),er.write_shift(1,0),er}function write_Blxf(e,_e){return _e||(_e=new_buf(10)),_e.write_shift(1,0),_e.write_shift(1,0),_e.write_shift(4,0),_e.write_shift(4,0),_e}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,_e){return _e||(_e=new_buf(51)),_e.write_shift(1,0),write_Blxf(null,_e),write_Blxf(null,_e),write_Blxf(null,_e),write_Blxf(null,_e),write_Blxf(null,_e),_e.length>_e.l?_e.slice(0,_e.l):_e}function write_BrtStyle(e,_e){return _e||(_e=new_buf(12+4*10)),_e.write_shift(4,e.xfId),_e.write_shift(2,1),_e.write_shift(1,0),_e.write_shift(1,0),write_XLNullableWideString(e.name||"",_e),_e.length>_e.l?_e.slice(0,_e.l):_e}function write_BrtBeginTableStyles(e,_e,er){var tr=new_buf(2052);return tr.write_shift(4,e),write_XLNullableWideString(_e,tr),write_XLNullableWideString(er,tr),tr.length>tr.l?tr.slice(0,tr.l):tr}function parse_sty_bin(e,_e,er){var tr={};tr.NumberFmt=[];for(var rr in table_fmt)tr.NumberFmt[rr]=table_fmt[rr];tr.CellXf=[],tr.Fonts=[];var nr=[],ir=!1;return recordhopper(e,function(sr,or,lr){switch(lr){case 44:tr.NumberFmt[sr[0]]=sr[1],SSF_load(sr[1],sr[0]);break;case 43:tr.Fonts.push(sr),sr.color.theme!=null&&_e&&_e.themeElements&&_e.themeElements.clrScheme&&(sr.color.rgb=rgb_tint(_e.themeElements.clrScheme[sr.color.theme].rgb,sr.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:nr[nr.length-1]==617&&tr.CellXf.push(sr);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:ir=!0;break;case 36:ir=!1;break;case 37:nr.push(lr),ir=!0;break;case 38:nr.pop(),ir=!1;break;default:if(or.T>0)nr.push(lr);else if(or.T<0)nr.pop();else if(!ir||er.WTF&&nr[nr.length-1]!=37)throw new Error("Unexpected record 0x"+lr.toString(16))}}),tr}function write_FMTS_bin(e,_e){if(_e){var er=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(tr){for(var rr=tr[0];rr<=tr[1];++rr)_e[rr]!=null&&++er}),er!=0&&(write_record(e,615,write_UInt32LE(er)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(tr){for(var rr=tr[0];rr<=tr[1];++rr)_e[rr]!=null&&write_record(e,44,write_BrtFmt(rr,_e[rr]))}),write_record(e,616))}}function write_FONTS_bin(e){var _e=1;write_record(e,611,write_UInt32LE(_e)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(e,612)}function write_FILLS_bin(e){var _e=2;write_record(e,603,write_UInt32LE(_e)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var _e=1;write_record(e,613,write_UInt32LE(_e)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var _e=1;write_record(e,626,write_UInt32LE(_e)),write_record(e,47,write_BrtXF({numFmtId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,_e){write_record(e,617,write_UInt32LE(_e.length)),_e.forEach(function(er){write_record(e,47,write_BrtXF(er,0))}),write_record(e,618)}function write_STYLES_bin(e){var _e=1;write_record(e,619,write_UInt32LE(_e)),write_record(e,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var _e=0;write_record(e,505,write_UInt32LE(_e)),write_record(e,506)}function write_TABLESTYLES_bin(e){var _e=0;write_record(e,508,write_BrtBeginTableStyles(_e,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,_e){var er=buf_array();return write_record(er,278),write_FMTS_bin(er,e.SSF),write_FONTS_bin(er),write_FILLS_bin(er),write_BORDERS_bin(er),write_CELLSTYLEXFS_bin(er),write_CELLXFS_bin(er,_e.cellXfs),write_STYLES_bin(er),write_DXFS_bin(er),write_TABLESTYLES_bin(er),write_record(er,279),er.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,_e,er){_e.themeElements.clrScheme=[];var tr={};(e[0].match(tagregex)||[]).forEach(function(rr){var nr=parsexmltag(rr);switch(nr[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":tr.rgb=nr.val;break;case"<a:sysClr":tr.rgb=nr.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":nr[0].charAt(1)==="/"?(_e.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(nr[0])]=tr,tr={}):tr.name=nr[0].slice(3,nr[0].length-1);break;default:if(er&&er.WTF)throw new Error("Unrecognized "+nr[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,_e,er){_e.themeElements={};var tr;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(rr){if(!(tr=e.match(rr[1])))throw new Error(rr[0]+" not found in themeElements");rr[2](tr,_e,er)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,_e){(!e||e.length===0)&&(e=write_theme());var er,tr={};if(!(er=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(er[0],tr,_e),tr.raw=e,tr}function write_theme(e,_e){if(_e&&_e.themeXLSX)return _e.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var er=[XML_HEADER];return er[er.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',er[er.length]="<a:themeElements>",er[er.length]='<a:clrScheme name="Office">',er[er.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',er[er.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',er[er.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',er[er.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',er[er.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',er[er.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',er[er.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',er[er.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',er[er.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',er[er.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',er[er.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',er[er.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',er[er.length]="</a:clrScheme>",er[er.length]='<a:fontScheme name="Office">',er[er.length]="<a:majorFont>",er[er.length]='<a:latin typeface="Cambria"/>',er[er.length]='<a:ea typeface=""/>',er[er.length]='<a:cs typeface=""/>',er[er.length]='<a:font script="Jpan" typeface=" "/>',er[er.length]='<a:font script="Hang" typeface=" "/>',er[er.length]='<a:font script="Hans" typeface=""/>',er[er.length]='<a:font script="Hant" typeface=""/>',er[er.length]='<a:font script="Arab" typeface="Times New Roman"/>',er[er.length]='<a:font script="Hebr" typeface="Times New Roman"/>',er[er.length]='<a:font script="Thai" typeface="Tahoma"/>',er[er.length]='<a:font script="Ethi" typeface="Nyala"/>',er[er.length]='<a:font script="Beng" typeface="Vrinda"/>',er[er.length]='<a:font script="Gujr" typeface="Shruti"/>',er[er.length]='<a:font script="Khmr" typeface="MoolBoran"/>',er[er.length]='<a:font script="Knda" typeface="Tunga"/>',er[er.length]='<a:font script="Guru" typeface="Raavi"/>',er[er.length]='<a:font script="Cans" typeface="Euphemia"/>',er[er.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',er[er.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',er[er.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',er[er.length]='<a:font script="Thaa" typeface="MV Boli"/>',er[er.length]='<a:font script="Deva" typeface="Mangal"/>',er[er.length]='<a:font script="Telu" typeface="Gautami"/>',er[er.length]='<a:font script="Taml" typeface="Latha"/>',er[er.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',er[er.length]='<a:font script="Orya" typeface="Kalinga"/>',er[er.length]='<a:font script="Mlym" typeface="Kartika"/>',er[er.length]='<a:font script="Laoo" typeface="DokChampa"/>',er[er.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',er[er.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',er[er.length]='<a:font script="Viet" typeface="Times New Roman"/>',er[er.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',er[er.length]='<a:font script="Geor" typeface="Sylfaen"/>',er[er.length]="</a:majorFont>",er[er.length]="<a:minorFont>",er[er.length]='<a:latin typeface="Calibri"/>',er[er.length]='<a:ea typeface=""/>',er[er.length]='<a:cs typeface=""/>',er[er.length]='<a:font script="Jpan" typeface=" "/>',er[er.length]='<a:font script="Hang" typeface=" "/>',er[er.length]='<a:font script="Hans" typeface=""/>',er[er.length]='<a:font script="Hant" typeface=""/>',er[er.length]='<a:font script="Arab" typeface="Arial"/>',er[er.length]='<a:font script="Hebr" typeface="Arial"/>',er[er.length]='<a:font script="Thai" typeface="Tahoma"/>',er[er.length]='<a:font script="Ethi" typeface="Nyala"/>',er[er.length]='<a:font script="Beng" typeface="Vrinda"/>',er[er.length]='<a:font script="Gujr" typeface="Shruti"/>',er[er.length]='<a:font script="Khmr" typeface="DaunPenh"/>',er[er.length]='<a:font script="Knda" typeface="Tunga"/>',er[er.length]='<a:font script="Guru" typeface="Raavi"/>',er[er.length]='<a:font script="Cans" typeface="Euphemia"/>',er[er.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',er[er.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',er[er.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',er[er.length]='<a:font script="Thaa" typeface="MV Boli"/>',er[er.length]='<a:font script="Deva" typeface="Mangal"/>',er[er.length]='<a:font script="Telu" typeface="Gautami"/>',er[er.length]='<a:font script="Taml" typeface="Latha"/>',er[er.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',er[er.length]='<a:font script="Orya" typeface="Kalinga"/>',er[er.length]='<a:font script="Mlym" typeface="Kartika"/>',er[er.length]='<a:font script="Laoo" typeface="DokChampa"/>',er[er.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',er[er.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',er[er.length]='<a:font script="Viet" typeface="Arial"/>',er[er.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',er[er.length]='<a:font script="Geor" typeface="Sylfaen"/>',er[er.length]="</a:minorFont>",er[er.length]="</a:fontScheme>",er[er.length]='<a:fmtScheme name="Office">',er[er.length]="<a:fillStyleLst>",er[er.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',er[er.length]='<a:gradFill rotWithShape="1">',er[er.length]="<a:gsLst>",er[er.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',er[er.length]="</a:gsLst>",er[er.length]='<a:lin ang="16200000" scaled="1"/>',er[er.length]="</a:gradFill>",er[er.length]='<a:gradFill rotWithShape="1">',er[er.length]="<a:gsLst>",er[er.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',er[er.length]="</a:gsLst>",er[er.length]='<a:lin ang="16200000" scaled="0"/>',er[er.length]="</a:gradFill>",er[er.length]="</a:fillStyleLst>",er[er.length]="<a:lnStyleLst>",er[er.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',er[er.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',er[er.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',er[er.length]="</a:lnStyleLst>",er[er.length]="<a:effectStyleLst>",er[er.length]="<a:effectStyle>",er[er.length]="<a:effectLst>",er[er.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',er[er.length]="</a:effectLst>",er[er.length]="</a:effectStyle>",er[er.length]="<a:effectStyle>",er[er.length]="<a:effectLst>",er[er.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',er[er.length]="</a:effectLst>",er[er.length]="</a:effectStyle>",er[er.length]="<a:effectStyle>",er[er.length]="<a:effectLst>",er[er.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',er[er.length]="</a:effectLst>",er[er.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',er[er.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',er[er.length]="</a:effectStyle>",er[er.length]="</a:effectStyleLst>",er[er.length]="<a:bgFillStyleLst>",er[er.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',er[er.length]='<a:gradFill rotWithShape="1">',er[er.length]="<a:gsLst>",er[er.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',er[er.length]="</a:gsLst>",er[er.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',er[er.length]="</a:gradFill>",er[er.length]='<a:gradFill rotWithShape="1">',er[er.length]="<a:gsLst>",er[er.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',er[er.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',er[er.length]="</a:gsLst>",er[er.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',er[er.length]="</a:gradFill>",er[er.length]="</a:bgFillStyleLst>",er[er.length]="</a:fmtScheme>",er[er.length]="</a:themeElements>",er[er.length]="<a:objectDefaults>",er[er.length]="<a:spDef>",er[er.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',er[er.length]="</a:spDef>",er[er.length]="<a:lnDef>",er[er.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',er[er.length]="</a:lnDef>",er[er.length]="</a:objectDefaults>",er[er.length]="<a:extraClrSchemeLst/>",er[er.length]="</a:theme>",er.join("")}function parse_Theme(e,_e,er){var tr=e.l+_e,rr=e.read_shift(4);if(rr!==124226){if(!er.cellStyles){e.l=tr;return}var nr=e.slice(e.l);e.l=tr;var ir;try{ir=zip_read(nr,{type:"array"})}catch{return}var ar=getzipstr(ir,"theme/theme/theme1.xml",!0);if(ar)return parse_theme_xml(ar,er)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var _e={};switch(_e.xclrType=e.read_shift(2),_e.nTintShade=e.read_shift(2),_e.xclrType){case 0:e.l+=4;break;case 1:_e.xclrValue=parse_IcvXF(e,4);break;case 2:_e.xclrValue=parse_LongRGBA(e);break;case 3:_e.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,_e}function parse_IcvXF(e,_e){return parsenoop(e,_e)}function parse_XFExtGradient(e,_e){return parsenoop(e,_e)}function parse_ExtProp(e){var _e=e.read_shift(2),er=e.read_shift(2)-4,tr=[_e];switch(_e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:tr[1]=parse_FullColorExt(e);break;case 6:tr[1]=parse_XFExtGradient(e,er);break;case 14:case 15:tr[1]=e.read_shift(er===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+_e+" "+er)}return tr}function parse_XFExt(e,_e){var er=e.l+_e;e.l+=2;var tr=e.read_shift(2);e.l+=2;for(var rr=e.read_shift(2),nr=[];rr-- >0;)nr.push(parse_ExtProp(e,er-e.l));return{ixfe:tr,ext:nr}}function update_xfext(e,_e){_e.forEach(function(er){switch(er[0]){}})}function parse_BrtMdtinfo(e,_e){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var _e=new_buf(12+2*e.name.length);return _e.write_shift(4,e.flags),_e.write_shift(4,e.version),write_XLWideString(e.name,_e),_e.slice(0,_e.l)}function parse_BrtMdb(e){for(var _e=[],er=e.read_shift(4);er-- >0;)_e.push([e.read_shift(4),e.read_shift(4)]);return _e}function write_BrtMdb(e){var _e=new_buf(4+8*e.length);_e.write_shift(4,e.length);for(var er=0;er<e.length;++er)_e.write_shift(4,e[er][0]),_e.write_shift(4,e[er][1]);return _e}function write_BrtBeginEsfmd(e,_e){var er=new_buf(8+2*_e.length);return er.write_shift(4,e),write_XLWideString(_e,er),er.slice(0,er.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,_e){var er=new_buf(8);return er.write_shift(4,e),er.write_shift(4,1),er}function parse_xlmeta_bin(e,_e,er){var tr={Types:[],Cell:[],Value:[]},rr=er||{},nr=[],ir=!1,ar=2;return recordhopper(e,function(sr,or,lr){switch(lr){case 335:tr.Types.push({name:sr.name});break;case 51:sr.forEach(function(ur){ar==1?tr.Cell.push({type:tr.Types[ur[0]-1].name,index:ur[1]}):ar==0&&tr.Value.push({type:tr.Types[ur[0]-1].name,index:ur[1]})});break;case 337:ar=sr?1:0;break;case 338:ar=2;break;case 35:nr.push(lr),ir=!0;break;case 36:nr.pop(),ir=!1;break;default:if(!or.T){if(!ir||rr.WTF&&nr[nr.length-1]!=35)throw new Error("Unexpected record 0x"+lr.toString(16))}}}),tr}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function parse_xlmeta_xml(e,_e,er){var tr={Types:[],Cell:[],Value:[]};if(!e)return tr;var rr=!1,nr=2,ir;return e.replace(tagregex,function(ar){var sr=parsexmltag(ar);switch(strip_ns(sr[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":tr.Types.push({name:sr.name});break;case"</metadataType>":break;case"<futureMetadata":for(var or=0;or<tr.Types.length;++or)tr.Types[or].name==sr.name&&(ir=tr.Types[or]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":nr==1?tr.Cell.push({type:tr.Types[sr.t-1].name,index:+sr.v}):nr==0&&tr.Value.push({type:tr.Types[sr.t-1].name,index:+sr.v});break;case"</rc>":break;case"<cellMetadata":nr=1;break;case"</cellMetadata>":nr=2;break;case"<valueMetadata":nr=0;break;case"</valueMetadata>":nr=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":rr=!0;break;case"</ext>":rr=!1;break;case"<rvb":if(!ir)break;ir.offsets||(ir.offsets=[]),ir.offsets.push(+sr.i);break;default:if(!rr&&er.WTF)throw new Error("unrecognized "+sr[0]+" in metadata")}return ar}),tr}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_cc_xml(e){var _e=[];if(!e)return _e;var er=1;return(e.match(tagregex)||[]).forEach(function(tr){var rr=parsexmltag(tr);switch(rr[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete rr[0],rr.i?er=rr.i:rr.i=er,_e.push(rr);break}}),_e}function parse_BrtCalcChainItem$(e){var _e={};_e.i=e.read_shift(4);var er={};er.r=e.read_shift(4),er.c=e.read_shift(4),_e.r=encode_cell(er);var tr=e.read_shift(1);return tr&2&&(_e.l="1"),tr&8&&(_e.a="1"),_e}function parse_cc_bin(e,_e,er){var tr=[];return recordhopper(e,function(nr,ir,ar){switch(ar){case 63:tr.push(nr);break;default:if(!ir.T)throw new Error("Unexpected record 0x"+ar.toString(16))}}),tr}function parse_xlink_xml(){}function parse_xlink_bin(e,_e,er,tr){if(!e)return e;var rr=tr||{},nr=!1;recordhopper(e,function(ar,sr,or){switch(or){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:nr=!0;break;case 36:nr=!1;break;default:if(!sr.T){if(!nr||rr.WTF)throw new Error("Unexpected record 0x"+or.toString(16))}}},rr)}function parse_drawing(e,_e){if(!e)return"??";var er=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return _e["!id"][er].Target}var _shapeid=1024;function write_comments_vml(e,_e){for(var er=[21600,21600],tr=["m0,0l0",er[1],er[0],er[1],er[0],"0xe"].join(","),rr=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:er.join(","),path:tr})];_shapeid<e*1e3;)_shapeid+=1e3;return _e.forEach(function(nr){var ir=decode_cell(nr[0]),ar={color2:"#BEFF82",type:"gradient"};ar.type=="gradient"&&(ar.angle="-180");var sr=ar.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,or=writextag("v:fill",sr,ar),lr={on:"t",obscured:"t"};++_shapeid,rr=rr.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(nr[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",or,writextag("v:shadow",null,lr),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[ir.c+1,0,ir.r+1,0,ir.c+3,20,ir.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(ir.r)),writetag("x:Column",String(ir.c)),nr[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),rr.push("</xml>"),rr.join("")}function sheet_insert_comments(e,_e,er,tr){var rr=Array.isArray(e),nr;_e.forEach(function(ir){var ar=decode_cell(ir.ref);if(rr?(e[ar.r]||(e[ar.r]=[]),nr=e[ar.r][ar.c]):nr=e[ir.ref],!nr){nr={t:"z"},rr?e[ar.r][ar.c]=nr:e[ir.ref]=nr;var sr=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");sr.s.r>ar.r&&(sr.s.r=ar.r),sr.e.r<ar.r&&(sr.e.r=ar.r),sr.s.c>ar.c&&(sr.s.c=ar.c),sr.e.c<ar.c&&(sr.e.c=ar.c);var or=encode_range(sr);or!==e["!ref"]&&(e["!ref"]=or)}nr.c||(nr.c=[]);var lr={a:ir.author,t:ir.t,r:ir.r,T:er};ir.h&&(lr.h=ir.h);for(var ur=nr.c.length-1;ur>=0;--ur){if(!er&&nr.c[ur].T)return;er&&!nr.c[ur].T&&nr.c.splice(ur,1)}if(er&&tr){for(ur=0;ur<tr.length;++ur)if(lr.a==tr[ur].id){lr.a=tr[ur].name||lr.a;break}}nr.c.push(lr)})}function parse_comments_xml(e,_e){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var er=[],tr=[],rr=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);rr&&rr[1]&&rr[1].split(/<\/\w*:?author>/).forEach(function(ir){if(!(ir===""||ir.trim()==="")){var ar=ir.match(/<(?:\w+:)?author[^>]*>(.*)/);ar&&er.push(ar[1])}});var nr=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return nr&&nr[1]&&nr[1].split(/<\/\w*:?comment>/).forEach(function(ir){if(!(ir===""||ir.trim()==="")){var ar=ir.match(/<(?:\w+:)?comment[^>]*>/);if(ar){var sr=parsexmltag(ar[0]),or={author:sr.authorId&&er[sr.authorId]||"sheetjsghost",ref:sr.ref,guid:sr.guid},lr=decode_cell(sr.ref);if(!(_e.sheetRows&&_e.sheetRows<=lr.r)){var ur=ir.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),fr=!!ur&&!!ur[1]&&parse_si(ur[1])||{r:"",t:"",h:""};or.r=fr.r,fr.r=="<t></t>"&&(fr.t=fr.h=""),or.t=(fr.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),_e.cellHTML&&(or.h=fr.h),tr.push(or)}}}}),tr}function write_comments_xml(e){var _e=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],er=[];return _e.push("<authors>"),e.forEach(function(tr){tr[1].forEach(function(rr){var nr=escapexml(rr.a);er.indexOf(nr)==-1&&(er.push(nr),_e.push("<author>"+nr+"</author>")),rr.T&&rr.ID&&er.indexOf("tc="+rr.ID)==-1&&(er.push("tc="+rr.ID),_e.push("<author>tc="+rr.ID+"</author>"))})}),er.length==0&&(er.push("SheetJ5"),_e.push("<author>SheetJ5</author>")),_e.push("</authors>"),_e.push("<commentList>"),e.forEach(function(tr){var rr=0,nr=[];if(tr[1][0]&&tr[1][0].T&&tr[1][0].ID?rr=er.indexOf("tc="+tr[1][0].ID):tr[1].forEach(function(sr){sr.a&&(rr=er.indexOf(escapexml(sr.a))),nr.push(sr.t||"")}),_e.push('<comment ref="'+tr[0]+'" authorId="'+rr+'"><text>'),nr.length<=1)_e.push(writetag("t",escapexml(nr[0]||"")));else{for(var ir=`Comment:
    `+nr[0]+`
`,ar=1;ar<nr.length;++ar)ir+=`Reply:
    `+nr[ar]+`
`;_e.push(writetag("t",escapexml(ir)))}_e.push("</text></comment>")}),_e.push("</commentList>"),_e.length>2&&(_e[_e.length]="</comments>",_e[1]=_e[1].replace("/>",">")),_e.join("")}function parse_tcmnt_xml(e,_e){var er=[],tr=!1,rr={},nr=0;return e.replace(tagregex,function(ar,sr){var or=parsexmltag(ar);switch(strip_ns(or[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":rr={author:or.personId,guid:or.id,ref:or.ref,T:1};break;case"</threadedComment>":rr.t!=null&&er.push(rr);break;case"<text>":case"<text":nr=sr+ar.length;break;case"</text>":rr.t=e.slice(nr,sr).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":tr=!0;break;case"</mentions>":tr=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":tr=!0;break;case"</ext>":tr=!1;break;default:if(!tr&&_e.WTF)throw new Error("unrecognized "+or[0]+" in threaded comments")}return ar}),er}function write_tcmnt_xml(e,_e,er){var tr=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(rr){var nr="";(rr[1]||[]).forEach(function(ir,ar){if(!ir.T){delete ir.ID;return}ir.a&&_e.indexOf(ir.a)==-1&&_e.push(ir.a);var sr={ref:rr[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+er.tcid++).slice(-12)+"}"};ar==0?nr=sr.id:sr.parentId=nr,ir.ID=sr.id,ir.a&&(sr.personId="{54EE7950-7262-4200-6969-"+("000000000000"+_e.indexOf(ir.a)).slice(-12)+"}"),tr.push(writextag("threadedComment",writetag("text",ir.t||""),sr))})}),tr.push("</ThreadedComments>"),tr.join("")}function parse_people_xml(e,_e){var er=[],tr=!1;return e.replace(tagregex,function(nr){var ir=parsexmltag(nr);switch(strip_ns(ir[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":er.push({name:ir.displayname,id:ir.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":tr=!0;break;case"</ext>":tr=!1;break;default:if(!tr&&_e.WTF)throw new Error("unrecognized "+ir[0]+" in threaded comments")}return nr}),er}function write_people_xml(e){var _e=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(er,tr){_e.push(writextag("person",null,{displayName:er,id:"{54EE7950-7262-4200-6969-"+("000000000000"+tr).slice(-12)+"}",userId:er,providerId:"None"}))}),_e.push("</personList>"),_e.join("")}function parse_BrtBeginComment(e){var _e={};_e.iauthor=e.read_shift(4);var er=parse_UncheckedRfX(e);return _e.rfx=er.s,_e.ref=encode_cell(er.s),e.l+=16,_e}function write_BrtBeginComment(e,_e){return _e==null&&(_e=new_buf(36)),_e.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],_e),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function parse_comments_bin(e,_e){var er=[],tr=[],rr={},nr=!1;return recordhopper(e,function(ar,sr,or){switch(or){case 632:tr.push(ar);break;case 635:rr=ar;break;case 637:rr.t=ar.t,rr.h=ar.h,rr.r=ar.r;break;case 636:if(rr.author=tr[rr.iauthor],delete rr.iauthor,_e.sheetRows&&rr.rfx&&_e.sheetRows<=rr.rfx.r)break;rr.t||(rr.t=""),delete rr.rfx,er.push(rr);break;case 3072:break;case 35:nr=!0;break;case 36:nr=!1;break;case 37:break;case 38:break;default:if(!sr.T){if(!nr||_e.WTF)throw new Error("Unexpected record 0x"+or.toString(16))}}}),er}function write_comments_bin(e){var _e=buf_array(),er=[];return write_record(_e,628),write_record(_e,630),e.forEach(function(tr){tr[1].forEach(function(rr){er.indexOf(rr.a)>-1||(er.push(rr.a.slice(0,54)),write_record(_e,632,write_BrtCommentAuthor(rr.a)))})}),write_record(_e,631),write_record(_e,633),e.forEach(function(tr){tr[1].forEach(function(rr){rr.iauthor=er.indexOf(rr.a);var nr={s:decode_cell(tr[0]),e:decode_cell(tr[0])};write_record(_e,635,write_BrtBeginComment([nr,rr])),rr.t&&rr.t.length>0&&write_record(_e,637,write_BrtCommentText(rr)),write_record(_e,636),delete rr.iauthor})}),write_record(_e,634),write_record(_e,629),_e.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var _e=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(er,tr){if(!(er.slice(-1)==="/"||!er.match(/_VBA_PROJECT_CUR/))){var rr=er.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(_e,rr,e.FileIndex[tr].content)}}),CFB.write(_e)}function fill_vba_xls(e,_e){_e.FullPaths.forEach(function(er,tr){if(tr!=0){var rr=er.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");rr.slice(-1)!=="/"&&CFB.utils.cfb_add(e,rr,_e.FileIndex[tr].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,_e={r:0,c:0};function er(tr,rr,nr,ir){var ar=!1,sr=!1;nr.length==0?sr=!0:nr.charAt(0)=="["&&(sr=!0,nr=nr.slice(1,-1)),ir.length==0?ar=!0:ir.charAt(0)=="["&&(ar=!0,ir=ir.slice(1,-1));var or=nr.length>0?parseInt(nr,10)|0:0,lr=ir.length>0?parseInt(ir,10)|0:0;return ar?lr+=_e.c:--lr,sr?or+=_e.r:--or,rr+(ar?"":"$")+encode_col(lr)+(sr?"":"$")+encode_row(or)}return function(rr,nr){return _e=nr,rr.replace(e,er)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(_e,er){return _e.replace(crefregex,function(tr,rr,nr,ir,ar,sr){var or=decode_col(ir)-(nr?0:er.c),lr=decode_row(sr)-(ar?0:er.r),ur=lr==0?"":ar?lr+1:"["+lr+"]",fr=or==0?"":nr?or+1:"["+or+"]";return rr+"R"+ur+"C"+fr})}}();function shift_formula_str(e,_e){return e.replace(crefregex,function(er,tr,rr,nr,ir,ar){return tr+(rr=="$"?rr+nr:encode_col(decode_col(nr)+_e.c))+(ir=="$"?ir+ar:encode_row(decode_row(ar)+_e.r))})}function shift_formula_xlsx(e,_e,er){var tr=decode_range(_e),rr=tr.s,nr=decode_cell(er),ir={r:nr.r-rr.r,c:nr.c-rr.c};return shift_formula_str(e,ir)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,_e){var er=e.read_shift(2);return[er&16383,er>>14&1,er>>15&1]}function parse_RgceArea(e,_e,er){var tr=2;if(er){if(er.biff>=2&&er.biff<=5)return parse_RgceArea_BIFF2(e);er.biff==12&&(tr=4)}var rr=e.read_shift(tr),nr=e.read_shift(tr),ir=parse_ColRelU(e),ar=parse_ColRelU(e);return{s:{r:rr,c:ir[0],cRel:ir[1],rRel:ir[2]},e:{r:nr,c:ar[0],cRel:ar[1],rRel:ar[2]}}}function parse_RgceArea_BIFF2(e){var _e=parse_ColRelU(e),er=parse_ColRelU(e),tr=e.read_shift(1),rr=e.read_shift(1);return{s:{r:_e[0],c:tr,cRel:_e[1],rRel:_e[2]},e:{r:er[0],c:rr,cRel:er[1],rRel:er[2]}}}function parse_RgceAreaRel(e,_e,er){if(er.biff<8)return parse_RgceArea_BIFF2(e);var tr=e.read_shift(er.biff==12?4:2),rr=e.read_shift(er.biff==12?4:2),nr=parse_ColRelU(e),ir=parse_ColRelU(e);return{s:{r:tr,c:nr[0],cRel:nr[1],rRel:nr[2]},e:{r:rr,c:ir[0],cRel:ir[1],rRel:ir[2]}}}function parse_RgceLoc(e,_e,er){if(er&&er.biff>=2&&er.biff<=5)return parse_RgceLoc_BIFF2(e);var tr=e.read_shift(er&&er.biff==12?4:2),rr=parse_ColRelU(e);return{r:tr,c:rr[0],cRel:rr[1],rRel:rr[2]}}function parse_RgceLoc_BIFF2(e){var _e=parse_ColRelU(e),er=e.read_shift(1);return{r:_e[0],c:er,cRel:_e[1],rRel:_e[2]}}function parse_RgceElfLoc(e){var _e=e.read_shift(2),er=e.read_shift(2);return{r:_e,c:er&255,fQuoted:!!(er&16384),cRel:er>>15,rRel:er>>15}}function parse_RgceLocRel(e,_e,er){var tr=er&&er.biff?er.biff:8;if(tr>=2&&tr<=5)return parse_RgceLocRel_BIFF2(e);var rr=e.read_shift(tr>=12?4:2),nr=e.read_shift(2),ir=(nr&16384)>>14,ar=(nr&32768)>>15;if(nr&=16383,ar==1)for(;rr>524287;)rr-=1048576;if(ir==1)for(;nr>8191;)nr=nr-16384;return{r:rr,c:nr,cRel:ir,rRel:ar}}function parse_RgceLocRel_BIFF2(e){var _e=e.read_shift(2),er=e.read_shift(1),tr=(_e&32768)>>15,rr=(_e&16384)>>14;return _e&=16383,tr==1&&_e>=8192&&(_e=_e-16384),rr==1&&er>=128&&(er=er-256),{r:_e,c:er,cRel:rr,rRel:tr}}function parse_PtgArea(e,_e,er){var tr=(e[e.l++]&96)>>5,rr=parse_RgceArea(e,er.biff>=2&&er.biff<=5?6:8,er);return[tr,rr]}function parse_PtgArea3d(e,_e,er){var tr=(e[e.l++]&96)>>5,rr=e.read_shift(2,"i"),nr=8;if(er)switch(er.biff){case 5:e.l+=12,nr=6;break;case 12:nr=12;break}var ir=parse_RgceArea(e,nr,er);return[tr,rr,ir]}function parse_PtgAreaErr(e,_e,er){var tr=(e[e.l++]&96)>>5;return e.l+=er&&er.biff>8?12:er.biff<8?6:8,[tr]}function parse_PtgAreaErr3d(e,_e,er){var tr=(e[e.l++]&96)>>5,rr=e.read_shift(2),nr=8;if(er)switch(er.biff){case 5:e.l+=12,nr=6;break;case 12:nr=12;break}return e.l+=nr,[tr,rr]}function parse_PtgAreaN(e,_e,er){var tr=(e[e.l++]&96)>>5,rr=parse_RgceAreaRel(e,_e-1,er);return[tr,rr]}function parse_PtgArray(e,_e,er){var tr=(e[e.l++]&96)>>5;return e.l+=er.biff==2?6:er.biff==12?14:7,[tr]}function parse_PtgAttrBaxcel(e){var _e=e[e.l+1]&1,er=1;return e.l+=4,[_e,er]}function parse_PtgAttrChoose(e,_e,er){e.l+=2;for(var tr=e.read_shift(er&&er.biff==2?1:2),rr=[],nr=0;nr<=tr;++nr)rr.push(e.read_shift(er&&er.biff==2?1:2));return rr}function parse_PtgAttrGoto(e,_e,er){var tr=e[e.l+1]&255?1:0;return e.l+=2,[tr,e.read_shift(er&&er.biff==2?1:2)]}function parse_PtgAttrIf(e,_e,er){var tr=e[e.l+1]&255?1:0;return e.l+=2,[tr,e.read_shift(er&&er.biff==2?1:2)]}function parse_PtgAttrIfError(e){var _e=e[e.l+1]&255?1:0;return e.l+=2,[_e,e.read_shift(2)]}function parse_PtgAttrSemi(e,_e,er){var tr=e[e.l+1]&255?1:0;return e.l+=er&&er.biff==2?3:4,[tr]}function parse_PtgAttrSpaceType(e){var _e=e.read_shift(1),er=e.read_shift(1);return[_e,er]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,_e,er){var tr=(e[e.l]&96)>>5;e.l+=1;var rr=parse_RgceLoc(e,0,er);return[tr,rr]}function parse_PtgRefN(e,_e,er){var tr=(e[e.l]&96)>>5;e.l+=1;var rr=parse_RgceLocRel(e,0,er);return[tr,rr]}function parse_PtgRef3d(e,_e,er){var tr=(e[e.l]&96)>>5;e.l+=1;var rr=e.read_shift(2);er&&er.biff==5&&(e.l+=12);var nr=parse_RgceLoc(e,0,er);return[tr,rr,nr]}function parse_PtgFunc(e,_e,er){var tr=(e[e.l]&96)>>5;e.l+=1;var rr=e.read_shift(er&&er.biff<=3?1:2);return[FtabArgc[rr],Ftab[rr],tr]}function parse_PtgFuncVar(e,_e,er){var tr=e[e.l++],rr=e.read_shift(1),nr=er&&er.biff<=3?[tr==88?-1:0,e.read_shift(1)]:parsetab(e);return[rr,(nr[0]===0?Ftab:Cetab)[nr[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,_e,er){e.l+=er&&er.biff==2?3:4}function parse_PtgExp(e,_e,er){if(e.l++,er&&er.biff==12)return[e.read_shift(4,"i"),0];var tr=e.read_shift(2),rr=e.read_shift(er&&er.biff==2?1:2);return[tr,rr]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,_e,er){return e.l++,parse_ShortXLUnicodeString(e,_e-1,er)}function parse_SerAr(e,_e){var er=[e.read_shift(1)];if(_e==12)switch(er[0]){case 2:er[0]=4;break;case 4:er[0]=16;break;case 0:er[0]=1;break;case 1:er[0]=2;break}switch(er[0]){case 4:er[1]=parsebool(e,1)?"TRUE":"FALSE",_e!=12&&(e.l+=7);break;case 37:case 16:er[1]=BErr[e[e.l]],e.l+=_e==12?4:8;break;case 0:e.l+=8;break;case 1:er[1]=parse_Xnum(e);break;case 2:er[1]=parse_XLUnicodeString2(e,0,{biff:_e>0&&_e<8?2:_e});break;default:throw new Error("Bad SerAr: "+er[0])}return er}function parse_PtgExtraMem(e,_e,er){for(var tr=e.read_shift(er.biff==12?4:2),rr=[],nr=0;nr!=tr;++nr)rr.push((er.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return rr}function parse_PtgExtraArray(e,_e,er){var tr=0,rr=0;er.biff==12?(tr=e.read_shift(4),rr=e.read_shift(4)):(rr=1+e.read_shift(1),tr=1+e.read_shift(2)),er.biff>=2&&er.biff<8&&(--tr,--rr==0&&(rr=256));for(var nr=0,ir=[];nr!=tr&&(ir[nr]=[]);++nr)for(var ar=0;ar!=rr;++ar)ir[nr][ar]=parse_SerAr(e,er.biff);return ir}function parse_PtgName(e,_e,er){var tr=e.read_shift(1)>>>5&3,rr=!er||er.biff>=8?4:2,nr=e.read_shift(rr);switch(er.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[tr,0,nr]}function parse_PtgNameX(e,_e,er){if(er.biff==5)return parse_PtgNameX_BIFF5(e);var tr=e.read_shift(1)>>>5&3,rr=e.read_shift(2),nr=e.read_shift(4);return[tr,rr,nr]}function parse_PtgNameX_BIFF5(e){var _e=e.read_shift(1)>>>5&3,er=e.read_shift(2,"i");e.l+=8;var tr=e.read_shift(2);return e.l+=12,[_e,er,tr]}function parse_PtgMemArea(e,_e,er){var tr=e.read_shift(1)>>>5&3;e.l+=er&&er.biff==2?3:4;var rr=e.read_shift(er&&er.biff==2?1:2);return[tr,rr]}function parse_PtgMemFunc(e,_e,er){var tr=e.read_shift(1)>>>5&3,rr=e.read_shift(er&&er.biff==2?1:2);return[tr,rr]}function parse_PtgRefErr(e,_e,er){var tr=e.read_shift(1)>>>5&3;return e.l+=4,er.biff<8&&e.l--,er.biff==12&&(e.l+=2),[tr]}function parse_PtgRefErr3d(e,_e,er){var tr=(e[e.l++]&96)>>5,rr=e.read_shift(2),nr=4;if(er)switch(er.biff){case 5:nr=15;break;case 12:nr=6;break}return e.l+=nr,[tr,rr]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,_e,er){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var _e=e.read_shift(2),er=e.read_shift(2),tr=e.read_shift(4),rr=e.read_shift(2),nr=e.read_shift(2),ir=PtgListRT[er>>2&31];return{ixti:_e,coltype:er&3,rt:ir,idx:tr,c:rr,C:nr}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,_e,er){return e.l+=5,e.l+=2,e.l+=er.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,_e,er){return e.l+=er.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var _e=e.read_shift(1)>>>5&3,er=e.read_shift(2);return[_e,er]}function parse_PtgMemNoMemN(e){var _e=e.read_shift(1)>>>5&3,er=e.read_shift(2);return[_e,er]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,_e,er,tr){if(tr.biff<8)return parsenoop(e,_e);for(var rr=e.l+_e,nr=[],ir=0;ir!==er.length;++ir)switch(er[ir][0]){case"PtgArray":er[ir][1]=parse_PtgExtraArray(e,0,tr),nr.push(er[ir][1]);break;case"PtgMemArea":er[ir][2]=parse_PtgExtraMem(e,er[ir][1],tr),nr.push(er[ir][2]);break;case"PtgExp":tr&&tr.biff==12&&(er[ir][1][1]=e.read_shift(4),nr.push(er[ir][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+er[ir][0]}return _e=rr-e.l,_e!==0&&nr.push(parsenoop(e,_e)),nr}function parse_Rgce(e,_e,er){for(var tr=e.l+_e,rr,nr,ir=[];tr!=e.l;)_e=tr-e.l,nr=e[e.l],rr=PtgTypes[nr]||PtgTypes[PtgDupes[nr]],(nr===24||nr===25)&&(rr=(nr===24?Ptg18:Ptg19)[e[e.l+1]]),!rr||!rr.f?parsenoop(e,_e):ir.push([rr.n,rr.f(e,_e,er)]);return ir}function stringify_array(e){for(var _e=[],er=0;er<e.length;++er){for(var tr=e[er],rr=[],nr=0;nr<tr.length;++nr){var ir=tr[nr];if(ir)switch(ir[0]){case 2:rr.push('"'+ir[1].replace(/"/g,'""')+'"');break;default:rr.push(ir[1])}else rr.push("")}_e.push(rr.join(","))}return _e.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,_e){if(!e&&!(_e&&_e.biff<=5&&_e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,_e,er){if(!e)return"SH33TJSERR0";if(er.biff>8&&(!e.XTI||!e.XTI[_e]))return e.SheetNames[_e];if(!e.XTI)return"SH33TJSERR6";var tr=e.XTI[_e];if(er.biff<8)return _e>1e4&&(_e-=65536),_e<0&&(_e=-_e),_e==0?"":e.XTI[_e-1];if(!tr)return"SH33TJSERR1";var rr="";if(er.biff>8)switch(e[tr[0]][0]){case 357:return rr=tr[1]==-1?"#REF":e.SheetNames[tr[1]],tr[1]==tr[2]?rr:rr+":"+e.SheetNames[tr[2]];case 358:return er.SID!=null?e.SheetNames[er.SID]:"SH33TJSSAME"+e[tr[0]][0];case 355:default:return"SH33TJSSRC"+e[tr[0]][0]}switch(e[tr[0]][0][0]){case 1025:return rr=tr[1]==-1?"#REF":e.SheetNames[tr[1]]||"SH33TJSERR3",tr[1]==tr[2]?rr:rr+":"+e.SheetNames[tr[2]];case 14849:return e[tr[0]].slice(1).map(function(nr){return nr.Name}).join(";;");default:return e[tr[0]][0][3]?(rr=tr[1]==-1?"#REF":e[tr[0]][0][3][tr[1]]||"SH33TJSERR4",tr[1]==tr[2]?rr:rr+":"+e[tr[0]][0][3][tr[2]]):"SH33TJSERR2"}}function get_ixti(e,_e,er){var tr=get_ixti_raw(e,_e,er);return tr=="#REF"?tr:formula_quote_sheet_name(tr,er)}function stringify_formula(e,_e,er,tr,rr){var nr=rr&&rr.biff||8,ir={s:{c:0,r:0}},ar=[],sr,or,lr,ur=0,fr=0,cr,mr="";if(!e[0]||!e[0][0])return"";for(var dr=-1,xr="",pr=0,gr=e[0].length;pr<gr;++pr){var vr=e[0][pr];switch(vr[0]){case"PtgUminus":ar.push("-"+ar.pop());break;case"PtgUplus":ar.push("+"+ar.pop());break;case"PtgPercent":ar.push(ar.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(sr=ar.pop(),or=ar.pop(),dr>=0){switch(e[0][dr][1][0]){case 0:xr=fill(" ",e[0][dr][1][1]);break;case 1:xr=fill("\r",e[0][dr][1][1]);break;default:if(xr="",rr.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][dr][1][0])}or=or+xr,dr=-1}ar.push(or+PtgBinOp[vr[0]]+sr);break;case"PtgIsect":sr=ar.pop(),or=ar.pop(),ar.push(or+" "+sr);break;case"PtgUnion":sr=ar.pop(),or=ar.pop(),ar.push(or+","+sr);break;case"PtgRange":sr=ar.pop(),or=ar.pop(),ar.push(or+":"+sr);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":lr=shift_cell_xls(vr[1][1],ir,rr),ar.push(encode_cell_xls(lr,nr));break;case"PtgRefN":lr=er?shift_cell_xls(vr[1][1],er,rr):vr[1][1],ar.push(encode_cell_xls(lr,nr));break;case"PtgRef3d":ur=vr[1][1],lr=shift_cell_xls(vr[1][2],ir,rr),mr=get_ixti(tr,ur,rr),ar.push(mr+"!"+encode_cell_xls(lr,nr));break;case"PtgFunc":case"PtgFuncVar":var Cr=vr[1][0],Tr=vr[1][1];Cr||(Cr=0),Cr&=127;var Fr=Cr==0?[]:ar.slice(-Cr);ar.length-=Cr,Tr==="User"&&(Tr=Fr.shift()),ar.push(Tr+"("+Fr.join(",")+")");break;case"PtgBool":ar.push(vr[1]?"TRUE":"FALSE");break;case"PtgInt":ar.push(vr[1]);break;case"PtgNum":ar.push(String(vr[1]));break;case"PtgStr":ar.push('"'+vr[1].replace(/"/g,'""')+'"');break;case"PtgErr":ar.push(vr[1]);break;case"PtgAreaN":cr=shift_range_xls(vr[1][1],er?{s:er}:ir,rr),ar.push(encode_range_xls(cr,rr));break;case"PtgArea":cr=shift_range_xls(vr[1][1],ir,rr),ar.push(encode_range_xls(cr,rr));break;case"PtgArea3d":ur=vr[1][1],cr=vr[1][2],mr=get_ixti(tr,ur,rr),ar.push(mr+"!"+encode_range_xls(cr,rr));break;case"PtgAttrSum":ar.push("SUM("+ar.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":fr=vr[1][2];var _r=(tr.names||[])[fr-1]||(tr[0]||[])[fr],Ar=_r?_r.Name:"SH33TJSNAME"+String(fr);Ar&&Ar.slice(0,6)=="_xlfn."&&!rr.xlfn&&(Ar=Ar.slice(6)),ar.push(Ar);break;case"PtgNameX":var Pr=vr[1][1];fr=vr[1][2];var Ir;if(rr.biff<=5)Pr<0&&(Pr=-Pr),tr[Pr]&&(Ir=tr[Pr][fr]);else{var wr="";if(((tr[Pr]||[])[0]||[])[0]==14849||(((tr[Pr]||[])[0]||[])[0]==1025?tr[Pr][fr]&&tr[Pr][fr].itab>0&&(wr=tr.SheetNames[tr[Pr][fr].itab-1]+"!"):wr=tr.SheetNames[fr-1]+"!"),tr[Pr]&&tr[Pr][fr])wr+=tr[Pr][fr].Name;else if(tr[0]&&tr[0][fr])wr+=tr[0][fr].Name;else{var kr=(get_ixti_raw(tr,Pr,rr)||"").split(";;");kr[fr-1]?wr=kr[fr-1]:wr+="SH33TJSERRX"}ar.push(wr);break}Ir||(Ir={Name:"SH33TJSERRY"}),ar.push(Ir.Name);break;case"PtgParen":var Mr="(",Hr=")";if(dr>=0){switch(xr="",e[0][dr][1][0]){case 2:Mr=fill(" ",e[0][dr][1][1])+Mr;break;case 3:Mr=fill("\r",e[0][dr][1][1])+Mr;break;case 4:Hr=fill(" ",e[0][dr][1][1])+Hr;break;case 5:Hr=fill("\r",e[0][dr][1][1])+Hr;break;default:if(rr.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][dr][1][0])}dr=-1}ar.push(Mr+ar.pop()+Hr);break;case"PtgRefErr":ar.push("#REF!");break;case"PtgRefErr3d":ar.push("#REF!");break;case"PtgExp":lr={c:vr[1][1],r:vr[1][0]};var Gr={c:er.c,r:er.r};if(tr.sharedf[encode_cell(lr)]){var zr=tr.sharedf[encode_cell(lr)];ar.push(stringify_formula(zr,ir,Gr,tr,rr))}else{var Br=!1;for(sr=0;sr!=tr.arrayf.length;++sr)if(or=tr.arrayf[sr],!(lr.c<or[0].s.c||lr.c>or[0].e.c)&&!(lr.r<or[0].s.r||lr.r>or[0].e.r)){ar.push(stringify_formula(or[1],ir,Gr,tr,rr)),Br=!0;break}Br||ar.push(vr[1])}break;case"PtgArray":ar.push("{"+stringify_array(vr[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":dr=pr;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":ar.push("");break;case"PtgAreaErr":ar.push("#REF!");break;case"PtgAreaErr3d":ar.push("#REF!");break;case"PtgList":ar.push("Table"+vr[1].idx+"[#"+vr[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(vr));default:throw new Error("Unrecognized Formula Token: "+String(vr))}var Vr=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(rr.biff!=3&&dr>=0&&Vr.indexOf(e[0][pr][0])==-1){vr=e[0][dr];var Rr=!0;switch(vr[1][0]){case 4:Rr=!1;case 0:xr=fill(" ",vr[1][1]);break;case 5:Rr=!1;case 1:xr=fill("\r",vr[1][1]);break;default:if(xr="",rr.WTF)throw new Error("Unexpected PtgAttrSpaceType "+vr[1][0])}ar.push((Rr?xr:"")+ar.pop()+(Rr?"":xr)),dr=-1}}if(ar.length>1&&rr.WTF)throw new Error("bad formula stack");return ar[0]}function parse_ArrayParsedFormula(e,_e,er){var tr=e.l+_e,rr=er.biff==2?1:2,nr,ir=e.read_shift(rr);if(ir==65535)return[[],parsenoop(e,_e-2)];var ar=parse_Rgce(e,ir,er);return _e!==ir+rr&&(nr=parse_RgbExtra(e,_e-ir-rr,ar,er)),e.l=tr,[ar,nr]}function parse_XLSCellParsedFormula(e,_e,er){var tr=e.l+_e,rr=er.biff==2?1:2,nr,ir=e.read_shift(rr);if(ir==65535)return[[],parsenoop(e,_e-2)];var ar=parse_Rgce(e,ir,er);return _e!==ir+rr&&(nr=parse_RgbExtra(e,_e-ir-rr,ar,er)),e.l=tr,[ar,nr]}function parse_NameParsedFormula(e,_e,er,tr){var rr=e.l+_e,nr=parse_Rgce(e,tr,er),ir;return rr!==e.l&&(ir=parse_RgbExtra(e,rr-e.l,nr,er)),[nr,ir]}function parse_SharedParsedFormula(e,_e,er){var tr=e.l+_e,rr,nr=e.read_shift(2),ir=parse_Rgce(e,nr,er);return nr==65535?[[],parsenoop(e,_e-2)]:(_e!==nr+2&&(rr=parse_RgbExtra(e,tr-nr-2,ir,er)),[ir,rr])}function parse_FormulaValue(e){var _e;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return _e=e[e.l+2]===1,e.l+=8,[_e,"b"];case 2:return _e=e[e.l+2],e.l+=8,[_e,"e"];case 3:return e.l+=8,["","s"]}return[]}function write_FormulaValue(e){if(e==null){var _e=new_buf(8);return _e.write_shift(1,3),_e.write_shift(1,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,65535),_e}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function parse_Formula(e,_e,er){var tr=e.l+_e,rr=parse_XLSCell(e);er.biff==2&&++e.l;var nr=parse_FormulaValue(e),ir=e.read_shift(1);er.biff!=2&&(e.read_shift(1),er.biff>=5&&e.read_shift(4));var ar=parse_XLSCellParsedFormula(e,tr-e.l,er);return{cell:rr,val:nr[0],formula:ar,shared:ir>>3&1,tt:nr[1]}}function write_Formula(e,_e,er,tr,rr){var nr=write_XLSCell(_e,er,rr),ir=write_FormulaValue(e.v),ar=new_buf(6),sr=33;ar.write_shift(2,sr),ar.write_shift(4,0);for(var or=new_buf(e.bf.length),lr=0;lr<e.bf.length;++lr)or[lr]=e.bf[lr];var ur=bconcat([nr,ir,ar,or]);return ur}function parse_XLSBParsedFormula(e,_e,er){var tr=e.read_shift(4),rr=parse_Rgce(e,tr,er),nr=e.read_shift(4),ir=nr>0?parse_RgbExtra(e,nr,rr,er):null;return[rr,ir]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(_e,er){return er.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(e){var _e="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return _e.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(e){var _e=e.split(":"),er=_e[0].split(".")[0];return[er,_e[0].split(".")[1]+(_e.length>1?":"+(_e[1].split(".")[1]||_e[1].split(".")[0]):"")]}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(e,_e,er){var tr=0,rr=e.length;if(er){if(browser_has_Map?er.has(_e):Object.prototype.hasOwnProperty.call(er,_e)){for(var nr=browser_has_Map?er.get(_e):er[_e];tr<nr.length;++tr)if(e[nr[tr]].t===_e)return e.Count++,nr[tr]}}else for(;tr<rr;++tr)if(e[tr].t===_e)return e.Count++,tr;return e[rr]={t:_e},e.Count++,e.Unique++,er&&(browser_has_Map?(er.has(_e)||er.set(_e,[]),er.get(_e).push(rr)):(Object.prototype.hasOwnProperty.call(er,_e)||(er[_e]=[]),er[_e].push(rr))),rr}function col_obj_w(e,_e){var er={min:e+1,max:e+1},tr=-1;return _e.MDW&&(MDW=_e.MDW),_e.width!=null?er.customWidth=1:_e.wpx!=null?tr=px2char(_e.wpx):_e.wch!=null&&(tr=_e.wch),tr>-1?(er.width=char2width(tr),er.customWidth=1):_e.width!=null&&(er.width=_e.width),_e.hidden&&(er.hidden=!0),_e.level!=null&&(er.outlineLevel=er.level=_e.level),er}function default_margins(e,_e){if(e){var er=[.7,.7,.75,.75,.3,.3];_e=="xlml"&&(er=[1,1,1,1,.5,.5]),e.left==null&&(e.left=er[0]),e.right==null&&(e.right=er[1]),e.top==null&&(e.top=er[2]),e.bottom==null&&(e.bottom=er[3]),e.header==null&&(e.header=er[4]),e.footer==null&&(e.footer=er[5])}}function get_cell_style(e,_e,er){var tr=er.revssf[_e.z!=null?_e.z:"General"],rr=60,nr=e.length;if(tr==null&&er.ssf){for(;rr<392;++rr)if(er.ssf[rr]==null){SSF_load(_e.z,rr),er.ssf[rr]=_e.z,er.revssf[_e.z]=tr=rr;break}}for(rr=0;rr!=nr;++rr)if(e[rr].numFmtId===tr)return rr;return e[nr]={numFmtId:tr,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},nr}function safe_format(e,_e,er,tr,rr,nr){try{tr.cellNF&&(e.z=table_fmt[_e])}catch(ar){if(tr.WTF)throw ar}if(!(e.t==="z"&&!tr.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!tr||tr.cellText!==!1)&&e.t!=="z")try{if(table_fmt[_e]==null&&SSF_load(SSFImplicit[_e]||"General",_e),e.t==="e")e.w=e.w||BErr[e.v];else if(_e===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var ir=datenum(e.v);(ir|0)===ir?e.w=ir.toString(10):e.w=SSF_general_num(ir)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(_e,datenum(e.v),_ssfopts):e.w=SSF_format(_e,e.v,_ssfopts)}catch(ar){if(tr.WTF)throw ar}if(tr.cellStyles&&er!=null)try{e.s=nr.Fills[er],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(rr.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),tr.WTF&&(e.s.fgColor.raw_rgb=rr.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(rr.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),tr.WTF&&(e.s.bgColor.raw_rgb=rr.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(ar){if(tr.WTF&&nr.Fills)throw ar}}}function check_ws(e,_e,er){if(e&&e["!ref"]){var tr=safe_decode_range(e["!ref"]);if(tr.e.c<tr.s.c||tr.e.r<tr.s.r)throw new Error("Bad range ("+er+"): "+e["!ref"])}}function parse_ws_xml_dim(e,_e){var er=safe_decode_range(_e);er.s.r<=er.e.r&&er.s.c<=er.e.c&&er.s.r>=0&&er.s.c>=0&&(e["!ref"]=encode_range(er))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,_e,er,tr,rr,nr,ir){if(!e)return e;tr||(tr={"!id":{}});var ar=_e.dense?[]:{},sr={s:{r:2e6,c:2e6},e:{r:0,c:0}},or="",lr="",ur=e.match(sheetdataregex);ur?(or=e.slice(0,ur.index),lr=e.slice(ur.index+ur[0].length)):or=lr=e;var fr=or.match(sheetprregex);fr?parse_ws_xml_sheetpr(fr[0],ar,rr,er):(fr=or.match(sheetprregex2))&&parse_ws_xml_sheetpr2(fr[0],fr[1]||"",ar,rr,er);var cr=(or.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(cr>0){var mr=or.slice(cr,cr+50).match(dimregex);mr&&parse_ws_xml_dim(ar,mr[1])}var dr=or.match(svsregex);dr&&dr[1]&&parse_ws_xml_sheetviews(dr[1],rr);var xr=[];if(_e.cellStyles){var pr=or.match(colregex);pr&&parse_ws_xml_cols(xr,pr)}ur&&parse_ws_xml_data(ur[1],ar,_e,sr,nr,ir);var gr=lr.match(afregex);gr&&(ar["!autofilter"]=parse_ws_xml_autofilter(gr[0]));var vr=[],Cr=lr.match(mergecregex);if(Cr)for(cr=0;cr!=Cr.length;++cr)vr[cr]=safe_decode_range(Cr[cr].slice(Cr[cr].indexOf('"')+1));var Tr=lr.match(hlinkregex);Tr&&parse_ws_xml_hlinks(ar,Tr,tr);var Fr=lr.match(marginregex);if(Fr&&(ar["!margins"]=parse_ws_xml_margins(parsexmltag(Fr[0]))),!ar["!ref"]&&sr.e.c>=sr.s.c&&sr.e.r>=sr.s.r&&(ar["!ref"]=encode_range(sr)),_e.sheetRows>0&&ar["!ref"]){var _r=safe_decode_range(ar["!ref"]);_e.sheetRows<=+_r.e.r&&(_r.e.r=_e.sheetRows-1,_r.e.r>sr.e.r&&(_r.e.r=sr.e.r),_r.e.r<_r.s.r&&(_r.s.r=_r.e.r),_r.e.c>sr.e.c&&(_r.e.c=sr.e.c),_r.e.c<_r.s.c&&(_r.s.c=_r.e.c),ar["!fullref"]=ar["!ref"],ar["!ref"]=encode_range(_r))}return xr.length>0&&(ar["!cols"]=xr),vr.length>0&&(ar["!merges"]=vr),ar}function write_ws_xml_merges(e){if(e.length===0)return"";for(var _e='<mergeCells count="'+e.length+'">',er=0;er!=e.length;++er)_e+='<mergeCell ref="'+encode_range(e[er])+'"/>';return _e+"</mergeCells>"}function parse_ws_xml_sheetpr(e,_e,er,tr){var rr=parsexmltag(e);er.Sheets[tr]||(er.Sheets[tr]={}),rr.codeName&&(er.Sheets[tr].CodeName=unescapexml(utf8read(rr.codeName)))}function parse_ws_xml_sheetpr2(e,_e,er,tr,rr){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),er,tr,rr)}function write_ws_xml_sheetpr(e,_e,er,tr,rr){var nr=!1,ir={},ar=null;if(tr.bookType!=="xlsx"&&_e.vbaraw){var sr=_e.SheetNames[er];try{_e.Workbook&&(sr=_e.Workbook.Sheets[er].CodeName||sr)}catch{}nr=!0,ir.codeName=utf8write(escapexml(sr))}if(e&&e["!outline"]){var or={summaryBelow:1,summaryRight:1};e["!outline"].above&&(or.summaryBelow=0),e["!outline"].left&&(or.summaryRight=0),ar=(ar||"")+writextag("outlinePr",null,or)}!nr&&!ar||(rr[rr.length]=writextag("sheetPr",ar,ir))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var _e={sheet:1};return sheetprot_deffalse.forEach(function(er){e[er]!=null&&e[er]&&(_e[er]="1")}),sheetprot_deftrue.forEach(function(er){e[er]!=null&&!e[er]&&(_e[er]="0")}),e.password&&(_e.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,_e)}function parse_ws_xml_hlinks(e,_e,er){for(var tr=Array.isArray(e),rr=0;rr!=_e.length;++rr){var nr=parsexmltag(utf8read(_e[rr]),!0);if(!nr.ref)return;var ir=((er||{})["!id"]||[])[nr.id];ir?(nr.Target=ir.Target,nr.location&&(nr.Target+="#"+unescapexml(nr.location))):(nr.Target="#"+unescapexml(nr.location),ir={Target:nr.Target,TargetMode:"Internal"}),nr.Rel=ir,nr.tooltip&&(nr.Tooltip=nr.tooltip,delete nr.tooltip);for(var ar=safe_decode_range(nr.ref),sr=ar.s.r;sr<=ar.e.r;++sr)for(var or=ar.s.c;or<=ar.e.c;++or){var lr=encode_cell({c:or,r:sr});tr?(e[sr]||(e[sr]=[]),e[sr][or]||(e[sr][or]={t:"z",v:void 0}),e[sr][or].l=nr):(e[lr]||(e[lr]={t:"z",v:void 0}),e[lr].l=nr)}}}function parse_ws_xml_margins(e){var _e={};return["left","right","top","bottom","header","footer"].forEach(function(er){e[er]&&(_e[er]=parseFloat(e[er]))}),_e}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function parse_ws_xml_cols(e,_e){for(var er=!1,tr=0;tr!=_e.length;++tr){var rr=parsexmltag(_e[tr],!0);rr.hidden&&(rr.hidden=parsexmlbool(rr.hidden));var nr=parseInt(rr.min,10)-1,ir=parseInt(rr.max,10)-1;for(rr.outlineLevel&&(rr.level=+rr.outlineLevel||0),delete rr.min,delete rr.max,rr.width=+rr.width,!er&&rr.width&&(er=!0,find_mdw_colw(rr.width)),process_col(rr);nr<=ir;)e[nr++]=dup(rr)}}function write_ws_xml_cols(e,_e){for(var er=["<cols>"],tr,rr=0;rr!=_e.length;++rr)(tr=_e[rr])&&(er[er.length]=writextag("col",null,col_obj_w(rr,tr)));return er[er.length]="</cols>",er.join("")}function parse_ws_xml_autofilter(e){var _e={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return _e}function write_ws_xml_autofilter(e,_e,er,tr){var rr=typeof e.ref=="string"?e.ref:encode_range(e.ref);er.Workbook||(er.Workbook={Sheets:[]}),er.Workbook.Names||(er.Workbook.Names=[]);var nr=er.Workbook.Names,ir=decode_range(rr);ir.s.r==ir.e.r&&(ir.e.r=decode_range(_e["!ref"]).e.r,rr=encode_range(ir));for(var ar=0;ar<nr.length;++ar){var sr=nr[ar];if(sr.Name=="_xlnm._FilterDatabase"&&sr.Sheet==tr){sr.Ref="'"+er.SheetNames[tr]+"'!"+rr;break}}return ar==nr.length&&nr.push({Name:"_xlnm._FilterDatabase",Sheet:tr,Ref:"'"+er.SheetNames[tr]+"'!"+rr}),writextag("autoFilter",null,{ref:rr})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,_e){_e.Views||(_e.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(er,tr){var rr=parsexmltag(er);_e.Views[tr]||(_e.Views[tr]={}),+rr.zoomScale&&(_e.Views[tr].zoom=+rr.zoomScale),parsexmlbool(rr.rightToLeft)&&(_e.Views[tr].RTL=!0)})}function write_ws_xml_sheetviews(e,_e,er,tr){var rr={workbookViewId:"0"};return(((tr||{}).Workbook||{}).Views||[])[0]&&(rr.rightToLeft=tr.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,rr),{})}function write_ws_xml_cell(e,_e,er,tr){if(e.c&&er["!comments"].push([_e,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var rr="",nr=e.t,ir=e.v;if(e.t!=="z")switch(e.t){case"b":rr=e.v?"1":"0";break;case"n":rr=""+e.v;break;case"e":rr=BErr[e.v];break;case"d":tr&&tr.cellDates?rr=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",rr=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:rr=e.v;break}var ar=writetag("v",escapexml(rr)),sr={r:_e},or=get_cell_style(tr.cellXfs,e,tr);switch(or!==0&&(sr.s=or),e.t){case"n":break;case"d":sr.t="d";break;case"b":sr.t="b";break;case"e":sr.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(tr&&tr.bookSST){ar=writetag("v",""+get_sst_id(tr.Strings,e.v,tr.revStrings)),sr.t="s";break}sr.t="str";break}if(e.t!=nr&&(e.t=nr,e.v=ir),typeof e.f=="string"&&e.f){var lr=e.F&&e.F.slice(0,_e.length)==_e?{t:"array",ref:e.F}:null;ar=writextag("f",escapexml(e.f),lr)+(e.v!=null?ar:"")}return e.l&&er["!links"].push([_e,e.l]),e.D&&(sr.cm=1),writextag("c",ar,sr)}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,_e=/<\/(?:\w+:)?row>/,er=/r=["']([^"']*)["']/,tr=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,rr=/ref=["']([^"']*)["']/,nr=matchtag("v"),ir=matchtag("f");return function(sr,or,lr,ur,fr,cr){for(var mr=0,dr="",xr=[],pr=[],gr=0,vr=0,Cr=0,Tr="",Fr,_r,Ar=0,Pr=0,Ir,wr,kr=0,Mr=0,Hr=Array.isArray(cr.CellXf),Gr,zr=[],Br=[],Vr=Array.isArray(or),Rr=[],Xr={},an=!1,yr=!!lr.sheetStubs,br=sr.split(_e),Er=0,Lr=br.length;Er!=Lr;++Er){dr=br[Er].trim();var Or=dr.length;if(Or!==0){var Ur=0;e:for(mr=0;mr<Or;++mr)switch(dr[mr]){case">":if(dr[mr-1]!="/"){++mr;break e}if(lr&&lr.cellStyles){if(_r=parsexmltag(dr.slice(Ur,mr),!0),Ar=_r.r!=null?parseInt(_r.r,10):Ar+1,Pr=-1,lr.sheetRows&&lr.sheetRows<Ar)continue;Xr={},an=!1,_r.ht&&(an=!0,Xr.hpt=parseFloat(_r.ht),Xr.hpx=pt2px(Xr.hpt)),_r.hidden=="1"&&(an=!0,Xr.hidden=!0),_r.outlineLevel!=null&&(an=!0,Xr.level=+_r.outlineLevel),an&&(Rr[Ar-1]=Xr)}break;case"<":Ur=mr;break}if(Ur>=mr)break;if(_r=parsexmltag(dr.slice(Ur,mr),!0),Ar=_r.r!=null?parseInt(_r.r,10):Ar+1,Pr=-1,!(lr.sheetRows&&lr.sheetRows<Ar)){ur.s.r>Ar-1&&(ur.s.r=Ar-1),ur.e.r<Ar-1&&(ur.e.r=Ar-1),lr&&lr.cellStyles&&(Xr={},an=!1,_r.ht&&(an=!0,Xr.hpt=parseFloat(_r.ht),Xr.hpx=pt2px(Xr.hpt)),_r.hidden=="1"&&(an=!0,Xr.hidden=!0),_r.outlineLevel!=null&&(an=!0,Xr.level=+_r.outlineLevel),an&&(Rr[Ar-1]=Xr)),xr=dr.slice(mr).split(e);for(var $r=0;$r!=xr.length&&xr[$r].trim().charAt(0)=="<";++$r);for(xr=xr.slice($r),mr=0;mr!=xr.length;++mr)if(dr=xr[mr].trim(),dr.length!==0){if(pr=dr.match(er),gr=mr,vr=0,Cr=0,dr="<c "+(dr.slice(0,1)=="<"?">":"")+dr,pr!=null&&pr.length===2){for(gr=0,Tr=pr[1],vr=0;vr!=Tr.length&&!((Cr=Tr.charCodeAt(vr)-64)<1||Cr>26);++vr)gr=26*gr+Cr;--gr,Pr=gr}else++Pr;for(vr=0;vr!=dr.length&&dr.charCodeAt(vr)!==62;++vr);if(++vr,_r=parsexmltag(dr.slice(0,vr),!0),_r.r||(_r.r=encode_cell({r:Ar-1,c:Pr})),Tr=dr.slice(vr),Fr={t:""},(pr=Tr.match(nr))!=null&&pr[1]!==""&&(Fr.v=unescapexml(pr[1])),lr.cellFormula){if((pr=Tr.match(ir))!=null&&pr[1]!==""){if(Fr.f=unescapexml(utf8read(pr[1])).replace(/\r\n/g,`
`),lr.xlfn||(Fr.f=_xlfn(Fr.f)),pr[0].indexOf('t="array"')>-1)Fr.F=(Tr.match(rr)||[])[1],Fr.F.indexOf(":")>-1&&zr.push([safe_decode_range(Fr.F),Fr.F]);else if(pr[0].indexOf('t="shared"')>-1){wr=parsexmltag(pr[0]);var Zr=unescapexml(utf8read(pr[1]));lr.xlfn||(Zr=_xlfn(Zr)),Br[parseInt(wr.si,10)]=[wr,Zr,_r.r]}}else(pr=Tr.match(/<f[^>]*\/>/))&&(wr=parsexmltag(pr[0]),Br[wr.si]&&(Fr.f=shift_formula_xlsx(Br[wr.si][1],Br[wr.si][2],_r.r)));var fn=decode_cell(_r.r);for(vr=0;vr<zr.length;++vr)fn.r>=zr[vr][0].s.r&&fn.r<=zr[vr][0].e.r&&fn.c>=zr[vr][0].s.c&&fn.c<=zr[vr][0].e.c&&(Fr.F=zr[vr][1])}if(_r.t==null&&Fr.v===void 0)if(Fr.f||Fr.F)Fr.v=0,Fr.t="n";else if(yr)Fr.t="z";else continue;else Fr.t=_r.t||"n";switch(ur.s.c>Pr&&(ur.s.c=Pr),ur.e.c<Pr&&(ur.e.c=Pr),Fr.t){case"n":if(Fr.v==""||Fr.v==null){if(!yr)continue;Fr.t="z"}else Fr.v=parseFloat(Fr.v);break;case"s":if(typeof Fr.v>"u"){if(!yr)continue;Fr.t="z"}else Ir=strs[parseInt(Fr.v,10)],Fr.v=Ir.t,Fr.r=Ir.r,lr.cellHTML&&(Fr.h=Ir.h);break;case"str":Fr.t="s",Fr.v=Fr.v!=null?utf8read(Fr.v):"",lr.cellHTML&&(Fr.h=escapehtml(Fr.v));break;case"inlineStr":pr=Tr.match(tr),Fr.t="s",pr!=null&&(Ir=parse_si(pr[1]))?(Fr.v=Ir.t,lr.cellHTML&&(Fr.h=Ir.h)):Fr.v="";break;case"b":Fr.v=parsexmlbool(Fr.v);break;case"d":lr.cellDates?Fr.v=parseDate(Fr.v,1):(Fr.v=datenum(parseDate(Fr.v,1)),Fr.t="n");break;case"e":(!lr||lr.cellText!==!1)&&(Fr.w=Fr.v),Fr.v=RBErr[Fr.v];break}if(kr=Mr=0,Gr=null,Hr&&_r.s!==void 0&&(Gr=cr.CellXf[_r.s],Gr!=null&&(Gr.numFmtId!=null&&(kr=Gr.numFmtId),lr.cellStyles&&Gr.fillId!=null&&(Mr=Gr.fillId))),safe_format(Fr,kr,Mr,lr,fr,cr),lr.cellDates&&Hr&&Fr.t=="n"&&fmt_is_date(table_fmt[kr])&&(Fr.t="d",Fr.v=numdate(Fr.v)),_r.cm&&lr.xlmeta){var _n=(lr.xlmeta.Cell||[])[+_r.cm-1];_n&&_n.type=="XLDAPR"&&(Fr.D=!0)}if(Vr){var Kr=decode_cell(_r.r);or[Kr.r]||(or[Kr.r]=[]),or[Kr.r][Kr.c]=Fr}else or[_r.r]=Fr}}}}Rr.length>0&&(or["!rows"]=Rr)}}();function write_ws_xml_data(e,_e,er,tr){var rr=[],nr=[],ir=safe_decode_range(e["!ref"]),ar="",sr,or="",lr=[],ur=0,fr=0,cr=e["!rows"],mr=Array.isArray(e),dr={r:or},xr,pr=-1;for(fr=ir.s.c;fr<=ir.e.c;++fr)lr[fr]=encode_col(fr);for(ur=ir.s.r;ur<=ir.e.r;++ur){for(nr=[],or=encode_row(ur),fr=ir.s.c;fr<=ir.e.c;++fr){sr=lr[fr]+or;var gr=mr?(e[ur]||[])[fr]:e[sr];gr!==void 0&&(ar=write_ws_xml_cell(gr,sr,e,_e))!=null&&nr.push(ar)}(nr.length>0||cr&&cr[ur])&&(dr={r:or},cr&&cr[ur]&&(xr=cr[ur],xr.hidden&&(dr.hidden=1),pr=-1,xr.hpx?pr=px2pt(xr.hpx):xr.hpt&&(pr=xr.hpt),pr>-1&&(dr.ht=pr,dr.customHeight=1),xr.level&&(dr.outlineLevel=xr.level)),rr[rr.length]=writextag("row",nr.join(""),dr))}if(cr)for(;ur<cr.length;++ur)cr&&cr[ur]&&(dr={r:ur+1},xr=cr[ur],xr.hidden&&(dr.hidden=1),pr=-1,xr.hpx?pr=px2pt(xr.hpx):xr.hpt&&(pr=xr.hpt),pr>-1&&(dr.ht=pr,dr.customHeight=1),xr.level&&(dr.outlineLevel=xr.level),rr[rr.length]=writextag("row","",dr));return rr.join("")}function write_ws_xml(e,_e,er,tr){var rr=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],nr=er.SheetNames[e],ir=0,ar="",sr=er.Sheets[nr];sr==null&&(sr={});var or=sr["!ref"]||"A1",lr=safe_decode_range(or);if(lr.e.c>16383||lr.e.r>1048575){if(_e.WTF)throw new Error("Range "+or+" exceeds format limit A1:XFD1048576");lr.e.c=Math.min(lr.e.c,16383),lr.e.r=Math.min(lr.e.c,1048575),or=encode_range(lr)}tr||(tr={}),sr["!comments"]=[];var ur=[];write_ws_xml_sheetpr(sr,er,e,_e,rr),rr[rr.length]=writextag("dimension",null,{ref:or}),rr[rr.length]=write_ws_xml_sheetviews(sr,_e,e,er),_e.sheetFormat&&(rr[rr.length]=writextag("sheetFormatPr",null,{defaultRowHeight:_e.sheetFormat.defaultRowHeight||"16",baseColWidth:_e.sheetFormat.baseColWidth||"10",outlineLevelRow:_e.sheetFormat.outlineLevelRow||"7"})),sr["!cols"]!=null&&sr["!cols"].length>0&&(rr[rr.length]=write_ws_xml_cols(sr,sr["!cols"])),rr[ir=rr.length]="<sheetData/>",sr["!links"]=[],sr["!ref"]!=null&&(ar=write_ws_xml_data(sr,_e),ar.length>0&&(rr[rr.length]=ar)),rr.length>ir+1&&(rr[rr.length]="</sheetData>",rr[ir]=rr[ir].replace("/>",">")),sr["!protect"]&&(rr[rr.length]=write_ws_xml_protection(sr["!protect"])),sr["!autofilter"]!=null&&(rr[rr.length]=write_ws_xml_autofilter(sr["!autofilter"],sr,er,e)),sr["!merges"]!=null&&sr["!merges"].length>0&&(rr[rr.length]=write_ws_xml_merges(sr["!merges"]));var fr=-1,cr,mr=-1;return sr["!links"].length>0&&(rr[rr.length]="<hyperlinks>",sr["!links"].forEach(function(dr){dr[1].Target&&(cr={ref:dr[0]},dr[1].Target.charAt(0)!="#"&&(mr=add_rels(tr,-1,escapexml(dr[1].Target).replace(/#.*$/,""),RELS.HLINK),cr["r:id"]="rId"+mr),(fr=dr[1].Target.indexOf("#"))>-1&&(cr.location=escapexml(dr[1].Target.slice(fr+1))),dr[1].Tooltip&&(cr.tooltip=escapexml(dr[1].Tooltip)),rr[rr.length]=writextag("hyperlink",null,cr))}),rr[rr.length]="</hyperlinks>"),delete sr["!links"],sr["!margins"]!=null&&(rr[rr.length]=write_ws_xml_margins(sr["!margins"])),(!_e||_e.ignoreEC||_e.ignoreEC==null)&&(rr[rr.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:or}))),ur.length>0&&(mr=add_rels(tr,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),rr[rr.length]=writextag("drawing",null,{"r:id":"rId"+mr}),sr["!drawing"]=ur),sr["!comments"].length>0&&(mr=add_rels(tr,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),rr[rr.length]=writextag("legacyDrawing",null,{"r:id":"rId"+mr}),sr["!legacy"]=mr),rr.length>1&&(rr[rr.length]="</worksheet>",rr[1]=rr[1].replace("/>",">")),rr.join("")}function parse_BrtRowHdr(e,_e){var er={},tr=e.l+_e;er.r=e.read_shift(4),e.l+=4;var rr=e.read_shift(2);e.l+=1;var nr=e.read_shift(1);return e.l=tr,nr&7&&(er.level=nr&7),nr&16&&(er.hidden=!0),nr&32&&(er.hpt=rr/20),er}function write_BrtRowHdr(e,_e,er){var tr=new_buf(145),rr=(er["!rows"]||[])[e]||{};tr.write_shift(4,e),tr.write_shift(4,0);var nr=320;rr.hpx?nr=px2pt(rr.hpx)*20:rr.hpt&&(nr=rr.hpt*20),tr.write_shift(2,nr),tr.write_shift(1,0);var ir=0;rr.level&&(ir|=rr.level),rr.hidden&&(ir|=16),(rr.hpx||rr.hpt)&&(ir|=32),tr.write_shift(1,ir),tr.write_shift(1,0);var ar=0,sr=tr.l;tr.l+=4;for(var or={r:e,c:0},lr=0;lr<16;++lr)if(!(_e.s.c>lr+1<<10||_e.e.c<lr<<10)){for(var ur=-1,fr=-1,cr=lr<<10;cr<lr+1<<10;++cr){or.c=cr;var mr=Array.isArray(er)?(er[or.r]||[])[or.c]:er[encode_cell(or)];mr&&(ur<0&&(ur=cr),fr=cr)}ur<0||(++ar,tr.write_shift(4,ur),tr.write_shift(4,fr))}var dr=tr.l;return tr.l=sr,tr.write_shift(4,ar),tr.l=dr,tr.length>tr.l?tr.slice(0,tr.l):tr}function write_row_header(e,_e,er,tr){var rr=write_BrtRowHdr(tr,er,_e);(rr.length>17||(_e["!rows"]||[])[tr])&&write_record(e,0,rr)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,_e){var er={},tr=e[e.l];return++e.l,er.above=!(tr&64),er.left=!(tr&128),e.l+=18,er.name=parse_XLSBCodeName(e),er}function write_BrtWsProp(e,_e,er){er==null&&(er=new_buf(84+4*e.length));var tr=192;_e&&(_e.above&&(tr&=-65),_e.left&&(tr&=-129)),er.write_shift(1,tr);for(var rr=1;rr<3;++rr)er.write_shift(1,0);return write_BrtColor({auto:1},er),er.write_shift(-4,-1),er.write_shift(-4,-1),write_XLSBCodeName(e,er),er.slice(0,er.l)}function parse_BrtCellBlank(e){var _e=parse_XLSBCell(e);return[_e]}function write_BrtCellBlank(e,_e,er){return er==null&&(er=new_buf(8)),write_XLSBCell(_e,er)}function parse_BrtShortBlank(e){var _e=parse_XLSBShortCell(e);return[_e]}function write_BrtShortBlank(e,_e,er){return er==null&&(er=new_buf(4)),write_XLSBShortCell(_e,er)}function parse_BrtCellBool(e){var _e=parse_XLSBCell(e),er=e.read_shift(1);return[_e,er,"b"]}function write_BrtCellBool(e,_e,er){return er==null&&(er=new_buf(9)),write_XLSBCell(_e,er),er.write_shift(1,e.v?1:0),er}function parse_BrtShortBool(e){var _e=parse_XLSBShortCell(e),er=e.read_shift(1);return[_e,er,"b"]}function write_BrtShortBool(e,_e,er){return er==null&&(er=new_buf(5)),write_XLSBShortCell(_e,er),er.write_shift(1,e.v?1:0),er}function parse_BrtCellError(e){var _e=parse_XLSBCell(e),er=e.read_shift(1);return[_e,er,"e"]}function write_BrtCellError(e,_e,er){return er==null&&(er=new_buf(9)),write_XLSBCell(_e,er),er.write_shift(1,e.v),er}function parse_BrtShortError(e){var _e=parse_XLSBShortCell(e),er=e.read_shift(1);return[_e,er,"e"]}function write_BrtShortError(e,_e,er){return er==null&&(er=new_buf(8)),write_XLSBShortCell(_e,er),er.write_shift(1,e.v),er.write_shift(2,0),er.write_shift(1,0),er}function parse_BrtCellIsst(e){var _e=parse_XLSBCell(e),er=e.read_shift(4);return[_e,er,"s"]}function write_BrtCellIsst(e,_e,er){return er==null&&(er=new_buf(12)),write_XLSBCell(_e,er),er.write_shift(4,_e.v),er}function parse_BrtShortIsst(e){var _e=parse_XLSBShortCell(e),er=e.read_shift(4);return[_e,er,"s"]}function write_BrtShortIsst(e,_e,er){return er==null&&(er=new_buf(8)),write_XLSBShortCell(_e,er),er.write_shift(4,_e.v),er}function parse_BrtCellReal(e){var _e=parse_XLSBCell(e),er=parse_Xnum(e);return[_e,er,"n"]}function write_BrtCellReal(e,_e,er){return er==null&&(er=new_buf(16)),write_XLSBCell(_e,er),write_Xnum(e.v,er),er}function parse_BrtShortReal(e){var _e=parse_XLSBShortCell(e),er=parse_Xnum(e);return[_e,er,"n"]}function write_BrtShortReal(e,_e,er){return er==null&&(er=new_buf(12)),write_XLSBShortCell(_e,er),write_Xnum(e.v,er),er}function parse_BrtCellRk(e){var _e=parse_XLSBCell(e),er=parse_RkNumber(e);return[_e,er,"n"]}function write_BrtCellRk(e,_e,er){return er==null&&(er=new_buf(12)),write_XLSBCell(_e,er),write_RkNumber(e.v,er),er}function parse_BrtShortRk(e){var _e=parse_XLSBShortCell(e),er=parse_RkNumber(e);return[_e,er,"n"]}function write_BrtShortRk(e,_e,er){return er==null&&(er=new_buf(8)),write_XLSBShortCell(_e,er),write_RkNumber(e.v,er),er}function parse_BrtCellRString(e){var _e=parse_XLSBCell(e),er=parse_RichStr(e);return[_e,er,"is"]}function parse_BrtCellSt(e){var _e=parse_XLSBCell(e),er=parse_XLWideString(e);return[_e,er,"str"]}function write_BrtCellSt(e,_e,er){return er==null&&(er=new_buf(12+4*e.v.length)),write_XLSBCell(_e,er),write_XLWideString(e.v,er),er.length>er.l?er.slice(0,er.l):er}function parse_BrtShortSt(e){var _e=parse_XLSBShortCell(e),er=parse_XLWideString(e);return[_e,er,"str"]}function write_BrtShortSt(e,_e,er){return er==null&&(er=new_buf(8+4*e.v.length)),write_XLSBShortCell(_e,er),write_XLWideString(e.v,er),er.length>er.l?er.slice(0,er.l):er}function parse_BrtFmlaBool(e,_e,er){var tr=e.l+_e,rr=parse_XLSBCell(e);rr.r=er["!row"];var nr=e.read_shift(1),ir=[rr,nr,"b"];if(er.cellFormula){e.l+=2;var ar=parse_XLSBCellParsedFormula(e,tr-e.l,er);ir[3]=stringify_formula(ar,null,rr,er.supbooks,er)}else e.l=tr;return ir}function parse_BrtFmlaError(e,_e,er){var tr=e.l+_e,rr=parse_XLSBCell(e);rr.r=er["!row"];var nr=e.read_shift(1),ir=[rr,nr,"e"];if(er.cellFormula){e.l+=2;var ar=parse_XLSBCellParsedFormula(e,tr-e.l,er);ir[3]=stringify_formula(ar,null,rr,er.supbooks,er)}else e.l=tr;return ir}function parse_BrtFmlaNum(e,_e,er){var tr=e.l+_e,rr=parse_XLSBCell(e);rr.r=er["!row"];var nr=parse_Xnum(e),ir=[rr,nr,"n"];if(er.cellFormula){e.l+=2;var ar=parse_XLSBCellParsedFormula(e,tr-e.l,er);ir[3]=stringify_formula(ar,null,rr,er.supbooks,er)}else e.l=tr;return ir}function parse_BrtFmlaString(e,_e,er){var tr=e.l+_e,rr=parse_XLSBCell(e);rr.r=er["!row"];var nr=parse_XLWideString(e),ir=[rr,nr,"str"];if(er.cellFormula){e.l+=2;var ar=parse_XLSBCellParsedFormula(e,tr-e.l,er);ir[3]=stringify_formula(ar,null,rr,er.supbooks,er)}else e.l=tr;return ir}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,_e){return _e==null&&(_e=new_buf(4)),_e.write_shift(4,e),_e}function parse_BrtHLink(e,_e){var er=e.l+_e,tr=parse_UncheckedRfX(e),rr=parse_XLNullableWideString(e),nr=parse_XLWideString(e),ir=parse_XLWideString(e),ar=parse_XLWideString(e);e.l=er;var sr={rfx:tr,relId:rr,loc:nr,display:ar};return ir&&(sr.Tooltip=ir),sr}function write_BrtHLink(e,_e){var er=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},er),write_RelID("rId"+_e,er);var tr=e[1].Target.indexOf("#"),rr=tr==-1?"":e[1].Target.slice(tr+1);return write_XLWideString(rr||"",er),write_XLWideString(e[1].Tooltip||"",er),write_XLWideString("",er),er.slice(0,er.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,_e,er){var tr=e.l+_e,rr=parse_RfX(e),nr=e.read_shift(1),ir=[rr];if(ir[2]=nr,er.cellFormula){var ar=parse_XLSBArrayParsedFormula(e,tr-e.l,er);ir[1]=ar}else e.l=tr;return ir}function parse_BrtShrFmla(e,_e,er){var tr=e.l+_e,rr=parse_UncheckedRfX(e),nr=[rr];if(er.cellFormula){var ir=parse_XLSBSharedParsedFormula(e,tr-e.l,er);nr[1]=ir,e.l=tr}else e.l=tr;return nr}function write_BrtColInfo(e,_e,er){er==null&&(er=new_buf(18));var tr=col_obj_w(e,_e);er.write_shift(-4,e),er.write_shift(-4,e),er.write_shift(4,(tr.width||10)*256),er.write_shift(4,0);var rr=0;return _e.hidden&&(rr|=1),typeof tr.width=="number"&&(rr|=2),_e.level&&(rr|=_e.level<<8),er.write_shift(2,rr),er}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var _e={};return BrtMarginKeys.forEach(function(er){_e[er]=parse_Xnum(e)}),_e}function write_BrtMargins(e,_e){return _e==null&&(_e=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(er){write_Xnum(e[er],_e)}),_e}function parse_BrtBeginWsView(e){var _e=e.read_shift(2);return e.l+=28,{RTL:_e&32}}function write_BrtBeginWsView(e,_e,er){er==null&&(er=new_buf(30));var tr=924;return(((_e||{}).Views||[])[0]||{}).RTL&&(tr|=32),er.write_shift(2,tr),er.write_shift(4,0),er.write_shift(4,0),er.write_shift(4,0),er.write_shift(1,0),er.write_shift(1,0),er.write_shift(2,0),er.write_shift(2,100),er.write_shift(2,0),er.write_shift(2,0),er.write_shift(2,0),er.write_shift(4,0),er}function write_BrtCellIgnoreEC(e){var _e=new_buf(24);return _e.write_shift(4,4),_e.write_shift(4,1),write_UncheckedRfX(e,_e),_e}function write_BrtSheetProtection(e,_e){return _e==null&&(_e=new_buf(16*4+2)),_e.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),_e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(er){er[1]?_e.write_shift(4,e[er[0]]!=null&&!e[er[0]]?1:0):_e.write_shift(4,e[er[0]]!=null&&e[er[0]]?0:1)}),_e}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,_e,er,tr,rr,nr,ir){if(!e)return e;var ar=_e||{};tr||(tr={"!id":{}});var sr=ar.dense?[]:{},or,lr={s:{r:2e6,c:2e6},e:{r:0,c:0}},ur=!1,fr=!1,cr,mr,dr,xr,pr,gr,vr,Cr,Tr,Fr=[];ar.biff=12,ar["!row"]=0;var _r=0,Ar=!1,Pr=[],Ir={},wr=ar.supbooks||rr.supbooks||[[]];if(wr.sharedf=Ir,wr.arrayf=Pr,wr.SheetNames=rr.SheetNames||rr.Sheets.map(function(Vr){return Vr.name}),!ar.supbooks&&(ar.supbooks=wr,rr.Names))for(var kr=0;kr<rr.Names.length;++kr)wr[0][kr+1]=rr.Names[kr];var Mr=[],Hr=[],Gr=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var zr;if(recordhopper(e,function(Rr,Xr,an){if(!fr)switch(an){case 148:or=Rr;break;case 0:cr=Rr,ar.sheetRows&&ar.sheetRows<=cr.r&&(fr=!0),Cr=encode_row(xr=cr.r),ar["!row"]=cr.r,(Rr.hidden||Rr.hpt||Rr.level!=null)&&(Rr.hpt&&(Rr.hpx=pt2px(Rr.hpt)),Hr[Rr.r]=Rr);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(mr={t:Rr[2]},Rr[2]){case"n":mr.v=Rr[1];break;case"s":vr=strs[Rr[1]],mr.v=vr.t,mr.r=vr.r;break;case"b":mr.v=!!Rr[1];break;case"e":mr.v=Rr[1],ar.cellText!==!1&&(mr.w=BErr[mr.v]);break;case"str":mr.t="s",mr.v=Rr[1];break;case"is":mr.t="s",mr.v=Rr[1].t;break}if((dr=ir.CellXf[Rr[0].iStyleRef])&&safe_format(mr,dr.numFmtId,null,ar,nr,ir),pr=Rr[0].c==-1?pr+1:Rr[0].c,ar.dense?(sr[xr]||(sr[xr]=[]),sr[xr][pr]=mr):sr[encode_col(pr)+Cr]=mr,ar.cellFormula){for(Ar=!1,_r=0;_r<Pr.length;++_r){var yr=Pr[_r];cr.r>=yr[0].s.r&&cr.r<=yr[0].e.r&&pr>=yr[0].s.c&&pr<=yr[0].e.c&&(mr.F=encode_range(yr[0]),Ar=!0)}!Ar&&Rr.length>3&&(mr.f=Rr[3])}if(lr.s.r>cr.r&&(lr.s.r=cr.r),lr.s.c>pr&&(lr.s.c=pr),lr.e.r<cr.r&&(lr.e.r=cr.r),lr.e.c<pr&&(lr.e.c=pr),ar.cellDates&&dr&&mr.t=="n"&&fmt_is_date(table_fmt[dr.numFmtId])){var br=SSF_parse_date_code(mr.v);br&&(mr.t="d",mr.v=new Date(br.y,br.m-1,br.d,br.H,br.M,br.S,br.u))}zr&&(zr.type=="XLDAPR"&&(mr.D=!0),zr=void 0);break;case 1:case 12:if(!ar.sheetStubs||ur)break;mr={t:"z",v:void 0},pr=Rr[0].c==-1?pr+1:Rr[0].c,ar.dense?(sr[xr]||(sr[xr]=[]),sr[xr][pr]=mr):sr[encode_col(pr)+Cr]=mr,lr.s.r>cr.r&&(lr.s.r=cr.r),lr.s.c>pr&&(lr.s.c=pr),lr.e.r<cr.r&&(lr.e.r=cr.r),lr.e.c<pr&&(lr.e.c=pr),zr&&(zr.type=="XLDAPR"&&(mr.D=!0),zr=void 0);break;case 176:Fr.push(Rr);break;case 49:zr=((ar.xlmeta||{}).Cell||[])[Rr-1];break;case 494:var Er=tr["!id"][Rr.relId];for(Er?(Rr.Target=Er.Target,Rr.loc&&(Rr.Target+="#"+Rr.loc),Rr.Rel=Er):Rr.relId==""&&(Rr.Target="#"+Rr.loc),xr=Rr.rfx.s.r;xr<=Rr.rfx.e.r;++xr)for(pr=Rr.rfx.s.c;pr<=Rr.rfx.e.c;++pr)ar.dense?(sr[xr]||(sr[xr]=[]),sr[xr][pr]||(sr[xr][pr]={t:"z",v:void 0}),sr[xr][pr].l=Rr):(gr=encode_cell({c:pr,r:xr}),sr[gr]||(sr[gr]={t:"z",v:void 0}),sr[gr].l=Rr);break;case 426:if(!ar.cellFormula)break;Pr.push(Rr),Tr=ar.dense?sr[xr][pr]:sr[encode_col(pr)+Cr],Tr.f=stringify_formula(Rr[1],lr,{r:cr.r,c:pr},wr,ar),Tr.F=encode_range(Rr[0]);break;case 427:if(!ar.cellFormula)break;Ir[encode_cell(Rr[0].s)]=Rr[1],Tr=ar.dense?sr[xr][pr]:sr[encode_col(pr)+Cr],Tr.f=stringify_formula(Rr[1],lr,{r:cr.r,c:pr},wr,ar);break;case 60:if(!ar.cellStyles)break;for(;Rr.e>=Rr.s;)Mr[Rr.e--]={width:Rr.w/256,hidden:!!(Rr.flags&1),level:Rr.level},Gr||(Gr=!0,find_mdw_colw(Rr.w/256)),process_col(Mr[Rr.e+1]);break;case 161:sr["!autofilter"]={ref:encode_range(Rr)};break;case 476:sr["!margins"]=Rr;break;case 147:rr.Sheets[er]||(rr.Sheets[er]={}),Rr.name&&(rr.Sheets[er].CodeName=Rr.name),(Rr.above||Rr.left)&&(sr["!outline"]={above:Rr.above,left:Rr.left});break;case 137:rr.Views||(rr.Views=[{}]),rr.Views[0]||(rr.Views[0]={}),Rr.RTL&&(rr.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:ur=!0;break;case 36:ur=!1;break;case 37:ur=!0;break;case 38:ur=!1;break;default:if(!Xr.T){if(!ur||ar.WTF)throw new Error("Unexpected record 0x"+an.toString(16))}}},ar),delete ar.supbooks,delete ar["!row"],!sr["!ref"]&&(lr.s.r<2e6||or&&(or.e.r>0||or.e.c>0||or.s.r>0||or.s.c>0))&&(sr["!ref"]=encode_range(or||lr)),ar.sheetRows&&sr["!ref"]){var Br=safe_decode_range(sr["!ref"]);ar.sheetRows<=+Br.e.r&&(Br.e.r=ar.sheetRows-1,Br.e.r>lr.e.r&&(Br.e.r=lr.e.r),Br.e.r<Br.s.r&&(Br.s.r=Br.e.r),Br.e.c>lr.e.c&&(Br.e.c=lr.e.c),Br.e.c<Br.s.c&&(Br.s.c=Br.e.c),sr["!fullref"]=sr["!ref"],sr["!ref"]=encode_range(Br))}return Fr.length>0&&(sr["!merges"]=Fr),Mr.length>0&&(sr["!cols"]=Mr),Hr.length>0&&(sr["!rows"]=Hr),sr}function write_ws_bin_cell(e,_e,er,tr,rr,nr,ir){if(_e.v===void 0)return!1;var ar="";switch(_e.t){case"b":ar=_e.v?"1":"0";break;case"d":_e=dup(_e),_e.z=_e.z||table_fmt[14],_e.v=datenum(parseDate(_e.v)),_e.t="n";break;case"n":case"e":ar=""+_e.v;break;default:ar=_e.v;break}var sr={r:er,c:tr};switch(sr.s=get_cell_style(rr.cellXfs,_e,rr),_e.l&&nr["!links"].push([encode_cell(sr),_e.l]),_e.c&&nr["!comments"].push([encode_cell(sr),_e.c]),_e.t){case"s":case"str":return rr.bookSST?(ar=get_sst_id(rr.Strings,_e.v,rr.revStrings),sr.t="s",sr.v=ar,ir?write_record(e,18,write_BrtShortIsst(_e,sr)):write_record(e,7,write_BrtCellIsst(_e,sr))):(sr.t="str",ir?write_record(e,17,write_BrtShortSt(_e,sr)):write_record(e,6,write_BrtCellSt(_e,sr))),!0;case"n":return _e.v==(_e.v|0)&&_e.v>-1e3&&_e.v<1e3?ir?write_record(e,13,write_BrtShortRk(_e,sr)):write_record(e,2,write_BrtCellRk(_e,sr)):ir?write_record(e,16,write_BrtShortReal(_e,sr)):write_record(e,5,write_BrtCellReal(_e,sr)),!0;case"b":return sr.t="b",ir?write_record(e,15,write_BrtShortBool(_e,sr)):write_record(e,4,write_BrtCellBool(_e,sr)),!0;case"e":return sr.t="e",ir?write_record(e,14,write_BrtShortError(_e,sr)):write_record(e,3,write_BrtCellError(_e,sr)),!0}return ir?write_record(e,12,write_BrtShortBlank(_e,sr)):write_record(e,1,write_BrtCellBlank(_e,sr)),!0}function write_CELLTABLE(e,_e,er,tr){var rr=safe_decode_range(_e["!ref"]||"A1"),nr,ir="",ar=[];write_record(e,145);var sr=Array.isArray(_e),or=rr.e.r;_e["!rows"]&&(or=Math.max(rr.e.r,_e["!rows"].length-1));for(var lr=rr.s.r;lr<=or;++lr){ir=encode_row(lr),write_row_header(e,_e,rr,lr);var ur=!1;if(lr<=rr.e.r)for(var fr=rr.s.c;fr<=rr.e.c;++fr){lr===rr.s.r&&(ar[fr]=encode_col(fr)),nr=ar[fr]+ir;var cr=sr?(_e[lr]||[])[fr]:_e[nr];if(!cr){ur=!1;continue}ur=write_ws_bin_cell(e,cr,lr,fr,tr,_e,ur)}}write_record(e,146)}function write_MERGECELLS(e,_e){!_e||!_e["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(_e["!merges"].length)),_e["!merges"].forEach(function(er){write_record(e,176,write_BrtMergeCell(er))}),write_record(e,178))}function write_COLINFOS(e,_e){!_e||!_e["!cols"]||(write_record(e,390),_e["!cols"].forEach(function(er,tr){er&&write_record(e,60,write_BrtColInfo(tr,er))}),write_record(e,391))}function write_IGNOREECS(e,_e){!_e||!_e["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(_e["!ref"]))),write_record(e,650))}function write_HLINKS(e,_e,er){_e["!links"].forEach(function(tr){if(tr[1].Target){var rr=add_rels(er,-1,tr[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(tr,rr))}}),delete _e["!links"]}function write_LEGACYDRAWING(e,_e,er,tr){if(_e["!comments"].length>0){var rr=add_rels(tr,-1,"../drawings/vmlDrawing"+(er+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+rr)),_e["!legacy"]=rr}}function write_AUTOFILTER(e,_e,er,tr){if(_e["!autofilter"]){var rr=_e["!autofilter"],nr=typeof rr.ref=="string"?rr.ref:encode_range(rr.ref);er.Workbook||(er.Workbook={Sheets:[]}),er.Workbook.Names||(er.Workbook.Names=[]);var ir=er.Workbook.Names,ar=decode_range(nr);ar.s.r==ar.e.r&&(ar.e.r=decode_range(_e["!ref"]).e.r,nr=encode_range(ar));for(var sr=0;sr<ir.length;++sr){var or=ir[sr];if(or.Name=="_xlnm._FilterDatabase"&&or.Sheet==tr){or.Ref="'"+er.SheetNames[tr]+"'!"+nr;break}}sr==ir.length&&ir.push({Name:"_xlnm._FilterDatabase",Sheet:tr,Ref:"'"+er.SheetNames[tr]+"'!"+nr}),write_record(e,161,write_UncheckedRfX(safe_decode_range(nr))),write_record(e,162)}}function write_WSVIEWS2(e,_e,er){write_record(e,133),write_record(e,137,write_BrtBeginWsView(_e,er)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,_e){_e["!protect"]&&write_record(e,535,write_BrtSheetProtection(_e["!protect"]))}function write_ws_bin(e,_e,er,tr){var rr=buf_array(),nr=er.SheetNames[e],ir=er.Sheets[nr]||{},ar=nr;try{er&&er.Workbook&&(ar=er.Workbook.Sheets[e].CodeName||ar)}catch{}var sr=safe_decode_range(ir["!ref"]||"A1");if(sr.e.c>16383||sr.e.r>1048575){if(_e.WTF)throw new Error("Range "+(ir["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");sr.e.c=Math.min(sr.e.c,16383),sr.e.r=Math.min(sr.e.c,1048575)}return ir["!links"]=[],ir["!comments"]=[],write_record(rr,129),(er.vbaraw||ir["!outline"])&&write_record(rr,147,write_BrtWsProp(ar,ir["!outline"])),write_record(rr,148,write_BrtWsDim(sr)),write_WSVIEWS2(rr,ir,er.Workbook),write_COLINFOS(rr,ir),write_CELLTABLE(rr,ir,e,_e),write_SHEETPROTECT(rr,ir),write_AUTOFILTER(rr,ir,er,e),write_MERGECELLS(rr,ir),write_HLINKS(rr,ir,tr),ir["!margins"]&&write_record(rr,476,write_BrtMargins(ir["!margins"])),(!_e||_e.ignoreEC||_e.ignoreEC==null)&&write_IGNOREECS(rr,ir),write_LEGACYDRAWING(rr,ir,e,tr),write_record(rr,130),rr.end()}function parse_Cache(e){var _e=[],er=e.match(/^<c:numCache>/),tr;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(nr){var ir=nr.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);ir&&(_e[+ir[1]]=er?+ir[2]:ir[2])});var rr=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(nr){tr=nr.replace(/<.*?>/g,"")}),[_e,rr,tr]}function parse_chart(e,_e,er,tr,rr,nr){var ir=nr||{"!type":"chart"};if(!e)return nr;var ar=0,sr=0,or="A",lr={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(ur){var fr=parse_Cache(ur);lr.s.r=lr.s.c=0,lr.e.c=ar,or=encode_col(ar),fr[0].forEach(function(cr,mr){ir[or+encode_row(mr)]={t:"n",v:cr,z:fr[1]},sr=mr}),lr.e.r<sr&&(lr.e.r=sr),++ar}),ar>0&&(ir["!ref"]=encode_range(lr)),ir}function parse_cs_xml(e,_e,er,tr,rr){if(!e)return e;tr||(tr={"!id":{}});var nr={"!type":"chart","!drawel":null,"!rel":""},ir,ar=e.match(sheetprregex);return ar&&parse_ws_xml_sheetpr(ar[0],nr,rr,er),(ir=e.match(/drawing r:id="(.*?)"/))&&(nr["!rel"]=ir[1]),tr["!id"][nr["!rel"]]&&(nr["!drawel"]=tr["!id"][nr["!rel"]]),nr}function parse_BrtCsProp(e,_e){e.l+=10;var er=parse_XLWideString(e);return{name:er}}function parse_cs_bin(e,_e,er,tr,rr){if(!e)return e;tr||(tr={"!id":{}});var nr={"!type":"chart","!drawel":null,"!rel":""},ir=!1;return recordhopper(e,function(sr,or,lr){switch(lr){case 550:nr["!rel"]=sr;break;case 651:rr.Sheets[er]||(rr.Sheets[er]={}),sr.name&&(rr.Sheets[er].CodeName=sr.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:ir=!0;break;case 36:ir=!1;break;case 37:break;case 38:break;default:if(!(or.T>0)){if(!(or.T<0)){if(!ir||_e.WTF)throw new Error("Unexpected record 0x"+lr.toString(16))}}}},_e),tr["!id"][nr["!rel"]]&&(nr["!drawel"]=tr["!id"][nr["!rel"]]),nr}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,_e){for(var er=0;er!=e.length;++er)for(var tr=e[er],rr=0;rr!=_e.length;++rr){var nr=_e[rr];if(tr[nr[0]]==null)tr[nr[0]]=nr[1];else switch(nr[2]){case"bool":typeof tr[nr[0]]=="string"&&(tr[nr[0]]=parsexmlbool(tr[nr[0]]));break;case"int":typeof tr[nr[0]]=="string"&&(tr[nr[0]]=parseInt(tr[nr[0]],10));break}}}function push_defaults(e,_e){for(var er=0;er!=_e.length;++er){var tr=_e[er];if(e[tr[0]]==null)e[tr[0]]=tr[1];else switch(tr[2]){case"bool":typeof e[tr[0]]=="string"&&(e[tr[0]]=parsexmlbool(e[tr[0]]));break;case"int":typeof e[tr[0]]=="string"&&(e[tr[0]]=parseInt(e[tr[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,_e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var er=!0;return badchars.forEach(function(tr){if(e.indexOf(tr)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),er}function check_wb_names(e,_e,er){e.forEach(function(tr,rr){check_ws_name(tr);for(var nr=0;nr<rr;++nr)if(tr==e[nr])throw new Error("Duplicate Sheet Name: "+tr);if(er){var ir=_e&&_e[rr]&&_e[rr].CodeName||tr;if(ir.charCodeAt(0)==95&&ir.length>22)throw new Error("Bad Code Name: Worksheet"+ir)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var _e=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,_e,!!e.vbaraw);for(var er=0;er<e.SheetNames.length;++er)check_ws(e.Sheets[e.SheetNames[er]],e.SheetNames[er],er)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,_e){if(!e)throw new Error("Could not find file");var er={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},tr=!1,rr="xmlns",nr={},ir=0;if(e.replace(tagregex,function(sr,or){var lr=parsexmltag(sr);switch(strip_ns(lr[0])){case"<?xml":break;case"<workbook":sr.match(wbnsregex)&&(rr="xmlns"+sr.match(/<(\w+):/)[1]),er.xmlns=lr[rr];break;case"</workbook>":break;case"<fileVersion":delete lr[0],er.AppVersion=lr;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(ur){if(lr[ur[0]]!=null)switch(ur[2]){case"bool":er.WBProps[ur[0]]=parsexmlbool(lr[ur[0]]);break;case"int":er.WBProps[ur[0]]=parseInt(lr[ur[0]],10);break;default:er.WBProps[ur[0]]=lr[ur[0]]}}),lr.codeName&&(er.WBProps.CodeName=utf8read(lr.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete lr[0],er.WBView.push(lr);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(lr.state){case"hidden":lr.Hidden=1;break;case"veryHidden":lr.Hidden=2;break;default:lr.Hidden=0}delete lr.state,lr.name=unescapexml(utf8read(lr.name)),delete lr[0],er.Sheets.push(lr);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":tr=!0;break;case"</definedNames>":tr=!1;break;case"<definedName":nr={},nr.Name=utf8read(lr.name),lr.comment&&(nr.Comment=lr.comment),lr.localSheetId&&(nr.Sheet=+lr.localSheetId),parsexmlbool(lr.hidden||"0")&&(nr.Hidden=!0),ir=or+sr.length;break;case"</definedName>":nr.Ref=unescapexml(utf8read(e.slice(ir,or))),er.Names.push(nr);break;case"<definedName/>":break;case"<calcPr":delete lr[0],er.CalcPr=lr;break;case"<calcPr/>":delete lr[0],er.CalcPr=lr;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":tr=!0;break;case"</ext>":tr=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":tr=!0;break;case"</AlternateContent>":tr=!1;break;case"<revisionPtr":break;default:if(!tr&&_e.WTF)throw new Error("unrecognized "+lr[0]+" in workbook")}return sr}),XMLNS_main.indexOf(er.xmlns)===-1)throw new Error("Unknown Namespace: "+er.xmlns);return parse_wb_defaults(er),er}function write_wb_xml(e){var _e=[XML_HEADER];_e[_e.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var er=e.Workbook&&(e.Workbook.Names||[]).length>0,tr={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(ar){e.Workbook.WBProps[ar[0]]!=null&&e.Workbook.WBProps[ar[0]]!=ar[1]&&(tr[ar[0]]=e.Workbook.WBProps[ar[0]])}),e.Workbook.WBProps.CodeName&&(tr.codeName=e.Workbook.WBProps.CodeName,delete tr.CodeName)),_e[_e.length]=writextag("workbookPr",null,tr);var rr=e.Workbook&&e.Workbook.Sheets||[],nr=0;if(rr&&rr[0]&&rr[0].Hidden){for(_e[_e.length]="<bookViews>",nr=0;nr!=e.SheetNames.length&&!(!rr[nr]||!rr[nr].Hidden);++nr);nr==e.SheetNames.length&&(nr=0),_e[_e.length]='<workbookView firstSheet="'+nr+'" activeTab="'+nr+'"/>',_e[_e.length]="</bookViews>"}for(_e[_e.length]="<sheets>",nr=0;nr!=e.SheetNames.length;++nr){var ir={name:escapexml(e.SheetNames[nr].slice(0,31))};if(ir.sheetId=""+(nr+1),ir["r:id"]="rId"+(nr+1),rr[nr])switch(rr[nr].Hidden){case 1:ir.state="hidden";break;case 2:ir.state="veryHidden";break}_e[_e.length]=writextag("sheet",null,ir)}return _e[_e.length]="</sheets>",er&&(_e[_e.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(ar){var sr={name:ar.Name};ar.Comment&&(sr.comment=ar.Comment),ar.Sheet!=null&&(sr.localSheetId=""+ar.Sheet),ar.Hidden&&(sr.hidden="1"),ar.Ref&&(_e[_e.length]=writextag("definedName",escapexml(ar.Ref),sr))}),_e[_e.length]="</definedNames>"),_e.length>2&&(_e[_e.length]="</workbook>",_e[1]=_e[1].replace("/>",">")),_e.join("")}function parse_BrtBundleSh(e,_e){var er={};return er.Hidden=e.read_shift(4),er.iTabID=e.read_shift(4),er.strRelID=parse_RelID(e),er.name=parse_XLWideString(e),er}function write_BrtBundleSh(e,_e){return _e||(_e=new_buf(127)),_e.write_shift(4,e.Hidden),_e.write_shift(4,e.iTabID),write_RelID(e.strRelID,_e),write_XLWideString(e.name.slice(0,31),_e),_e.length>_e.l?_e.slice(0,_e.l):_e}function parse_BrtWbProp(e,_e){var er={},tr=e.read_shift(4);er.defaultThemeVersion=e.read_shift(4);var rr=_e>8?parse_XLWideString(e):"";return rr.length>0&&(er.CodeName=rr),er.autoCompressPictures=!!(tr&65536),er.backupFile=!!(tr&64),er.checkCompatibility=!!(tr&4096),er.date1904=!!(tr&1),er.filterPrivacy=!!(tr&8),er.hidePivotFieldList=!!(tr&1024),er.promptedSolutions=!!(tr&16),er.publishItems=!!(tr&2048),er.refreshAllConnections=!!(tr&262144),er.saveExternalLinkValues=!!(tr&128),er.showBorderUnselectedTables=!!(tr&4),er.showInkAnnotation=!!(tr&32),er.showObjects=["all","placeholders","none"][tr>>13&3],er.showPivotChartFilter=!!(tr&32768),er.updateLinks=["userSet","never","always"][tr>>8&3],er}function write_BrtWbProp(e,_e){_e||(_e=new_buf(72));var er=0;return e&&e.filterPrivacy&&(er|=8),_e.write_shift(4,er),_e.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",_e),_e.slice(0,_e.l)}function parse_BrtFRTArchID$(e,_e){var er={};return e.read_shift(4),er.ArchID=e.read_shift(4),e.l+=_e-8,er}function parse_BrtName(e,_e,er){var tr=e.l+_e;e.l+=4,e.l+=1;var rr=e.read_shift(4),nr=parse_XLNameWideString(e),ir=parse_XLSBNameParsedFormula(e,0,er),ar=parse_XLNullableWideString(e);e.l=tr;var sr={Name:nr,Ptg:ir};return rr<268435455&&(sr.Sheet=rr),ar&&(sr.Comment=ar),sr}function parse_wb_bin(e,_e){var er={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},tr=[],rr=!1;_e||(_e={}),_e.biff=12;var nr=[],ir=[[]];return ir.SheetNames=[],ir.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(sr,or,lr){switch(lr){case 156:ir.SheetNames.push(sr.name),er.Sheets.push(sr);break;case 153:er.WBProps=sr;break;case 39:sr.Sheet!=null&&(_e.SID=sr.Sheet),sr.Ref=stringify_formula(sr.Ptg,null,null,ir,_e),delete _e.SID,delete sr.Ptg,nr.push(sr);break;case 1036:break;case 357:case 358:case 355:case 667:ir[0].length?ir.push([lr,sr]):ir[0]=[lr,sr],ir[ir.length-1].XTI=[];break;case 362:ir.length===0&&(ir[0]=[],ir[0].XTI=[]),ir[ir.length-1].XTI=ir[ir.length-1].XTI.concat(sr),ir.XTI=ir.XTI.concat(sr);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:tr.push(lr),rr=!0;break;case 36:tr.pop(),rr=!1;break;case 37:tr.push(lr),rr=!0;break;case 38:tr.pop(),rr=!1;break;case 16:break;default:if(!or.T){if(!rr||_e.WTF&&tr[tr.length-1]!=37&&tr[tr.length-1]!=35)throw new Error("Unexpected record 0x"+lr.toString(16))}}},_e),parse_wb_defaults(er),er.Names=nr,er.supbooks=ir,er}function write_BUNDLESHS(e,_e){write_record(e,143);for(var er=0;er!=_e.SheetNames.length;++er){var tr=_e.Workbook&&_e.Workbook.Sheets&&_e.Workbook.Sheets[er]&&_e.Workbook.Sheets[er].Hidden||0,rr={Hidden:tr,iTabID:er+1,strRelID:"rId"+(er+1),name:_e.SheetNames[er]};write_record(e,156,write_BrtBundleSh(rr))}write_record(e,144)}function write_BrtFileVersion(e,_e){_e||(_e=new_buf(127));for(var er=0;er!=4;++er)_e.write_shift(4,0);return write_XLWideString("SheetJS",_e),write_XLWideString(XLSX.version,_e),write_XLWideString(XLSX.version,_e),write_XLWideString("7262",_e),_e.length>_e.l?_e.slice(0,_e.l):_e}function write_BrtBookView(e,_e){_e||(_e=new_buf(29)),_e.write_shift(-4,0),_e.write_shift(-4,460),_e.write_shift(4,28800),_e.write_shift(4,17600),_e.write_shift(4,500),_e.write_shift(4,e),_e.write_shift(4,e);var er=120;return _e.write_shift(1,er),_e.length>_e.l?_e.slice(0,_e.l):_e}function write_BOOKVIEWS(e,_e){if(!(!_e.Workbook||!_e.Workbook.Sheets)){for(var er=_e.Workbook.Sheets,tr=0,rr=-1,nr=-1;tr<er.length;++tr)!er[tr]||!er[tr].Hidden&&rr==-1?rr=tr:er[tr].Hidden==1&&nr==-1&&(nr=tr);nr>rr||(write_record(e,135),write_record(e,158,write_BrtBookView(rr)),write_record(e,136))}}function write_wb_bin(e,_e){var er=buf_array();return write_record(er,131),write_record(er,128,write_BrtFileVersion()),write_record(er,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(er,e),write_BUNDLESHS(er,e),write_record(er,132),er.end()}function parse_wb(e,_e,er){return _e.slice(-4)===".bin"?parse_wb_bin(e,er):parse_wb_xml(e,er)}function parse_ws(e,_e,er,tr,rr,nr,ir,ar){return _e.slice(-4)===".bin"?parse_ws_bin(e,tr,er,rr,nr,ir,ar):parse_ws_xml(e,tr,er,rr,nr,ir,ar)}function parse_cs(e,_e,er,tr,rr,nr,ir,ar){return _e.slice(-4)===".bin"?parse_cs_bin(e,tr,er,rr,nr):parse_cs_xml(e,tr,er,rr,nr)}function parse_ms(e,_e,er,tr,rr,nr,ir,ar){return _e.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,_e,er,tr,rr,nr,ir,ar){return _e.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,_e,er,tr){return _e.slice(-4)===".bin"?parse_sty_bin(e,er,tr):parse_sty_xml(e,er,tr)}function parse_theme(e,_e,er){return parse_theme_xml(e,er)}function parse_sst(e,_e,er){return _e.slice(-4)===".bin"?parse_sst_bin(e,er):parse_sst_xml(e,er)}function parse_cmnt(e,_e,er){return _e.slice(-4)===".bin"?parse_comments_bin(e,er):parse_comments_xml(e,er)}function parse_cc(e,_e,er){return _e.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,_e,er,tr){return er.slice(-4)===".bin"?parse_xlink_bin(e,_e,er,tr):void 0}function parse_xlmeta(e,_e,er){return _e.slice(-4)===".bin"?parse_xlmeta_bin(e,_e,er):parse_xlmeta_xml(e,_e,er)}function write_wb(e,_e,er){return(_e.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,_e,er,tr,rr){return(_e.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,er,tr,rr)}function write_sty(e,_e,er){return(_e.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,er)}function write_sst(e,_e,er){return(_e.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,er)}function write_cmnt(e,_e,er){return(_e.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,_e){var er=e.split(/\s+/),tr=[];if(tr[0]=er[0],er.length===1)return tr;var rr=e.match(attregexg2),nr,ir,ar,sr;if(rr)for(sr=0;sr!=rr.length;++sr)nr=rr[sr].match(attregex2),(ir=nr[1].indexOf(":"))===-1?tr[nr[1]]=nr[2].slice(1,nr[2].length-1):(nr[1].slice(0,6)==="xmlns:"?ar="xmlns"+nr[1].slice(6):ar=nr[1].slice(ir+1),tr[ar]=nr[2].slice(1,nr[2].length-1));return tr}function xlml_parsexmltagobj(e){var _e=e.split(/\s+/),er={};if(_e.length===1)return er;var tr=e.match(attregexg2),rr,nr,ir,ar;if(tr)for(ar=0;ar!=tr.length;++ar)rr=tr[ar].match(attregex2),(nr=rr[1].indexOf(":"))===-1?er[rr[1]]=rr[2].slice(1,rr[2].length-1):(rr[1].slice(0,6)==="xmlns:"?ir="xmlns"+rr[1].slice(6):ir=rr[1].slice(nr+1),er[ir]=rr[2].slice(1,rr[2].length-1));return er}var XLMLFormatMap;function xlml_format(e,_e){var er=XLMLFormatMap[e]||unescapexml(e);return er==="General"?SSF_general(_e):SSF_format(er,_e)}function xlml_set_custprop(e,_e,er,tr){var rr=tr;switch((er[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":rr=parsexmlbool(tr);break;case"i2":case"int":rr=parseInt(tr,10);break;case"r4":case"float":rr=parseFloat(tr);break;case"date":case"dateTime.tz":rr=parseDate(tr);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+er[0])}e[unescapexml(_e)]=rr}function safe_format_xlml(e,_e,er){if(e.t!=="z"){if(!er||er.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:_e==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(_e||"General",e.v)}catch(nr){if(er.WTF)throw nr}try{var tr=XLMLFormatMap[_e]||_e||"General";if(er.cellNF&&(e.z=tr),er.cellDates&&e.t=="n"&&fmt_is_date(tr)){var rr=SSF_parse_date_code(e.v);rr&&(e.t="d",e.v=new Date(rr.y,rr.m-1,rr.d,rr.H,rr.M,rr.S,rr.u))}}catch(nr){if(er.WTF)throw nr}}}function process_style_xlml(e,_e,er){if(er.cellStyles&&_e.Interior){var tr=_e.Interior;tr.Pattern&&(tr.patternType=XLMLPatternTypeMap[tr.Pattern]||tr.Pattern)}e[_e.ID]=_e}function parse_xlml_data(e,_e,er,tr,rr,nr,ir,ar,sr,or){var lr="General",ur=tr.StyleID,fr={};or=or||{};var cr=[],mr=0;for(ur===void 0&&ar&&(ur=ar.StyleID),ur===void 0&&ir&&(ur=ir.StyleID);nr[ur]!==void 0&&(nr[ur].nf&&(lr=nr[ur].nf),nr[ur].Interior&&cr.push(nr[ur].Interior),!!nr[ur].Parent);)ur=nr[ur].Parent;switch(er.Type){case"Boolean":tr.t="b",tr.v=parsexmlbool(e);break;case"String":tr.t="s",tr.r=xlml_fixstr(unescapexml(e)),tr.v=e.indexOf("<")>-1?unescapexml(_e||e).replace(/<.*?>/g,""):tr.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),tr.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),tr.v!==tr.v?tr.v=unescapexml(e):tr.v<60&&(tr.v=tr.v-1),(!lr||lr=="General")&&(lr="yyyy-mm-dd");case"Number":tr.v===void 0&&(tr.v=+e),tr.t||(tr.t="n");break;case"Error":tr.t="e",tr.v=RBErr[e],or.cellText!==!1&&(tr.w=e);break;default:e==""&&_e==""?tr.t="z":(tr.t="s",tr.v=xlml_fixstr(_e||e));break}if(safe_format_xlml(tr,lr,or),or.cellFormula!==!1)if(tr.Formula){var dr=unescapexml(tr.Formula);dr.charCodeAt(0)==61&&(dr=dr.slice(1)),tr.f=rc_to_a1(dr,rr),delete tr.Formula,tr.ArrayRange=="RC"?tr.F=rc_to_a1("RC:RC",rr):tr.ArrayRange&&(tr.F=rc_to_a1(tr.ArrayRange,rr),sr.push([safe_decode_range(tr.F),tr.F]))}else for(mr=0;mr<sr.length;++mr)rr.r>=sr[mr][0].s.r&&rr.r<=sr[mr][0].e.r&&rr.c>=sr[mr][0].s.c&&rr.c<=sr[mr][0].e.c&&(tr.F=sr[mr][1]);or.cellStyles&&(cr.forEach(function(xr){!fr.patternType&&xr.patternType&&(fr.patternType=xr.patternType)}),tr.s=fr),tr.StyleID!==void 0&&(tr.ixfe=tr.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,_e){var er=_e||{};make_ssf();var tr=debom(xlml_normalize(e));(er.type=="binary"||er.type=="array"||er.type=="base64")&&(tr=utf8read(tr));var rr=tr.slice(0,1024).toLowerCase(),nr=!1;if(rr=rr.replace(/".*?"/g,""),(rr.indexOf(">")&1023)>Math.min(rr.indexOf(",")&1023,rr.indexOf(";")&1023)){var ir=dup(er);return ir.type="string",PRN.to_workbook(tr,ir)}if(rr.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tn){rr.indexOf("<"+tn)>=0&&(nr=!0)}),nr)return html_to_workbook(tr,er);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var ar,sr=[],or,lr={},ur=[],fr=er.dense?[]:{},cr="",mr={},dr={},xr=xlml_parsexmltag('<Data ss:Type="String">'),pr=0,gr=0,vr=0,Cr={s:{r:2e6,c:2e6},e:{r:0,c:0}},Tr={},Fr={},_r="",Ar=0,Pr=[],Ir={},wr={},kr=0,Mr=[],Hr=[],Gr={},zr=[],Br,Vr=!1,Rr=[],Xr=[],an={},yr=0,br=0,Er={Sheets:[],WBProps:{date1904:!1}},Lr={};xlmlregex.lastIndex=0,tr=tr.replace(/<!--([\s\S]*?)-->/mg,"");for(var Or="";ar=xlmlregex.exec(tr);)switch(ar[3]=(Or=ar[3]).toLowerCase()){case"data":if(Or=="data"){if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else ar[0].charAt(ar[0].length-2)!=="/"&&sr.push([ar[3],!0]);break}if(sr[sr.length-1][1])break;ar[1]==="/"?parse_xlml_data(tr.slice(pr,ar.index),_r,xr,sr[sr.length-1][0]=="comment"?Gr:mr,{c:gr,r:vr},Tr,zr[gr],dr,Rr,er):(_r="",xr=xlml_parsexmltag(ar[0]),pr=ar.index+ar[0].length);break;case"cell":if(ar[1]==="/")if(Hr.length>0&&(mr.c=Hr),(!er.sheetRows||er.sheetRows>vr)&&mr.v!==void 0&&(er.dense?(fr[vr]||(fr[vr]=[]),fr[vr][gr]=mr):fr[encode_col(gr)+encode_row(vr)]=mr),mr.HRef&&(mr.l={Target:unescapexml(mr.HRef)},mr.HRefScreenTip&&(mr.l.Tooltip=mr.HRefScreenTip),delete mr.HRef,delete mr.HRefScreenTip),(mr.MergeAcross||mr.MergeDown)&&(yr=gr+(parseInt(mr.MergeAcross,10)|0),br=vr+(parseInt(mr.MergeDown,10)|0),Pr.push({s:{c:gr,r:vr},e:{c:yr,r:br}})),!er.sheetStubs)mr.MergeAcross?gr=yr+1:++gr;else if(mr.MergeAcross||mr.MergeDown){for(var Ur=gr;Ur<=yr;++Ur)for(var $r=vr;$r<=br;++$r)(Ur>gr||$r>vr)&&(er.dense?(fr[$r]||(fr[$r]=[]),fr[$r][Ur]={t:"z"}):fr[encode_col(Ur)+encode_row($r)]={t:"z"});gr=yr+1}else++gr;else mr=xlml_parsexmltagobj(ar[0]),mr.Index&&(gr=+mr.Index-1),gr<Cr.s.c&&(Cr.s.c=gr),gr>Cr.e.c&&(Cr.e.c=gr),ar[0].slice(-2)==="/>"&&++gr,Hr=[];break;case"row":ar[1]==="/"||ar[0].slice(-2)==="/>"?(vr<Cr.s.r&&(Cr.s.r=vr),vr>Cr.e.r&&(Cr.e.r=vr),ar[0].slice(-2)==="/>"&&(dr=xlml_parsexmltag(ar[0]),dr.Index&&(vr=+dr.Index-1)),gr=0,++vr):(dr=xlml_parsexmltag(ar[0]),dr.Index&&(vr=+dr.Index-1),an={},(dr.AutoFitHeight=="0"||dr.Height)&&(an.hpx=parseInt(dr.Height,10),an.hpt=px2pt(an.hpx),Xr[vr]=an),dr.Hidden=="1"&&(an.hidden=!0,Xr[vr]=an));break;case"worksheet":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"));ur.push(cr),Cr.s.r<=Cr.e.r&&Cr.s.c<=Cr.e.c&&(fr["!ref"]=encode_range(Cr),er.sheetRows&&er.sheetRows<=Cr.e.r&&(fr["!fullref"]=fr["!ref"],Cr.e.r=er.sheetRows-1,fr["!ref"]=encode_range(Cr))),Pr.length&&(fr["!merges"]=Pr),zr.length>0&&(fr["!cols"]=zr),Xr.length>0&&(fr["!rows"]=Xr),lr[cr]=fr}else Cr={s:{r:2e6,c:2e6},e:{r:0,c:0}},vr=gr=0,sr.push([ar[3],!1]),or=xlml_parsexmltag(ar[0]),cr=unescapexml(or.Name),fr=er.dense?[]:{},Pr=[],Rr=[],Xr=[],Lr={name:cr,Hidden:0},Er.Sheets.push(Lr);break;case"table":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else{if(ar[0].slice(-2)=="/>")break;sr.push([ar[3],!1]),zr=[],Vr=!1}break;case"style":ar[1]==="/"?process_style_xlml(Tr,Fr,er):Fr=xlml_parsexmltag(ar[0]);break;case"numberformat":Fr.nf=unescapexml(xlml_parsexmltag(ar[0]).Format||"General"),XLMLFormatMap[Fr.nf]&&(Fr.nf=XLMLFormatMap[Fr.nf]);for(var Zr=0;Zr!=392&&table_fmt[Zr]!=Fr.nf;++Zr);if(Zr==392){for(Zr=57;Zr!=392;++Zr)if(table_fmt[Zr]==null){SSF_load(Fr.nf,Zr);break}}break;case"column":if(sr[sr.length-1][0]!=="table")break;if(Br=xlml_parsexmltag(ar[0]),Br.Hidden&&(Br.hidden=!0,delete Br.Hidden),Br.Width&&(Br.wpx=parseInt(Br.Width,10)),!Vr&&Br.wpx>10){Vr=!0,MDW=DEF_MDW;for(var fn=0;fn<zr.length;++fn)zr[fn]&&process_col(zr[fn])}Vr&&process_col(Br),zr[Br.Index-1||zr.length]=Br;for(var _n=0;_n<+Br.Span;++_n)zr[zr.length]=dup(Br);break;case"namedrange":if(ar[1]==="/")break;Er.Names||(Er.Names=[]);var Kr=parsexmltag(ar[0]),Cn={Name:Kr.Name,Ref:rc_to_a1(Kr.RefersTo.slice(1),{r:0,c:0})};Er.Sheets.length>0&&(Cn.Sheet=Er.Sheets.length-1),Er.Names.push(Cn);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(ar[0].slice(-2)==="/>")break;ar[1]==="/"?_r+=tr.slice(Ar,ar.index):Ar=ar.index+ar[0].length;break;case"interior":if(!er.cellStyles)break;Fr.Interior=xlml_parsexmltag(ar[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(ar[0].slice(-2)==="/>")break;ar[1]==="/"?xlml_set_prop(Ir,Or,tr.slice(kr,ar.index)):kr=ar.index+ar[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else sr.push([ar[3],!1]);break;case"comment":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"));xlml_clean_comment(Gr),Hr.push(Gr)}else sr.push([ar[3],!1]),or=xlml_parsexmltag(ar[0]),Gr={a:or.Author};break;case"autofilter":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else if(ar[0].charAt(ar[0].length-2)!=="/"){var Dn=xlml_parsexmltag(ar[0]);fr["!autofilter"]={ref:rc_to_a1(Dn.Range).replace(/\$/g,"")},sr.push([ar[3],!0])}break;case"name":break;case"datavalidation":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else ar[0].charAt(ar[0].length-2)!=="/"&&sr.push([ar[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(ar[1]==="/"){if((or=sr.pop())[0]!==ar[3])throw new Error("Bad state: "+or.join("|"))}else ar[0].charAt(ar[0].length-2)!=="/"&&sr.push([ar[3],!0]);break;case"null":break;default:if(sr.length==0&&ar[3]=="document"||sr.length==0&&ar[3]=="uof")return parse_fods(tr,er);var wn=!0;switch(sr[sr.length-1][0]){case"officedocumentsettings":switch(ar[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wn=!1}break;case"componentoptions":switch(ar[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wn=!1}break;case"excelworkbook":switch(ar[3]){case"date1904":Er.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wn=!1}break;case"workbookoptions":switch(ar[3]){case"owcversion":break;case"height":break;case"width":break;default:wn=!1}break;case"worksheetoptions":switch(ar[3]){case"visible":if(ar[0].slice(-2)!=="/>")if(ar[1]==="/")switch(tr.slice(kr,ar.index)){case"SheetHidden":Lr.Hidden=1;break;case"SheetVeryHidden":Lr.Hidden=2;break}else kr=ar.index+ar[0].length;break;case"header":fr["!margins"]||default_margins(fr["!margins"]={},"xlml"),isNaN(+parsexmltag(ar[0]).Margin)||(fr["!margins"].header=+parsexmltag(ar[0]).Margin);break;case"footer":fr["!margins"]||default_margins(fr["!margins"]={},"xlml"),isNaN(+parsexmltag(ar[0]).Margin)||(fr["!margins"].footer=+parsexmltag(ar[0]).Margin);break;case"pagemargins":var Qr=parsexmltag(ar[0]);fr["!margins"]||default_margins(fr["!margins"]={},"xlml"),isNaN(+Qr.Top)||(fr["!margins"].top=+Qr.Top),isNaN(+Qr.Left)||(fr["!margins"].left=+Qr.Left),isNaN(+Qr.Right)||(fr["!margins"].right=+Qr.Right),isNaN(+Qr.Bottom)||(fr["!margins"].bottom=+Qr.Bottom);break;case"displayrighttoleft":Er.Views||(Er.Views=[]),Er.Views[0]||(Er.Views[0]={}),Er.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":fr["!outline"]||(fr["!outline"]={}),fr["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":fr["!outline"]||(fr["!outline"]={}),fr["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wn=!1}break;case"pivottable":case"pivotcache":switch(ar[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wn=!1}break;case"pagebreaks":switch(ar[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wn=!1}break;case"autofilter":switch(ar[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wn=!1}break;case"querytable":switch(ar[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wn=!1}break;case"datavalidation":switch(ar[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wn=!1}break;case"sorting":case"conditionalformatting":switch(ar[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wn=!1}break;case"mapinfo":case"schema":case"data":switch(ar[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wn=!1}break;case"smarttags":break;default:wn=!1;break}if(wn||ar[3].match(/!\[CDATA/))break;if(!sr[sr.length-1][1])throw"Unrecognized tag: "+ar[3]+"|"+sr.join("|");if(sr[sr.length-1][0]==="customdocumentproperties"){if(ar[0].slice(-2)==="/>")break;ar[1]==="/"?xlml_set_custprop(wr,Or,Mr,tr.slice(kr,ar.index)):(Mr=ar,kr=ar.index+ar[0].length);break}if(er.WTF)throw"Unrecognized tag: "+ar[3]+"|"+sr.join("|")}var xn={};return!er.bookSheets&&!er.bookProps&&(xn.Sheets=lr),xn.SheetNames=ur,xn.Workbook=Er,xn.SSF=dup(table_fmt),xn.Props=Ir,xn.Custprops=wr,xn}function parse_xlml(e,_e){switch(fix_read_opts(_e=_e||{}),_e.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),_e);case"binary":case"buffer":case"file":return parse_xlml_xml(e,_e);case"array":return parse_xlml_xml(a2s(e),_e)}}function write_props_xlml(e,_e){var er=[];return e.Props&&er.push(xlml_write_docprops(e.Props,_e)),e.Custprops&&er.push(xlml_write_custprops(e.Props,e.Custprops)),er.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,_e){var er=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return _e.cellXfs.forEach(function(tr,rr){var nr=[];nr.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[tr.numFmtId])}));var ir={"ss:ID":"s"+(21+rr)};er.push(writextag("Style",nr.join(""),ir))}),writextag("Styles",er.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var _e=e.Workbook.Names,er=[],tr=0;tr<_e.length;++tr){var rr=_e[tr];rr.Sheet==null&&(rr.Name.match(/^_xlfn\./)||er.push(write_name_xlml(rr)))}return writextag("Names",er.join(""))}function write_ws_xlml_names(e,_e,er,tr){if(!e||!((tr||{}).Workbook||{}).Names)return"";for(var rr=tr.Workbook.Names,nr=[],ir=0;ir<rr.length;++ir){var ar=rr[ir];ar.Sheet==er&&(ar.Name.match(/^_xlfn\./)||nr.push(write_name_xlml(ar)))}return nr.join("")}function write_ws_xlml_wsopts(e,_e,er,tr){if(!e)return"";var rr=[];if(e["!margins"]&&(rr.push("<PageSetup>"),e["!margins"].header&&rr.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&rr.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),rr.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),rr.push("</PageSetup>")),tr&&tr.Workbook&&tr.Workbook.Sheets&&tr.Workbook.Sheets[er])if(tr.Workbook.Sheets[er].Hidden)rr.push(writextag("Visible",tr.Workbook.Sheets[er].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var nr=0;nr<er&&!(tr.Workbook.Sheets[nr]&&!tr.Workbook.Sheets[nr].Hidden);++nr);nr==er&&rr.push("<Selected/>")}return((((tr||{}).Workbook||{}).Views||[])[0]||{}).RTL&&rr.push("<DisplayRightToLeft/>"),e["!protect"]&&(rr.push(writetag("ProtectContents","True")),e["!protect"].objects&&rr.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&rr.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?rr.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&rr.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(ir){e["!protect"][ir[0]]&&rr.push("<"+ir[1]+"/>")})),rr.length==0?"":writextag("WorksheetOptions",rr.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(_e){var er=xlml_unfixstr(_e.t||""),tr=writextag("ss:Data",er,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",tr,{"ss:Author":_e.a})}).join("")}function write_ws_xlml_cell(e,_e,er,tr,rr,nr,ir){if(!e||e.v==null&&e.f==null)return"";var ar={};if(e.f&&(ar["ss:Formula"]="="+escapexml(a1_to_rc(e.f,ir))),e.F&&e.F.slice(0,_e.length)==_e){var sr=decode_cell(e.F.slice(_e.length+1));ar["ss:ArrayRange"]="RC:R"+(sr.r==ir.r?"":"["+(sr.r-ir.r)+"]")+"C"+(sr.c==ir.c?"":"["+(sr.c-ir.c)+"]")}if(e.l&&e.l.Target&&(ar["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(ar["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),er["!merges"])for(var or=er["!merges"],lr=0;lr!=or.length;++lr)or[lr].s.c!=ir.c||or[lr].s.r!=ir.r||(or[lr].e.c>or[lr].s.c&&(ar["ss:MergeAcross"]=or[lr].e.c-or[lr].s.c),or[lr].e.r>or[lr].s.r&&(ar["ss:MergeDown"]=or[lr].e.r-or[lr].s.r));var ur="",fr="";switch(e.t){case"z":if(!tr.sheetStubs)return"";break;case"n":ur="Number",fr=String(e.v);break;case"b":ur="Boolean",fr=e.v?"1":"0";break;case"e":ur="Error",fr=BErr[e.v];break;case"d":ur="DateTime",fr=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":ur="String",fr=escapexlml(e.v||"");break}var cr=get_cell_style(tr.cellXfs,e,tr);ar["ss:StyleID"]="s"+(21+cr),ar["ss:Index"]=ir.c+1;var mr=e.v!=null?fr:"",dr=e.t=="z"?"":'<Data ss:Type="'+ur+'">'+mr+"</Data>";return(e.c||[]).length>0&&(dr+=write_ws_xlml_comment(e.c)),writextag("Cell",dr,ar)}function write_ws_xlml_row(e,_e){var er='<Row ss:Index="'+(e+1)+'"';return _e&&(_e.hpt&&!_e.hpx&&(_e.hpx=pt2px(_e.hpt)),_e.hpx&&(er+=' ss:AutoFitHeight="0" ss:Height="'+_e.hpx+'"'),_e.hidden&&(er+=' ss:Hidden="1"')),er+">"}function write_ws_xlml_table(e,_e,er,tr){if(!e["!ref"])return"";var rr=safe_decode_range(e["!ref"]),nr=e["!merges"]||[],ir=0,ar=[];e["!cols"]&&e["!cols"].forEach(function(xr,pr){process_col(xr);var gr=!!xr.width,vr=col_obj_w(pr,xr),Cr={"ss:Index":pr+1};gr&&(Cr["ss:Width"]=width2px(vr.width)),xr.hidden&&(Cr["ss:Hidden"]="1"),ar.push(writextag("Column",null,Cr))});for(var sr=Array.isArray(e),or=rr.s.r;or<=rr.e.r;++or){for(var lr=[write_ws_xlml_row(or,(e["!rows"]||[])[or])],ur=rr.s.c;ur<=rr.e.c;++ur){var fr=!1;for(ir=0;ir!=nr.length;++ir)if(!(nr[ir].s.c>ur)&&!(nr[ir].s.r>or)&&!(nr[ir].e.c<ur)&&!(nr[ir].e.r<or)){(nr[ir].s.c!=ur||nr[ir].s.r!=or)&&(fr=!0);break}if(!fr){var cr={r:or,c:ur},mr=encode_cell(cr),dr=sr?(e[or]||[])[ur]:e[mr];lr.push(write_ws_xlml_cell(dr,mr,e,_e,er,tr,cr))}}lr.push("</Row>"),lr.length>2&&ar.push(lr.join(""))}return ar.join("")}function write_ws_xlml(e,_e,er){var tr=[],rr=er.SheetNames[e],nr=er.Sheets[rr],ir=nr?write_ws_xlml_names(nr,_e,e,er):"";return ir.length>0&&tr.push("<Names>"+ir+"</Names>"),ir=nr?write_ws_xlml_table(nr,_e,e,er):"",ir.length>0&&tr.push("<Table>"+ir+"</Table>"),tr.push(write_ws_xlml_wsopts(nr,_e,e,er)),tr.join("")}function write_xlml(e,_e){_e||(_e={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),_e.revssf=evert_num(e.SSF),_e.revssf[e.SSF[65535]]=0,_e.ssf=e.SSF,_e.cellXfs=[],get_cell_style(_e.cellXfs,{},{revssf:{General:0}}));var er=[];er.push(write_props_xlml(e,_e)),er.push(write_wb_xlml()),er.push(""),er.push("");for(var tr=0;tr<e.SheetNames.length;++tr)er.push(writextag("Worksheet",write_ws_xlml(tr,_e,e),{"ss:Name":escapexml(e.SheetNames[tr])}));return er[2]=write_sty_xlml(e,_e),er[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",er.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(e){var _e={},er=e.content;if(er.l=28,_e.AnsiUserType=er.read_shift(0,"lpstr-ansi"),_e.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(er),er.length-er.l<=4)return _e;var tr=er.read_shift(4);if(tr==0||tr>40||(er.l-=4,_e.Reserved1=er.read_shift(0,"lpstr-ansi"),er.length-er.l<=4)||(tr=er.read_shift(4),tr!==1907505652)||(_e.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(er),tr=er.read_shift(4),tr==0||tr>40))return _e;er.l-=4,_e.Reserved2=er.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,_e,er,tr,rr){var nr=tr,ir=[],ar=er.slice(er.l,er.l+nr);if(rr&&rr.enc&&rr.enc.insitu&&ar.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:rr.enc.insitu(ar)}ir.push(ar),er.l+=nr;for(var sr=__readUInt16LE(er,er.l),or=XLSRecordEnum[sr],lr=0;or!=null&&CONTINUE_RT.indexOf(sr)>-1;)nr=__readUInt16LE(er,er.l+2),lr=er.l+4,sr==2066?lr+=4:(sr==2165||sr==2175)&&(lr+=12),ar=er.slice(lr,er.l+4+nr),ir.push(ar),er.l+=4+nr,or=XLSRecordEnum[sr=__readUInt16LE(er,er.l)];var ur=bconcat(ir);prep_blob(ur,0);var fr=0;ur.lens=[];for(var cr=0;cr<ir.length;++cr)ur.lens.push(fr),fr+=ir[cr].length;if(ur.length<tr)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+ur.length+" < "+tr;return _e.f(ur,ur.length,rr)}function safe_format_xf(e,_e,er){if(e.t!=="z"&&e.XF){var tr=0;try{tr=e.z||e.XF.numFmtId||0,_e.cellNF&&(e.z=table_fmt[tr])}catch(nr){if(_e.WTF)throw nr}if(!_e||_e.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:tr===0||tr=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(tr,e.v,{date1904:!!er,dateNF:_e&&_e.dateNF})}catch(nr){if(_e.WTF)throw nr}if(_e.cellDates&&tr&&e.t=="n"&&fmt_is_date(table_fmt[tr]||String(tr))){var rr=SSF_parse_date_code(e.v);rr&&(e.t="d",e.v=new Date(rr.y,rr.m-1,rr.d,rr.H,rr.M,rr.S,rr.u))}}}function make_cell(e,_e,er){return{v:e,ixfe:_e,t:er}}function parse_workbook(e,_e){var er={opts:{}},tr={},rr=_e.dense?[]:{},nr={},ir={},ar=null,sr=[],or="",lr={},ur,fr="",cr,mr,dr,xr,pr={},gr=[],vr,Cr,Tr=[],Fr=[],_r={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ar={},Pr=function(ls){return ls<8?XLSIcv[ls]:ls<64&&Fr[ls-8]||XLSIcv[ls]},Ir=function(ls,Xn,ws){var ds=Xn.XF.data;if(!(!ds||!ds.patternType||!ws||!ws.cellStyles)){Xn.s={},Xn.s.patternType=ds.patternType;var Ps;(Ps=rgb2Hex(Pr(ds.icvFore)))&&(Xn.s.fgColor={rgb:Ps}),(Ps=rgb2Hex(Pr(ds.icvBack)))&&(Xn.s.bgColor={rgb:Ps})}},wr=function(ls,Xn,ws){if(!(an>1)&&!(ws.sheetRows&&ls.r>=ws.sheetRows)){if(ws.cellStyles&&Xn.XF&&Xn.XF.data&&Ir(ls,Xn,ws),delete Xn.ixfe,delete Xn.XF,ur=ls,fr=encode_cell(ls),(!ir||!ir.s||!ir.e)&&(ir={s:{r:0,c:0},e:{r:0,c:0}}),ls.r<ir.s.r&&(ir.s.r=ls.r),ls.c<ir.s.c&&(ir.s.c=ls.c),ls.r+1>ir.e.r&&(ir.e.r=ls.r+1),ls.c+1>ir.e.c&&(ir.e.c=ls.c+1),ws.cellFormula&&Xn.f){for(var ds=0;ds<gr.length;++ds)if(!(gr[ds][0].s.c>ls.c||gr[ds][0].s.r>ls.r)&&!(gr[ds][0].e.c<ls.c||gr[ds][0].e.r<ls.r)){Xn.F=encode_range(gr[ds][0]),(gr[ds][0].s.c!=ls.c||gr[ds][0].s.r!=ls.r)&&delete Xn.f,Xn.f&&(Xn.f=""+stringify_formula(gr[ds][1],ir,ls,Rr,kr));break}}ws.dense?(rr[ls.r]||(rr[ls.r]=[]),rr[ls.r][ls.c]=Xn):rr[fr]=Xn}},kr={enc:!1,sbcch:0,snames:[],sharedf:pr,arrayf:gr,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!_e&&!!_e.cellStyles,WTF:!!_e&&!!_e.wtf};_e.password&&(kr.password=_e.password);var Mr,Hr=[],Gr=[],zr=[],Br=[],Vr=!1,Rr=[];Rr.SheetNames=kr.snames,Rr.sharedf=kr.sharedf,Rr.arrayf=kr.arrayf,Rr.names=[],Rr.XTI=[];var Xr=0,an=0,yr=0,br=[],Er=[],Lr;kr.codepage=1200,set_cp(1200);for(var Or=!1;e.l<e.length-1;){var Ur=e.l,$r=e.read_shift(2);if($r===0&&Xr===10)break;var Zr=e.l===e.length?0:e.read_shift(2),fn=XLSRecordEnum[$r];if(fn&&fn.f){if(_e.bookSheets&&Xr===133&&$r!==133)break;if(Xr=$r,fn.r===2||fn.r==12){var _n=e.read_shift(2);if(Zr-=2,!kr.enc&&_n!==$r&&((_n&255)<<8|_n>>8)!==$r)throw new Error("rt mismatch: "+_n+"!="+$r);fn.r==12&&(e.l+=10,Zr-=10)}var Kr={};if($r===10?Kr=fn.f(e,Zr,kr):Kr=slurp($r,fn,e,Zr,kr),an==0&&[9,521,1033,2057].indexOf(Xr)===-1)continue;switch($r){case 34:er.opts.Date1904=_r.WBProps.date1904=Kr;break;case 134:er.opts.WriteProtect=!0;break;case 47:if(kr.enc||(e.l=0),kr.enc=Kr,!_e.password)throw new Error("File is password-protected");if(Kr.valid==null)throw new Error("Encryption scheme unsupported");if(!Kr.valid)throw new Error("Password is incorrect");break;case 92:kr.lastuser=Kr;break;case 66:var Cn=Number(Kr);switch(Cn){case 21010:Cn=1200;break;case 32768:Cn=1e4;break;case 32769:Cn=1252;break}set_cp(kr.codepage=Cn),Or=!0;break;case 317:kr.rrtabid=Kr;break;case 25:kr.winlocked=Kr;break;case 439:er.opts.RefreshAll=Kr;break;case 12:er.opts.CalcCount=Kr;break;case 16:er.opts.CalcDelta=Kr;break;case 17:er.opts.CalcIter=Kr;break;case 13:er.opts.CalcMode=Kr;break;case 14:er.opts.CalcPrecision=Kr;break;case 95:er.opts.CalcSaveRecalc=Kr;break;case 15:kr.CalcRefMode=Kr;break;case 2211:er.opts.FullCalc=Kr;break;case 129:Kr.fDialog&&(rr["!type"]="dialog"),Kr.fBelow||((rr["!outline"]||(rr["!outline"]={})).above=!0),Kr.fRight||((rr["!outline"]||(rr["!outline"]={})).left=!0);break;case 224:Tr.push(Kr);break;case 430:Rr.push([Kr]),Rr[Rr.length-1].XTI=[];break;case 35:case 547:Rr[Rr.length-1].push(Kr);break;case 24:case 536:Lr={Name:Kr.Name,Ref:stringify_formula(Kr.rgce,ir,null,Rr,kr)},Kr.itab>0&&(Lr.Sheet=Kr.itab-1),Rr.names.push(Lr),Rr[0]||(Rr[0]=[],Rr[0].XTI=[]),Rr[Rr.length-1].push(Kr),Kr.Name=="_xlnm._FilterDatabase"&&Kr.itab>0&&Kr.rgce&&Kr.rgce[0]&&Kr.rgce[0][0]&&Kr.rgce[0][0][0]=="PtgArea3d"&&(Er[Kr.itab-1]={ref:encode_range(Kr.rgce[0][0][1][2])});break;case 22:kr.ExternCount=Kr;break;case 23:Rr.length==0&&(Rr[0]=[],Rr[0].XTI=[]),Rr[Rr.length-1].XTI=Rr[Rr.length-1].XTI.concat(Kr),Rr.XTI=Rr.XTI.concat(Kr);break;case 2196:if(kr.biff<8)break;Lr!=null&&(Lr.Comment=Kr[1]);break;case 18:rr["!protect"]=Kr;break;case 19:Kr!==0&&kr.WTF&&console.error("Password verifier: "+Kr);break;case 133:nr[Kr.pos]=Kr,kr.snames.push(Kr.name);break;case 10:{if(--an)break;if(ir.e){if(ir.e.r>0&&ir.e.c>0){if(ir.e.r--,ir.e.c--,rr["!ref"]=encode_range(ir),_e.sheetRows&&_e.sheetRows<=ir.e.r){var Dn=ir.e.r;ir.e.r=_e.sheetRows-1,rr["!fullref"]=rr["!ref"],rr["!ref"]=encode_range(ir),ir.e.r=Dn}ir.e.r++,ir.e.c++}Hr.length>0&&(rr["!merges"]=Hr),Gr.length>0&&(rr["!objects"]=Gr),zr.length>0&&(rr["!cols"]=zr),Br.length>0&&(rr["!rows"]=Br),_r.Sheets.push(Ar)}or===""?lr=rr:tr[or]=rr,rr=_e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(kr.biff===8&&(kr.biff={9:2,521:3,1033:4}[$r]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Kr.BIFFVer]||8),kr.biffguess=Kr.BIFFVer==0,Kr.BIFFVer==0&&Kr.dt==4096&&(kr.biff=5,Or=!0,set_cp(kr.codepage=28591)),kr.biff==8&&Kr.BIFFVer==0&&Kr.dt==16&&(kr.biff=2),an++)break;if(rr=_e.dense?[]:{},kr.biff<8&&!Or&&(Or=!0,set_cp(kr.codepage=_e.codepage||1252)),kr.biff<5||Kr.BIFFVer==0&&Kr.dt==4096){or===""&&(or="Sheet1"),ir={s:{r:0,c:0},e:{r:0,c:0}};var wn={pos:e.l-Zr,name:or};nr[wn.pos]=wn,kr.snames.push(or)}else or=(nr[Ur]||{name:""}).name;Kr.dt==32&&(rr["!type"]="chart"),Kr.dt==64&&(rr["!type"]="macro"),Hr=[],Gr=[],kr.arrayf=gr=[],zr=[],Br=[],Vr=!1,Ar={Hidden:(nr[Ur]||{hs:0}).hs,name:or}}break;case 515:case 3:case 2:rr["!type"]=="chart"&&(_e.dense?(rr[Kr.r]||[])[Kr.c]:rr[encode_cell({c:Kr.c,r:Kr.r})])&&++Kr.c,vr={ixfe:Kr.ixfe,XF:Tr[Kr.ixfe]||{},v:Kr.val,t:"n"},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e);break;case 5:case 517:vr={ixfe:Kr.ixfe,XF:Tr[Kr.ixfe],v:Kr.val,t:Kr.t},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e);break;case 638:vr={ixfe:Kr.ixfe,XF:Tr[Kr.ixfe],v:Kr.rknum,t:"n"},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e);break;case 189:for(var Qr=Kr.c;Qr<=Kr.C;++Qr){var xn=Kr.rkrec[Qr-Kr.c][0];vr={ixfe:xn,XF:Tr[xn],v:Kr.rkrec[Qr-Kr.c][1],t:"n"},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Qr,r:Kr.r},vr,_e)}break;case 6:case 518:case 1030:{if(Kr.val=="String"){ar=Kr;break}if(vr=make_cell(Kr.val,Kr.cell.ixfe,Kr.tt),vr.XF=Tr[vr.ixfe],_e.cellFormula){var tn=Kr.formula;if(tn&&tn[0]&&tn[0][0]&&tn[0][0][0]=="PtgExp"){var on=tn[0][0][1][0],vn=tn[0][0][1][1],Sn=encode_cell({r:on,c:vn});pr[Sn]?vr.f=""+stringify_formula(Kr.formula,ir,Kr.cell,Rr,kr):vr.F=((_e.dense?(rr[on]||[])[vn]:rr[Sn])||{}).F}else vr.f=""+stringify_formula(Kr.formula,ir,Kr.cell,Rr,kr)}yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr(Kr.cell,vr,_e),ar=Kr}break;case 7:case 519:if(ar)ar.val=Kr,vr=make_cell(Kr,ar.cell.ixfe,"s"),vr.XF=Tr[vr.ixfe],_e.cellFormula&&(vr.f=""+stringify_formula(ar.formula,ir,ar.cell,Rr,kr)),yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr(ar.cell,vr,_e),ar=null;else throw new Error("String record expects Formula");break;case 33:case 545:{gr.push(Kr);var Ln=encode_cell(Kr[0].s);if(cr=_e.dense?(rr[Kr[0].s.r]||[])[Kr[0].s.c]:rr[Ln],_e.cellFormula&&cr){if(!ar||!Ln||!cr)break;cr.f=""+stringify_formula(Kr[1],ir,Kr[0],Rr,kr),cr.F=encode_range(Kr[0])}}break;case 1212:{if(!_e.cellFormula)break;if(fr){if(!ar)break;pr[encode_cell(ar.cell)]=Kr[0],cr=_e.dense?(rr[ar.cell.r]||[])[ar.cell.c]:rr[encode_cell(ar.cell)],(cr||{}).f=""+stringify_formula(Kr[0],ir,ur,Rr,kr)}}break;case 253:vr=make_cell(sr[Kr.isst].t,Kr.ixfe,"s"),sr[Kr.isst].h&&(vr.h=sr[Kr.isst].h),vr.XF=Tr[vr.ixfe],yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e);break;case 513:_e.sheetStubs&&(vr={ixfe:Kr.ixfe,XF:Tr[Kr.ixfe],t:"z"},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e));break;case 190:if(_e.sheetStubs)for(var Wn=Kr.c;Wn<=Kr.C;++Wn){var $n=Kr.ixfe[Wn-Kr.c];vr={ixfe:$n,XF:Tr[$n],t:"z"},yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Wn,r:Kr.r},vr,_e)}break;case 214:case 516:case 4:vr=make_cell(Kr.val,Kr.ixfe,"s"),vr.XF=Tr[vr.ixfe],yr>0&&(vr.z=br[vr.ixfe>>8&63]),safe_format_xf(vr,_e,er.opts.Date1904),wr({c:Kr.c,r:Kr.r},vr,_e);break;case 0:case 512:an===1&&(ir=Kr);break;case 252:sr=Kr;break;case 1054:if(kr.biff==4){br[yr++]=Kr[1];for(var En=0;En<yr+163&&table_fmt[En]!=Kr[1];++En);En>=163&&SSF_load(Kr[1],yr+163)}else SSF_load(Kr[1],Kr[0]);break;case 30:{br[yr++]=Kr;for(var ba=0;ba<yr+163&&table_fmt[ba]!=Kr;++ba);ba>=163&&SSF_load(Kr,yr+163)}break;case 229:Hr=Hr.concat(Kr);break;case 93:Gr[Kr.cmo[0]]=kr.lastobj=Kr;break;case 438:kr.lastobj.TxO=Kr;break;case 127:kr.lastobj.ImData=Kr;break;case 440:for(xr=Kr[0].s.r;xr<=Kr[0].e.r;++xr)for(dr=Kr[0].s.c;dr<=Kr[0].e.c;++dr)cr=_e.dense?(rr[xr]||[])[dr]:rr[encode_cell({c:dr,r:xr})],cr&&(cr.l=Kr[1]);break;case 2048:for(xr=Kr[0].s.r;xr<=Kr[0].e.r;++xr)for(dr=Kr[0].s.c;dr<=Kr[0].e.c;++dr)cr=_e.dense?(rr[xr]||[])[dr]:rr[encode_cell({c:dr,r:xr})],cr&&cr.l&&(cr.l.Tooltip=Kr[1]);break;case 28:{if(kr.biff<=5&&kr.biff>=2)break;cr=_e.dense?(rr[Kr[0].r]||[])[Kr[0].c]:rr[encode_cell(Kr[0])];var Qn=Gr[Kr[2]];cr||(_e.dense?(rr[Kr[0].r]||(rr[Kr[0].r]=[]),cr=rr[Kr[0].r][Kr[0].c]={t:"z"}):cr=rr[encode_cell(Kr[0])]={t:"z"},ir.e.r=Math.max(ir.e.r,Kr[0].r),ir.s.r=Math.min(ir.s.r,Kr[0].r),ir.e.c=Math.max(ir.e.c,Kr[0].c),ir.s.c=Math.min(ir.s.c,Kr[0].c)),cr.c||(cr.c=[]),mr={a:Kr[1],t:Qn.TxO.t},cr.c.push(mr)}break;case 2173:update_xfext(Tr[Kr.ixfe],Kr.ext);break;case 125:{if(!kr.cellStyles)break;for(;Kr.e>=Kr.s;)zr[Kr.e--]={width:Kr.w/256,level:Kr.level||0,hidden:!!(Kr.flags&1)},Vr||(Vr=!0,find_mdw_colw(Kr.w/256)),process_col(zr[Kr.e+1])}break;case 520:{var vs={};Kr.level!=null&&(Br[Kr.r]=vs,vs.level=Kr.level),Kr.hidden&&(Br[Kr.r]=vs,vs.hidden=!0),Kr.hpt&&(Br[Kr.r]=vs,vs.hpt=Kr.hpt,vs.hpx=pt2px(Kr.hpt))}break;case 38:case 39:case 40:case 41:rr["!margins"]||default_margins(rr["!margins"]={}),rr["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[$r]]=Kr;break;case 161:rr["!margins"]||default_margins(rr["!margins"]={}),rr["!margins"].header=Kr.header,rr["!margins"].footer=Kr.footer;break;case 574:Kr.RTL&&(_r.Views[0].RTL=!0);break;case 146:Fr=Kr;break;case 2198:Mr=Kr;break;case 140:Cr=Kr;break;case 442:or?Ar.CodeName=Kr||Ar.name:_r.WBProps.CodeName=Kr||"ThisWorkbook";break}}else fn||console.error("Missing Info for XLS Record 0x"+$r.toString(16)),e.l+=Zr}return er.SheetNames=keys(nr).sort(function(es,ls){return Number(es)-Number(ls)}).map(function(es){return nr[es].name}),_e.bookSheets||(er.Sheets=tr),!er.SheetNames.length&&lr["!ref"]?(er.SheetNames.push("Sheet1"),er.Sheets&&(er.Sheets.Sheet1=lr)):er.Preamble=lr,er.Sheets&&Er.forEach(function(es,ls){er.Sheets[er.SheetNames[ls]]["!autofilter"]=es}),er.Strings=sr,er.SSF=dup(table_fmt),kr.enc&&(er.Encryption=kr.enc),Mr&&(er.Themes=Mr),er.Metadata={},Cr!==void 0&&(er.Metadata.Country=Cr),Rr.names.length>0&&(_r.Names=Rr.names),er.Workbook=_r,er}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,_e,er){var tr=CFB.find(e,"/!DocumentSummaryInformation");if(tr&&tr.size>0)try{var rr=parse_PropertySetStream(tr,DocSummaryPIDDSI,PSCLSID.DSI);for(var nr in rr)_e[nr]=rr[nr]}catch(or){if(er.WTF)throw or}var ir=CFB.find(e,"/!SummaryInformation");if(ir&&ir.size>0)try{var ar=parse_PropertySetStream(ir,SummaryPIDSI,PSCLSID.SI);for(var sr in ar)_e[sr]==null&&(_e[sr]=ar[sr])}catch(or){if(er.WTF)throw or}_e.HeadingPairs&&_e.TitlesOfParts&&(load_props_pairs(_e.HeadingPairs,_e.TitlesOfParts,_e,er),delete _e.HeadingPairs,delete _e.TitlesOfParts)}function write_xls_props(e,_e){var er=[],tr=[],rr=[],nr=0,ir,ar=evert_key(DocSummaryPIDDSI,"n"),sr=evert_key(SummaryPIDSI,"n");if(e.Props)for(ir=keys(e.Props),nr=0;nr<ir.length;++nr)(Object.prototype.hasOwnProperty.call(ar,ir[nr])?er:Object.prototype.hasOwnProperty.call(sr,ir[nr])?tr:rr).push([ir[nr],e.Props[ir[nr]]]);if(e.Custprops)for(ir=keys(e.Custprops),nr=0;nr<ir.length;++nr)Object.prototype.hasOwnProperty.call(e.Props||{},ir[nr])||(Object.prototype.hasOwnProperty.call(ar,ir[nr])?er:Object.prototype.hasOwnProperty.call(sr,ir[nr])?tr:rr).push([ir[nr],e.Custprops[ir[nr]]]);var or=[];for(nr=0;nr<rr.length;++nr)XLSPSSkip.indexOf(rr[nr][0])>-1||PseudoPropsPairs.indexOf(rr[nr][0])>-1||rr[nr][1]!=null&&or.push(rr[nr]);tr.length&&CFB.utils.cfb_add(_e,"/SummaryInformation",write_PropertySetStream(tr,PSCLSID.SI,sr,SummaryPIDSI)),(er.length||or.length)&&CFB.utils.cfb_add(_e,"/DocumentSummaryInformation",write_PropertySetStream(er,PSCLSID.DSI,ar,DocSummaryPIDDSI,or.length?or:null,PSCLSID.UDI))}function parse_xlscfb(e,_e){_e||(_e={}),fix_read_opts(_e),reset_cp(),_e.codepage&&set_ansi(_e.codepage);var er,tr;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");er=CFB.find(e,"!CompObj"),tr=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(_e.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),tr={content:e}}var rr,nr;if(er&&parse_compobj(er),_e.bookProps&&!_e.bookSheets)rr={};else{var ir=has_buf?"buffer":"array";if(tr&&tr.content)rr=parse_workbook(tr.content,_e);else if((nr=CFB.find(e,"PerfectOffice_MAIN"))&&nr.content)rr=WK_.to_workbook(nr.content,(_e.type=ir,_e));else if((nr=CFB.find(e,"NativeContent_MAIN"))&&nr.content)rr=WK_.to_workbook(nr.content,(_e.type=ir,_e));else throw(nr=CFB.find(e,"MN0"))&&nr.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");_e.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(rr.vbaraw=make_vba_xls(e))}var ar={};return e.FullPaths&&parse_xls_props(e,ar,_e),rr.Props=rr.Custprops=ar,_e.bookFiles&&(rr.cfb=e),rr}function write_xlscfb(e,_e){var er=_e||{},tr=CFB.utils.cfb_new({root:"R"}),rr="/Workbook";switch(er.bookType||"xls"){case"xls":er.bookType="biff8";case"xla":er.bookType||(er.bookType="xla");case"biff8":rr="/Workbook",er.biff=8;break;case"biff5":rr="/Book",er.biff=5;break;default:throw new Error("invalid type "+er.bookType+" for XLS CFB")}return CFB.utils.cfb_add(tr,rr,write_biff_buf(e,er)),er.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,tr),er.biff==8&&e.vbaraw&&fill_vba_xls(tr,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),tr}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,_e,er,tr){var rr=_e;if(!isNaN(rr)){var nr=tr||(er||[]).length||0,ir=e.next(4);ir.write_shift(2,rr),ir.write_shift(2,nr),nr>0&&is_buf(er)&&e.push(er)}}function write_biff_continue(e,_e,er,tr){var rr=(er||[]).length||0;if(rr<=8224)return write_biff_rec(e,_e,er,rr);var nr=_e;if(!isNaN(nr)){for(var ir=er.parts||[],ar=0,sr=0,or=0;or+(ir[ar]||8224)<=8224;)or+=ir[ar]||8224,ar++;var lr=e.next(4);for(lr.write_shift(2,nr),lr.write_shift(2,or),e.push(er.slice(sr,sr+or)),sr+=or;sr<rr;){for(lr=e.next(4),lr.write_shift(2,60),or=0;or+(ir[ar]||8224)<=8224;)or+=ir[ar]||8224,ar++;lr.write_shift(2,or),e.push(er.slice(sr,sr+or)),sr+=or}}}function write_BIFF2Cell(e,_e,er){return e||(e=new_buf(7)),e.write_shift(2,_e),e.write_shift(2,er),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,_e,er,tr){var rr=new_buf(9);return write_BIFF2Cell(rr,e,_e),write_Bes(er,tr||"b",rr),rr}function write_BIFF2LABEL(e,_e,er){var tr=new_buf(8+2*er.length);return write_BIFF2Cell(tr,e,_e),tr.write_shift(1,er.length),tr.write_shift(er.length,er,"sbcs"),tr.l<tr.length?tr.slice(0,tr.l):tr}function write_ws_biff2_cell(e,_e,er,tr){if(_e.v!=null)switch(_e.t){case"d":case"n":var rr=_e.t=="d"?datenum(parseDate(_e.v)):_e.v;rr==(rr|0)&&rr>=0&&rr<65536?write_biff_rec(e,2,write_BIFF2INT(er,tr,rr)):write_biff_rec(e,3,write_BIFF2NUM(er,tr,rr));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(er,tr,_e.v,_e.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(er,tr,(_e.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,er,tr))}function write_ws_biff2(e,_e,er,tr){var rr=Array.isArray(_e),nr=safe_decode_range(_e["!ref"]||"A1"),ir,ar="",sr=[];if(nr.e.c>255||nr.e.r>16383){if(tr.WTF)throw new Error("Range "+(_e["!ref"]||"A1")+" exceeds format limit A1:IV16384");nr.e.c=Math.min(nr.e.c,255),nr.e.r=Math.min(nr.e.c,16383),ir=encode_range(nr)}for(var or=nr.s.r;or<=nr.e.r;++or){ar=encode_row(or);for(var lr=nr.s.c;lr<=nr.e.c;++lr){or===nr.s.r&&(sr[lr]=encode_col(lr)),ir=sr[lr]+ar;var ur=rr?(_e[or]||[])[lr]:_e[ir];ur&&write_ws_biff2_cell(e,ur,or,lr)}}}function write_biff2_buf(e,_e){for(var er=_e||{},tr=buf_array(),rr=0,nr=0;nr<e.SheetNames.length;++nr)e.SheetNames[nr]==er.sheet&&(rr=nr);if(rr==0&&er.sheet&&e.SheetNames[0]!=er.sheet)throw new Error("Sheet not found: "+er.sheet);return write_biff_rec(tr,er.biff==4?1033:er.biff==3?521:9,write_BOF(e,16,er)),write_ws_biff2(tr,e.Sheets[e.SheetNames[rr]],rr,er),write_biff_rec(tr,10),tr.end()}function write_FONTS_biff8(e,_e,er){write_biff_rec(e,49,write_Font({sz:12,name:"Arial"},er))}function write_FMTS_biff8(e,_e,er){_e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(tr){for(var rr=tr[0];rr<=tr[1];++rr)_e[rr]!=null&&write_biff_rec(e,1054,write_Format(rr,_e[rr],er))})}function write_FEAT(e,_e){var er=new_buf(19);er.write_shift(4,2151),er.write_shift(4,0),er.write_shift(4,0),er.write_shift(2,3),er.write_shift(1,1),er.write_shift(4,0),write_biff_rec(e,2151,er),er=new_buf(39),er.write_shift(4,2152),er.write_shift(4,0),er.write_shift(4,0),er.write_shift(2,3),er.write_shift(1,0),er.write_shift(4,0),er.write_shift(2,1),er.write_shift(4,4),er.write_shift(2,0),write_Ref8U(safe_decode_range(_e["!ref"]||"A1"),er),er.write_shift(4,4),write_biff_rec(e,2152,er)}function write_CELLXFS_biff8(e,_e){for(var er=0;er<16;++er)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,_e));_e.cellXfs.forEach(function(tr){write_biff_rec(e,224,write_XF(tr,0,_e))})}function write_ws_biff8_hlinks(e,_e){for(var er=0;er<_e["!links"].length;++er){var tr=_e["!links"][er];write_biff_rec(e,440,write_HLink(tr)),tr[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(tr))}delete _e["!links"]}function write_ws_cols_biff8(e,_e){if(_e){var er=0;_e.forEach(function(tr,rr){++er<=256&&tr&&write_biff_rec(e,125,write_ColInfo(col_obj_w(rr,tr),rr))})}}function write_ws_biff8_cell(e,_e,er,tr,rr){var nr=16+get_cell_style(rr.cellXfs,_e,rr);if(_e.v==null&&!_e.bf){write_biff_rec(e,513,write_XLSCell(er,tr,nr));return}if(_e.bf)write_biff_rec(e,6,write_Formula(_e,er,tr,rr,nr));else switch(_e.t){case"d":case"n":var ir=_e.t=="d"?datenum(parseDate(_e.v)):_e.v;write_biff_rec(e,515,write_Number(er,tr,ir,nr));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(er,tr,_e.v,nr,rr,_e.t));break;case"s":case"str":if(rr.bookSST){var ar=get_sst_id(rr.Strings,_e.v,rr.revStrings);write_biff_rec(e,253,write_LabelSst(er,tr,ar,nr))}else write_biff_rec(e,516,write_Label(er,tr,(_e.v||"").slice(0,255),nr,rr));break;default:write_biff_rec(e,513,write_XLSCell(er,tr,nr))}}function write_ws_biff8(e,_e,er){var tr=buf_array(),rr=er.SheetNames[e],nr=er.Sheets[rr]||{},ir=(er||{}).Workbook||{},ar=(ir.Sheets||[])[e]||{},sr=Array.isArray(nr),or=_e.biff==8,lr,ur="",fr=[],cr=safe_decode_range(nr["!ref"]||"A1"),mr=or?65536:16384;if(cr.e.c>255||cr.e.r>=mr){if(_e.WTF)throw new Error("Range "+(nr["!ref"]||"A1")+" exceeds format limit A1:IV16384");cr.e.c=Math.min(cr.e.c,255),cr.e.r=Math.min(cr.e.c,mr-1)}write_biff_rec(tr,2057,write_BOF(er,16,_e)),write_biff_rec(tr,13,writeuint16(1)),write_biff_rec(tr,12,writeuint16(100)),write_biff_rec(tr,15,writebool(!0)),write_biff_rec(tr,17,writebool(!1)),write_biff_rec(tr,16,write_Xnum(.001)),write_biff_rec(tr,95,writebool(!0)),write_biff_rec(tr,42,writebool(!1)),write_biff_rec(tr,43,writebool(!1)),write_biff_rec(tr,130,writeuint16(1)),write_biff_rec(tr,128,write_Guts()),write_biff_rec(tr,131,writebool(!1)),write_biff_rec(tr,132,writebool(!1)),or&&write_ws_cols_biff8(tr,nr["!cols"]),write_biff_rec(tr,512,write_Dimensions(cr,_e)),or&&(nr["!links"]=[]);for(var dr=cr.s.r;dr<=cr.e.r;++dr){ur=encode_row(dr);for(var xr=cr.s.c;xr<=cr.e.c;++xr){dr===cr.s.r&&(fr[xr]=encode_col(xr)),lr=fr[xr]+ur;var pr=sr?(nr[dr]||[])[xr]:nr[lr];pr&&(write_ws_biff8_cell(tr,pr,dr,xr,_e),or&&pr.l&&nr["!links"].push([lr,pr.l]))}}var gr=ar.CodeName||ar.name||rr;return or&&write_biff_rec(tr,574,write_Window2((ir.Views||[])[0])),or&&(nr["!merges"]||[]).length&&write_biff_rec(tr,229,write_MergeCells(nr["!merges"])),or&&write_ws_biff8_hlinks(tr,nr),write_biff_rec(tr,442,write_XLUnicodeString(gr)),or&&write_FEAT(tr,nr),write_biff_rec(tr,10),tr.end()}function write_biff8_global(e,_e,er){var tr=buf_array(),rr=(e||{}).Workbook||{},nr=rr.Sheets||[],ir=rr.WBProps||{},ar=er.biff==8,sr=er.biff==5;if(write_biff_rec(tr,2057,write_BOF(e,5,er)),er.bookType=="xla"&&write_biff_rec(tr,135),write_biff_rec(tr,225,ar?writeuint16(1200):null),write_biff_rec(tr,193,writezeroes(2)),sr&&write_biff_rec(tr,191),sr&&write_biff_rec(tr,192),write_biff_rec(tr,226),write_biff_rec(tr,92,write_WriteAccess("SheetJS",er)),write_biff_rec(tr,66,writeuint16(ar?1200:1252)),ar&&write_biff_rec(tr,353,writeuint16(0)),ar&&write_biff_rec(tr,448),write_biff_rec(tr,317,write_RRTabId(e.SheetNames.length)),ar&&e.vbaraw&&write_biff_rec(tr,211),ar&&e.vbaraw){var or=ir.CodeName||"ThisWorkbook";write_biff_rec(tr,442,write_XLUnicodeString(or))}write_biff_rec(tr,156,writeuint16(17)),write_biff_rec(tr,25,writebool(!1)),write_biff_rec(tr,18,writebool(!1)),write_biff_rec(tr,19,writeuint16(0)),ar&&write_biff_rec(tr,431,writebool(!1)),ar&&write_biff_rec(tr,444,writeuint16(0)),write_biff_rec(tr,61,write_Window1()),write_biff_rec(tr,64,writebool(!1)),write_biff_rec(tr,141,writeuint16(0)),write_biff_rec(tr,34,writebool(safe1904(e)=="true")),write_biff_rec(tr,14,writebool(!0)),ar&&write_biff_rec(tr,439,writebool(!1)),write_biff_rec(tr,218,writeuint16(0)),write_FONTS_biff8(tr,e,er),write_FMTS_biff8(tr,e.SSF,er),write_CELLXFS_biff8(tr,er),ar&&write_biff_rec(tr,352,writebool(!1));var lr=tr.end(),ur=buf_array();ar&&write_biff_rec(ur,140,write_Country()),ar&&er.Strings&&write_biff_continue(ur,252,write_SST(er.Strings)),write_biff_rec(ur,10);var fr=ur.end(),cr=buf_array(),mr=0,dr=0;for(dr=0;dr<e.SheetNames.length;++dr)mr+=(ar?12:11)+(ar?2:1)*e.SheetNames[dr].length;var xr=lr.length+mr+fr.length;for(dr=0;dr<e.SheetNames.length;++dr){var pr=nr[dr]||{};write_biff_rec(cr,133,write_BoundSheet8({pos:xr,hs:pr.Hidden||0,dt:0,name:e.SheetNames[dr]},er)),xr+=_e[dr].length}var gr=cr.end();if(mr!=gr.length)throw new Error("BS8 "+mr+" != "+gr.length);var vr=[];return lr.length&&vr.push(lr),gr.length&&vr.push(gr),fr.length&&vr.push(fr),bconcat(vr)}function write_biff8_buf(e,_e){var er=_e||{},tr=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),er.revssf=evert_num(e.SSF),er.revssf[e.SSF[65535]]=0,er.ssf=e.SSF),er.Strings=[],er.Strings.Count=0,er.Strings.Unique=0,fix_write_opts(er),er.cellXfs=[],get_cell_style(er.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var rr=0;rr<e.SheetNames.length;++rr)tr[tr.length]=write_ws_biff8(rr,er,e);return tr.unshift(write_biff8_global(e,tr,er)),bconcat(tr)}function write_biff_buf(e,_e){for(var er=0;er<=e.SheetNames.length;++er){var tr=e.Sheets[e.SheetNames[er]];if(!(!tr||!tr["!ref"])){var rr=decode_range(tr["!ref"]);rr.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[er]+"' extends beyond column IV (255).  Data may be lost.")}}var nr=_e||{};switch(nr.biff||2){case 8:case 5:return write_biff8_buf(e,_e);case 4:case 3:case 2:return write_biff2_buf(e,_e)}throw new Error("invalid type "+nr.bookType+" for BIFF")}function html_to_sheet(e,_e){var er=_e||{},tr=er.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var rr=e.match(/<table/i);if(!rr)throw new Error("Invalid HTML: could not find <table>");var nr=e.match(/<\/table/i),ir=rr.index,ar=nr&&nr.index||e.length,sr=split_regex(e.slice(ir,ar),/(:?<tr[^>]*>)/i,"<tr>"),or=-1,lr=0,ur=0,fr=0,cr={s:{r:1e7,c:1e7},e:{r:0,c:0}},mr=[];for(ir=0;ir<sr.length;++ir){var dr=sr[ir].trim(),xr=dr.slice(0,3).toLowerCase();if(xr=="<tr"){if(++or,er.sheetRows&&er.sheetRows<=or){--or;break}lr=0;continue}if(!(xr!="<td"&&xr!="<th")){var pr=dr.split(/<\/t[dh]>/i);for(ar=0;ar<pr.length;++ar){var gr=pr[ar].trim();if(gr.match(/<t[dh]/i)){for(var vr=gr,Cr=0;vr.charAt(0)=="<"&&(Cr=vr.indexOf(">"))>-1;)vr=vr.slice(Cr+1);for(var Tr=0;Tr<mr.length;++Tr){var Fr=mr[Tr];Fr.s.c==lr&&Fr.s.r<or&&or<=Fr.e.r&&(lr=Fr.e.c+1,Tr=-1)}var _r=parsexmltag(gr.slice(0,gr.indexOf(">")));fr=_r.colspan?+_r.colspan:1,((ur=+_r.rowspan)>1||fr>1)&&mr.push({s:{r:or,c:lr},e:{r:or+(ur||1)-1,c:lr+fr-1}});var Ar=_r.t||_r["data-t"]||"";if(!vr.length){lr+=fr;continue}if(vr=htmldecode(vr),cr.s.r>or&&(cr.s.r=or),cr.e.r<or&&(cr.e.r=or),cr.s.c>lr&&(cr.s.c=lr),cr.e.c<lr&&(cr.e.c=lr),!vr.length){lr+=fr;continue}var Pr={t:"s",v:vr};er.raw||!vr.trim().length||Ar=="s"||(vr==="TRUE"?Pr={t:"b",v:!0}:vr==="FALSE"?Pr={t:"b",v:!1}:isNaN(fuzzynum(vr))?isNaN(fuzzydate(vr).getDate())||(Pr={t:"d",v:parseDate(vr)},er.cellDates||(Pr={t:"n",v:datenum(Pr.v)}),Pr.z=er.dateNF||table_fmt[14]):Pr={t:"n",v:fuzzynum(vr)}),er.dense?(tr[or]||(tr[or]=[]),tr[or][lr]=Pr):tr[encode_cell({r:or,c:lr})]=Pr,lr+=fr}}}}return tr["!ref"]=encode_range(cr),mr.length&&(tr["!merges"]=mr),tr}function make_html_row(e,_e,er,tr){for(var rr=e["!merges"]||[],nr=[],ir=_e.s.c;ir<=_e.e.c;++ir){for(var ar=0,sr=0,or=0;or<rr.length;++or)if(!(rr[or].s.r>er||rr[or].s.c>ir)&&!(rr[or].e.r<er||rr[or].e.c<ir)){if(rr[or].s.r<er||rr[or].s.c<ir){ar=-1;break}ar=rr[or].e.r-rr[or].s.r+1,sr=rr[or].e.c-rr[or].s.c+1;break}if(!(ar<0)){var lr=encode_cell({r:er,c:ir}),ur=tr.dense?(e[er]||[])[ir]:e[lr],fr=ur&&ur.v!=null&&(ur.h||escapehtml(ur.w||(format_cell(ur),ur.w)||""))||"",cr={};ar>1&&(cr.rowspan=ar),sr>1&&(cr.colspan=sr),tr.editable?fr='<span contenteditable="true">'+fr+"</span>":ur&&(cr["data-t"]=ur&&ur.t||"z",ur.v!=null&&(cr["data-v"]=ur.v),ur.z!=null&&(cr["data-z"]=ur.z),ur.l&&(ur.l.Target||"#").charAt(0)!="#"&&(fr='<a href="'+ur.l.Target+'">'+fr+"</a>")),cr.id=(tr.id||"sjs")+"-"+lr,nr.push(writextag("td",fr,cr))}}var mr="<tr>";return mr+nr.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,_e){var er=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!er||er.length==0)throw new Error("Invalid HTML: could not find <table>");if(er.length==1)return sheet_to_workbook(html_to_sheet(er[0],_e),_e);var tr=book_new();return er.forEach(function(rr,nr){book_append_sheet(tr,html_to_sheet(rr,_e),"Sheet"+(nr+1))}),tr}function make_html_preamble(e,_e,er){var tr=[];return tr.join("")+"<table"+(er&&er.id?' id="'+er.id+'"':"")+">"}function sheet_to_html(e,_e){var er=_e||{},tr=er.header!=null?er.header:HTML_BEGIN,rr=er.footer!=null?er.footer:HTML_END,nr=[tr],ir=decode_range(e["!ref"]);er.dense=Array.isArray(e),nr.push(make_html_preamble(e,ir,er));for(var ar=ir.s.r;ar<=ir.e.r;++ar)nr.push(make_html_row(e,ir,ar,er));return nr.push("</table>"+rr),nr.join("")}function sheet_add_dom(e,_e,er){var tr=er||{},rr=0,nr=0;if(tr.origin!=null)if(typeof tr.origin=="number")rr=tr.origin;else{var ir=typeof tr.origin=="string"?decode_cell(tr.origin):tr.origin;rr=ir.r,nr=ir.c}var ar=_e.getElementsByTagName("tr"),sr=Math.min(tr.sheetRows||1e7,ar.length),or={s:{r:0,c:0},e:{r:rr,c:nr}};if(e["!ref"]){var lr=decode_range(e["!ref"]);or.s.r=Math.min(or.s.r,lr.s.r),or.s.c=Math.min(or.s.c,lr.s.c),or.e.r=Math.max(or.e.r,lr.e.r),or.e.c=Math.max(or.e.c,lr.e.c),rr==-1&&(or.e.r=rr=lr.e.r+1)}var ur=[],fr=0,cr=e["!rows"]||(e["!rows"]=[]),mr=0,dr=0,xr=0,pr=0,gr=0,vr=0;for(e["!cols"]||(e["!cols"]=[]);mr<ar.length&&dr<sr;++mr){var Cr=ar[mr];if(is_dom_element_hidden(Cr)){if(tr.display)continue;cr[dr]={hidden:!0}}var Tr=Cr.children;for(xr=pr=0;xr<Tr.length;++xr){var Fr=Tr[xr];if(!(tr.display&&is_dom_element_hidden(Fr))){var _r=Fr.hasAttribute("data-v")?Fr.getAttribute("data-v"):Fr.hasAttribute("v")?Fr.getAttribute("v"):htmldecode(Fr.innerHTML),Ar=Fr.getAttribute("data-z")||Fr.getAttribute("z");for(fr=0;fr<ur.length;++fr){var Pr=ur[fr];Pr.s.c==pr+nr&&Pr.s.r<dr+rr&&dr+rr<=Pr.e.r&&(pr=Pr.e.c+1-nr,fr=-1)}vr=+Fr.getAttribute("colspan")||1,((gr=+Fr.getAttribute("rowspan")||1)>1||vr>1)&&ur.push({s:{r:dr+rr,c:pr+nr},e:{r:dr+rr+(gr||1)-1,c:pr+nr+(vr||1)-1}});var Ir={t:"s",v:_r},wr=Fr.getAttribute("data-t")||Fr.getAttribute("t")||"";_r!=null&&(_r.length==0?Ir.t=wr||"z":tr.raw||_r.trim().length==0||wr=="s"||(_r==="TRUE"?Ir={t:"b",v:!0}:_r==="FALSE"?Ir={t:"b",v:!1}:isNaN(fuzzynum(_r))?isNaN(fuzzydate(_r).getDate())||(Ir={t:"d",v:parseDate(_r)},tr.cellDates||(Ir={t:"n",v:datenum(Ir.v)}),Ir.z=tr.dateNF||table_fmt[14]):Ir={t:"n",v:fuzzynum(_r)})),Ir.z===void 0&&Ar!=null&&(Ir.z=Ar);var kr="",Mr=Fr.getElementsByTagName("A");if(Mr&&Mr.length)for(var Hr=0;Hr<Mr.length&&!(Mr[Hr].hasAttribute("href")&&(kr=Mr[Hr].getAttribute("href"),kr.charAt(0)!="#"));++Hr);kr&&kr.charAt(0)!="#"&&(Ir.l={Target:kr}),tr.dense?(e[dr+rr]||(e[dr+rr]=[]),e[dr+rr][pr+nr]=Ir):e[encode_cell({c:pr+nr,r:dr+rr})]=Ir,or.e.c<pr+nr&&(or.e.c=pr+nr),pr+=vr}}++dr}return ur.length&&(e["!merges"]=(e["!merges"]||[]).concat(ur)),or.e.r=Math.max(or.e.r,dr-1+rr),e["!ref"]=encode_range(or),dr>=sr&&(e["!fullref"]=encode_range((or.e.r=ar.length-mr+dr-1+rr,or))),e}function parse_dom_table(e,_e){var er=_e||{},tr=er.dense?[]:{};return sheet_add_dom(tr,e,_e)}function table_to_book(e,_e){return sheet_to_workbook(parse_dom_table(e,_e),_e)}function is_dom_element_hidden(e){var _e="",er=get_get_computed_style_function(e);return er&&(_e=er(e).getPropertyValue("display")),_e||(_e=e.style&&e.style.display),_e==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var _e=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(tr,rr){return Array(parseInt(rr,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),er=unescapexml(_e.replace(/<[^>]*>/g,""));return[er]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,_e){var er=_e||{},tr=xlml_normalize(e),rr=[],nr,ir,ar={name:""},sr="",or=0,lr,ur,fr={},cr=[],mr=er.dense?[]:{},dr,xr,pr={value:""},gr="",vr=0,Cr=[],Tr=-1,Fr=-1,_r={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ar=0,Pr={},Ir=[],wr={},kr=0,Mr=0,Hr=[],Gr=1,zr=1,Br=[],Vr={Names:[]},Rr={},Xr=["",""],an=[],yr={},br="",Er=0,Lr=!1,Or=!1,Ur=0;for(xlmlregex.lastIndex=0,tr=tr.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");dr=xlmlregex.exec(tr);)switch(dr[3]=dr[3].replace(/_.*$/,"")){case"table":case"":dr[1]==="/"?(_r.e.c>=_r.s.c&&_r.e.r>=_r.s.r?mr["!ref"]=encode_range(_r):mr["!ref"]="A1:A1",er.sheetRows>0&&er.sheetRows<=_r.e.r&&(mr["!fullref"]=mr["!ref"],_r.e.r=er.sheetRows-1,mr["!ref"]=encode_range(_r)),Ir.length&&(mr["!merges"]=Ir),Hr.length&&(mr["!rows"]=Hr),lr.name=lr.||lr.name,typeof JSON<"u"&&JSON.stringify(lr),cr.push(lr.name),fr[lr.name]=mr,Or=!1):dr[0].charAt(dr[0].length-2)!=="/"&&(lr=parsexmltag(dr[0],!1),Tr=Fr=-1,_r.s.r=_r.s.c=1e7,_r.e.r=_r.e.c=0,mr=er.dense?[]:{},Ir=[],Hr=[],Or=!0);break;case"table-row-group":dr[1]==="/"?--Ar:++Ar;break;case"table-row":case"":if(dr[1]==="/"){Tr+=Gr,Gr=1;break}if(ur=parsexmltag(dr[0],!1),ur.?Tr=ur.-1:Tr==-1&&(Tr=0),Gr=+ur["number-rows-repeated"]||1,Gr<10)for(Ur=0;Ur<Gr;++Ur)Ar>0&&(Hr[Tr+Ur]={level:Ar});Fr=-1;break;case"covered-table-cell":dr[1]!=="/"&&++Fr,er.sheetStubs&&(er.dense?(mr[Tr]||(mr[Tr]=[]),mr[Tr][Fr]={t:"z"}):mr[encode_cell({r:Tr,c:Fr})]={t:"z"}),gr="",Cr=[];break;case"table-cell":case"":if(dr[0].charAt(dr[0].length-2)==="/")++Fr,pr=parsexmltag(dr[0],!1),zr=parseInt(pr["number-columns-repeated"]||"1",10),xr={t:"z",v:null},pr.formula&&er.cellFormula!=!1&&(xr.f=ods_to_csf_formula(unescapexml(pr.formula))),(pr.||pr["value-type"])=="string"&&(xr.t="s",xr.v=unescapexml(pr["string-value"]||""),er.dense?(mr[Tr]||(mr[Tr]=[]),mr[Tr][Fr]=xr):mr[encode_cell({r:Tr,c:Fr})]=xr),Fr+=zr-1;else if(dr[1]!=="/"){++Fr,gr="",vr=0,Cr=[],zr=1;var $r=Gr?Tr+Gr-1:Tr;if(Fr>_r.e.c&&(_r.e.c=Fr),Fr<_r.s.c&&(_r.s.c=Fr),Tr<_r.s.r&&(_r.s.r=Tr),$r>_r.e.r&&(_r.e.r=$r),pr=parsexmltag(dr[0],!1),an=[],yr={},xr={t:pr.||pr["value-type"],v:null},er.cellFormula)if(pr.formula&&(pr.formula=unescapexml(pr.formula)),pr["number-matrix-columns-spanned"]&&pr["number-matrix-rows-spanned"]&&(kr=parseInt(pr["number-matrix-rows-spanned"],10)||0,Mr=parseInt(pr["number-matrix-columns-spanned"],10)||0,wr={s:{r:Tr,c:Fr},e:{r:Tr+kr-1,c:Fr+Mr-1}},xr.F=encode_range(wr),Br.push([wr,xr.F])),pr.formula)xr.f=ods_to_csf_formula(pr.formula);else for(Ur=0;Ur<Br.length;++Ur)Tr>=Br[Ur][0].s.r&&Tr<=Br[Ur][0].e.r&&Fr>=Br[Ur][0].s.c&&Fr<=Br[Ur][0].e.c&&(xr.F=Br[Ur][1]);switch((pr["number-columns-spanned"]||pr["number-rows-spanned"])&&(kr=parseInt(pr["number-rows-spanned"],10)||0,Mr=parseInt(pr["number-columns-spanned"],10)||0,wr={s:{r:Tr,c:Fr},e:{r:Tr+kr-1,c:Fr+Mr-1}},Ir.push(wr)),pr["number-columns-repeated"]&&(zr=parseInt(pr["number-columns-repeated"],10)),xr.t){case"boolean":xr.t="b",xr.v=parsexmlbool(pr["boolean-value"]);break;case"float":xr.t="n",xr.v=parseFloat(pr.value);break;case"percentage":xr.t="n",xr.v=parseFloat(pr.value);break;case"currency":xr.t="n",xr.v=parseFloat(pr.value);break;case"date":xr.t="d",xr.v=parseDate(pr["date-value"]),er.cellDates||(xr.t="n",xr.v=datenum(xr.v)),xr.z="m/d/yy";break;case"time":xr.t="n",xr.v=parse_isodur(pr["time-value"])/86400,er.cellDates&&(xr.t="d",xr.v=numdate(xr.v)),xr.z="HH:MM:SS";break;case"number":xr.t="n",xr.v=parseFloat(pr.);break;default:if(xr.t==="string"||xr.t==="text"||!xr.t)xr.t="s",pr["string-value"]!=null&&(gr=unescapexml(pr["string-value"]),Cr=[]);else throw new Error("Unsupported value type "+xr.t)}}else{if(Lr=!1,xr.t==="s"&&(xr.v=gr||"",Cr.length&&(xr.R=Cr),Lr=vr==0),Rr.Target&&(xr.l=Rr),an.length>0&&(xr.c=an,an=[]),gr&&er.cellText!==!1&&(xr.w=gr),Lr&&(xr.t="z",delete xr.v),(!Lr||er.sheetStubs)&&!(er.sheetRows&&er.sheetRows<=Tr))for(var Zr=0;Zr<Gr;++Zr){if(zr=parseInt(pr["number-columns-repeated"]||"1",10),er.dense)for(mr[Tr+Zr]||(mr[Tr+Zr]=[]),mr[Tr+Zr][Fr]=Zr==0?xr:dup(xr);--zr>0;)mr[Tr+Zr][Fr+zr]=dup(xr);else for(mr[encode_cell({r:Tr+Zr,c:Fr})]=xr;--zr>0;)mr[encode_cell({r:Tr+Zr,c:Fr+zr})]=dup(xr);_r.e.c<=Fr&&(_r.e.c=Fr)}zr=parseInt(pr["number-columns-repeated"]||"1",10),Fr+=zr-1,zr=0,xr={},gr="",Cr=[]}Rr={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(dr[1]==="/"){if((nr=rr.pop())[0]!==dr[3])throw"Bad state: "+nr}else dr[0].charAt(dr[0].length-2)!=="/"&&rr.push([dr[3],!0]);break;case"annotation":if(dr[1]==="/"){if((nr=rr.pop())[0]!==dr[3])throw"Bad state: "+nr;yr.t=gr,Cr.length&&(yr.R=Cr),yr.a=br,an.push(yr)}else dr[0].charAt(dr[0].length-2)!=="/"&&rr.push([dr[3],!1]);br="",Er=0,gr="",vr=0,Cr=[];break;case"creator":dr[1]==="/"?br=tr.slice(Er,dr.index):Er=dr.index+dr[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(dr[1]==="/"){if((nr=rr.pop())[0]!==dr[3])throw"Bad state: "+nr}else dr[0].charAt(dr[0].length-2)!=="/"&&rr.push([dr[3],!1]);gr="",vr=0,Cr=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(dr[1]==="/"){if(Pr[ar.name]=sr,(nr=rr.pop())[0]!==dr[3])throw"Bad state: "+nr}else dr[0].charAt(dr[0].length-2)!=="/"&&(sr="",ar=parsexmltag(dr[0],!1),rr.push([dr[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(rr[rr.length-1][0]){case"time-style":case"date-style":ir=parsexmltag(dr[0],!1),sr+=number_formats_ods[dr[3]][ir.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(rr[rr.length-1][0]){case"time-style":case"date-style":ir=parsexmltag(dr[0],!1),sr+=number_formats_ods[dr[3]][ir.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(dr[0].slice(-2)==="/>")break;if(dr[1]==="/")switch(rr[rr.length-1][0]){case"number-style":case"date-style":case"time-style":sr+=tr.slice(or,dr.index);break}else or=dr.index+dr[0].length;break;case"named-range":ir=parsexmltag(dr[0],!1),Xr=ods_to_csf_3D(ir["cell-range-address"]);var fn={Name:ir.name,Ref:Xr[0]+"!"+Xr[1]};Or&&(fn.Sheet=cr.length),Vr.Names.push(fn);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(rr[rr.length-1][0])>-1)break;if(dr[1]==="/"&&(!pr||!pr["string-value"])){var _n=parse_text_p(tr.slice(vr,dr.index));gr=(gr.length>0?gr+`
`:"")+_n[0]}else parsexmltag(dr[0],!1),vr=dr.index+dr[0].length;break;case"s":break;case"database-range":if(dr[1]==="/")break;try{Xr=ods_to_csf_3D(parsexmltag(dr[0])["target-range-address"]),fr[Xr[0]]["!autofilter"]={ref:Xr[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(dr[1]!=="/"){if(Rr=parsexmltag(dr[0],!1),!Rr.href)break;Rr.Target=unescapexml(Rr.href),delete Rr.href,Rr.Target.charAt(0)=="#"&&Rr.Target.indexOf(".")>-1?(Xr=ods_to_csf_3D(Rr.Target.slice(1)),Rr.Target="#"+Xr[0]+"!"+Xr[1]):Rr.Target.match(/^\.\.[\\\/]/)&&(Rr.Target=Rr.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(dr[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(er.WTF)throw new Error(dr)}}var Kr={Sheets:fr,SheetNames:cr,Workbook:Vr};return er.bookSheets&&delete Kr.Sheets,Kr}function parse_ods(e,_e){_e=_e||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),_e);var er=getzipstr(e,"content.xml");if(!er)throw new Error("Missing content.xml in ODS / UOF file");var tr=parse_content_xml(utf8read(er),_e);return safegetzipfile(e,"meta.xml")&&(tr.Props=parse_core_props(getzipdata(e,"meta.xml"))),tr}function parse_fods(e,_e){return parse_content_xml(e,_e)}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),_e="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+_e}}(),write_content_ods=function(){var e=function(nr){return escapexml(nr).replace(/  +/g,function(ir){return'<text:s text:c="'+ir.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},_e=`          <table:table-cell />
`,er=`          <table:covered-table-cell/>
`,tr=function(nr,ir,ar){var sr=[];sr.push('      <table:table table:name="'+escapexml(ir.SheetNames[ar])+`" table:style-name="ta1">
`);var or=0,lr=0,ur=decode_range(nr["!ref"]||"A1"),fr=nr["!merges"]||[],cr=0,mr=Array.isArray(nr);if(nr["!cols"])for(lr=0;lr<=ur.e.c;++lr)sr.push("        <table:table-column"+(nr["!cols"][lr]?' table:style-name="co'+nr["!cols"][lr].ods+'"':"")+`></table:table-column>
`);var dr="",xr=nr["!rows"]||[];for(or=0;or<ur.s.r;++or)dr=xr[or]?' table:style-name="ro'+xr[or].ods+'"':"",sr.push("        <table:table-row"+dr+`></table:table-row>
`);for(;or<=ur.e.r;++or){for(dr=xr[or]?' table:style-name="ro'+xr[or].ods+'"':"",sr.push("        <table:table-row"+dr+`>
`),lr=0;lr<ur.s.c;++lr)sr.push(_e);for(;lr<=ur.e.c;++lr){var pr=!1,gr={},vr="";for(cr=0;cr!=fr.length;++cr)if(!(fr[cr].s.c>lr)&&!(fr[cr].s.r>or)&&!(fr[cr].e.c<lr)&&!(fr[cr].e.r<or)){(fr[cr].s.c!=lr||fr[cr].s.r!=or)&&(pr=!0),gr["table:number-columns-spanned"]=fr[cr].e.c-fr[cr].s.c+1,gr["table:number-rows-spanned"]=fr[cr].e.r-fr[cr].s.r+1;break}if(pr){sr.push(er);continue}var Cr=encode_cell({r:or,c:lr}),Tr=mr?(nr[or]||[])[lr]:nr[Cr];if(Tr&&Tr.f&&(gr["table:formula"]=escapexml(csf_to_ods_formula(Tr.f)),Tr.F&&Tr.F.slice(0,Cr.length)==Cr)){var Fr=decode_range(Tr.F);gr["table:number-matrix-columns-spanned"]=Fr.e.c-Fr.s.c+1,gr["table:number-matrix-rows-spanned"]=Fr.e.r-Fr.s.r+1}if(!Tr){sr.push(_e);continue}switch(Tr.t){case"b":vr=Tr.v?"TRUE":"FALSE",gr["office:value-type"]="boolean",gr["office:boolean-value"]=Tr.v?"true":"false";break;case"n":vr=Tr.w||String(Tr.v||0),gr["office:value-type"]="float",gr["office:value"]=Tr.v||0;break;case"s":case"str":vr=Tr.v==null?"":Tr.v,gr["office:value-type"]="string";break;case"d":vr=Tr.w||parseDate(Tr.v).toISOString(),gr["office:value-type"]="date",gr["office:date-value"]=parseDate(Tr.v).toISOString(),gr["table:style-name"]="ce1";break;default:sr.push(_e);continue}var _r=e(vr);if(Tr.l&&Tr.l.Target){var Ar=Tr.l.Target;Ar=Ar.charAt(0)=="#"?"#"+csf_to_ods_3D(Ar.slice(1)):Ar,Ar.charAt(0)!="#"&&!Ar.match(/^\w+:/)&&(Ar="../"+Ar),_r=writextag("text:a",_r,{"xlink:href":Ar.replace(/&/g,"&amp;")})}sr.push("          "+writextag("table:table-cell",writextag("text:p",_r,{}),gr)+`
`)}sr.push(`        </table:table-row>
`)}return sr.push(`      </table:table>
`),sr.join("")},rr=function(nr,ir){nr.push(` <office:automatic-styles>
`),nr.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),nr.push(`   <number:month number:style="long"/>
`),nr.push(`   <number:text>/</number:text>
`),nr.push(`   <number:day number:style="long"/>
`),nr.push(`   <number:text>/</number:text>
`),nr.push(`   <number:year/>
`),nr.push(`  </number:date-style>
`);var ar=0;ir.SheetNames.map(function(or){return ir.Sheets[or]}).forEach(function(or){if(or&&or["!cols"]){for(var lr=0;lr<or["!cols"].length;++lr)if(or["!cols"][lr]){var ur=or["!cols"][lr];if(ur.width==null&&ur.wpx==null&&ur.wch==null)continue;process_col(ur),ur.ods=ar;var fr=or["!cols"][lr].wpx+"px";nr.push('  <style:style style:name="co'+ar+`" style:family="table-column">
`),nr.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+fr+`"/>
`),nr.push(`  </style:style>
`),++ar}}});var sr=0;ir.SheetNames.map(function(or){return ir.Sheets[or]}).forEach(function(or){if(or&&or["!rows"]){for(var lr=0;lr<or["!rows"].length;++lr)if(or["!rows"][lr]){or["!rows"][lr].ods=sr;var ur=or["!rows"][lr].hpx+"px";nr.push('  <style:style style:name="ro'+sr+`" style:family="table-row">
`),nr.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+ur+`"/>
`),nr.push(`  </style:style>
`),++sr}}}),nr.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),nr.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),nr.push(`  </style:style>
`),nr.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),nr.push(` </office:automatic-styles>
`)};return function(ir,ar){var sr=[XML_HEADER],or=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),lr=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});ar.bookType=="fods"?(sr.push("<office:document"+or+lr+`>
`),sr.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):sr.push("<office:document-content"+or+`>
`),rr(sr,ir),sr.push(`  <office:body>
`),sr.push(`    <office:spreadsheet>
`);for(var ur=0;ur!=ir.SheetNames.length;++ur)sr.push(tr(ir.Sheets[ir.SheetNames[ur]],ir,ur));return sr.push(`    </office:spreadsheet>
`),sr.push(`  </office:body>
`),ar.bookType=="fods"?sr.push("</office:document>"):sr.push("</office:document-content>"),sr.join("")}}();function write_ods(e,_e){if(_e.bookType=="fods")return write_content_ods(e,_e);var er=zip_new(),tr="",rr=[],nr=[];return tr="mimetype",zip_add_file(er,tr,"application/vnd.oasis.opendocument.spreadsheet"),tr="content.xml",zip_add_file(er,tr,write_content_ods(e,_e)),rr.push([tr,"text/xml"]),nr.push([tr,"ContentFile"]),tr="styles.xml",zip_add_file(er,tr,write_styles_ods(e,_e)),rr.push([tr,"text/xml"]),nr.push([tr,"StylesFile"]),tr="meta.xml",zip_add_file(er,tr,XML_HEADER+write_meta_ods()),rr.push([tr,"text/xml"]),nr.push([tr,"MetadataFile"]),tr="manifest.rdf",zip_add_file(er,tr,write_rdf(nr)),rr.push([tr,"application/rdf+xml"]),tr="META-INF/manifest.xml",zip_add_file(er,tr,write_manifest(rr)),er}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,_e){e:for(var er=0;er<=e.length-_e.length;++er){for(var tr=0;tr<_e.length;++tr)if(e[er+tr]!=_e[tr])continue e;return!0}return!1}function u8concat(e){var _e=e.reduce(function(rr,nr){return rr+nr.length},0),er=new Uint8Array(_e),tr=0;return e.forEach(function(rr){er.set(rr,tr),tr+=rr.length}),er}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,_e){for(var er=(e[_e+15]&127)<<7|e[_e+14]>>1,tr=e[_e+14]&1,rr=_e+13;rr>=_e;--rr)tr=tr*256+e[rr];return(e[_e+15]&128?-tr:tr)*Math.pow(10,er-6176)}function writeDecimal128LE(e,_e,er){var tr=Math.floor(er==0?0:Math.LOG10E*Math.log(Math.abs(er)))+6176-20,rr=er/Math.pow(10,tr-6176);e[_e+15]|=tr>>7,e[_e+14]|=(tr&127)<<1;for(var nr=0;rr>=1;++nr,rr/=256)e[_e+nr]=rr&255;e[_e+15]|=er>=0?0:128}function parse_varint49(e,_e){var er=_e?_e[0]:0,tr=e[er]&127;e:if(e[er++]>=128&&(tr|=(e[er]&127)<<7,e[er++]<128||(tr|=(e[er]&127)<<14,e[er++]<128)||(tr|=(e[er]&127)<<21,e[er++]<128)||(tr+=(e[er]&127)*Math.pow(2,28),++er,e[er++]<128)||(tr+=(e[er]&127)*Math.pow(2,35),++er,e[er++]<128)||(tr+=(e[er]&127)*Math.pow(2,42),++er,e[er++]<128)))break e;return _e&&(_e[0]=er),tr}function write_varint49(e){var _e=new Uint8Array(7);_e[0]=e&127;var er=1;e:if(e>127){if(_e[er-1]|=128,_e[er]=e>>7&127,++er,e<=16383||(_e[er-1]|=128,_e[er]=e>>14&127,++er,e<=2097151)||(_e[er-1]|=128,_e[er]=e>>21&127,++er,e<=268435455)||(_e[er-1]|=128,_e[er]=e/256>>>21&127,++er,e<=34359738367)||(_e[er-1]|=128,_e[er]=e/65536>>>21&127,++er,e<=4398046511103))break e;_e[er-1]|=128,_e[er]=e/16777216>>>21&127,++er}return _e.slice(0,er)}function varint_to_i32(e){var _e=0,er=e[_e]&127;e:if(e[_e++]>=128){if(er|=(e[_e]&127)<<7,e[_e++]<128||(er|=(e[_e]&127)<<14,e[_e++]<128)||(er|=(e[_e]&127)<<21,e[_e++]<128))break e;er|=(e[_e]&127)<<28}return er}function parse_shallow(e){for(var _e=[],er=[0];er[0]<e.length;){var tr=er[0],rr=parse_varint49(e,er),nr=rr&7;rr=Math.floor(rr/8);var ir=0,ar;if(rr==0)break;switch(nr){case 0:{for(var sr=er[0];e[er[0]++]>=128;);ar=e.slice(sr,er[0])}break;case 5:ir=4,ar=e.slice(er[0],er[0]+ir),er[0]+=ir;break;case 1:ir=8,ar=e.slice(er[0],er[0]+ir),er[0]+=ir;break;case 2:ir=parse_varint49(e,er),ar=e.slice(er[0],er[0]+ir),er[0]+=ir;break;case 3:case 4:default:throw new Error("PB Type ".concat(nr," for Field ").concat(rr," at offset ").concat(tr))}var or={data:ar,type:nr};_e[rr]==null?_e[rr]=[or]:_e[rr].push(or)}return _e}function write_shallow(e){var _e=[];return e.forEach(function(er,tr){er.forEach(function(rr){rr.data&&(_e.push(write_varint49(tr*8+rr.type)),rr.type==2&&_e.push(write_varint49(rr.data.length)),_e.push(rr.data))})}),u8concat(_e)}function mappa(e,_e){return(e==null?void 0:e.map(function(er){return _e(er.data)}))||[]}function parse_iwa_file(e){for(var _e,er=[],tr=[0];tr[0]<e.length;){var rr=parse_varint49(e,tr),nr=parse_shallow(e.slice(tr[0],tr[0]+rr));tr[0]+=rr;var ir={id:varint_to_i32(nr[1][0].data),messages:[]};nr[2].forEach(function(ar){var sr=parse_shallow(ar.data),or=varint_to_i32(sr[3][0].data);ir.messages.push({meta:sr,data:e.slice(tr[0],tr[0]+or)}),tr[0]+=or}),(_e=nr[3])!=null&&_e[0]&&(ir.merge=varint_to_i32(nr[3][0].data)>>>0>0),er.push(ir)}return er}function write_iwa_file(e){var _e=[];return e.forEach(function(er){var tr=[];tr[1]=[{data:write_varint49(er.id),type:0}],tr[2]=[],er.merge!=null&&(tr[3]=[{data:write_varint49(+!!er.merge),type:0}]);var rr=[];er.messages.forEach(function(ir){rr.push(ir.data),ir.meta[3]=[{type:0,data:write_varint49(ir.data.length)}],tr[2].push({data:write_shallow(ir.meta),type:2})});var nr=write_shallow(tr);_e.push(write_varint49(nr.length)),_e.push(nr),rr.forEach(function(ir){return _e.push(ir)})}),u8concat(_e)}function parse_snappy_chunk(e,_e){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var er=[0],tr=parse_varint49(_e,er),rr=[];er[0]<_e.length;){var nr=_e[er[0]]&3;if(nr==0){var ir=_e[er[0]++]>>2;if(ir<60)++ir;else{var ar=ir-59;ir=_e[er[0]],ar>1&&(ir|=_e[er[0]+1]<<8),ar>2&&(ir|=_e[er[0]+2]<<16),ar>3&&(ir|=_e[er[0]+3]<<24),ir>>>=0,ir++,er[0]+=ar}rr.push(_e.slice(er[0],er[0]+ir)),er[0]+=ir;continue}else{var sr=0,or=0;if(nr==1?(or=(_e[er[0]]>>2&7)+4,sr=(_e[er[0]++]&224)<<3,sr|=_e[er[0]++]):(or=(_e[er[0]++]>>2)+1,nr==2?(sr=_e[er[0]]|_e[er[0]+1]<<8,er[0]+=2):(sr=(_e[er[0]]|_e[er[0]+1]<<8|_e[er[0]+2]<<16|_e[er[0]+3]<<24)>>>0,er[0]+=4)),rr=[u8concat(rr)],sr==0)throw new Error("Invalid offset 0");if(sr>rr[0].length)throw new Error("Invalid offset beyond length");if(or>=sr)for(rr.push(rr[0].slice(-sr)),or-=sr;or>=rr[rr.length-1].length;)rr.push(rr[rr.length-1]),or-=rr[rr.length-1].length;rr.push(rr[0].slice(-sr,-sr+or))}}var lr=u8concat(rr);if(lr.length!=tr)throw new Error("Unexpected length: ".concat(lr.length," != ").concat(tr));return lr}function decompress_iwa_file(e){for(var _e=[],er=0;er<e.length;){var tr=e[er++],rr=e[er]|e[er+1]<<8|e[er+2]<<16;er+=3,_e.push(parse_snappy_chunk(tr,e.slice(er,er+rr))),er+=rr}if(er!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(_e)}function compress_iwa_file(e){for(var _e=[],er=0;er<e.length;){var tr=Math.min(e.length-er,268435455),rr=new Uint8Array(4);_e.push(rr);var nr=write_varint49(tr),ir=nr.length;_e.push(nr),tr<=60?(ir++,_e.push(new Uint8Array([tr-1<<2]))):tr<=256?(ir+=2,_e.push(new Uint8Array([240,tr-1&255]))):tr<=65536?(ir+=3,_e.push(new Uint8Array([244,tr-1&255,tr-1>>8&255]))):tr<=16777216?(ir+=4,_e.push(new Uint8Array([248,tr-1&255,tr-1>>8&255,tr-1>>16&255]))):tr<=4294967296&&(ir+=5,_e.push(new Uint8Array([252,tr-1&255,tr-1>>8&255,tr-1>>16&255,tr-1>>>24&255]))),_e.push(e.slice(er,er+tr)),ir+=tr,rr[0]=0,rr[1]=ir&255,rr[2]=ir>>8&255,rr[3]=ir>>16&255,er+=tr}return u8concat(_e)}function parse_old_storage(e,_e,er,tr){var rr=u8_to_dataview(e),nr=rr.getUint32(4,!0),ir=(tr>1?12:8)+popcnt(nr&(tr>1?3470:398))*4,ar=-1,sr=-1,or=NaN,lr=new Date(2001,0,1);nr&512&&(ar=rr.getUint32(ir,!0),ir+=4),ir+=popcnt(nr&(tr>1?12288:4096))*4,nr&16&&(sr=rr.getUint32(ir,!0),ir+=4),nr&32&&(or=rr.getFloat64(ir,!0),ir+=8),nr&64&&(lr.setTime(lr.getTime()+rr.getFloat64(ir,!0)*1e3),ir+=8);var ur;switch(e[2]){case 0:break;case 2:ur={t:"n",v:or};break;case 3:ur={t:"s",v:_e[sr]};break;case 5:ur={t:"d",v:lr};break;case 6:ur={t:"b",v:or>0};break;case 7:ur={t:"n",v:or/86400};break;case 8:ur={t:"e",v:0};break;case 9:if(ar>-1)ur={t:"s",v:er[ar]};else if(sr>-1)ur={t:"s",v:_e[sr]};else if(!isNaN(or))ur={t:"n",v:or};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return ur}function parse_new_storage(e,_e,er){var tr=u8_to_dataview(e),rr=tr.getUint32(8,!0),nr=12,ir=-1,ar=-1,sr=NaN,or=NaN,lr=new Date(2001,0,1);rr&1&&(sr=readDecimal128LE(e,nr),nr+=16),rr&2&&(or=tr.getFloat64(nr,!0),nr+=8),rr&4&&(lr.setTime(lr.getTime()+tr.getFloat64(nr,!0)*1e3),nr+=8),rr&8&&(ar=tr.getUint32(nr,!0),nr+=4),rr&16&&(ir=tr.getUint32(nr,!0),nr+=4);var ur;switch(e[1]){case 0:break;case 2:ur={t:"n",v:sr};break;case 3:ur={t:"s",v:_e[ar]};break;case 5:ur={t:"d",v:lr};break;case 6:ur={t:"b",v:or>0};break;case 7:ur={t:"n",v:or/86400};break;case 8:ur={t:"e",v:0};break;case 9:if(ir>-1)ur={t:"s",v:er[ir]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(rr&31," : ").concat(e.slice(0,4)));break;case 10:ur={t:"n",v:sr};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(rr&31," : ").concat(e.slice(0,4)))}return ur}function write_new_storage(e,_e){var er=new Uint8Array(32),tr=u8_to_dataview(er),rr=12,nr=0;switch(er[0]=5,e.t){case"n":er[1]=2,writeDecimal128LE(er,rr,e.v),nr|=1,rr+=16;break;case"b":er[1]=6,tr.setFloat64(rr,e.v?1:0,!0),nr|=2,rr+=8;break;case"s":if(_e.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));er[1]=3,tr.setUint32(rr,_e.indexOf(e.v),!0),nr|=8,rr+=4;break;default:throw"unsupported cell type "+e.t}return tr.setUint32(8,nr,!0),er.slice(0,rr)}function write_old_storage(e,_e){var er=new Uint8Array(32),tr=u8_to_dataview(er),rr=12,nr=0;switch(er[0]=3,e.t){case"n":er[2]=2,tr.setFloat64(rr,e.v,!0),nr|=32,rr+=8;break;case"b":er[2]=6,tr.setFloat64(rr,e.v?1:0,!0),nr|=32,rr+=8;break;case"s":if(_e.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));er[2]=3,tr.setUint32(rr,_e.indexOf(e.v),!0),nr|=16,rr+=4;break;default:throw"unsupported cell type "+e.t}return tr.setUint32(4,nr,!0),er.slice(0,rr)}function parse_cell_storage(e,_e,er){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,_e,er,e[0]);case 5:return parse_new_storage(e,_e,er);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var _e=parse_shallow(e);return parse_varint49(_e[1][0].data)}function parse_TST_TableDataList(e,_e){var er=parse_shallow(_e.data),tr=varint_to_i32(er[1][0].data),rr=er[3],nr=[];return(rr||[]).forEach(function(ir){var ar=parse_shallow(ir.data),sr=varint_to_i32(ar[1][0].data)>>>0;switch(tr){case 1:nr[sr]=u8str(ar[3][0].data);break;case 8:{var or=e[parse_TSP_Reference(ar[9][0].data)][0],lr=parse_shallow(or.data),ur=e[parse_TSP_Reference(lr[1][0].data)][0],fr=varint_to_i32(ur.meta[1][0].data);if(fr!=2001)throw new Error("2000 unexpected reference to ".concat(fr));var cr=parse_shallow(ur.data);nr[sr]=cr[3].map(function(mr){return u8str(mr.data)}).join("")}break}}),nr}function parse_TST_TileRowInfo(e,_e){var er,tr,rr,nr,ir,ar,sr,or,lr,ur,fr,cr,mr,dr,xr=parse_shallow(e),pr=varint_to_i32(xr[1][0].data)>>>0,gr=varint_to_i32(xr[2][0].data)>>>0,vr=((tr=(er=xr[8])==null?void 0:er[0])==null?void 0:tr.data)&&varint_to_i32(xr[8][0].data)>0||!1,Cr,Tr;if((nr=(rr=xr[7])==null?void 0:rr[0])!=null&&nr.data&&_e!=0)Cr=(ar=(ir=xr[7])==null?void 0:ir[0])==null?void 0:ar.data,Tr=(or=(sr=xr[6])==null?void 0:sr[0])==null?void 0:or.data;else if((ur=(lr=xr[4])==null?void 0:lr[0])!=null&&ur.data&&_e!=1)Cr=(cr=(fr=xr[4])==null?void 0:fr[0])==null?void 0:cr.data,Tr=(dr=(mr=xr[3])==null?void 0:mr[0])==null?void 0:dr.data;else throw"NUMBERS Tile missing ".concat(_e," cell storage");for(var Fr=vr?4:1,_r=u8_to_dataview(Cr),Ar=[],Pr=0;Pr<Cr.length/2;++Pr){var Ir=_r.getUint16(Pr*2,!0);Ir<65535&&Ar.push([Pr,Ir])}if(Ar.length!=gr)throw"Expected ".concat(gr," cells, found ").concat(Ar.length);var wr=[];for(Pr=0;Pr<Ar.length-1;++Pr)wr[Ar[Pr][0]]=Tr.subarray(Ar[Pr][1]*Fr,Ar[Pr+1][1]*Fr);return Ar.length>=1&&(wr[Ar[Ar.length-1][0]]=Tr.subarray(Ar[Ar.length-1][1]*Fr)),{R:pr,cells:wr}}function parse_TST_Tile(e,_e){var er,tr=parse_shallow(_e.data),rr=(er=tr==null?void 0:tr[7])!=null&&er[0]?varint_to_i32(tr[7][0].data)>>>0>0?1:0:-1,nr=mappa(tr[5],function(ir){return parse_TST_TileRowInfo(ir,rr)});return{nrows:varint_to_i32(tr[4][0].data)>>>0,data:nr.reduce(function(ir,ar){return ir[ar.R]||(ir[ar.R]=[]),ar.cells.forEach(function(sr,or){if(ir[ar.R][or])throw new Error("Duplicate cell r=".concat(ar.R," c=").concat(or));ir[ar.R][or]=sr}),ir},[])}}function parse_TST_TableModelArchive(e,_e,er){var tr,rr=parse_shallow(_e.data),nr={s:{r:0,c:0},e:{r:0,c:0}};if(nr.e.r=(varint_to_i32(rr[6][0].data)>>>0)-1,nr.e.r<0)throw new Error("Invalid row varint ".concat(rr[6][0].data));if(nr.e.c=(varint_to_i32(rr[7][0].data)>>>0)-1,nr.e.c<0)throw new Error("Invalid col varint ".concat(rr[7][0].data));er["!ref"]=encode_range(nr);var ir=parse_shallow(rr[4][0].data),ar=parse_TST_TableDataList(e,e[parse_TSP_Reference(ir[4][0].data)][0]),sr=(tr=ir[17])!=null&&tr[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(ir[17][0].data)][0]):[],or=parse_shallow(ir[3][0].data),lr=0;or[1].forEach(function(ur){var fr=parse_shallow(ur.data),cr=e[parse_TSP_Reference(fr[2][0].data)][0],mr=varint_to_i32(cr.meta[1][0].data);if(mr!=6002)throw new Error("6001 unexpected reference to ".concat(mr));var dr=parse_TST_Tile(e,cr);dr.data.forEach(function(xr,pr){xr.forEach(function(gr,vr){var Cr=encode_cell({r:lr+pr,c:vr}),Tr=parse_cell_storage(gr,ar,sr);Tr&&(er[Cr]=Tr)})}),lr+=dr.nrows})}function parse_TST_TableInfoArchive(e,_e){var er=parse_shallow(_e.data),tr={"!ref":"A1"},rr=e[parse_TSP_Reference(er[2][0].data)],nr=varint_to_i32(rr[0].meta[1][0].data);if(nr!=6001)throw new Error("6000 unexpected reference to ".concat(nr));return parse_TST_TableModelArchive(e,rr[0],tr),tr}function parse_TN_SheetArchive(e,_e){var er,tr=parse_shallow(_e.data),rr={name:(er=tr[1])!=null&&er[0]?u8str(tr[1][0].data):"",sheets:[]},nr=mappa(tr[2],parse_TSP_Reference);return nr.forEach(function(ir){e[ir].forEach(function(ar){var sr=varint_to_i32(ar.meta[1][0].data);sr==6e3&&rr.sheets.push(parse_TST_TableInfoArchive(e,ar))})}),rr}function parse_TN_DocumentArchive(e,_e){var er=book_new(),tr=parse_shallow(_e.data),rr=mappa(tr[1],parse_TSP_Reference);if(rr.forEach(function(nr){e[nr].forEach(function(ir){var ar=varint_to_i32(ir.meta[1][0].data);if(ar==2){var sr=parse_TN_SheetArchive(e,ir);sr.sheets.forEach(function(or,lr){book_append_sheet(er,or,lr==0?sr.name:sr.name+"_"+lr,!0)})}})}),er.SheetNames.length==0)throw new Error("Empty NUMBERS file");return er}function parse_numbers_iwa(e){var _e,er,tr,rr,nr={},ir=[];if(e.FullPaths.forEach(function(sr){if(sr.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(sr){if(sr.name.match(/\.iwa$/)){var or;try{or=decompress_iwa_file(sr.content)}catch(ur){return console.log("?? "+sr.content.length+" "+(ur.message||ur))}var lr;try{lr=parse_iwa_file(or)}catch(ur){return console.log("## "+(ur.message||ur))}lr.forEach(function(ur){nr[ur.id]=ur.messages,ir.push(ur.id)})}}),!ir.length)throw new Error("File has no messages");var ar=((rr=(tr=(er=(_e=nr==null?void 0:nr[1])==null?void 0:_e[0])==null?void 0:er.meta)==null?void 0:tr[1])==null?void 0:rr[0].data)&&varint_to_i32(nr[1][0].meta[1][0].data)==1&&nr[1][0];if(ar||ir.forEach(function(sr){nr[sr].forEach(function(or){var lr=varint_to_i32(or.meta[1][0].data)>>>0;if(lr==1)if(!ar)ar=or;else throw new Error("Document has multiple roots")})}),!ar)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(nr,ar)}function write_tile_row(e,_e,er){var tr,rr,nr,ir;if(!((tr=e[6])!=null&&tr[0])||!((rr=e[7])!=null&&rr[0]))throw"Mutation only works on post-BNC storages!";var ar=((ir=(nr=e[8])==null?void 0:nr[0])==null?void 0:ir.data)&&varint_to_i32(e[8][0].data)>0||!1;if(ar)throw"Math only works with normal offsets";for(var sr=0,or=u8_to_dataview(e[7][0].data),lr=0,ur=[],fr=u8_to_dataview(e[4][0].data),cr=0,mr=[],dr=0;dr<_e.length;++dr){if(_e[dr]==null){or.setUint16(dr*2,65535,!0),fr.setUint16(dr*2,65535);continue}or.setUint16(dr*2,lr,!0),fr.setUint16(dr*2,cr,!0);var xr,pr;switch(typeof _e[dr]){case"string":xr=write_new_storage({t:"s",v:_e[dr]},er),pr=write_old_storage({t:"s",v:_e[dr]},er);break;case"number":xr=write_new_storage({t:"n",v:_e[dr]},er),pr=write_old_storage({t:"n",v:_e[dr]},er);break;case"boolean":xr=write_new_storage({t:"b",v:_e[dr]},er),pr=write_old_storage({t:"b",v:_e[dr]},er);break;default:throw new Error("Unsupported value "+_e[dr])}ur.push(xr),lr+=xr.length,mr.push(pr),cr+=pr.length,++sr}for(e[2][0].data=write_varint49(sr);dr<e[7][0].data.length/2;++dr)or.setUint16(dr*2,65535,!0),fr.setUint16(dr*2,65535,!0);return e[6][0].data=u8concat(ur),e[3][0].data=u8concat(mr),sr}function write_numbers_iwa(e,_e){if(!_e||!_e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var er=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var tr=decode_range(er["!ref"]);tr.s.r=tr.s.c=0;var rr=!1;tr.e.c>9&&(rr=!0,tr.e.c=9),tr.e.r>49&&(rr=!0,tr.e.r=49),rr&&console.error("The Numbers writer is currently limited to ".concat(encode_range(tr)));var nr=sheet_to_json(er,{range:tr,header:1}),ir=["~Sh33tJ5~"];nr.forEach(function(br){return br.forEach(function(Er){typeof Er=="string"&&ir.push(Er)})});var ar={},sr=[],or=CFB.read(_e.numbers,{type:"base64"});or.FileIndex.map(function(br,Er){return[br,or.FullPaths[Er]]}).forEach(function(br){var Er=br[0],Lr=br[1];if(Er.type==2&&Er.name.match(/\.iwa/)){var Or=Er.content,Ur=decompress_iwa_file(Or),$r=parse_iwa_file(Ur);$r.forEach(function(Zr){sr.push(Zr.id),ar[Zr.id]={deps:[],location:Lr,type:varint_to_i32(Zr.messages[0].meta[1][0].data)}})}}),sr.sort(function(br,Er){return br-Er});var lr=sr.filter(function(br){return br>1}).map(function(br){return[br,write_varint49(br)]});or.FileIndex.map(function(br,Er){return[br,or.FullPaths[Er]]}).forEach(function(br){var Er=br[0];if(br[1],!!Er.name.match(/\.iwa/)){var Lr=parse_iwa_file(decompress_iwa_file(Er.content));Lr.forEach(function(Or){Or.messages.forEach(function(Ur){lr.forEach(function($r){Or.messages.some(function(Zr){return varint_to_i32(Zr.meta[1][0].data)!=11006&&u8contains(Zr.data,$r[1])})&&ar[$r[0]].deps.push(Or.id)})})})}});for(var ur=CFB.find(or,ar[1].location),fr=parse_iwa_file(decompress_iwa_file(ur.content)),cr,mr=0;mr<fr.length;++mr){var dr=fr[mr];dr.id==1&&(cr=dr)}var xr=parse_TSP_Reference(parse_shallow(cr.messages[0].data)[1][0].data);for(ur=CFB.find(or,ar[xr].location),fr=parse_iwa_file(decompress_iwa_file(ur.content)),mr=0;mr<fr.length;++mr)dr=fr[mr],dr.id==xr&&(cr=dr);for(xr=parse_TSP_Reference(parse_shallow(cr.messages[0].data)[2][0].data),ur=CFB.find(or,ar[xr].location),fr=parse_iwa_file(decompress_iwa_file(ur.content)),mr=0;mr<fr.length;++mr)dr=fr[mr],dr.id==xr&&(cr=dr);for(xr=parse_TSP_Reference(parse_shallow(cr.messages[0].data)[2][0].data),ur=CFB.find(or,ar[xr].location),fr=parse_iwa_file(decompress_iwa_file(ur.content)),mr=0;mr<fr.length;++mr)dr=fr[mr],dr.id==xr&&(cr=dr);var pr=parse_shallow(cr.messages[0].data);{pr[6][0].data=write_varint49(tr.e.r+1),pr[7][0].data=write_varint49(tr.e.c+1);var gr=parse_TSP_Reference(pr[46][0].data),vr=CFB.find(or,ar[gr].location),Cr=parse_iwa_file(decompress_iwa_file(vr.content));{for(var Tr=0;Tr<Cr.length&&Cr[Tr].id!=gr;++Tr);if(Cr[Tr].id!=gr)throw"Bad ColumnRowUIDMapArchive";var Fr=parse_shallow(Cr[Tr].messages[0].data);Fr[1]=[],Fr[2]=[],Fr[3]=[];for(var _r=0;_r<=tr.e.c;++_r){var Ar=[];Ar[1]=Ar[2]=[{type:0,data:write_varint49(_r+420690)}],Fr[1].push({type:2,data:write_shallow(Ar)}),Fr[2].push({type:0,data:write_varint49(_r)}),Fr[3].push({type:0,data:write_varint49(_r)})}Fr[4]=[],Fr[5]=[],Fr[6]=[];for(var Pr=0;Pr<=tr.e.r;++Pr)Ar=[],Ar[1]=Ar[2]=[{type:0,data:write_varint49(Pr+726270)}],Fr[4].push({type:2,data:write_shallow(Ar)}),Fr[5].push({type:0,data:write_varint49(Pr)}),Fr[6].push({type:0,data:write_varint49(Pr)});Cr[Tr].messages[0].data=write_shallow(Fr)}vr.content=compress_iwa_file(write_iwa_file(Cr)),vr.size=vr.content.length,delete pr[46];var Ir=parse_shallow(pr[4][0].data);{Ir[7][0].data=write_varint49(tr.e.r+1);var wr=parse_shallow(Ir[1][0].data),kr=parse_TSP_Reference(wr[2][0].data);vr=CFB.find(or,ar[kr].location),Cr=parse_iwa_file(decompress_iwa_file(vr.content));{if(Cr[0].id!=kr)throw"Bad HeaderStorageBucket";var Mr=parse_shallow(Cr[0].messages[0].data);for(Pr=0;Pr<nr.length;++Pr){var Hr=parse_shallow(Mr[2][0].data);Hr[1][0].data=write_varint49(Pr),Hr[4][0].data=write_varint49(nr[Pr].length),Mr[2][Pr]={type:Mr[2][0].type,data:write_shallow(Hr)}}Cr[0].messages[0].data=write_shallow(Mr)}vr.content=compress_iwa_file(write_iwa_file(Cr)),vr.size=vr.content.length;var Gr=parse_TSP_Reference(Ir[2][0].data);vr=CFB.find(or,ar[Gr].location),Cr=parse_iwa_file(decompress_iwa_file(vr.content));{if(Cr[0].id!=Gr)throw"Bad HeaderStorageBucket";for(Mr=parse_shallow(Cr[0].messages[0].data),_r=0;_r<=tr.e.c;++_r)Hr=parse_shallow(Mr[2][0].data),Hr[1][0].data=write_varint49(_r),Hr[4][0].data=write_varint49(tr.e.r+1),Mr[2][_r]={type:Mr[2][0].type,data:write_shallow(Hr)};Cr[0].messages[0].data=write_shallow(Mr)}vr.content=compress_iwa_file(write_iwa_file(Cr)),vr.size=vr.content.length;var zr=parse_TSP_Reference(Ir[4][0].data);(function(){for(var br=CFB.find(or,ar[zr].location),Er=parse_iwa_file(decompress_iwa_file(br.content)),Lr,Or=0;Or<Er.length;++Or){var Ur=Er[Or];Ur.id==zr&&(Lr=Ur)}var $r=parse_shallow(Lr.messages[0].data);{$r[3]=[];var Zr=[];ir.forEach(function(Kr,Cn){Zr[1]=[{type:0,data:write_varint49(Cn)}],Zr[2]=[{type:0,data:write_varint49(1)}],Zr[3]=[{type:2,data:stru8(Kr)}],$r[3].push({type:2,data:write_shallow(Zr)})})}Lr.messages[0].data=write_shallow($r);var fn=write_iwa_file(Er),_n=compress_iwa_file(fn);br.content=_n,br.size=br.content.length})();var Br=parse_shallow(Ir[3][0].data);{var Vr=Br[1][0];delete Br[2];var Rr=parse_shallow(Vr.data);{var Xr=parse_TSP_Reference(Rr[2][0].data);(function(){for(var br=CFB.find(or,ar[Xr].location),Er=parse_iwa_file(decompress_iwa_file(br.content)),Lr,Or=0;Or<Er.length;++Or){var Ur=Er[Or];Ur.id==Xr&&(Lr=Ur)}var $r=parse_shallow(Lr.messages[0].data);{delete $r[6],delete Br[7];var Zr=new Uint8Array($r[5][0].data);$r[5]=[];for(var fn=0,_n=0;_n<=tr.e.r;++_n){var Kr=parse_shallow(Zr);fn+=write_tile_row(Kr,nr[_n],ir),Kr[1][0].data=write_varint49(_n),$r[5].push({data:write_shallow(Kr),type:2})}$r[1]=[{type:0,data:write_varint49(tr.e.c+1)}],$r[2]=[{type:0,data:write_varint49(tr.e.r+1)}],$r[3]=[{type:0,data:write_varint49(fn)}],$r[4]=[{type:0,data:write_varint49(tr.e.r+1)}]}Lr.messages[0].data=write_shallow($r);var Cn=write_iwa_file(Er),Dn=compress_iwa_file(Cn);br.content=Dn,br.size=br.content.length})()}Vr.data=write_shallow(Rr)}Ir[3][0].data=write_shallow(Br)}pr[4][0].data=write_shallow(Ir)}cr.messages[0].data=write_shallow(pr);var an=write_iwa_file(fr),yr=compress_iwa_file(an);return ur.content=yr,ur.size=ur.content.length,or}function fix_opts_func(e){return function(er){for(var tr=0;tr!=e.length;++tr){var rr=e[tr];er[rr[0]]===void 0&&(er[rr[0]]=rr[1]),rr[2]==="n"&&(er[rr[0]]=Number(er[rr[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,_e){if(!e)return 0;try{e=_e.map(function(tr){return tr.id||(tr.id=tr.strRelID),[tr.name,e["!id"][tr.id].Target,get_sheet_type(e["!id"][tr.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,_e,er,tr,rr,nr,ir,ar,sr,or,lr,ur){try{nr[tr]=parse_rels(getzipstr(e,er,!0),_e);var fr=getzipdata(e,_e),cr;switch(ar){case"sheet":cr=parse_ws(fr,_e,rr,sr,nr[tr],or,lr,ur);break;case"chart":if(cr=parse_cs(fr,_e,rr,sr,nr[tr],or,lr,ur),!cr||!cr["!drawel"])break;var mr=resolve_path(cr["!drawel"].Target,_e),dr=get_rels_path(mr),xr=parse_drawing(getzipstr(e,mr,!0),parse_rels(getzipstr(e,dr,!0),mr)),pr=resolve_path(xr,mr),gr=get_rels_path(pr);cr=parse_chart(getzipstr(e,pr,!0),pr,sr,parse_rels(getzipstr(e,gr,!0),pr),or,cr);break;case"macro":cr=parse_ms(fr,_e,rr,sr,nr[tr],or,lr,ur);break;case"dialog":cr=parse_ds(fr,_e,rr,sr,nr[tr],or,lr,ur);break;default:throw new Error("Unrecognized sheet type "+ar)}ir[tr]=cr;var vr=[];nr&&nr[tr]&&keys(nr[tr]).forEach(function(Cr){var Tr="";if(nr[tr][Cr].Type==RELS.CMNT){Tr=resolve_path(nr[tr][Cr].Target,_e);var Fr=parse_cmnt(getzipdata(e,Tr,!0),Tr,sr);if(!Fr||!Fr.length)return;sheet_insert_comments(cr,Fr,!1)}nr[tr][Cr].Type==RELS.TCMNT&&(Tr=resolve_path(nr[tr][Cr].Target,_e),vr=vr.concat(parse_tcmnt_xml(getzipdata(e,Tr,!0),sr)))}),vr&&vr.length&&sheet_insert_comments(cr,vr,!0,sr.people||[])}catch(Cr){if(sr.WTF)throw Cr}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,_e){if(make_ssf(),_e=_e||{},fix_read_opts(_e),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,_e);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var er=CFB.utils.cfb_new();return zipentries(e).forEach(function(Hr){zip_add_file(er,Hr,getzipbin(e,Hr))}),parse_numbers_iwa(er)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var tr=zipentries(e),rr=parse_ct(getzipstr(e,"[Content_Types].xml")),nr=!1,ir,ar;if(rr.workbooks.length===0&&(ar="xl/workbook.xml",getzipdata(e,ar,!0)&&rr.workbooks.push(ar)),rr.workbooks.length===0){if(ar="xl/workbook.bin",!getzipdata(e,ar,!0))throw new Error("Could not find workbook");rr.workbooks.push(ar),nr=!0}rr.workbooks[0].slice(-3)=="bin"&&(nr=!0);var sr={},or={};if(!_e.bookSheets&&!_e.bookProps){if(strs=[],rr.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(rr.sst)),rr.sst,_e)}catch(Hr){if(_e.WTF)throw Hr}_e.cellStyles&&rr.themes.length&&(sr=parse_theme(getzipstr(e,rr.themes[0].replace(/^\//,""),!0)||"",rr.themes[0],_e)),rr.style&&(or=parse_sty(getzipdata(e,strip_front_slash(rr.style)),rr.style,sr,_e))}rr.links.map(function(Hr){try{var Gr=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(Hr))),Hr);return parse_xlink(getzipdata(e,strip_front_slash(Hr)),Gr,Hr,_e)}catch{}});var lr=parse_wb(getzipdata(e,strip_front_slash(rr.workbooks[0])),rr.workbooks[0],_e),ur={},fr="";rr.coreprops.length&&(fr=getzipdata(e,strip_front_slash(rr.coreprops[0]),!0),fr&&(ur=parse_core_props(fr)),rr.extprops.length!==0&&(fr=getzipdata(e,strip_front_slash(rr.extprops[0]),!0),fr&&parse_ext_props(fr,ur,_e)));var cr={};(!_e.bookSheets||_e.bookProps)&&rr.custprops.length!==0&&(fr=getzipstr(e,strip_front_slash(rr.custprops[0]),!0),fr&&(cr=parse_cust_props(fr,_e)));var mr={};if((_e.bookSheets||_e.bookProps)&&(lr.Sheets?ir=lr.Sheets.map(function(Gr){return Gr.name}):ur.Worksheets&&ur.SheetNames.length>0&&(ir=ur.SheetNames),_e.bookProps&&(mr.Props=ur,mr.Custprops=cr),_e.bookSheets&&typeof ir<"u"&&(mr.SheetNames=ir),_e.bookSheets?mr.SheetNames:_e.bookProps))return mr;ir={};var dr={};_e.bookDeps&&rr.calcchain&&(dr=parse_cc(getzipdata(e,strip_front_slash(rr.calcchain)),rr.calcchain));var xr=0,pr={},gr,vr;{var Cr=lr.Sheets;ur.Worksheets=Cr.length,ur.SheetNames=[];for(var Tr=0;Tr!=Cr.length;++Tr)ur.SheetNames[Tr]=Cr[Tr].name}var Fr=nr?"bin":"xml",_r=rr.workbooks[0].lastIndexOf("/"),Ar=(rr.workbooks[0].slice(0,_r+1)+"_rels/"+rr.workbooks[0].slice(_r+1)+".rels").replace(/^\//,"");safegetzipfile(e,Ar)||(Ar="xl/_rels/workbook."+Fr+".rels");var Pr=parse_rels(getzipstr(e,Ar,!0),Ar.replace(/_rels.*/,"s5s"));(rr.metadata||[]).length>=1&&(_e.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(rr.metadata[0])),rr.metadata[0],_e)),(rr.people||[]).length>=1&&(_e.people=parse_people_xml(getzipdata(e,strip_front_slash(rr.people[0])),_e)),Pr&&(Pr=safe_parse_wbrels(Pr,lr.Sheets));var Ir=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(xr=0;xr!=ur.Worksheets;++xr){var wr="sheet";if(Pr&&Pr[xr]?(gr="xl/"+Pr[xr][1].replace(/[\/]?xl\//,""),safegetzipfile(e,gr)||(gr=Pr[xr][1]),safegetzipfile(e,gr)||(gr=Ar.replace(/_rels\/.*$/,"")+Pr[xr][1]),wr=Pr[xr][2]):(gr="xl/worksheets/sheet"+(xr+1-Ir)+"."+Fr,gr=gr.replace(/sheet0\./,"sheet.")),vr=gr.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),_e&&_e.sheets!=null)switch(typeof _e.sheets){case"number":if(xr!=_e.sheets)continue e;break;case"string":if(ur.SheetNames[xr].toLowerCase()!=_e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(_e.sheets)){for(var kr=!1,Mr=0;Mr!=_e.sheets.length;++Mr)typeof _e.sheets[Mr]=="number"&&_e.sheets[Mr]==xr&&(kr=1),typeof _e.sheets[Mr]=="string"&&_e.sheets[Mr].toLowerCase()==ur.SheetNames[xr].toLowerCase()&&(kr=1);if(!kr)continue e}}safe_parse_sheet(e,gr,vr,ur.SheetNames[xr],xr,pr,ir,wr,_e,lr,sr,or)}return mr={Directory:rr,Workbook:lr,Props:ur,Custprops:cr,Deps:dr,Sheets:ir,SheetNames:ur.SheetNames,Strings:strs,Styles:or,Themes:sr,SSF:dup(table_fmt)},_e&&_e.bookFiles&&(e.files?(mr.keys=tr,mr.files=e.files):(mr.keys=[],mr.files={},e.FullPaths.forEach(function(Hr,Gr){Hr=Hr.replace(/^Root Entry[\/]/,""),mr.keys.push(Hr),mr.files[Hr]=e.FileIndex[Gr]}))),_e&&_e.bookVBA&&(rr.vba.length>0?mr.vbaraw=getzipdata(e,strip_front_slash(rr.vba[0]),!0):rr.defaults&&rr.defaults.bin===CT_VBA&&(mr.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),mr}function parse_xlsxcfb(e,_e){var er=_e||{},tr="Workbook",rr=CFB.find(e,tr);try{if(tr="/!DataSpaces/Version",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);if(parse_DataSpaceVersionInfo(rr.content),tr="/!DataSpaces/DataSpaceMap",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);var nr=parse_DataSpaceMap(rr.content);if(nr.length!==1||nr[0].comps.length!==1||nr[0].comps[0].t!==0||nr[0].name!=="StrongEncryptionDataSpace"||nr[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+tr);if(tr="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);var ir=parse_DataSpaceDefinition(rr.content);if(ir.length!=1||ir[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+tr);if(tr="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);parse_Primary(rr.content)}catch{}if(tr="/EncryptionInfo",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);var ar=parse_EncryptionInfo(rr.content);if(tr="/EncryptedPackage",rr=CFB.find(e,tr),!rr||!rr.content)throw new Error("ECMA-376 Encrypted file missing "+tr);if(ar[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(ar[1],rr.content,er.password||"",er);if(ar[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(ar[1],rr.content,er.password||"",er);throw new Error("File is password-protected")}function write_zip(e,_e){return _e.bookType=="ods"?write_ods(e,_e):_e.bookType=="numbers"?write_numbers_iwa(e,_e):_e.bookType=="xlsb"?write_zip_xlsxb(e,_e):write_zip_xlsx(e,_e)}function write_zip_xlsxb(e,_e){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),_e.revssf=evert_num(e.SSF),_e.revssf[e.SSF[65535]]=0,_e.ssf=e.SSF),_e.rels={},_e.wbrels={},_e.Strings=[],_e.Strings.Count=0,_e.Strings.Unique=0,browser_has_Map?_e.revStrings=new Map:(_e.revStrings={},_e.revStrings.foo=[],delete _e.revStrings.foo);var er=_e.bookType=="xlsb"?"bin":"xml",tr=VBAFMTS.indexOf(_e.bookType)>-1,rr=new_ct();fix_write_opts(_e=_e||{});var nr=zip_new(),ir="",ar=0;if(_e.cellXfs=[],get_cell_style(_e.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ir="docProps/core.xml",zip_add_file(nr,ir,write_core_props(e.Props,_e)),rr.coreprops.push(ir),add_rels(_e.rels,2,ir,RELS.CORE_PROPS),ir="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var sr=[],or=0;or<e.SheetNames.length;++or)(e.Workbook.Sheets[or]||{}).Hidden!=2&&sr.push(e.SheetNames[or]);e.Props.SheetNames=sr}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(nr,ir,write_ext_props(e.Props)),rr.extprops.push(ir),add_rels(_e.rels,3,ir,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(ir="docProps/custom.xml",zip_add_file(nr,ir,write_cust_props(e.Custprops)),rr.custprops.push(ir),add_rels(_e.rels,4,ir,RELS.CUST_PROPS)),ar=1;ar<=e.SheetNames.length;++ar){var lr={"!id":{}},ur=e.Sheets[e.SheetNames[ar-1]],fr=(ur||{})["!type"]||"sheet";switch(fr){case"chart":default:ir="xl/worksheets/sheet"+ar+"."+er,zip_add_file(nr,ir,write_ws(ar-1,ir,_e,e,lr)),rr.sheets.push(ir),add_rels(_e.wbrels,-1,"worksheets/sheet"+ar+"."+er,RELS.WS[0])}if(ur){var cr=ur["!comments"],mr=!1,dr="";cr&&cr.length>0&&(dr="xl/comments"+ar+"."+er,zip_add_file(nr,dr,write_cmnt(cr,dr)),rr.comments.push(dr),add_rels(lr,-1,"../comments"+ar+"."+er,RELS.CMNT),mr=!0),ur["!legacy"]&&mr&&zip_add_file(nr,"xl/drawings/vmlDrawing"+ar+".vml",write_comments_vml(ar,ur["!comments"])),delete ur["!comments"],delete ur["!legacy"]}lr["!id"].rId1&&zip_add_file(nr,get_rels_path(ir),write_rels(lr))}return _e.Strings!=null&&_e.Strings.length>0&&(ir="xl/sharedStrings."+er,zip_add_file(nr,ir,write_sst(_e.Strings,ir,_e)),rr.strs.push(ir),add_rels(_e.wbrels,-1,"sharedStrings."+er,RELS.SST)),ir="xl/workbook."+er,zip_add_file(nr,ir,write_wb(e,ir)),rr.workbooks.push(ir),add_rels(_e.rels,1,ir,RELS.WB),ir="xl/theme/theme1.xml",zip_add_file(nr,ir,write_theme(e.Themes,_e)),rr.themes.push(ir),add_rels(_e.wbrels,-1,"theme/theme1.xml",RELS.THEME),ir="xl/styles."+er,zip_add_file(nr,ir,write_sty(e,ir,_e)),rr.styles.push(ir),add_rels(_e.wbrels,-1,"styles."+er,RELS.STY),e.vbaraw&&tr&&(ir="xl/vbaProject.bin",zip_add_file(nr,ir,e.vbaraw),rr.vba.push(ir),add_rels(_e.wbrels,-1,"vbaProject.bin",RELS.VBA)),ir="xl/metadata."+er,zip_add_file(nr,ir,write_xlmeta(ir)),rr.metadata.push(ir),add_rels(_e.wbrels,-1,"metadata."+er,RELS.XLMETA),zip_add_file(nr,"[Content_Types].xml",write_ct(rr,_e)),zip_add_file(nr,"_rels/.rels",write_rels(_e.rels)),zip_add_file(nr,"xl/_rels/workbook."+er+".rels",write_rels(_e.wbrels)),delete _e.revssf,delete _e.ssf,nr}function write_zip_xlsx(e,_e){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),_e.revssf=evert_num(e.SSF),_e.revssf[e.SSF[65535]]=0,_e.ssf=e.SSF),_e.rels={},_e.wbrels={},_e.Strings=[],_e.Strings.Count=0,_e.Strings.Unique=0,browser_has_Map?_e.revStrings=new Map:(_e.revStrings={},_e.revStrings.foo=[],delete _e.revStrings.foo);var er="xml",tr=VBAFMTS.indexOf(_e.bookType)>-1,rr=new_ct();fix_write_opts(_e=_e||{});var nr=zip_new(),ir="",ar=0;if(_e.cellXfs=[],get_cell_style(_e.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ir="docProps/core.xml",zip_add_file(nr,ir,write_core_props(e.Props,_e)),rr.coreprops.push(ir),add_rels(_e.rels,2,ir,RELS.CORE_PROPS),ir="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var sr=[],or=0;or<e.SheetNames.length;++or)(e.Workbook.Sheets[or]||{}).Hidden!=2&&sr.push(e.SheetNames[or]);e.Props.SheetNames=sr}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(nr,ir,write_ext_props(e.Props)),rr.extprops.push(ir),add_rels(_e.rels,3,ir,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(ir="docProps/custom.xml",zip_add_file(nr,ir,write_cust_props(e.Custprops)),rr.custprops.push(ir),add_rels(_e.rels,4,ir,RELS.CUST_PROPS));var lr=["SheetJ5"];for(_e.tcid=0,ar=1;ar<=e.SheetNames.length;++ar){var ur={"!id":{}},fr=e.Sheets[e.SheetNames[ar-1]],cr=(fr||{})["!type"]||"sheet";switch(cr){case"chart":default:ir="xl/worksheets/sheet"+ar+"."+er,zip_add_file(nr,ir,write_ws_xml(ar-1,_e,e,ur)),rr.sheets.push(ir),add_rels(_e.wbrels,-1,"worksheets/sheet"+ar+"."+er,RELS.WS[0])}if(fr){var mr=fr["!comments"],dr=!1,xr="";if(mr&&mr.length>0){var pr=!1;mr.forEach(function(gr){gr[1].forEach(function(vr){vr.T==!0&&(pr=!0)})}),pr&&(xr="xl/threadedComments/threadedComment"+ar+"."+er,zip_add_file(nr,xr,write_tcmnt_xml(mr,lr,_e)),rr.threadedcomments.push(xr),add_rels(ur,-1,"../threadedComments/threadedComment"+ar+"."+er,RELS.TCMNT)),xr="xl/comments"+ar+"."+er,zip_add_file(nr,xr,write_comments_xml(mr)),rr.comments.push(xr),add_rels(ur,-1,"../comments"+ar+"."+er,RELS.CMNT),dr=!0}fr["!legacy"]&&dr&&zip_add_file(nr,"xl/drawings/vmlDrawing"+ar+".vml",write_comments_vml(ar,fr["!comments"])),delete fr["!comments"],delete fr["!legacy"]}ur["!id"].rId1&&zip_add_file(nr,get_rels_path(ir),write_rels(ur))}return _e.Strings!=null&&_e.Strings.length>0&&(ir="xl/sharedStrings."+er,zip_add_file(nr,ir,write_sst_xml(_e.Strings,_e)),rr.strs.push(ir),add_rels(_e.wbrels,-1,"sharedStrings."+er,RELS.SST)),ir="xl/workbook."+er,zip_add_file(nr,ir,write_wb_xml(e)),rr.workbooks.push(ir),add_rels(_e.rels,1,ir,RELS.WB),ir="xl/theme/theme1.xml",zip_add_file(nr,ir,write_theme(e.Themes,_e)),rr.themes.push(ir),add_rels(_e.wbrels,-1,"theme/theme1.xml",RELS.THEME),ir="xl/styles."+er,zip_add_file(nr,ir,write_sty_xml(e,_e)),rr.styles.push(ir),add_rels(_e.wbrels,-1,"styles."+er,RELS.STY),e.vbaraw&&tr&&(ir="xl/vbaProject.bin",zip_add_file(nr,ir,e.vbaraw),rr.vba.push(ir),add_rels(_e.wbrels,-1,"vbaProject.bin",RELS.VBA)),ir="xl/metadata."+er,zip_add_file(nr,ir,write_xlmeta_xml()),rr.metadata.push(ir),add_rels(_e.wbrels,-1,"metadata."+er,RELS.XLMETA),lr.length>1&&(ir="xl/persons/person.xml",zip_add_file(nr,ir,write_people_xml(lr)),rr.people.push(ir),add_rels(_e.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(nr,"[Content_Types].xml",write_ct(rr,_e)),zip_add_file(nr,"_rels/.rels",write_rels(_e.rels)),zip_add_file(nr,"xl/_rels/workbook."+er+".rels",write_rels(_e.wbrels)),delete _e.revssf,delete _e.ssf,nr}function firstbyte(e,_e){var er="";switch((_e||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":er=Base64_decode(e.slice(0,12));break;case"binary":er=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(_e&&_e.type||"undefined"))}return[er.charCodeAt(0),er.charCodeAt(1),er.charCodeAt(2),er.charCodeAt(3),er.charCodeAt(4),er.charCodeAt(5),er.charCodeAt(6),er.charCodeAt(7)]}function read_cfb(e,_e){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,_e):parse_xlscfb(e,_e)}function read_zip(e,_e){var er,tr=e,rr=_e||{};return rr.type||(rr.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),er=zip_read(tr,rr),parse_zip(er,rr)}function read_plaintext(e,_e){var er=0;e:for(;er<e.length;)switch(e.charCodeAt(er)){case 10:case 13:case 32:++er;break;case 60:return parse_xlml(e.slice(er),_e);default:break e}return PRN.to_workbook(e,_e)}function read_plaintext_raw(e,_e){var er="",tr=firstbyte(e,_e);switch(_e.type){case"base64":er=Base64_decode(e);break;case"binary":er=e;break;case"buffer":er=e.toString("binary");break;case"array":er=cc2str(e);break;default:throw new Error("Unrecognized type "+_e.type)}return tr[0]==239&&tr[1]==187&&tr[2]==191&&(er=utf8read(er)),_e.type="binary",read_plaintext(er,_e)}function read_utf16(e,_e){var er=e;return _e.type=="base64"&&(er=Base64_decode(er)),er=$cptable.utils.decode(1200,er.slice(2),"str"),_e.type="binary",read_plaintext(er,_e)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,_e,er,tr){return tr?(er.type="string",PRN.to_workbook(e,er)):PRN.to_workbook(_e,er)}function readSync(e,_e){reset_cp();var er=_e||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(er=dup(er),er.type="array",er));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!er.type&&(er.type=typeof Deno<"u"?"buffer":"array");var tr=e,rr=[0,0,0,0],nr=!1;if(er.cellStyles&&(er.cellNF=!0,er.sheetStubs=!0),_ssfopts={},er.dateNF&&(_ssfopts.dateNF=er.dateNF),er.type||(er.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),er.type=="file"&&(er.type=has_buf?"buffer":"binary",tr=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(er.type="array")),er.type=="string"&&(nr=!0,er.type="binary",er.codepage=65001,tr=bstrify(e)),er.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var ir=new ArrayBuffer(3),ar=new Uint8Array(ir);if(ar.foo="bar",!ar.foo)return er=dup(er),er.type="array",readSync(ab2a(tr),er)}switch((rr=firstbyte(tr,er))[0]){case 208:if(rr[1]===207&&rr[2]===17&&rr[3]===224&&rr[4]===161&&rr[5]===177&&rr[6]===26&&rr[7]===225)return read_cfb(CFB.read(tr,er),er);break;case 9:if(rr[1]<=8)return parse_xlscfb(tr,er);break;case 60:return parse_xlml(tr,er);case 73:if(rr[1]===73&&rr[2]===42&&rr[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(rr[1]===68)return read_wb_ID(tr,er);break;case 84:if(rr[1]===65&&rr[2]===66&&rr[3]===76)return DIF.to_workbook(tr,er);break;case 80:return rr[1]===75&&rr[2]<9&&rr[3]<9?read_zip(tr,er):read_prn(e,tr,er,nr);case 239:return rr[3]===60?parse_xlml(tr,er):read_prn(e,tr,er,nr);case 255:if(rr[1]===254)return read_utf16(tr,er);if(rr[1]===0&&rr[2]===2&&rr[3]===0)return WK_.to_workbook(tr,er);break;case 0:if(rr[1]===0&&(rr[2]>=2&&rr[3]===0||rr[2]===0&&(rr[3]===8||rr[3]===9)))return WK_.to_workbook(tr,er);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(tr,er);case 123:if(rr[1]===92&&rr[2]===114&&rr[3]===116)return RTF.to_workbook(tr,er);break;case 10:case 13:case 32:return read_plaintext_raw(tr,er);case 137:if(rr[1]===80&&rr[2]===78&&rr[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(rr[0])>-1&&rr[2]<=12&&rr[3]<=31?DBF.to_workbook(tr,er):read_prn(e,tr,er,nr)}function write_cfb_ctr(e,_e){switch(_e.type){case"base64":case"binary":break;case"buffer":case"array":_e.type="";break;case"file":return write_dl(_e.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+_e.bookType+"' files");default:throw new Error("Unrecognized type "+_e.type)}return CFB.write(e,_e)}function write_zip_type(e,_e){var er=dup(_e||{}),tr=write_zip(e,er);return write_zip_denouement(tr,er)}function write_zip_denouement(e,_e){var er={},tr=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(_e.compression&&(er.compression="DEFLATE"),_e.password)er.type=tr;else switch(_e.type){case"base64":er.type="base64";break;case"binary":er.type="string";break;case"string":throw new Error("'string' output type invalid for '"+_e.bookType+"' files");case"buffer":case"file":er.type=tr;break;default:throw new Error("Unrecognized type "+_e.type)}var rr=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[er.type]||er.type,compression:!!_e.compression}):e.generate(er);if(typeof Deno<"u"&&typeof rr=="string"){if(_e.type=="binary"||_e.type=="base64")return rr;rr=new Uint8Array(s2ab(rr))}return _e.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(rr,_e.password),_e):_e.type==="file"?write_dl(_e.file,rr):_e.type=="string"?utf8read(rr):rr}function write_cfb_type(e,_e){var er=_e||{},tr=write_xlscfb(e,er);return write_cfb_ctr(tr,er)}function write_string_type(e,_e,er){er||(er="");var tr=er+e;switch(_e.type){case"base64":return Base64_encode(utf8write(tr));case"binary":return utf8write(tr);case"string":return e;case"file":return write_dl(_e.file,tr,"utf8");case"buffer":return has_buf?Buffer_from(tr,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(tr):write_string_type(tr,{type:"binary"}).split("").map(function(rr){return rr.charCodeAt(0)})}throw new Error("Unrecognized type "+_e.type)}function write_stxt_type(e,_e){switch(_e.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(_e.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(er){return er.charCodeAt(0)})}throw new Error("Unrecognized type "+_e.type)}function write_binary_type(e,_e){switch(_e.type){case"string":case"base64":case"binary":for(var er="",tr=0;tr<e.length;++tr)er+=String.fromCharCode(e[tr]);return _e.type=="base64"?Base64_encode(er):_e.type=="string"?utf8read(er):er;case"file":return write_dl(_e.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+_e.type)}}function writeSync(e,_e){reset_cp(),check_wb(e);var er=dup(_e||{});if(er.cellStyles&&(er.cellNF=!0,er.sheetStubs=!0),er.type=="array"){er.type="binary";var tr=writeSync(e,er);return er.type="array",s2ab(tr)}var rr=0;if(er.sheet&&(typeof er.sheet=="number"?rr=er.sheet:rr=e.SheetNames.indexOf(er.sheet),!e.SheetNames[rr]))throw new Error("Sheet not found: "+er.sheet+" : "+typeof er.sheet);switch(er.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,er),er);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[rr]],er),er);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[rr]],er),er);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[rr]],er),er,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[rr]],er),er);case"fods":return write_string_type(write_ods(e,er),er);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[rr]],er),er);case"wk3":return write_binary_type(WK_.book_to_wk3(e,er),er);case"biff2":er.biff||(er.biff=2);case"biff3":er.biff||(er.biff=3);case"biff4":return er.biff||(er.biff=4),write_binary_type(write_biff_buf(e,er),er);case"biff5":er.biff||(er.biff=5);case"biff8":case"xla":case"xls":return er.biff||(er.biff=8),write_cfb_type(e,er);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,er);default:throw new Error("Unrecognized bookType |"+er.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var _e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},er=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();er.match(/^\.[a-z]+$/)&&(e.bookType=er.slice(1)),e.bookType=_e[e.bookType]||e.bookType}}function writeFileSync(e,_e,er){var tr={};return tr.type="file",tr.file=_e,resolve_book_type(tr),writeSync(e,tr)}function make_json_row(e,_e,er,tr,rr,nr,ir,ar){var sr=encode_row(er),or=ar.defval,lr=ar.raw||!Object.prototype.hasOwnProperty.call(ar,"raw"),ur=!0,fr=rr===1?[]:{};if(rr!==1)if(Object.defineProperty)try{Object.defineProperty(fr,"__rowNum__",{value:er,enumerable:!1})}catch{fr.__rowNum__=er}else fr.__rowNum__=er;if(!ir||e[er])for(var cr=_e.s.c;cr<=_e.e.c;++cr){var mr=ir?e[er][cr]:e[tr[cr]+sr];if(mr===void 0||mr.t===void 0){if(or===void 0)continue;nr[cr]!=null&&(fr[nr[cr]]=or);continue}var dr=mr.v;switch(mr.t){case"z":if(dr==null)break;continue;case"e":dr=dr==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+mr.t)}if(nr[cr]!=null){if(dr==null)if(mr.t=="e"&&dr===null)fr[nr[cr]]=null;else if(or!==void 0)fr[nr[cr]]=or;else if(lr&&dr===null)fr[nr[cr]]=null;else continue;else fr[nr[cr]]=lr&&(mr.t!=="n"||mr.t==="n"&&ar.rawNumbers!==!1)?dr:format_cell(mr,dr,ar);dr!=null&&(ur=!1)}}return{row:fr,isempty:ur}}function sheet_to_json(e,_e){if(e==null||e["!ref"]==null)return[];var er={t:"n",v:0},tr=0,rr=1,nr=[],ir=0,ar="",sr={s:{r:0,c:0},e:{r:0,c:0}},or=_e||{},lr=or.range!=null?or.range:e["!ref"];switch(or.header===1?tr=1:or.header==="A"?tr=2:Array.isArray(or.header)?tr=3:or.header==null&&(tr=0),typeof lr){case"string":sr=safe_decode_range(lr);break;case"number":sr=safe_decode_range(e["!ref"]),sr.s.r=lr;break;default:sr=lr}tr>0&&(rr=0);var ur=encode_row(sr.s.r),fr=[],cr=[],mr=0,dr=0,xr=Array.isArray(e),pr=sr.s.r,gr=0,vr={};xr&&!e[pr]&&(e[pr]=[]);var Cr=or.skipHidden&&e["!cols"]||[],Tr=or.skipHidden&&e["!rows"]||[];for(gr=sr.s.c;gr<=sr.e.c;++gr)if(!(Cr[gr]||{}).hidden)switch(fr[gr]=encode_col(gr),er=xr?e[pr][gr]:e[fr[gr]+ur],tr){case 1:nr[gr]=gr-sr.s.c;break;case 2:nr[gr]=fr[gr];break;case 3:nr[gr]=or.header[gr-sr.s.c];break;default:if(er==null&&(er={w:"__EMPTY",t:"s"}),ar=ir=format_cell(er,null,or),dr=vr[ir]||0,!dr)vr[ir]=1;else{do ar=ir+"_"+dr++;while(vr[ar]);vr[ir]=dr,vr[ar]=1}nr[gr]=ar}for(pr=sr.s.r+rr;pr<=sr.e.r;++pr)if(!(Tr[pr]||{}).hidden){var Fr=make_json_row(e,sr,pr,fr,tr,nr,xr,or);(Fr.isempty===!1||(tr===1?or.blankrows!==!1:or.blankrows))&&(cr[mr++]=Fr.row)}return cr.length=mr,cr}var qreg=/"/g;function make_csv_row(e,_e,er,tr,rr,nr,ir,ar){for(var sr=!0,or=[],lr="",ur=encode_row(er),fr=_e.s.c;fr<=_e.e.c;++fr)if(tr[fr]){var cr=ar.dense?(e[er]||[])[fr]:e[tr[fr]+ur];if(cr==null)lr="";else if(cr.v!=null){sr=!1,lr=""+(ar.rawNumbers&&cr.t=="n"?cr.v:format_cell(cr,null,ar));for(var mr=0,dr=0;mr!==lr.length;++mr)if((dr=lr.charCodeAt(mr))===rr||dr===nr||dr===34||ar.forceQuotes){lr='"'+lr.replace(qreg,'""')+'"';break}lr=="ID"&&(lr='"ID"')}else cr.f!=null&&!cr.F?(sr=!1,lr="="+cr.f,lr.indexOf(",")>=0&&(lr='"'+lr.replace(qreg,'""')+'"')):lr="";or.push(lr)}return ar.blankrows===!1&&sr?null:or.join(ir)}function sheet_to_csv(e,_e){var er=[],tr=_e??{};if(e==null||e["!ref"]==null)return"";var rr=safe_decode_range(e["!ref"]),nr=tr.FS!==void 0?tr.FS:",",ir=nr.charCodeAt(0),ar=tr.RS!==void 0?tr.RS:`
`,sr=ar.charCodeAt(0),or=new RegExp((nr=="|"?"\\|":nr)+"+$"),lr="",ur=[];tr.dense=Array.isArray(e);for(var fr=tr.skipHidden&&e["!cols"]||[],cr=tr.skipHidden&&e["!rows"]||[],mr=rr.s.c;mr<=rr.e.c;++mr)(fr[mr]||{}).hidden||(ur[mr]=encode_col(mr));for(var dr=0,xr=rr.s.r;xr<=rr.e.r;++xr)(cr[xr]||{}).hidden||(lr=make_csv_row(e,rr,xr,ur,ir,sr,nr,tr),lr!=null&&(tr.strip&&(lr=lr.replace(or,"")),(lr||tr.blankrows!==!1)&&er.push((dr++?ar:"")+lr)));return delete tr.dense,er.join("")}function sheet_to_txt(e,_e){_e||(_e={}),_e.FS="	",_e.RS=`
`;var er=sheet_to_csv(e,_e);return er}function sheet_to_formulae(e){var _e="",er,tr="";if(e==null||e["!ref"]==null)return[];var rr=safe_decode_range(e["!ref"]),nr="",ir=[],ar,sr=[],or=Array.isArray(e);for(ar=rr.s.c;ar<=rr.e.c;++ar)ir[ar]=encode_col(ar);for(var lr=rr.s.r;lr<=rr.e.r;++lr)for(nr=encode_row(lr),ar=rr.s.c;ar<=rr.e.c;++ar)if(_e=ir[ar]+nr,er=or?(e[lr]||[])[ar]:e[_e],tr="",er!==void 0){if(er.F!=null){if(_e=er.F,!er.f)continue;tr=er.f,_e.indexOf(":")==-1&&(_e=_e+":"+_e)}if(er.f!=null)tr=er.f;else{if(er.t=="z")continue;if(er.t=="n"&&er.v!=null)tr=""+er.v;else if(er.t=="b")tr=er.v?"TRUE":"FALSE";else if(er.w!==void 0)tr="'"+er.w;else{if(er.v===void 0)continue;er.t=="s"?tr="'"+er.v:tr=""+er.v}}sr[sr.length]=_e+"="+tr}return sr}function sheet_add_json(e,_e,er){var tr=er||{},rr=+!tr.skipHeader,nr=e||{},ir=0,ar=0;if(nr&&tr.origin!=null)if(typeof tr.origin=="number")ir=tr.origin;else{var sr=typeof tr.origin=="string"?decode_cell(tr.origin):tr.origin;ir=sr.r,ar=sr.c}var or,lr={s:{c:0,r:0},e:{c:ar,r:ir+_e.length-1+rr}};if(nr["!ref"]){var ur=safe_decode_range(nr["!ref"]);lr.e.c=Math.max(lr.e.c,ur.e.c),lr.e.r=Math.max(lr.e.r,ur.e.r),ir==-1&&(ir=ur.e.r+1,lr.e.r=ir+_e.length-1+rr)}else ir==-1&&(ir=0,lr.e.r=_e.length-1+rr);var fr=tr.header||[],cr=0;_e.forEach(function(dr,xr){keys(dr).forEach(function(pr){(cr=fr.indexOf(pr))==-1&&(fr[cr=fr.length]=pr);var gr=dr[pr],vr="z",Cr="",Tr=encode_cell({c:ar+cr,r:ir+xr+rr});or=ws_get_cell_stub(nr,Tr),gr&&typeof gr=="object"&&!(gr instanceof Date)?nr[Tr]=gr:(typeof gr=="number"?vr="n":typeof gr=="boolean"?vr="b":typeof gr=="string"?vr="s":gr instanceof Date?(vr="d",tr.cellDates||(vr="n",gr=datenum(gr)),Cr=tr.dateNF||table_fmt[14]):gr===null&&tr.nullError&&(vr="e",gr=0),or?(or.t=vr,or.v=gr,delete or.w,delete or.R,Cr&&(or.z=Cr)):nr[Tr]=or={t:vr,v:gr},Cr&&(or.z=Cr))})}),lr.e.c=Math.max(lr.e.c,ar+fr.length-1);var mr=encode_row(ir);if(rr)for(cr=0;cr<fr.length;++cr)nr[encode_col(cr+ar)+mr]={t:"s",v:fr[cr]};return nr["!ref"]=encode_range(lr),nr}function json_to_sheet(e,_e){return sheet_add_json(null,e,_e)}function ws_get_cell_stub(e,_e,er){if(typeof _e=="string"){if(Array.isArray(e)){var tr=decode_cell(_e);return e[tr.r]||(e[tr.r]=[]),e[tr.r][tr.c]||(e[tr.r][tr.c]={t:"z"})}return e[_e]||(e[_e]={t:"z"})}return typeof _e!="number"?ws_get_cell_stub(e,encode_cell(_e)):ws_get_cell_stub(e,encode_cell({r:_e,c:er||0}))}function wb_sheet_idx(e,_e){if(typeof _e=="number"){if(_e>=0&&e.SheetNames.length>_e)return _e;throw new Error("Cannot find sheet # "+_e)}else if(typeof _e=="string"){var er=e.SheetNames.indexOf(_e);if(er>-1)return er;throw new Error("Cannot find sheet name |"+_e+"|")}else throw new Error("Cannot find sheet |"+_e+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,_e,er,tr){var rr=1;if(!er)for(;rr<=65535&&e.SheetNames.indexOf(er="Sheet"+rr)!=-1;++rr,er=void 0);if(!er||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(tr&&e.SheetNames.indexOf(er)>=0){var nr=er.match(/(^.*?)(\d+)$/);rr=nr&&+nr[2]||0;var ir=nr&&nr[1]||er;for(++rr;rr<=65535&&e.SheetNames.indexOf(er=ir+rr)!=-1;++rr);}if(check_ws_name(er),e.SheetNames.indexOf(er)>=0)throw new Error("Worksheet with name |"+er+"| already exists!");return e.SheetNames.push(er),e.Sheets[er]=_e,er}function book_set_sheet_visibility(e,_e,er){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var tr=wb_sheet_idx(e,_e);switch(e.Workbook.Sheets[tr]||(e.Workbook.Sheets[tr]={}),er){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+er)}e.Workbook.Sheets[tr].Hidden=er}function cell_set_number_format(e,_e){return e.z=_e,e}function cell_set_hyperlink(e,_e,er){return _e?(e.l={Target:_e},er&&(e.l.Tooltip=er)):delete e.l,e}function cell_set_internal_link(e,_e,er){return cell_set_hyperlink(e,"#"+_e,er)}function cell_add_comment(e,_e,er){e.c||(e.c=[]),e.c.push({t:_e,a:er||"SheetJS"})}function sheet_set_array_formula(e,_e,er,tr){for(var rr=typeof _e!="string"?_e:safe_decode_range(_e),nr=typeof _e=="string"?_e:encode_range(_e),ir=rr.s.r;ir<=rr.e.r;++ir)for(var ar=rr.s.c;ar<=rr.e.c;++ar){var sr=ws_get_cell_stub(e,ir,ar);sr.t="n",sr.F=nr,delete sr.v,ir==rr.s.r&&ar==rr.s.c&&(sr.f=er,tr&&(sr.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const DashboardLayout=({children:e})=>jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto p-4",children:e})}),Button=reactExports.forwardRef(({className:e="",variant:_e="default",size:er="default",...tr},rr)=>{const nr="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",ir={default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-100",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300",ghost:"hover:bg-gray-100",link:"text-blue-600 underline-offset-4 hover:underline"},ar={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"};return jsxRuntimeExports.jsx("button",{className:`${nr} ${ir[_e]} ${ar[er]} ${e}`,ref:rr,...tr})});Button.displayName="Button";const Input=reactExports.forwardRef(({className:e="",type:_e="text",...er},tr)=>jsxRuntimeExports.jsx("input",{type:_e,className:`flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 ${e}`,ref:tr,...er}));Input.displayName="Input";const Label=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("label",{ref:er,className:`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${e}`,..._e}));Label.displayName="Label";const Card=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`rounded-lg border border-gray-200 bg-white shadow-sm ${e}`,..._e}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex flex-col space-y-1.5 p-6 ${e}`,..._e}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("h3",{ref:er,className:`text-2xl font-semibold leading-none tracking-tight ${e}`,..._e}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("p",{ref:er,className:`text-sm text-gray-500 ${e}`,..._e}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`p-6 pt-0 ${e}`,..._e}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex items-center p-6 pt-0 ${e}`,..._e}));CardFooter.displayName="CardFooter";const SelectContext=reactExports.createContext({open:!1,setOpen:()=>{}}),Select=({value:e,onValueChange:_e,children:er})=>{const[tr,rr]=reactExports.useState(!1);return jsxRuntimeExports.jsx(SelectContext.Provider,{value:{value:e,onValueChange:_e,open:tr,setOpen:rr},children:jsxRuntimeExports.jsx("div",{className:"relative",children:er})})},SelectTrigger=reactExports.forwardRef(({className:e="",children:_e,...er},tr)=>{const{open:rr,setOpen:nr}=reactExports.useContext(SelectContext);return jsxRuntimeExports.jsxs("button",{type:"button",ref:tr,className:`flex h-10 w-full items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50 ${e}`,onClick:()=>nr(!rr),...er,children:[_e,jsxRuntimeExports.jsx("svg",{className:"h-4 w-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})});SelectTrigger.displayName="SelectTrigger";const SelectValue=({placeholder:e})=>{const{value:_e}=reactExports.useContext(SelectContext);return jsxRuntimeExports.jsx("span",{children:_e||e})},SelectContent=({children:e})=>{const{open:_e,setOpen:er}=reactExports.useContext(SelectContext);return _e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>er(!1)}),jsxRuntimeExports.jsx("div",{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-300 bg-white py-1 shadow-lg",children:e})]}):null},SelectItem=({value:e,children:_e})=>{const{onValueChange:er,setOpen:tr,value:rr}=reactExports.useContext(SelectContext);return jsxRuntimeExports.jsx("div",{className:`relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-gray-100 ${rr===e?"bg-gray-100":""}`,onClick:()=>{er==null||er(e),tr(!1)},children:_e})},Badge=({className:e="",variant:_e="default",...er})=>{const tr={default:"bg-blue-600 text-white",secondary:"bg-gray-200 text-gray-900",destructive:"bg-red-600 text-white",outline:"border border-gray-300 bg-transparent"};return jsxRuntimeExports.jsx("div",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors ${tr[_e]} ${e}`,...er})},TabsContext=reactExports.createContext({}),Tabs=({value:e,defaultValue:_e,onValueChange:er,children:tr,className:rr=""})=>{const[nr,ir]=reactExports.useState(_e||e),ar=e!==void 0?e:nr,sr=or=>{e===void 0&&ir(or),er==null||er(or)};return jsxRuntimeExports.jsx(TabsContext.Provider,{value:{value:ar,onValueChange:sr},children:jsxRuntimeExports.jsx("div",{className:rr,children:tr})})},TabsList=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 ${e}`,..._e}));TabsList.displayName="TabsList";const TabsTrigger=reactExports.forwardRef(({className:e="",value:_e,...er},tr)=>{const{value:rr,onValueChange:nr}=reactExports.useContext(TabsContext),ir=rr===_e;return jsxRuntimeExports.jsx("button",{ref:tr,type:"button",className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 ${ir?"bg-white shadow-sm":"text-gray-600 hover:text-gray-900"} ${e}`,onClick:()=>nr==null?void 0:nr(_e),...er})});TabsTrigger.displayName="TabsTrigger";const TabsContent=reactExports.forwardRef(({className:e="",value:_e,...er},tr)=>{const{value:rr}=reactExports.useContext(TabsContext);return rr!==_e?null:jsxRuntimeExports.jsx("div",{ref:tr,className:`mt-2 focus-visible:outline-none focus-visible:ring-2 ${e}`,...er})});TabsContent.displayName="TabsContent";const DialogContext=reactExports.createContext({open:!1}),Dialog=({open:e=!1,onOpenChange:_e,children:er})=>jsxRuntimeExports.jsx(DialogContext.Provider,{value:{open:e,onOpenChange:_e},children:er}),DialogTrigger=reactExports.forwardRef(({children:e,onClick:_e,...er},tr)=>{const{onOpenChange:rr}=reactExports.useContext(DialogContext);return jsxRuntimeExports.jsx("button",{ref:tr,onClick:nr=>{_e==null||_e(nr),rr==null||rr(!0)},...er,children:e})});DialogTrigger.displayName="DialogTrigger";const DialogContent=reactExports.forwardRef(({className:e="",children:_e,...er},tr)=>{const{open:rr,onOpenChange:nr}=reactExports.useContext(DialogContext);return rr?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>nr==null?void 0:nr(!1)}),jsxRuntimeExports.jsx("div",{ref:tr,className:`relative z-50 w-full max-w-lg rounded-lg border border-gray-200 bg-white p-6 shadow-lg ${e}`,...er,children:_e})]}):null});DialogContent.displayName="DialogContent";const DialogHeader=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex flex-col space-y-1.5 text-center sm:text-left ${e}`,..._e}));DialogHeader.displayName="DialogHeader";const DialogTitle=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("h2",{ref:er,className:`text-lg font-semibold leading-none tracking-tight ${e}`,..._e}));DialogTitle.displayName="DialogTitle";const DialogDescription=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("p",{ref:er,className:`text-sm text-gray-500 ${e}`,..._e}));DialogDescription.displayName="DialogDescription";const DialogFooter=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 ${e}`,..._e}));DialogFooter.displayName="DialogFooter";const AlertDialogContext=reactExports.createContext({open:!1}),AlertDialog=({open:e=!1,onOpenChange:_e,children:er})=>jsxRuntimeExports.jsx(AlertDialogContext.Provider,{value:{open:e,onOpenChange:_e},children:er}),AlertDialogTrigger=reactExports.forwardRef(({children:e,onClick:_e,...er},tr)=>{const{onOpenChange:rr}=reactExports.useContext(AlertDialogContext);return jsxRuntimeExports.jsx("button",{ref:tr,onClick:nr=>{_e==null||_e(nr),rr==null||rr(!0)},...er,children:e})});AlertDialogTrigger.displayName="AlertDialogTrigger";const AlertDialogContent=reactExports.forwardRef(({className:e="",children:_e,...er},tr)=>{const{open:rr,onOpenChange:nr}=reactExports.useContext(AlertDialogContext);return rr?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>nr==null?void 0:nr(!1)}),jsxRuntimeExports.jsx("div",{ref:tr,className:`relative z-50 w-full max-w-lg rounded-lg border border-gray-200 bg-white p-6 shadow-lg ${e}`,...er,children:_e})]}):null});AlertDialogContent.displayName="AlertDialogContent";const AlertDialogHeader=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex flex-col space-y-2 text-center sm:text-left ${e}`,..._e}));AlertDialogHeader.displayName="AlertDialogHeader";const AlertDialogTitle=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("h2",{ref:er,className:`text-lg font-semibold ${e}`,..._e}));AlertDialogTitle.displayName="AlertDialogTitle";const AlertDialogDescription=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("p",{ref:er,className:`text-sm text-gray-500 ${e}`,..._e}));AlertDialogDescription.displayName="AlertDialogDescription";const AlertDialogFooter=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 ${e}`,..._e}));AlertDialogFooter.displayName="AlertDialogFooter";const AlertDialogAction=reactExports.forwardRef(({className:e="",onClick:_e,...er},tr)=>{const{onOpenChange:rr}=reactExports.useContext(AlertDialogContext);return jsxRuntimeExports.jsx("button",{ref:tr,className:`inline-flex h-10 items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 ${e}`,onClick:nr=>{_e==null||_e(nr),rr==null||rr(!1)},...er})});AlertDialogAction.displayName="AlertDialogAction";const AlertDialogCancel=reactExports.forwardRef(({className:e="",onClick:_e,...er},tr)=>{const{onOpenChange:rr}=reactExports.useContext(AlertDialogContext);return jsxRuntimeExports.jsx("button",{ref:tr,className:`inline-flex h-10 items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-100 ${e}`,onClick:nr=>{_e==null||_e(nr),rr==null||rr(!1)},...er})});AlertDialogCancel.displayName="AlertDialogCancel";const DropdownMenuContext=reactExports.createContext({open:!1,setOpen:()=>{}}),DropdownMenu=({children:e})=>{const[_e,er]=reactExports.useState(!1);return jsxRuntimeExports.jsx(DropdownMenuContext.Provider,{value:{open:_e,setOpen:er},children:jsxRuntimeExports.jsx("div",{className:"relative inline-block",children:e})})},DropdownMenuTrigger=reactExports.forwardRef(({children:e,onClick:_e,asChild:er,...tr},rr)=>{const{open:nr,setOpen:ir}=reactExports.useContext(DropdownMenuContext);return er&&reactExports.isValidElement(e)?reactExports.cloneElement(e,{onClick:ar=>{_e==null||_e(ar),ir(!nr)}}):jsxRuntimeExports.jsx("button",{ref:rr,onClick:ar=>{_e==null||_e(ar),ir(!nr)},...tr,children:e})});DropdownMenuTrigger.displayName="DropdownMenuTrigger";const DropdownMenuContent=reactExports.forwardRef(({className:e="",children:_e,align:er="end",...tr},rr)=>{const{open:nr,setOpen:ir}=reactExports.useContext(DropdownMenuContext);if(!nr)return null;const ar=er==="start"?"left-0":er==="center"?"left-1/2 -translate-x-1/2":"right-0";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>ir(!1)}),jsxRuntimeExports.jsx("div",{ref:rr,className:`absolute ${ar} z-50 mt-2 w-56 rounded-md border border-gray-200 bg-white p-1 shadow-lg ${e}`,...tr,children:_e})]})});DropdownMenuContent.displayName="DropdownMenuContent";const DropdownMenuItem=reactExports.forwardRef(({className:e="",onClick:_e,...er},tr)=>{const{setOpen:rr}=reactExports.useContext(DropdownMenuContext);return jsxRuntimeExports.jsx("div",{ref:tr,className:`relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-gray-100 ${e}`,onClick:nr=>{_e==null||_e(nr),rr(!1)},...er})});DropdownMenuItem.displayName="DropdownMenuItem";const DropdownMenuSeparator=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`-mx-1 my-1 h-px bg-gray-200 ${e}`,..._e}));DropdownMenuSeparator.displayName="DropdownMenuSeparator";const DropdownMenuLabel=reactExports.forwardRef(({className:e="",..._e},er)=>jsxRuntimeExports.jsx("div",{ref:er,className:`px-2 py-1.5 text-sm font-semibold ${e}`,..._e}));DropdownMenuLabel.displayName="DropdownMenuLabel";const useToast=()=>{const[e,_e]=reactExports.useState([]);return{toast:tr=>{_e(nr=>[...nr,tr]),setTimeout(()=>{_e(nr=>nr.slice(1))},3e3);const rr=`${tr.title}${tr.description?`
`+tr.description:""}`;tr.variant==="destructive"?console.error(rr):console.log(rr)},toasts:e}},mockCongregations=[{id:"1",name:"Congregao Central",city:"So Paulo",state:"SP",rehearsals:[{type:"local",time:"19h30",day:"Tera"},{type:"regional",time:"09h00",day:"Sbado"}]}],useCongregations=()=>{const[e,_e]=reactExports.useState(mockCongregations),[er]=reactExports.useState(!1);return{congregations:e,loading:er,addCongregation:async ir=>{_e([...e,{...ir,id:Date.now().toString()}])},updateCongregation:async(ir,ar)=>{_e(e.map(sr=>sr.id===ir?{...ar,id:ir}:sr))},deleteCongregation:async ir=>{_e(e.filter(ar=>ar.id!==ir))}}};class MusicianService{constructor(){Xs(this,"musicians",[])}async getAll(){return this.musicians}async getById(_e){return this.musicians.find(er=>er.id===_e)}async create(_e){const er={..._e,id:Date.now().toString()};return this.musicians.push(er),er}async update(_e,er){const tr=this.musicians.findIndex(rr=>rr.id===_e);if(tr!==-1)return this.musicians[tr]={...er,id:_e},this.musicians[tr];throw new Error("Musician not found")}async delete(_e){this.musicians=this.musicians.filter(er=>er.id!==_e)}async bulkCreate(_e){const er=_e.map(tr=>({...tr,id:Date.now().toString()+Math.random()}));return this.musicians.push(...er),er}}const musicianService=new MusicianService;class EnsaioDataService{constructor(){Xs(this,"ensaios",[])}async getAll(){return this.ensaios}async getById(_e){return this.ensaios.find(er=>er.id===_e)}async create(_e){const er={..._e,id:Date.now().toString()};return this.ensaios.push(er),er}async update(_e,er){const tr=this.ensaios.findIndex(rr=>rr.id===_e);if(tr!==-1)return this.ensaios[tr]={...er,id:_e},this.ensaios[tr];throw new Error("Ensaio not found")}async delete(_e){this.ensaios=this.ensaios.filter(er=>er.id!==_e)}async getByYear(_e){return this.ensaios.filter(er=>er.date.getFullYear()===_e)}async getByCongregation(_e){return this.ensaios.filter(er=>er.congregationId===_e)}}const ensaioDataService=new EnsaioDataService;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,_e)=>{const er=reactExports.forwardRef(({color:tr="currentColor",size:rr=24,strokeWidth:nr=2,absoluteStrokeWidth:ir,className:ar="",children:sr,...or},lr)=>reactExports.createElement("svg",{ref:lr,...defaultAttributes,width:rr,height:rr,stroke:tr,strokeWidth:ir?Number(nr)*24/Number(rr):nr,className:["lucide",`lucide-${toKebabCase(e)}`,ar].join(" "),...or},[..._e.map(([ur,fr])=>reactExports.createElement(ur,fr)),...Array.isArray(sr)?sr:[sr]]));return er.displayName=`${e}`,er};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileSpreadsheet=createLucideIcon("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileUp=createLucideIcon("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Music=createLucideIcon("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Printer=createLucideIcon("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Search=createLucideIcon("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),INSTRUMENTS=["Clarinete","Clarone","Sax Soprano","Sax Alto","Sax Tenor","Sax Bartono","Trompete","Flugelhorn","Eufnio","Trombone","Trombonito","Tuba","Viola","Violino","Cello","rgo","Acordeon","Flauta"],STAGES=["Ensaio","RJM","Culto Oficial","Oficializao"];function Musical(){var Jr;const[e,_e]=reactExports.useState(!1),[er,tr]=reactExports.useState("local"),[rr,nr]=reactExports.useState(format(new Date,"yyyy-MM-dd")),[ir,ar]=reactExports.useState(""),[sr,or]=reactExports.useState(""),[lr,ur]=reactExports.useState(""),[fr,cr]=reactExports.useState({clarinete:0,clarone:0,saxSoprano:0,saxAlto:0,saxTenor:0,saxBaritono:0,trompete:0,flugelhorn:0,euphonio:0,trombone:0,trombonito:0,tuba:0,viola:0,violino:0,cello:0,organista:0}),mr=()=>{dr({title:"Exportao no implementada",description:"Funo de exportar frequncia ainda no implementada."})},{toast:dr}=useToast(),{congregations:xr}=useCongregations(),[pr,gr]=reactExports.useState([]),[vr,Cr]=reactExports.useState(!1),[Tr,Fr]=reactExports.useState(!1),[_r,Ar]=reactExports.useState(""),[Pr,Ir]=reactExports.useState(""),[wr,kr]=reactExports.useState(""),[Mr,Hr]=reactExports.useState(""),[Gr,zr]=reactExports.useState(""),[Br,Vr]=reactExports.useState("Ensaio"),[Rr,Xr]=reactExports.useState(""),[an,yr]=reactExports.useState(""),[br,Er]=reactExports.useState(""),[Lr,Or]=reactExports.useState(""),[Ur,$r]=reactExports.useState(!1),[Zr,fn]=reactExports.useState(null),[_n,Kr]=reactExports.useState(!1),[Cn,Dn]=reactExports.useState([]),[wn,Qr]=reactExports.useState(!1),[xn,tn]=reactExports.useState(!1),[on,vn]=reactExports.useState(!1),[Sn,Ln]=reactExports.useState([]),[Wn,$n]=reactExports.useState(!1),[En,ba]=reactExports.useState("all"),[Qn,vs]=reactExports.useState("all"),[es,ls]=reactExports.useState("all"),[Xn,ws]=reactExports.useState(new Date().getFullYear().toString()),[ds,Ps]=reactExports.useState("all"),[Zn,Mn]=reactExports.useState(!1),zn=reactExports.useCallback(async()=>{Cr(!0);try{const Yr=await musicianService.getAll();gr(Yr)}catch(Yr){console.error("Error loading musicians:",Yr),dr({title:"Erro ao carregar",description:"No foi possvel carregar os msicos.",variant:"destructive"})}finally{Cr(!1)}},[dr]),cs=reactExports.useCallback(async()=>{$n(!0);try{const Yr=await ensaioDataService.getAll();Ln(Yr)}catch(Yr){console.error("Error loading ensaios:",Yr),dr({title:"Erro ao carregar ensaios",description:"No foi possvel carregar os ensaios cadastrados.",variant:"destructive"})}finally{$n(!1)}},[dr]);reactExports.useEffect(()=>{zn()},[zn]),reactExports.useEffect(()=>{cs()},[cs]),reactExports.useEffect(()=>{if(Pr){const Yr=xr.find(qr=>qr.id===Pr);Yr&&kr(Yr.city)}},[Pr,xr]);const Ls=async()=>{if(!_r||!Pr||!wr||!Mr||!Gr||!Br){dr({title:"Campos obrigatrios",description:"Preencha todos os campos para cadastrar um msico.",variant:"destructive"});return}const Yr=xr.find(qr=>qr.id===Pr);if(Yr){Fr(!0);try{await musicianService.create({name:_r,congregationId:Pr,congregationName:Yr.name,city:wr,phone:Mr,instrument:Gr,stage:Br}),dr({title:"Msico cadastrado!",description:`${_r} foi cadastrado com sucesso.`}),Ar(""),Ir(""),kr(""),Hr(""),zr(""),Vr("Ensaio"),zn()}catch(qr){console.error("Error adding musician:",qr),dr({title:"Erro ao cadastrar",description:"No foi possvel cadastrar o msico.",variant:"destructive"})}finally{Fr(!1)}}},As=(Yr,qr)=>{fn({id:Yr,name:qr}),$r(!0)},yn=async()=>{if(Zr)try{await musicianService.delete(Zr.id),zn(),dr({title:"Msico removido",description:`${Zr.name} foi removido com sucesso.`})}catch(Yr){console.error("Error deleting musician:",Yr),dr({title:"Erro ao remover",description:"No foi possvel remover o msico.",variant:"destructive"})}finally{$r(!1),fn(null)}};pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;const _i=async Yr=>{var en;const qr=(en=Yr.target.files)==null?void 0:en[0];if(qr){if(qr.type!=="application/pdf"){dr({title:"Arquivo invlido",description:"Por favor, selecione um arquivo PDF.",variant:"destructive"});return}Qr(!0);try{const sn=await qr.arrayBuffer(),un=await pdfExports.getDocument({data:sn}).promise;let Tn="";const In=[];console.log(` Processando PDF com ${un.numPages} pgina(s)...`);for(let kn=1;kn<=un.numPages;kn++){const Kn=await(await un.getPage(kn)).getTextContent(),is=new Map;Kn.items.forEach(ns=>{const ss=ns;if(ss.str&&ss.str.trim()&&ss.transform){const Ss=Math.round(ss.transform[5]);is.has(Ss)||is.set(Ss,[]),is.get(Ss).push({str:ss.str,transform:ss.transform})}}),Array.from(is.entries()).sort((ns,ss)=>ss[0]-ns[0]).forEach(([ns,ss])=>{ss.sort((ks,Ns)=>ks.transform[4]-Ns.transform[4]);const Ss=ss.map(ks=>ks.str).join(" ");Ss.trim()&&(In.push(Ss.trim()),Tn+=Ss+`
`)})}console.log(" Texto extrado do PDF:"),console.log("".repeat(80)),console.log(Tn.substring(0,1e3)),console.log("".repeat(80)),console.log(`Total de linhas: ${In.length}`);const Fn=os(Tn,In);console.log(` Msicos encontrados: ${Fn.length}`),Fn.length===0?(console.warn(" Nenhum msico vlido encontrado."),console.log(" Dica: Verifique se o PDF est no formato correto:"),console.log("   Nome | Congregao | Cidade | Telefone | Instrumento | Etapa"),dr({title:"Nenhum dado encontrado",description:"Verifique o console do navegador (F12) para ver o texto extrado e ajustar o formato.",variant:"destructive"})):(Dn(Fn),dr({title:"PDF processado!",description:`${Fn.length} msico(s) encontrado(s) no arquivo.`}))}catch(sn){console.error(" Error processing PDF:",sn),dr({title:"Erro ao processar PDF",description:"No foi possvel ler o arquivo PDF. Verifique o console (F12).",variant:"destructive"})}finally{Qr(!1),Yr.target.value=""}}},rs=Yr=>{const qr=[],en=Yr.slice(1);for(const sn of en){if(sn.length<6)continue;const[un,Tn,In,Fn,kn,Nn]=sn.map(is=>String(is||"").trim());if(!un||!Tn||!In||!Fn||!kn||!Nn)continue;if(!INSTRUMENTS.includes(kn)){console.warn(`Instrumento invlido: ${kn} para ${un}`);continue}if(!STAGES.includes(Nn)){console.warn(`Etapa invlida: ${Nn} para ${un}`);continue}const Kn=xr.find(is=>is.name.toLowerCase().includes(Tn.toLowerCase())||Tn.toLowerCase().includes(is.name.toLowerCase()));Kn?qr.push({name:un,congregationId:Kn.id,congregationName:Kn.name,city:In||Kn.city,phone:Fn,instrument:kn,stage:Nn}):console.warn(`Congregao no encontrada: ${Tn} para ${un}`)}return qr},os=(Yr,qr)=>{const en=[],sn=qr||Yr.split(`
`).filter(Fn=>Fn.trim());console.log(" Iniciando parsing do PDF..."),console.log(` Total de linhas a processar: ${sn.length}`);let un="standard";const Tn=sn.slice(0,10).join(" ").toUpperCase();Tn.includes("LOCALIDADE")&&Tn.includes("NIVEL")?(un="alternative",console.log(" Formato alternativo detectado (NOME | INSTRUMENTO | LOCALIDADE | NIVEL)")):console.log(" Formato padro detectado (Nome | Congregao | Cidade | Telefone | Instrumento | Etapa)");const In=Fn=>{const kn=Fn.toUpperCase().trim();return kn.includes("OFICIALIZADO")?"Oficializao":kn.includes("CULTO OFICIAL")?"Culto Oficial":kn.includes("RJM")&&!kn.includes("ENSAIO")?"RJM":kn.includes("ENSAIO")&&!kn.includes("RJM")?"Ensaio":kn.includes("RJM")&&kn.includes("ENSAIO")?"RJM":null};for(let Fn=0;Fn<sn.length;Fn++){const kn=sn[Fn];if(!kn.trim())continue;const Nn=kn.toLowerCase();if(Nn.includes("nome")&&(Nn.includes("congregao")||Nn.includes("instrumento"))){console.log(`  Pulando cabealho na linha ${Fn+1}: ${kn}`);continue}if(Nn.includes("relatrio")||Nn.includes("sistema")||Nn.includes("gerado em")){console.log(`  Pulando metadado na linha ${Fn+1}: ${kn}`);continue}let Kn=[],is="";if(kn.includes("|")&&(Kn=kn.split("|").map(Is=>Is.trim()).filter(Is=>Is),is="pipe (|)"),Kn.length<4&&kn.includes("	")&&(Kn=kn.split("	").map(Is=>Is.trim()).filter(Is=>Is),is="tabulao"),Kn.length<4){const Is=kn.split(/\s{2,}/).map(Gs=>Gs.trim()).filter(Gs=>Gs);Is.length>=4&&(Kn=Is,is="espaos mltiplos")}if(Kn.length<4){const Is=kn.match(/\(?\d{2}\)?\s?\d{4,5}-?\d{4}/);if(Is){const Gs=Is[0],so=kn.substring(0,Is.index).trim(),ro=kn.substring((Is.index||0)+Gs.length).trim(),Qs=so.split(/\s{2,}/).filter(Hs=>Hs.trim()),qs=ro.split(/\s{2,}/).filter(Hs=>Hs.trim());Qs.length>=3&&qs.length>=2&&(Kn=[...Qs,Gs,...qs],is="padro de telefone")}}if(Kn.length<4){Kn.length>0&&!Nn.includes("pgina")&&!Nn.includes("total")&&console.log(`  Linha ${Fn+1} ignorada (${Kn.length} campos): ${kn.substring(0,100)}`);continue}let ps="",ns="",ss="",Ss="",ks="",Ns="";if(un==="alternative"){if(Kn.length>=4){ps=Kn[0],ks=Kn[1];const Is=Kn[2],Gs=Kn[Kn.length-1];if(Is.includes(" - ")){const ro=Is.split(" - ").map(Qs=>Qs.trim());ns=ro[0],ss=ro[ro.length-1]}else ns=Is,ss=Is;const so=In(Gs);so?Ns=so:Ns=Gs,Ss=""}}else Kn.length>=6&&([ps,ns,ss,Ss,ks,Ns]=Kn);if(console.log(`
 Linha ${Fn+1} (${is}):`),console.log(`   Nome: "${ps}"`),console.log(`   Instrumento: "${ks}"`),console.log(`   Congregao: "${ns}"`),console.log(`   Cidade: "${ss}"`),console.log(`   Telefone: "${Ss||"(no informado)"}"`),console.log(`   Etapa: "${Ns}"`),!ps||!ns||!ks||!Ns){console.log("    Campos vazios detectados");continue}if(!INSTRUMENTS.includes(ks)){console.log(`    Instrumento invlido: "${ks}"`),console.log(`    Instrumentos vlidos: ${INSTRUMENTS.join(", ")}`);const Is=INSTRUMENTS.find(Gs=>Gs.toLowerCase().includes(ks.toLowerCase())||ks.toLowerCase().includes(Gs.toLowerCase()));if(Is)console.log(`    Usando instrumento similar: "${Is}"`),ks=Is;else continue}if(!STAGES.includes(Ns)){console.log(`    Etapa invlida: "${Ns}"`),console.log(`    Etapas vlidas: ${STAGES.join(", ")}`);continue}const Us=xr.find(Is=>Is.name.toLowerCase().includes(ns.toLowerCase())||ns.toLowerCase().includes(Is.name.toLowerCase()));if(Us)console.log(`    Congregao encontrada: ${Us.name}`),en.push({name:ps,congregationId:Us.id,congregationName:Us.name,city:ss||Us.city,phone:Ss||"",instrument:ks,stage:Ns});else{console.log(`     Congregao no encontrada: "${ns}"`),console.log(`    Cadastrando com nome do PDF. Congregaes disponveis: ${xr.map(Gs=>Gs.name).slice(0,5).join(", ")}...`);const Is=`temp_${ns.toLowerCase().replace(/\s+/g,"_")}`;en.push({name:ps,congregationId:Is,congregationName:ns,city:ss||"No informada",phone:Ss||"",instrument:ks,stage:Ns})}}return console.log(`
 Total de msicos vlidos encontrados: ${en.length}`),en},ms=async Yr=>{var sn;const qr=(sn=Yr.target.files)==null?void 0:sn[0];if(!qr)return;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(qr.type)&&!qr.name.match(/\.(xlsx?|csv)$/i)){dr({title:"Arquivo invlido",description:"Por favor, selecione um arquivo Excel (.xlsx, .xls) ou CSV.",variant:"destructive"});return}Qr(!0);try{const un=await qr.arrayBuffer(),Tn=readSync(un,{type:"array"}),In=Tn.Sheets[Tn.SheetNames[0]],Fn=utils.sheet_to_json(In,{header:1}),kn=rs(Fn);kn.length===0?dr({title:"Nenhum dado encontrado",description:"No foi possvel extrair dados do arquivo. Verifique o formato.",variant:"destructive"}):(Dn(kn),dr({title:"Arquivo processado!",description:`${kn.length} msico(s) encontrado(s) no arquivo.`}))}catch(un){console.error("Error processing Excel:",un),dr({title:"Erro ao processar arquivo",description:"No foi possvel ler o arquivo Excel/CSV.",variant:"destructive"})}finally{Qr(!1),Yr.target.value=""}},bs=async()=>{if(Cn.length===0)return;tn(!0);let Yr=0,qr=0;try{for(const en of Cn)try{await musicianService.create(en),Yr++}catch(sn){console.error("Error importing musician:",en.name,sn),qr++}dr({title:"Importao concluda!",description:`${Yr} msico(s) importado(s) com sucesso${qr>0?`. ${qr} falha(s).`:"."}`}),Dn([]),Kr(!1),zn()}catch(en){console.error("Error during import:",en),dr({title:"Erro na importao",description:"Ocorreu um erro ao importar os dados.",variant:"destructive"})}finally{tn(!1)}},gn=()=>{Dn([]),Kr(!1)},pn=pr.filter(Yr=>!(Rr&&Yr.instrument!==Rr||an&&Yr.stage!==an||br&&Yr.congregationId!==br||Lr&&!Yr.name.toLowerCase().includes(Lr.toLowerCase()))),Pn=STAGES.reduce((Yr,qr)=>(Yr[qr]=pn.filter(en=>en.stage===qr),Yr),{}),Rn=Yr=>{switch(Yr){case"Ensaio":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"RJM":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"Culto Oficial":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"Oficializao":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}},Yn={domingo:0,segunda:1,terca:2,quarta:3,quinta:4,sexta:5,sabado:6},xa=()=>{const Yr=[],qr=parseInt(Xn||new Date().getFullYear().toString());let en,sn;if(es==="all")en=new Date,sn=addMonths(en,3);else if(es==="annual")en=startOfYear(new Date(qr,0,1)),sn=endOfYear(new Date(qr,0,1));else if(es){const Tn=parseInt(es)-1;en=startOfMonth(new Date(qr,Tn,1)),sn=endOfMonth(new Date(qr,Tn,1))}else en=new Date,sn=addMonths(en,3);let un=xr;return En&&En!=="all"&&(un=xr.filter(Tn=>Tn.id===En)),Qn&&Qn!=="all"&&(un=un.filter(Tn=>Tn.city===Qn)),un.forEach(Tn=>{!Tn.rehearsals||Tn.rehearsals.length===0||Tn.rehearsals.forEach(In=>{const Fn=In.type.toLowerCase();if(ds&&ds!=="all"&&ds!==Fn)return;const kn=[];if(In.recurrenceType==="Agendado"){if(In.date){const Nn=In.date instanceof Date?In.date:new Date(In.date);Nn>=en&&Nn<=sn&&kn.push(Nn)}}else if(In.day){const Nn=Yn[In.day.toLowerCase()];Nn!==void 0&&(In.recurrenceType==="Mensal"&&In.months&&In.months.length>0?In.months:Array.from({length:12},(is,ps)=>ps+1)).forEach(is=>{const ps=new Date(qr,is-1,1),ns=new Date(qr,is,0);if(ns<en||ps>sn)return;const ss=new Date(ps);for(;ss.getDay()!==Nn&&(ss.setDate(ss.getDate()+1),!(ss>ns)););if(In.recurrenceType==="Mensal"&&In.weekOfMonth){const Ss=In.weekOfMonth-1;ss.setDate(ss.getDate()+Ss*7),ss<=ns&&ss>=en&&ss<=sn&&kn.push(new Date(ss))}else ss<=ns&&ss>=en&&ss<=sn&&kn.push(new Date(ss))})}kn.forEach(Nn=>{Yr.push({id:`${Tn.id}-${format(Nn,"yyyy-MM-dd")}-${In.type}`,congregationId:Tn.id,congregationName:Tn.name,city:Tn.city,date:Nn,type:Fn,instrumentos:{clarinete:0,clarone:0,saxSoprano:0,saxAlto:0,saxTenor:0,saxBaritono:0,trompete:0,flugelhorn:0,euphonio:0,trombone:0,trombonito:0,tuba:0,viola:0,violino:0,cello:0,organista:0}})})})}),Yr},$a=()=>{const Yr=xa();let qr=[...Sn,...Yr];if(console.log("Ensaios salvos no banco:",Sn.length),console.log("Ensaios recorrentes gerados:",Yr.length),console.log("Total combinado:",qr.length),console.log("Tipos de ensaios gerados:",Yr.map(en=>`${en.congregationName} - ${en.type}`)),Xn){const en=parseInt(Xn);qr=qr.filter(sn=>getYear(sn.date)===en)}if(En&&En!=="all"&&(qr=qr.filter(en=>en.congregationId===En)),Qn&&Qn!=="all"&&(qr=qr.filter(en=>{const sn=xr.find(un=>un.id===en.congregationId);return(sn==null?void 0:sn.city)===Qn})),es&&es!=="all"&&es!=="annual"){const en=parseInt(es)-1;qr=qr.filter(sn=>getMonth(sn.date)===en)}return ds&&ds!=="all"&&(qr=qr.filter(en=>en.type===ds)),console.log("Aps filtros:",qr.length),qr},ys=async()=>{await cs();const Yr=$a();if(Yr.length===0){dr({title:"Nenhum ensaio encontrado",description:"No h ensaios cadastrados com os filtros selecionados.",variant:"destructive"});return}const qr=[];qr.push(["CALENDRIO DE ENSAIOS MUSICAIS"]),qr.push([]);const en=[];if(En){const Fn=xr.find(kn=>kn.id===En);en.push(`Congregao: ${Fn==null?void 0:Fn.name}`)}if(Qn&&en.push(`Cidade: ${Qn}`),ds&&ds!=="all"){const Fn=ds==="local"?"Local":ds==="regional"?"Regional":ds==="gem"?"GEM":ds==="darpe"?"DARPE":"Geral";en.push(`Tipo: ${Fn}`)}if(es&&es!=="all"&&es!=="annual"){const Fn=format(new Date(2e3,parseInt(es)-1,1),"MMMM");en.push(`Ms: ${Fn}`)}else es==="annual"&&en.push("Perodo: Anual");en.push(`Ano: ${Xn}`),en.forEach(Fn=>qr.push([Fn])),qr.push([]),qr.push(["Data","Congregao","Tipo","Cidade"]),Yr.sort((Fn,kn)=>Fn.date.getTime()-kn.date.getTime()).forEach(Fn=>{const kn=xr.find(Kn=>Kn.id===Fn.congregationId),Nn=Fn.type==="regional"?"Regional":Fn.type==="local"?"Local":Fn.type==="gem"?"GEM":Fn.type==="darpe"?"DARPE":"Geral";qr.push([format(Fn.date,"dd/MM/yyyy"),Fn.congregationName,Nn,(kn==null?void 0:kn.city)||"-"])});const un=utils.aoa_to_sheet(qr),Tn=utils.book_new();utils.book_append_sheet(Tn,un,"Ensaios");const In=`calendario-ensaios-${Xn}${es==="annual"?"-anual":es&&es!=="all"?`-${es.padStart(2,"0")}`:""}.xlsx`;writeFileSync(Tn,In),dr({title:"Calendrio exportado!",description:"O arquivo Excel foi gerado com sucesso."}),vn(!1)},xs=async()=>{await cs();const Yr=$a();if(Yr.length===0){dr({title:"Nenhum ensaio encontrado",description:"No h ensaios cadastrados com os filtros selecionados.",variant:"destructive"});return}const qr=new E("landscape");qr.setFont("helvetica"),qr.setFontSize(14),qr.setTextColor(0,0,0),qr.setFont("helvetica","bold"),qr.text("CONGREGAO CRIST NO BRASIL",qr.internal.pageSize.getWidth()/2,10,{align:"center"}),qr.setFontSize(10),qr.text("Administrao Ituiutaba-MG",qr.internal.pageSize.getWidth()/2,16,{align:"center"}),qr.setFontSize(11),qr.text(`Calendrio de Ensaios Musicais ${Xn}`,qr.internal.pageSize.getWidth()/2,22,{align:"center"}),qr.setFont("helvetica","normal"),qr.setFontSize(7),qr.setTextColor(60,60,60);let en="";if(En&&En!=="all"){const Nn=xr.find(Kn=>Kn.id===En);en+=`Congregao: ${Nn==null?void 0:Nn.name}  `}Qn&&Qn!=="all"&&(en+=`Cidade: ${Qn}  `),en&&qr.text(en,qr.internal.pageSize.getWidth()/2,27,{align:"center"});let sn=32;const un={regional:Yr.filter(Nn=>Nn.type.toLowerCase()==="regional"),local:Yr.filter(Nn=>Nn.type.toLowerCase()==="local"),gem:Yr.filter(Nn=>Nn.type.toLowerCase()==="gem"),geral:Yr.filter(Nn=>Nn.type.toLowerCase()==="geral"),darpe:Yr.filter(Nn=>Nn.type.toLowerCase()==="darpe")},Tn=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];["regional","gem","geral","darpe"].forEach(Nn=>{const Kn=un[Nn];if(Kn.length===0)return;const is=Kn.reduce((ss,Ss)=>(ss[Ss.congregationId]||(ss[Ss.congregationId]=[]),ss[Ss.congregationId].push(Ss),ss),{}),ps=Object.entries(is).map(([ss,Ss])=>{var ro,Qs;const ks=xr.find(qs=>qs.id===ss),Ns={};Ss.forEach(qs=>{const Hs=qs.date.getMonth();Ns[Hs]||(Ns[Hs]=qs.date.getDate())});const Us=Ss[0],Is=format(Us.date,"EEEE").substring(0,3),Gs=((Qs=(ro=ks==null?void 0:ks.rehearsals)==null?void 0:ro.find(qs=>qs.type.toLowerCase()===Nn))==null?void 0:Qs.time)||"09h00",so=[ks!=null&&ks.city?`${ks.city} - ${ks.name}`:(ks==null?void 0:ks.name)||"",Is,Gs];return Tn.forEach((qs,Hs)=>{so.push(Ns[Hs]?Ns[Hs].toString():"-")}),so});sn>160&&(qr.addPage(),sn=15),autoTable(qr,{startY:sn,head:[[{content:`ENSAIOS ${Nn==="regional"?"REGIONAIS":Nn==="gem"?"GEM":Nn==="geral"?"GERAIS":Nn==="darpe"?"DARPE":""}`,colSpan:15,styles:{halign:"center",fillColor:[30,58,138],textColor:255,fontSize:8,fontStyle:"bold"}}],["LOCALIDADE","DIA","HORA",...Tn]],body:ps,theme:"grid",headStyles:{fillColor:[209,213,219],textColor:[0,0,0],fontStyle:"bold",fontSize:6.5,halign:"center"},bodyStyles:{fontSize:6,textColor:[0,0,0]},columnStyles:{0:{cellWidth:32,halign:"left"},1:{cellWidth:11,halign:"center"},2:{cellWidth:11,halign:"center"}},styles:{cellPadding:1.5,lineColor:[100,100,100],lineWidth:.1,halign:"center"}}),sn=qr.lastAutoTable.finalY+3});const In=un.local;if(In.length>0){const Nn=In.reduce((Kn,is)=>{const ps=xr.find(ss=>ss.id===is.congregationId);let ns=(ps==null?void 0:ps.city)||"Sem cidade";return(ps!=null&&ps.name.toLowerCase().includes("chaveslndia")||ps!=null&&ps.name.toLowerCase().includes("chaveslandia"))&&(ns="Santa Vitria"),ns=ns.trim(),Kn[ns]||(Kn[ns]={}),Kn[ns][is.congregationId]||(Kn[ns][is.congregationId]=[]),Kn[ns][is.congregationId].push(is),Kn},{});Object.entries(Nn).forEach(([Kn,is])=>{sn>160&&(qr.addPage(),sn=15);const ps=Object.entries(is).sort(([ns],[ss])=>{const Ss=xr.find(Ns=>Ns.id===ns),ks=xr.find(Ns=>Ns.id===ss);return((Ss==null?void 0:Ss.name)||"").localeCompare((ks==null?void 0:ks.name)||"")}).map(([ns,ss])=>{var so,ro;const Ss=xr.find(Qs=>Qs.id===ns),ks={};ss.forEach(Qs=>{const qs=Qs.date.getMonth();ks[qs]||(ks[qs]=Qs.date.getDate())});const Ns=ss[0],Us=format(Ns.date,"EEEE").substring(0,3),Is=((ro=(so=Ss==null?void 0:Ss.rehearsals)==null?void 0:so.find(Qs=>Qs.type.toLowerCase()==="local"))==null?void 0:ro.time)||"19h30",Gs=[(Ss==null?void 0:Ss.name)||"",Us,Is];return Tn.forEach((Qs,qs)=>{Gs.push(ks[qs]?ks[qs].toString():"-")}),Gs});autoTable(qr,{startY:sn,head:[[{content:"ENSAIOS LOCAIS",colSpan:15,styles:{halign:"center",fillColor:[30,58,138],textColor:255,fontSize:8,fontStyle:"bold"}}],[{content:Kn.toUpperCase(),colSpan:15,styles:{halign:"center",fillColor:[30,58,138],textColor:255,fontSize:7.5,fontStyle:"bold"}}],["LOCALIDADE","DIA","HORA",...Tn]],body:ps,theme:"grid",headStyles:{fillColor:[209,213,219],textColor:[0,0,0],fontStyle:"bold",fontSize:6.5,halign:"center"},bodyStyles:{fontSize:6,textColor:[0,0,0]},columnStyles:{0:{cellWidth:32,halign:"left"},1:{cellWidth:11,halign:"center"},2:{cellWidth:11,halign:"center"}},styles:{cellPadding:1.5,lineColor:[100,100,100],lineWidth:.1,halign:"center"}}),sn=qr.lastAutoTable.finalY+3})}const Fn=qr.internal.pages.length-1;for(let Nn=1;Nn<=Fn;Nn++)qr.setPage(Nn),qr.setFontSize(7),qr.setTextColor(120,120,120),qr.text(`Total de ensaios: ${Yr.length} | Gerado em ${format(new Date,"dd/MM/yyyy 's' HH:mm")}`,qr.internal.pageSize.getWidth()/2,qr.internal.pageSize.getHeight()-7,{align:"center"});const kn=`calendario-ensaios-${Xn}${es==="annual"?"-anual":es&&es!=="all"?`-${es.padStart(2,"0")}`:""}.pdf`;qr.save(kn),dr({title:"Calendrio exportado!",description:"O arquivo PDF foi gerado com sucesso."}),vn(!1)};return jsxRuntimeExports.jsxs(DashboardLayout,{children:[jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-foreground",children:"Musical"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mt-1",children:"Gerencie msicos e organistas da regio"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"gap-2",children:[jsxRuntimeExports.jsx(FileUp,{className:"h-4 w-4"}),"Importar Dados"]})}),jsxRuntimeExports.jsxs(DropdownMenuContent,{align:"end",children:[jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:()=>Kr(!0),children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4 mr-2"}),"Importar PDF"]}),jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:()=>Kr(!0),children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Importar Excel"]})]})]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"gap-2",onClick:()=>_e(!0),children:[jsxRuntimeExports.jsx(Music,{className:"h-4 w-4"}),"Frequncia de Ensaios"]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"gap-2",onClick:()=>{cs(),vn(!0)},children:[jsxRuntimeExports.jsx(Calendar,{className:"h-4 w-4"}),"Calendrio de Ensaios",jsxRuntimeExports.jsx(Filter,{className:"h-4 w-4"})]})]})]}),jsxRuntimeExports.jsx(Dialog,{open:e,onOpenChange:_e,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-lg",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Lanar Frequncia de Ensaios"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Preencha os dados para registrar a frequncia dos ensaios."})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end pb-2",children:jsxRuntimeExports.jsxs(Button,{variant:"secondary",size:"sm",onClick:mr,children:[jsxRuntimeExports.jsx(Printer,{className:"h-4 w-4 mr-1"})," Imprimir Frequncia"]})}),jsxRuntimeExports.jsxs("form",{className:"space-y-4",onSubmit:async Yr=>{Yr.preventDefault();const qr=xr.find(en=>en.id===ir);if(!er||!rr||!ir||!qr){dr({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios.",variant:"destructive"});return}if(er==="regional"&&(!sr||!lr)){dr({title:"Campos obrigatrios",description:"Informe o nome do Ancio e Encarregado Regional.",variant:"destructive"});return}try{await ensaioDataService.create({congregationId:ir,congregationName:qr.name,city:qr.city,date:new Date(rr),type:er,instrumentos:fr,anciao:er==="regional"?sr:void 0,encarregado:er==="regional"?lr:void 0}),dr({title:"Frequncia lanada!",description:"Frequncia de ensaio registrada com sucesso."}),_e(!1),tr("local"),nr(format(new Date,"yyyy-MM-dd")),ar(""),or(""),ur(""),cr({clarinete:0,clarone:0,saxSoprano:0,saxAlto:0,saxTenor:0,saxBaritono:0,trompete:0,flugelhorn:0,euphonio:0,trombone:0,trombonito:0,tuba:0,viola:0,violino:0,cello:0,organista:0})}catch{dr({title:"Erro ao lanar frequncia",description:"Ocorreu um erro ao salvar.",variant:"destructive"})}},children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"frequencia-tipo",children:"Tipo de Ensaio *"}),jsxRuntimeExports.jsxs(Select,{value:er,onValueChange:Yr=>tr(Yr),children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"frequencia-tipo",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Selecione"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"regional",children:"Regional"}),jsxRuntimeExports.jsx(SelectItem,{value:"local",children:"Local"}),jsxRuntimeExports.jsx(SelectItem,{value:"gem",children:"GEM"}),jsxRuntimeExports.jsx(SelectItem,{value:"geral",children:"Geral"}),jsxRuntimeExports.jsx(SelectItem,{value:"darpe",children:"DARPE"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"frequencia-data",children:"Data *"}),jsxRuntimeExports.jsx(Input,{id:"frequencia-data",type:"date",value:rr,onChange:Yr=>nr(Yr.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"frequencia-congregacao",children:"Congregao *"}),jsxRuntimeExports.jsxs(Select,{value:ir,onValueChange:ar,children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"frequencia-congregacao",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Selecione"})}),jsxRuntimeExports.jsx(SelectContent,{children:xr.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr.id,children:Yr.name},Yr.id))})]})]}),er==="regional"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"frequencia-anciao",children:"Nome do Ancio *"}),jsxRuntimeExports.jsx(Input,{id:"frequencia-anciao",value:sr,onChange:Yr=>or(Yr.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"frequencia-encarregado",children:"Encarregado Regional *"}),jsxRuntimeExports.jsx(Input,{id:"frequencia-encarregado",value:lr,onChange:Yr=>ur(Yr.target.value)})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Instrumentos (quantidade)"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(fr).map(Yr=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"capitalize",children:Yr}),jsxRuntimeExports.jsx(Input,{type:"number",min:0,value:fr[Yr],onChange:qr=>cr({...fr,[Yr]:Number(qr.target.value)}),className:"w-16"})]},Yr))})]}),jsxRuntimeExports.jsxs(DialogFooter,{className:"pt-4",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",type:"button",onClick:()=>_e(!1),children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",children:"Salvar Frequncia"})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[jsxRuntimeExports.jsxs(Card,{className:"lg:col-span-1",children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Music,{className:"h-5 w-5"}),"Cadastrar Msico/Organista"]}),jsxRuntimeExports.jsx(CardDescription,{children:"Adicione novos msicos da regio"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-name",children:"Nome *"}),jsxRuntimeExports.jsx(Input,{id:"musician-name",placeholder:"Nome completo",value:_r,onChange:Yr=>Ar(Yr.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-congregation",children:"Comum Congregao *"}),jsxRuntimeExports.jsxs(Select,{value:Pr,onValueChange:Ir,children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"musician-congregation",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Selecione"})}),jsxRuntimeExports.jsx(SelectContent,{children:xr.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr.id,children:Yr.name},Yr.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-city",children:"Cidade *"}),jsxRuntimeExports.jsx(Input,{id:"musician-city",placeholder:"Cidade",value:wr,onChange:Yr=>kr(Yr.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-phone",children:"Telefone *"}),jsxRuntimeExports.jsx(Input,{id:"musician-phone",type:"tel",placeholder:"(00) 00000-0000",value:Mr,onChange:Yr=>Hr(Yr.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-instrument",children:"Instrumento *"}),jsxRuntimeExports.jsxs(Select,{value:Gr,onValueChange:zr,children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"musician-instrument",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Selecione"})}),jsxRuntimeExports.jsx(SelectContent,{children:INSTRUMENTS.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr,children:Yr},Yr))})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"musician-stage",children:"Etapa *"}),jsxRuntimeExports.jsxs(Select,{value:Br,onValueChange:Yr=>Vr(Yr),children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"musician-stage",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:STAGES.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr,children:Yr},Yr))})]})]}),jsxRuntimeExports.jsx(Button,{onClick:Ls,disabled:Tr,className:"w-full",children:Tr?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Cadastrando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Plus,{className:"mr-2 h-4 w-4"}),"Cadastrar"]})})]})]}),jsxRuntimeExports.jsxs(Card,{className:"lg:col-span-2",children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Music,{className:"h-5 w-5"}),"Msicos e Organistas"]}),jsxRuntimeExports.jsxs(CardDescription,{children:["Total: ",pn.length," msico",pn.length!==1?"s":""]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 pt-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),jsxRuntimeExports.jsx(Input,{placeholder:"Buscar nome...",value:Lr,onChange:Yr=>Or(Yr.target.value),className:"pl-8"})]}),jsxRuntimeExports.jsxs(Select,{value:Rr,onValueChange:Xr,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Instrumento"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:" ",children:"Todos"}),INSTRUMENTS.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr,children:Yr},Yr))]})]}),jsxRuntimeExports.jsxs(Select,{value:an,onValueChange:yr,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Etapa"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:" ",children:"Todas"}),STAGES.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr,children:Yr},Yr))]})]}),jsxRuntimeExports.jsxs(Select,{value:br,onValueChange:Er,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Congregao"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:" ",children:"Todas"}),xr.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr.id,children:Yr.name},Yr.id))]})]})]})]}),jsxRuntimeExports.jsx(CardContent,{children:vr?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-8",children:jsxRuntimeExports.jsx(Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):pn.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[jsxRuntimeExports.jsx(Music,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Nenhum msico encontrado"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-6",children:STAGES.map(Yr=>{const qr=Pn[Yr];return qr.length===0?null:jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-border",children:[jsxRuntimeExports.jsx(Badge,{className:Rn(Yr),children:Yr}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",qr.length,")"]})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-2",children:qr.map(en=>jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between p-3 rounded-lg bg-secondary/20 border border-secondary/40",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold",children:en.name}),jsxRuntimeExports.jsx(Badge,{variant:"outline",children:en.instrument})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:[en.congregationName,"  ",en.city]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",en.phone]})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",onClick:()=>As(en.id,en.name),children:jsxRuntimeExports.jsx(Trash2,{className:"h-4 w-4 text-destructive"})})]},en.id))})]},Yr)})})})]})]})]}),jsxRuntimeExports.jsx(Dialog,{open:_n,onOpenChange:Kr,children:jsxRuntimeExports.jsxs(DialogContent,{className:"sm:max-w-3xl max-h-[90vh]",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Importar Msicos"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Selecione um arquivo PDF ou Excel/CSV contendo dados de msicos"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:Cn.length===0?jsxRuntimeExports.jsxs(Tabs,{defaultValue:"pdf",className:"w-full",children:[jsxRuntimeExports.jsxs(TabsList,{className:"grid w-full grid-cols-2",children:[jsxRuntimeExports.jsxs(TabsTrigger,{value:"pdf",children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4 mr-2"}),"PDF"]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"excel",children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Excel/CSV"]})]}),jsxRuntimeExports.jsx(TabsContent,{value:"pdf",className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[jsxRuntimeExports.jsx(Upload,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),jsxRuntimeExports.jsxs(Label,{htmlFor:"pdf-upload",className:"cursor-pointer",children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium mb-2",children:wn?"Processando PDF...":"Clique para selecionar um arquivo PDF"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mb-3",children:"Formato esperado: Nome | Congregao | Cidade | Telefone | Instrumento | Etapa"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",type:"button",children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4 mr-2"}),"Selecionar PDF"]})]}),jsxRuntimeExports.jsx(Input,{id:"pdf-upload",type:"file",accept:".pdf",onChange:_i,disabled:wn,className:"hidden"}),wn&&jsxRuntimeExports.jsx("div",{className:"mt-4 flex justify-center",children:jsxRuntimeExports.jsx(Loader2,{className:"h-6 w-6 animate-spin text-primary"})})]})}),jsxRuntimeExports.jsx(TabsContent,{value:"excel",className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[jsxRuntimeExports.jsx(Upload,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),jsxRuntimeExports.jsxs(Label,{htmlFor:"excel-upload",className:"cursor-pointer",children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium mb-2",children:wn?"Processando arquivo...":"Clique para selecionar um arquivo Excel ou CSV"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mb-3",children:"Formato esperado: Colunas - Nome | Congregao | Cidade | Telefone | Instrumento | Etapa"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",type:"button",children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Selecionar Excel/CSV"]})]}),jsxRuntimeExports.jsx(Input,{id:"excel-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:ms,disabled:wn,className:"hidden"}),wn&&jsxRuntimeExports.jsx("div",{className:"mt-4 flex justify-center",children:jsxRuntimeExports.jsx(Loader2,{className:"h-6 w-6 animate-spin text-primary"})})]})})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 bg-primary/10 rounded-lg border border-primary/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(Music,{className:"h-5 w-5 text-primary"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold",children:"Dados Prontos para Importao"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:[Cn.length," msico(s) encontrado(s)  Revise antes de confirmar"]})]})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:gn,children:"Limpar"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-2",children:[jsxRuntimeExports.jsx(Label,{className:"text-xs text-muted-foreground uppercase",children:"Preview dos Dados"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground",children:[Cn.length," ",Cn.length===1?"registro":"registros"]})]}),jsxRuntimeExports.jsx("div",{className:"max-h-80 overflow-y-auto space-y-2 border rounded-lg p-4 bg-muted/30",children:Cn.map((Yr,qr)=>jsxRuntimeExports.jsx("div",{className:"flex items-start justify-between p-3 rounded-lg bg-secondary/20 border border-secondary/40",children:jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold",children:Yr.name}),jsxRuntimeExports.jsx(Badge,{variant:"outline",children:Yr.instrument}),jsxRuntimeExports.jsx(Badge,{className:Rn(Yr.stage),children:Yr.stage})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:[Yr.congregationName,"  ",Yr.city]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",Yr.phone]})]})},qr))})]})]})}),jsxRuntimeExports.jsx(DialogFooter,{children:Cn.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:gn,disabled:xn,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{onClick:bs,disabled:xn,children:xn?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Importando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Upload,{className:"mr-2 h-4 w-4"}),"Confirmar e Importar"]})})]})})]})}),jsxRuntimeExports.jsx(Dialog,{open:on,onOpenChange:vn,children:jsxRuntimeExports.jsxs(DialogContent,{className:"sm:max-w-md",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Exportar Calendrio de Ensaios"}),jsxRuntimeExports.jsx(DialogDescription,{children:Wn?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Loader2,{className:"h-3 w-3 animate-spin"}),"Carregando ensaios..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Sn.length," ensaio",Sn.length!==1?"s":""," encontrado",Sn.length!==1?"s":"","  Escolha os filtros para gerar o calendrio"]})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Congregao"}),jsxRuntimeExports.jsxs(Select,{value:En,onValueChange:ba,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Todas"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Todas"}),xr.map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr.id,children:Yr.name},Yr.id))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Cidade"}),jsxRuntimeExports.jsxs(Select,{value:Qn,onValueChange:vs,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Todas"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Todas"}),Array.from(new Set(xr.map(Yr=>Yr.city))).sort().map(Yr=>jsxRuntimeExports.jsx(SelectItem,{value:Yr,children:Yr},Yr))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Tipo de Ensaio"}),jsxRuntimeExports.jsxs(Select,{value:ds,onValueChange:Yr=>Ps(Yr),children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Todos"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Todos os Tipos"}),jsxRuntimeExports.jsx(SelectItem,{value:"local",children:"Local"}),jsxRuntimeExports.jsx(SelectItem,{value:"regional",children:"Regional"}),jsxRuntimeExports.jsx(SelectItem,{value:"gem",children:"GEM"}),jsxRuntimeExports.jsx(SelectItem,{value:"geral",children:"Geral"}),jsxRuntimeExports.jsx(SelectItem,{value:"darpe",children:"DARPE"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Ms"}),jsxRuntimeExports.jsxs(Select,{value:es,onValueChange:ls,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Prximos 3 meses"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Prximos 3 meses"}),jsxRuntimeExports.jsx(SelectItem,{value:"annual",children:"Anual (12 meses)"}),jsxRuntimeExports.jsx(SelectItem,{value:"1",children:"Janeiro"}),jsxRuntimeExports.jsx(SelectItem,{value:"2",children:"Fevereiro"}),jsxRuntimeExports.jsx(SelectItem,{value:"3",children:"Maro"}),jsxRuntimeExports.jsx(SelectItem,{value:"4",children:"Abril"}),jsxRuntimeExports.jsx(SelectItem,{value:"5",children:"Maio"}),jsxRuntimeExports.jsx(SelectItem,{value:"6",children:"Junho"}),jsxRuntimeExports.jsx(SelectItem,{value:"7",children:"Julho"}),jsxRuntimeExports.jsx(SelectItem,{value:"8",children:"Agosto"}),jsxRuntimeExports.jsx(SelectItem,{value:"9",children:"Setembro"}),jsxRuntimeExports.jsx(SelectItem,{value:"10",children:"Outubro"}),jsxRuntimeExports.jsx(SelectItem,{value:"11",children:"Novembro"}),jsxRuntimeExports.jsx(SelectItem,{value:"12",children:"Dezembro"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Ano"}),jsxRuntimeExports.jsxs(Select,{value:Xn,onValueChange:ws,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Ano atual"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:String(new Date().getFullYear()),children:new Date().getFullYear()}),jsxRuntimeExports.jsx(SelectItem,{value:String(new Date().getFullYear()+1),children:new Date().getFullYear()+1})]})]})]})]}),!Wn&&Sn.length>0&&jsxRuntimeExports.jsxs("div",{className:"border-t pt-4",children:[jsxRuntimeExports.jsxs(Label,{className:"text-sm font-semibold mb-2 block",children:["Ensaios que sero exportados (",$a().length,")"]}),jsxRuntimeExports.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:$a().length===0?jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum ensaio encontrado com os filtros selecionados"}):$a().sort((Yr,qr)=>Yr.date.getTime()-qr.date.getTime()).map((Yr,qr)=>{const en=xr.find(un=>un.id===Yr.congregationId),sn=Yr.type==="regional"?"Regional":Yr.type==="local"?"Local":Yr.type==="gem"?"GEM":Yr.type==="darpe"?"DARPE":"Geral";return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded text-xs",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:format(Yr.date,"dd/MM/yyyy")}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),jsxRuntimeExports.jsx("span",{children:Yr.congregationName})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs",children:sn}),en&&jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:en.city})]})]},qr)})})]}),jsxRuntimeExports.jsxs(DialogFooter,{className:"flex-col sm:flex-row gap-2",children:[jsxRuntimeExports.jsxs(Button,{onClick:()=>{if($a().length===0){dr({title:"Nenhum ensaio encontrado",description:"No h ensaios cadastrados com os filtros selecionados.",variant:"destructive"});return}Mn(!0)},disabled:Wn,variant:"default",className:"w-full sm:w-auto",children:[jsxRuntimeExports.jsx(Calendar,{className:"h-4 w-4 mr-2"}),"Preview e Imprimir"]}),jsxRuntimeExports.jsxs(Button,{onClick:ys,disabled:Wn,variant:"outline",className:"w-full sm:w-auto",children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Exportar Excel"]})]})]})}),jsxRuntimeExports.jsx(Dialog,{open:Zn,onOpenChange:Mn,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Preview do Calendrio de Ensaios Musicais"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Visualize o calendrio antes de imprimir"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto border rounded-lg p-6 bg-white",id:"calendar-preview-content",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-6 print:mb-4",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-1 print:text-xl",children:"CONGREGAO CRIST NO BRASIL"}),jsxRuntimeExports.jsxs("h2",{className:"text-lg font-semibold text-gray-700 mb-1 print:text-base",children:["Calendrio de Ensaios Musicais ",Xn]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 mb-4 print:text-xs",children:[En&&En!=="all"&&jsxRuntimeExports.jsxs("span",{className:"mr-3",children:[" ",(Jr=xr.find(Yr=>Yr.id===En))==null?void 0:Jr.name]}),Qn&&Qn!=="all"&&jsxRuntimeExports.jsxs("span",{className:"mr-3",children:[" ",Qn]})]})]}),(()=>{const Yr=$a().sort((un,Tn)=>un.date.getTime()-Tn.date.getTime()),qr={regional:Yr.filter(un=>un.type.toLowerCase()==="regional"),gem:Yr.filter(un=>un.type.toLowerCase()==="gem"),geral:Yr.filter(un=>un.type.toLowerCase()==="geral"),darpe:Yr.filter(un=>un.type.toLowerCase()==="darpe"),local:Yr.filter(un=>un.type.toLowerCase()==="local")},en=qr.local.reduce((un,Tn)=>{const In=xr.find(kn=>kn.id===Tn.congregationId);let Fn=(In==null?void 0:In.city)||"Sem cidade";return(In!=null&&In.name.toLowerCase().includes("chaveslndia")||In!=null&&In.name.toLowerCase().includes("chaveslandia"))&&(Fn="Santa Vitria"),Fn=Fn.trim(),un[Fn]||(un[Fn]={}),un[Fn][Tn.congregationId]||(un[Fn][Tn.congregationId]=[]),un[Fn][Tn.congregationId].push(Tn),un},{}),sn=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[["regional","gem","geral","darpe"].map(un=>{const Tn=qr[un];if(Tn.length===0)return null;const In=Tn.reduce((kn,Nn)=>(kn[Nn.congregationId]||(kn[Nn.congregationId]=[]),kn[Nn.congregationId].push(Nn),kn),{}),Fn=un==="regional"?"REGIONAIS":un==="gem"?"GEM":un==="darpe"?"DARPE":"GERAIS";return jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("h3",{className:"bg-blue-900 text-white text-center font-bold py-2 text-sm print:text-xs",children:["ENSAIOS ",Fn]}),jsxRuntimeExports.jsxs("table",{className:"w-full border-collapse text-xs print:text-[10px]",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"bg-gray-300",children:[jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left font-semibold",children:"LOCALIDADE"}),jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-center font-semibold",children:"DIA"}),jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-center font-semibold",children:"HORA"}),sn.map(kn=>jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-1 py-1 text-center font-semibold",children:kn},kn))]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(In).map(([kn,Nn])=>{var Ss,ks;const Kn=xr.find(Ns=>Ns.id===kn),is={};Nn.forEach(Ns=>{const Us=Ns.date.getMonth();is[Us]||(is[Us]=Ns.date.getDate())});const ps=Nn[0],ns=format(ps.date,"EEEE"),ss=((ks=(Ss=Kn==null?void 0:Kn.rehearsals)==null?void 0:Ss.find(Ns=>Ns.type.toLowerCase()===un))==null?void 0:ks.time)||"09h00";return jsxRuntimeExports.jsxs("tr",{className:"hover:bg-gray-50",children:[jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1",children:Kn!=null&&Kn.city?`${Kn.city} - ${Kn.name}`:Kn==null?void 0:Kn.name}),jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center capitalize",children:ns.substring(0,3)}),jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center",children:ss}),sn.map((Ns,Us)=>jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-1 py-1 text-center",children:is[Us]||"-"},Us))]},kn)})})]})]},un)}),Object.keys(en).length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"bg-blue-900 text-white text-center font-bold py-2 text-sm print:text-xs",children:"ENSAIOS LOCAIS"}),Object.entries(en).map(([un,Tn])=>jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h4",{className:"bg-blue-900 text-white text-center font-bold py-1.5 text-sm print:text-xs",children:un.toUpperCase()}),jsxRuntimeExports.jsxs("table",{className:"w-full border-collapse text-xs print:text-[10px]",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"bg-gray-300",children:[jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left font-semibold",children:"LOCALIDADE"}),jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-center font-semibold",children:"DIA"}),jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-2 py-1 text-center font-semibold",children:"HORA"}),sn.map(In=>jsxRuntimeExports.jsx("th",{className:"border border-gray-400 px-1 py-1 text-center font-semibold",children:In},In))]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(Tn).sort(([In],[Fn])=>{const kn=xr.find(Kn=>Kn.id===In),Nn=xr.find(Kn=>Kn.id===Fn);return((kn==null?void 0:kn.name)||"").localeCompare((Nn==null?void 0:Nn.name)||"")}).map(([In,Fn])=>{var ns,ss;const kn=xr.find(Ss=>Ss.id===In),Nn={};Fn.forEach(Ss=>{const ks=Ss.date.getMonth();Nn[ks]||(Nn[ks]=Ss.date.getDate())});const Kn=Fn[0],is=format(Kn.date,"EEEE"),ps=((ss=(ns=kn==null?void 0:kn.rehearsals)==null?void 0:ns.find(Ss=>Ss.type.toLowerCase()==="local"))==null?void 0:ss.time)||"19h30";return jsxRuntimeExports.jsxs("tr",{className:"hover:bg-gray-50",children:[jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1",children:kn==null?void 0:kn.name}),jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center capitalize",children:is.substring(0,3)}),jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center",children:ps}),sn.map((Ss,ks)=>jsxRuntimeExports.jsx("td",{className:"border border-gray-400 px-1 py-1 text-center",children:Nn[ks]||"-"},ks))]},In)})})]})]},un))]}),Yr.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-gray-500",children:jsxRuntimeExports.jsx("p",{children:"Nenhum ensaio encontrado com os filtros selecionados"})}),jsxRuntimeExports.jsxs("div",{className:"mt-6 text-xs text-gray-600 print:text-[10px]",children:[jsxRuntimeExports.jsxs("p",{className:"font-semibold",children:["Total de ensaios: ",Yr.length]}),jsxRuntimeExports.jsxs("p",{className:"mt-1",children:["Gerado em ",format(new Date,"dd/MM/yyyy 's' HH:mm")]})]})]})})()]}),jsxRuntimeExports.jsxs(DialogFooter,{className:"gap-2 no-print",children:[jsxRuntimeExports.jsx(Button,{onClick:()=>Mn(!1),variant:"outline",children:"Fechar"}),jsxRuntimeExports.jsxs(Button,{onClick:()=>window.print(),variant:"outline",className:"gap-2",children:[jsxRuntimeExports.jsx(Printer,{className:"h-4 w-4"}),"Imprimir Direto"]}),jsxRuntimeExports.jsxs(Button,{onClick:()=>{xs(),Mn(!1)},className:"gap-2",children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4"}),"Salvar como PDF"]})]})]})}),jsxRuntimeExports.jsx(AlertDialog,{open:Ur,onOpenChange:$r,children:jsxRuntimeExports.jsxs(AlertDialogContent,{children:[jsxRuntimeExports.jsxs(AlertDialogHeader,{children:[jsxRuntimeExports.jsx(AlertDialogTitle,{children:"Confirmar remoo"}),jsxRuntimeExports.jsxs(AlertDialogDescription,{children:["Tem certeza que deseja remover"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:Zr==null?void 0:Zr.name}),"? Esta ao no pode ser desfeita."]})]}),jsxRuntimeExports.jsxs(AlertDialogFooter,{children:[jsxRuntimeExports.jsx(AlertDialogCancel,{children:"Cancelar"}),jsxRuntimeExports.jsx(AlertDialogAction,{onClick:yn,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(Musical,{})}));export{_typeof as _,commonjsGlobal as c,getDefaultExportFromCjs as g};
